[
    {
        "content": "<p>I am starting to work on <a href=\"https://github.com/zulip/zulip/pull/3683\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/3683\">#3683</a> <code>Create a stream owner/permission concept.</code> <br>\nMost of frontend bugs for stream settings are covered in PR <a href=\"https://github.com/zulip/zulip/pull/8029\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/8029\">#8029</a> and <a href=\"https://github.com/zulip/zulip/pull/7987\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/7987\">#7987</a>.<br>\n<strong>What I get from the discussion on issue <a href=\"https://github.com/zulip/zulip/pull/3683\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/3683\"><a href=\"https://github.com/zulip/zulip/pull/3683\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/3683\">#3683</a></a>, <a href=\"https://github.com/zulip/zulip/pull/566\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/566\"><a href=\"https://github.com/zulip/zulip/pull/566\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/566\">#566</a></a> thread?</strong></p>\n<p><strong>Who is stream owner by default?</strong><br>\nUser who create stream.</p>\n<p><strong>How stream owner will differ from other subscriber to stream?</strong><br>\nStream owner will be only subscriber to stream </p>\n<ul>\n<li>who can edit stream settings like name, description, type. </li>\n<li>who can unsubscribe other user from stream</li>\n<li>who can add other user to stream(not sure about this one either we want to go with the current behavior or restrict it to only stream owner, in current scenario every user in stream can add other user)</li>\n<li>who can make other user as stream owner.</li>\n</ul>\n<p><strong>Can stream have more than one stream owner?</strong><br>\nYES, stream owner can make stream owner from subscriber to stream.<br>\nEvery stream owner has the same admin rights.</p>\n<p><strong>How many admin rights org admin will have for stream settings?</strong>(current behavior)</p>\n<ul>\n<li>Org admin can always delete stream from org settings.</li>\n<li>Org admin can not access private stream information(other then name,description) if admin not subscribed</li>\n<li>Org admin can unsubscribe user from public stream.</li>\n<li>Org admin can edit public streams settings.<br>\n NOTE: If org admin is subscribed to private stream, and not a stream owner then org admin will not be able to edit stream settings.(not current behavior)</li>\n</ul>\n<p><strong>What if there is only one stream owner and he/she leaves the stream?</strong><br>\nWhen stream owner will leave the stream, owner must give admin rights to someone from subscriber of stream. <br>\nThere will be no private stream without stream owner.(should we allow public stream without owner?)</p>\n<p><strong>Wouldn't stream owner for public stream has the same admin rights as org admin have for public stream?</strong><br>\nYes.</p>\n<p>Do I miss anything here? Any suggestions?</p>",
        "id": 438815,
        "sender_full_name": "Yashashvi Dave",
        "timestamp": 1515611435
    },
    {
        "content": "<p>Some corrections/clarifications/answers:</p>\n<ul>\n<li>\n<p>Simply keeping track of the stream owner will be an important milestone for us, so think of this as you set up your commits.  (And then we'll gradually empower them--it should be pretty quick to iterate once we have the basic concept in place.)</p>\n</li>\n<li>\n<p>Any user can add other users to public streams, but only stream owners and org admins can remove other subscribers, edit descriptions, and appoint other stream owners.  For public streams I can't think of any difference between owners and org admins.  But the main point of this feature is definitely <strong>private</strong> streams, since in some cases private stream owners will have even more power over their streams than unsubscribed org admins do.</p>\n</li>\n<li>\n<p>We can allow non-owned public streams, since org admins already have plenty of power there.</p>\n</li>\n</ul>",
        "id": 438892,
        "sender_full_name": "Steve Howell",
        "timestamp": 1515613565
    },
    {
        "content": "<p>I have implemented following:</p>\n<ul>\n<li>Add <code>is_admin</code> property in <code>Subscription</code> model</li>\n<li>Add method for setting this property in <code>actions.py</code></li>\n<li>In frontend we will have one more widget for stream admin(just like we have one in <code>Organization settings--&gt;User groups--&gt;Subscribers</code> in which current user will automatically added.</li>\n<li>User(who is creating stream) can add other user in that widget</li>\n<li>Set all added user as stream admins in that widget</li>\n<li>While creating stream check if stream admins is none and stream is private return jsonerror</li>\n</ul>\n<p>Work to do next:</p>\n<ul>\n<li>Add stream admin widget in <code>Stream settings</code> and allow stream admins to handle(add/remove) other stream admins</li>\n<li>Add validation <code>is_admin</code> for changing stream properties</li>\n</ul>\n<p>But I am so confused how I should commit this work. <span class=\"emoji emoji-1f615\" title=\"confused\">:confused:</span> <br>\nShould I add this all in one commit? If in separate commits, please guide that in which order should I commit.</p>",
        "id": 446929,
        "sender_full_name": "Yashashvi Dave",
        "timestamp": 1516000587
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"yashashvidave@gmail.com\" data-user-id=\"3244\">@Yashashvi Dave</span> You should try to be thoughtful about separating these commits, but we don't necessarily expect all of them to be small.  I do think it's almost always possible to have the first commits be backend only.  It might break down like this:</p>\n<ul>\n<li>add model + migration</li>\n<li>add basic endpoint with fully correct authentication and thorough tests</li>\n<li>allow stream admin to add subscriber w/thorough tests (even though it's backend only and we won't actually surface it on the UI, it will still be a valid commit)</li>\n</ul>\n<p>We will probably want management commands here to assign stream owners, too.</p>",
        "id": 449319,
        "sender_full_name": "Steve Howell",
        "timestamp": 1516106859
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"showell@zulipchat.com\" data-user-id=\"58\">@Steve Howell</span> Wants to know your suggestions on this one. <br>\n<strong>When stream is created</strong><br>\nPassing list of admins on POST method of <code>/users/me/subscriptions</code>endpoint which calls <code>add_subscriptions_backend</code>.  So the <code>add_subscriptions_backend</code> method will look like this:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nd\">@has_request_variables</span>\n<span class=\"k\">def</span> <span class=\"nf\">add_subscriptions_backend</span><span class=\"p\">(</span>\n        <span class=\"n\">request</span><span class=\"p\">:</span> <span class=\"n\">HttpRequest</span><span class=\"p\">,</span> <span class=\"n\">user_profile</span><span class=\"p\">:</span> <span class=\"n\">UserProfile</span><span class=\"p\">,</span>\n        <span class=\"n\">streams_raw</span><span class=\"p\">:</span> <span class=\"n\">Iterable</span><span class=\"p\">[</span><span class=\"n\">Mapping</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">Text</span><span class=\"p\">]]</span><span class=\"o\">=</span><span class=\"n\">REQ</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;subscriptions&quot;</span><span class=\"p\">,</span> <span class=\"n\">validator</span><span class=\"o\">=</span><span class=\"n\">check_list</span><span class=\"p\">(</span><span class=\"n\">check_dict</span><span class=\"p\">([(</span><span class=\"s1\">&#39;name&#39;</span><span class=\"p\">,</span> <span class=\"n\">check_string</span><span class=\"p\">)]))),</span>\n        <span class=\"n\">invite_only</span><span class=\"p\">:</span> <span class=\"nb\">bool</span><span class=\"o\">=</span><span class=\"n\">REQ</span><span class=\"p\">(</span><span class=\"n\">validator</span><span class=\"o\">=</span><span class=\"n\">check_bool</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"bp\">False</span><span class=\"p\">),</span>\n        <span class=\"n\">announce</span><span class=\"p\">:</span> <span class=\"nb\">bool</span><span class=\"o\">=</span><span class=\"n\">REQ</span><span class=\"p\">(</span><span class=\"n\">validator</span><span class=\"o\">=</span><span class=\"n\">check_bool</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"bp\">False</span><span class=\"p\">),</span>\n        <span class=\"n\">principals</span><span class=\"p\">:</span> <span class=\"n\">List</span><span class=\"p\">[</span><span class=\"n\">Text</span><span class=\"p\">]</span><span class=\"o\">=</span><span class=\"n\">REQ</span><span class=\"p\">(</span><span class=\"n\">validator</span><span class=\"o\">=</span><span class=\"n\">check_list</span><span class=\"p\">(</span><span class=\"n\">check_string</span><span class=\"p\">),</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"p\">[]),</span>\n        <span class=\"n\">stream_admins</span><span class=\"p\">:</span> <span class=\"n\">List</span><span class=\"p\">[</span><span class=\"n\">Text</span><span class=\"p\">]</span><span class=\"o\">=</span><span class=\"n\">REQ</span><span class=\"p\">(</span><span class=\"n\">validator</span><span class=\"o\">=</span><span class=\"n\">check_list</span><span class=\"p\">(</span><span class=\"n\">check_string</span><span class=\"p\">),</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"p\">[]),</span>\n        <span class=\"n\">authorization_errors_fatal</span><span class=\"p\">:</span> <span class=\"nb\">bool</span><span class=\"o\">=</span><span class=\"n\">REQ</span><span class=\"p\">(</span><span class=\"n\">validator</span><span class=\"o\">=</span><span class=\"n\">check_bool</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"bp\">True</span><span class=\"p\">),</span>\n<span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"n\">HttpResponse</span><span class=\"p\">:</span>\n</pre></div>\n\n\n<p>This method calls <code>bulk_add_subscriptions</code> in <code>actions.py</code>. Pass the list of admins to this method. This method will pass <code>is_admin</code> value(when <code>Subscription</code> object is created) by checking user exists in stream admin list or not. </p>\n<p><strong>To change value afterwards</strong><br>\nIn <code>actions.py</code> the function <code>do_change_subscription_property</code> can be used to change <code>is_admin</code> flag's value.</p>\n<p>Is this correct way?</p>",
        "id": 449508,
        "sender_full_name": "Yashashvi Dave",
        "timestamp": 1516111624
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"yashashvidave@gmail.com\" data-user-id=\"3244\">@Yashashvi Dave</span> </p>\n<p>yep, that all makes sense to me...obviously, automated tests will be key here</p>",
        "id": 449534,
        "sender_full_name": "Steve Howell",
        "timestamp": 1516113496
    },
    {
        "content": "<p>Should we provide all permissions for stream to org admin subscribed to private stream but not a stream admin?</p>",
        "id": 458129,
        "sender_full_name": "Yashashvi Dave",
        "timestamp": 1516543597
    },
    {
        "content": "<p>I think yes</p>",
        "id": 458133,
        "sender_full_name": "Steve Howell",
        "timestamp": 1516544138
    }
]