[
    {
        "content": "<p>Hey folks! I recently chatted with a user who expressed frustration with being unable to navigate to a conversation from search results. They are on a self-hosted Zulip server, and we've made one improvement that they don't currently have access to, but I think we can do better.</p>\n<p>The things the user described having tried were: click on message? click on timestamp? click on date? three-dot menu?</p>\n<p>The change we've made already is that the timestamp now <em>does</em> take you to a \"near\" context for the message.</p>\n<p>Other ideas for how to make this common workflow easier:</p>\n<ol>\n<li>Currently, clicking on the search result topic (or the recipients in a PM thread) takes you to the message if it's been read. However, if it's unread, it takes you to the latest read message, which is super confusing. I think the topic/PM recipients link should just be a \"near\" link to the message, same as the timestamp. Note that \"near\" views don't mark messages as read, and we have a release blocker feature to show a banner explaining this and allowing the user to mark messages as read.</li>\n<li>Perhaps then entire bar should be a click target for navigating to the message (from a search view), or the topic (from, e.g., All messages).</li>\n<li>Maybe in general we should add  a \"Go to message\" or maybe \"Go to message in context\" link to the three-dot menu?</li>\n<li>We could consider adding a keyboard shortcut for going to a message near: view as well.</li>\n</ol>\n<p>The user's first idea was to click on the message itself, but I'm not sure we can make that work while keeping the experience consistent with other contexts.</p>\n<p>Thoughts on the ideas above? Any other suggestions?</p>",
        "id": 1329377,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1644963723
    },
    {
        "content": "<p>I think the 3rd option (\"Go to message in context\") should be the first approach we try.</p>\n<p>I don't think the user's idea is super crazy in a search context.  If you click on the message, it's hard for the app to know what you really want to do:</p>\n<ul>\n<li>reply to the message</li>\n<li>see the message in context</li>\n</ul>\n<p>My guess is that it's about 50/50.  It's somewhat problematic to reply to a message in a search view, because you're not seeing all the context around it, so you risk spamming a topic where things have already been addressed.  So it seems reasonable for the app to pop up a simple modal asking what you want to do.</p>",
        "id": 1329438,
        "sender_full_name": "Steve Howell",
        "timestamp": 1644966551
    },
    {
        "content": "<p>Pop ups are usually excuse way to solve a problem without solving it. That’s a last resort. I agree that the context menu is a place to add any kinds of action with a reasonable label and a hot key.  The question after that would be if we really need an additional button inside a message and if we can utilize a current element like a timestamp for that</p>",
        "id": 1329475,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644968936
    },
    {
        "content": "<p>On mobile there is no action attached to the time of a message, So it looks like a good button for show me that in context of other messages at that time“”</p>",
        "id": 1329478,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644969061
    },
    {
        "content": "<p>What's the benefit of going to the message without also bringing up the context around it?</p>",
        "id": 1329546,
        "sender_full_name": "Evy",
        "timestamp": 1644972540
    },
    {
        "content": "<p>Because having context is definitely my intuition as well (I think I've been confused about this in the past) and I'm curious how the other use case works</p>",
        "id": 1329548,
        "sender_full_name": "Evy",
        "timestamp": 1644972585
    },
    {
        "content": "<p>I think proposal 1 makes the most sense to me logically, but it might be annoying in practice -- would need to test-deploy to know.  The rule would be \"If you're currently in a view that doesn't mark messages as read and click a topic heading, you get the <code>near:</code> version of that view like if you clicked on the timestamp which lets you see the target content in a view that doesn't mark messages as read\"</p>",
        "id": 1329553,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644972728
    },
    {
        "content": "<p>It's already the case that clicking the timestamp is a permanent link to a message, though I guess the tooltip for that element does not hint that fact at all, so that could be worth changing.  But it's a small click target, and intuitively clicking the topic feels like a more natural way to navigate to a topic.  In general I think it's valuable to have consistent models that, e.g., clicking on a given element does the same thing regardless of view (E.g. clicking the stream titles takes you to that stream), but the search UI could be a reasonable exception (it takes you to that message via the permanent link mechanism)</p>",
        "id": 1329554,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644972914
    },
    {
        "content": "<p>Clicking on a message bringing you to the topic view makes sense to me globally, but I also am not a user that ever uses the view that mixes messages from different topics. So, if I click on a message then I want to see the message in context. Even if I'm just replying, I want to see the context around where I'm replying</p>",
        "id": 1329578,
        "sender_full_name": "Evy",
        "timestamp": 1644974088
    },
    {
        "content": "<p>Anecdotally, a friend of mine was having a similar issue where they wanted to reply to one of their mentions (from the @mentions view) and would often miss that someone further in the conversation had already addressed the issue (because clicking on the mention didn't bring up the context)</p>",
        "id": 1329585,
        "sender_full_name": "Evy",
        "timestamp": 1644974164
    },
    {
        "content": "<p>Actually yes. If we open the reply but do show the context (jumping in the topic view) it would be ideal, no?</p>",
        "id": 1329679,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644978222
    },
    {
        "content": "<p>Yup.  I am sure I am overlooking some annoying edge case, but I suspect doing both things here may be the right solution.</p>",
        "id": 1329689,
        "sender_full_name": "Steve Howell",
        "timestamp": 1644979027
    },
    {
        "content": "<p>There's a tradeoff here -- if we take you to a /near/ conversation view (i.e. one that centers on a message regardless of unread state, and won't mark messages as read), that could be annoying if your goal was to find a thread someone told you about and read it from the beginning.  I'm unsure if that's a significant issue, especially now that have a banner when you get to the bottom of such a view.</p>\n<p>My proposal is that we try changing the ways the recipient bar links when in a search view (<code>!filter.supports_collapsing_recipients()</code>, specifically) to be the same as the timestamp link, and see how that goes.  I suppose we'll want this to apply to the <code>s</code> keyboard shortcut as well.</p>",
        "id": 1330422,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645055378
    },
    {
        "content": "<blockquote>\n<p>I suppose we'll want this to apply to the <code>s</code> keyboard shortcut as well.</p>\n</blockquote>\n<p>Do you mean <code>Shift + s</code> (topic / PM shortcut, not stream shortcut)?</p>",
        "id": 1330465,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645057094
    },
    {
        "content": "<p>I'm excited to try <span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> 's proposal (i.e. (1)) regardless of whether we also do something else. <span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> maybe it would be best for you to write up the issue, so that the technical details can be expressed more clearly?</p>",
        "id": 1330469,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645057217
    },
    {
        "content": "<p>My philosophy on these type of debates is that the most respectful way to deal with a user is to present them with info and let them decide, even if it comes with a convenience cost.  I am wary of expecting users to figure out which elements to click on or which hotkeys to memorize to accomplish a task. I say this as a power user.</p>",
        "id": 1330479,
        "sender_full_name": "Steve Howell",
        "timestamp": 1645057568
    },
    {
        "content": "<p>(As a power user I want the best of both worlds.  Convenience and control.)</p>",
        "id": 1330489,
        "sender_full_name": "Steve Howell",
        "timestamp": 1645058012
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"22433\">Vlad Korobov</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1329679\">said</a>:</p>\n<blockquote>\n<p>Actually yes. If we open the reply but do show the context (jumping in the topic view) it would be ideal, no?</p>\n</blockquote>\n<p>That might be right... Replying to a message when you don't see the context is likely to trip people up, as in <span class=\"user-mention silent\" data-user-id=\"21453\">Evy Kassirer</span> 's friend's experience.</p>",
        "id": 1330507,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645058628
    },
    {
        "content": "<p>I suppose we could also show a \"Back to search results\" banner in that situation, or keep that idea in our back pocket if folks complain? I feel like I unintentionally click on messages with some frequency.</p>",
        "id": 1330514,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645058810
    },
    {
        "content": "<p>This is the classic debate about whether it’s better to ask for forgiveness or permission.</p>",
        "id": 1330520,
        "sender_full_name": "Steve Howell",
        "timestamp": 1645059039
    },
    {
        "content": "<p>Like every good question, the answer here depends on context.</p>",
        "id": 1330524,
        "sender_full_name": "Steve Howell",
        "timestamp": 1645059121
    },
    {
        "content": "<p>Can we just ask the user what they want to do?</p>",
        "id": 1330525,
        "sender_full_name": "Steve Howell",
        "timestamp": 1645059153
    },
    {
        "content": "<p>Well, I suppose the banner idea could go in either direction: \"Back to search results\" or \"Go to message in context\". The advantage of a banner over a popover is that you only need one click in one of the two cases (whichever one we decide should be the default).</p>",
        "id": 1330531,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645059349
    },
    {
        "content": "<p>I am obviously not super obsessed about mouse clicks, but I wouldn’t completely diminish it either. I want our app to converse with the user.  Present the user with the options and let them make explicit, informed decisions.</p>",
        "id": 1330539,
        "sender_full_name": "Steve Howell",
        "timestamp": 1645059712
    },
    {
        "content": "<p>I was actually thinking earlier about having a back to search results button</p>",
        "id": 1330710,
        "sender_full_name": "Evy",
        "timestamp": 1645118707
    },
    {
        "content": "<p>That would be my preferred workflow. And it feels common to other apps</p>",
        "id": 1330711,
        "sender_full_name": "Evy",
        "timestamp": 1645118719
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1330422\">said</a>:</p>\n<blockquote>\n<p>My proposal is that we try changing the ways the recipient bar links when in a search view (<code>!filter.supports_collapsing_recipients()</code>, specifically) to be the same as the timestamp link, and see how that goes.  I suppose we'll want this to apply to the <code>s</code> keyboard shortcut as well.</p>\n</blockquote>\n<p>This seems pretty reasonable to me. With a potential followup of a \"back to search results\" banner when viewing the conversation</p>",
        "id": 1332855,
        "sender_full_name": "Evy",
        "timestamp": 1645561064
    },
    {
        "content": "<p>Oh it seems like clicking on the topic name also goes to the correct narrow. But I think the change we want is to also have that view when clicking on the message itself? Or at least, avoiding the situation where you're replying to a message but not in its narrow</p>",
        "id": 1332858,
        "sender_full_name": "Evy",
        "timestamp": 1645561192
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"21453\">Evy Kassirer</span> where that link goes is contextual:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1329377\">said</a>:</p>\n<blockquote>\n<ol>\n<li>Currently, clicking on the search result topic (or the recipients in a PM thread) takes you to the message if it's been read. However, if it's unread, it takes you to the latest read message, which is super confusing. I think the topic/PM recipients link should just be a \"near\" link to the message, same as the timestamp. Note that \"near\" views don't mark messages as read, and we have a release blocker feature to show a banner explaining this and allowing the user to mark messages as read.</li>\n</ol>\n</blockquote>",
        "id": 1332975,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645570828
    },
    {
        "content": "<p>I filed <a href=\"https://github.com/zulip/zulip/pull/21216\">#21216</a> for the topic link change, and <a href=\"https://github.com/zulip/zulip/pull/21217\">#21217</a> for the idea of clicking on a message taking the user to the near: view for that message.</p>",
        "id": 1333002,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645571859
    },
    {
        "content": "<p>A couple more questions:</p>\n<ol>\n<li>Should we add the <code>S</code> shortcut to the topic link tooltip in the message header bar?</li>\n<li>Is it worth adding a \"Narrow to topic (<code>S</code>)\" / \"Narrow to PM conversation (<code>S</code>)\" option to the three-dot message menu in interleaved views (search views, All messages, interleaved stream views, etc.)?</li>\n</ol>",
        "id": 1333008,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645572125
    },
    {
        "content": "<p>Note that the browser <code>Back</code> button is already a \"Back to search results\" button.  The main problem with adding such a button is figuring out where to put it that won't make the app feel cluttered.</p>",
        "id": 1333043,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645573475
    },
    {
        "content": "<p>I would prefer to avoid adding additional \"Narrow to ...\" options in the 3-dot menus; clicking the timestamp right next that menu does essentially the same thing, as does clicking the recipient bar, and we put a lot of effort in the past into figuring out how to remove redundant options like that one in the past.</p>",
        "id": 1333045,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645573537
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1333008\">said</a>:</p>\n<blockquote>\n<ol>\n<li>Should we add the <code>S</code> shortcut to the topic link tooltip in the message header bar?</li>\n</ol>\n</blockquote>\n<p>Yeah, we should change those tooltips, and possibly also migrate them to Tippy while we're at it so that we can style the shortcut itself.</p>",
        "id": 1333046,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645573580
    },
    {
        "content": "<p>This was <a href=\"#narrow/stream/415-chat.2Ezulip.2Eorg/topic/experiments/near/1414753\">test-deployed</a> just now. I recommend playing around with search and clicking the recipient bars on messages, especially those that are marked unread to explore this.</p>",
        "id": 1414770,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1659572947
    },
    {
        "content": "<p>One aspect that may be a bit subtle and may deserve follow-up thinking is if you search for an old thread, and then start a conversation there without changing your view, then even if you were previously caught up, new messages that come in will not be eligible for being marked as read. There's a few directions for how we could change that if we think it's not the desired outcome, but certainly worth noting as it may be a while before someone encounters this scenario in the wild.</p>",
        "id": 1414772,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1659573030
    },
    {
        "content": "<p>I'm not a fan of it not marking as read when I click on Mentions and go from there to the conversation where I was mentioned</p>",
        "id": 1415475,
        "sender_full_name": "Evy",
        "timestamp": 1659664482
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"21453\">@Evy</span> hmm, I wonder if that's an implementation bug -- the mentions view currently lets you mark messages as read (though we may want to change that), and so I'd have expected <code>message_lists.current.can_mark_messages_read()</code> to be true, and thus this to not apply.</p>",
        "id": 1415919,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1659747617
    },
    {
        "content": "<p>I haven't reloaded all the context back into my brain, but if I remember correctly all near views don't mark messages as read?</p>",
        "id": 1415949,
        "sender_full_name": "Evy",
        "timestamp": 1659751511
    },
    {
        "content": "<p>Yeah, that looks to be the case.</p>",
        "id": 1415952,
        "sender_full_name": "Evy",
        "timestamp": 1659751601
    },
    {
        "content": "<p>And the mention links to a near view</p>",
        "id": 1415953,
        "sender_full_name": "Evy",
        "timestamp": 1659751606
    },
    {
        "content": "<p>Right, but the mentions view <strong>does</strong> mark messages as read, and that's the thing your code is checking to see if it's a search view, so I'm a bit confused.</p>",
        "id": 1416489,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1659849207
    },
    {
        "content": "<p>That said ... I think it's possible that the mentions view should work like other search views in not marking things as read -- now that we have a \"mark all as read\" button, that feels like a better experience than having clicking into the mentions view eat an unread mention.</p>",
        "id": 1416490,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1659849275
    },
    {
        "content": "<p>It's not about a search view, it's about the near view that clicking on the mentions message brings me to.</p>",
        "id": 1416705,
        "sender_full_name": "Evy",
        "timestamp": 1659897561
    },
    {
        "content": "<p>I click mentions --&gt; see a message in Mentions view --&gt; that message gets read --&gt; I click to see the rest of the conversation and reply --&gt; end up in a near view (in the topic narrow) where it says messages aren't being marked read</p>",
        "id": 1416706,
        "sender_full_name": "Evy",
        "timestamp": 1659897602
    },
    {
        "content": "<p>I agree that having the mentions view not mark as read is better than what it currently is. I could see an argument that a near view linked to by the Mentions view shouldn't do the \"don't mark as read\" thing.</p>",
        "id": 1416707,
        "sender_full_name": "Evy",
        "timestamp": 1659897685
    },
    {
        "content": "<p>Here's the challenge -- clicking on the mention should probably take you to the mention itself, even if that's 50 messages below the last thing you've read in that topic.</p>",
        "id": 1417187,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1660002422
    },
    {
        "content": "<p>But it'd be pretty bad if we marked everything as read for you in the topic above what you clicked on -- that's going to lose your place if you want to actually read the portion of the context that's new.</p>",
        "id": 1417188,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1660002462
    },
    {
        "content": "<p>Could we do something smart that can tell if all unread messages are currently in view?</p>",
        "id": 1417989,
        "sender_full_name": "Evy",
        "timestamp": 1660153155
    },
    {
        "content": "<p>It seems like part of the change that's been test-deployed here is that the shift-S shortcut no longer takes me to a view where the messages actually get marked as read in the normal way.</p>\n<p>A consequence of that is that AFAICT there no longer is any way to get to such a view with the keyboard, and no longer a way to get to such a view without doing something pretty subtle and nonobvious -- like click a second time on the topic in the recipient header.</p>",
        "id": 1418031,
        "sender_full_name": "Greg Price",
        "timestamp": 1660162572
    },
    {
        "content": "<p>Previously a thing I've regularly used is:</p>\n<ul>\n<li>I'm on some /near/NNN view.</li>\n<li>I've now read the messages and want to mark them as read -- or, it's a long thread, I've read the first few messages, and I want the ones I read to get marked as read in the normal way.</li>\n<li>So I hit shift-S. That removes the /near/NNN from the URL, so that messages get marked as read in the normal way.</li>\n</ul>\n<p>It seems like shift-S no longer removes /near/NNN, so effectively once I'm on a /near/NNN view for a given conversation shift-S no longer does anything useful. I'd like to have it start working again, at least in that situation.</p>",
        "id": 1418035,
        "sender_full_name": "Greg Price",
        "timestamp": 1660162802
    },
    {
        "content": "<p>Hmm, I would not have expected the <code>shift+S</code> behavior to change ... though I suppose logically it is basically the same as clicking on a message heading, so I'm not sure it totally makes sense for these to be inconsistent.</p>",
        "id": 1418168,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1660179624
    },
    {
        "content": "<p>I'm not sure this experiment is going to be successful as designed; it seems possible we want to think about an alternative design for how to get the \"don't mark messages read\" view.</p>",
        "id": 1418169,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1660179654
    },
    {
        "content": "<p>Hmm, the problem we were trying to solve in <a href=\"https://github.com/zulip/zulip/pull/21216\">#21216</a> was not really about whether messages were getting marked as read. It was about which message the header bar link would take you to:</p>\n<blockquote>\n<p>Currently, clicking on the search result topic (or the recipients in a PM thread) takes you to the message if it's been read. However, if it's unread, it takes you to the latest read message, which can be very confusing.</p>\n</blockquote>",
        "id": 1422944,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661192069
    },
    {
        "content": "<p>The resulting not marking as read state was just a consequence of how <code>near</code> links work in general.</p>",
        "id": 1422948,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661192146
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"2187\">Greg Price</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1418035\">said</a>:</p>\n<blockquote>\n<p>Previously a thing I've regularly used is:</p>\n<ul>\n<li>I'm on some /near/NNN view.</li>\n<li>I've now read the messages and want to mark them as read -- or, it's a long thread, I've read the first few messages, and I want the ones I read to get marked as read in the normal way.</li>\n<li>So I hit shift-S. That removes the /near/NNN from the URL, so that messages get marked as read in the normal way.</li>\n</ul>\n<p>It seems like shift-S no longer removes /near/NNN, so effectively once I'm on a /near/NNN view for a given conversation shift-S no longer does anything useful. I'd like to have it start working again, at least in that situation.</p>\n</blockquote>\n<p>Hmm, if you're currently in a \"near\" view, is removing the \"near\" part from the URL the only thing that <code>Shift-S</code> does? Or does it also potentially navigate you to a different part of the thread?</p>",
        "id": 1422950,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661192310
    },
    {
        "content": "<p>Well, currently on czo it does nothing <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> </p>\n<p>(More precisely, it changes the URL from …/near/NNN to …/near/MMM , to refer to the message the cursor is currently on -- but nothing happens in the actual page)</p>",
        "id": 1422956,
        "sender_full_name": "Greg Price",
        "timestamp": 1661192908
    },
    {
        "content": "<p>I believe before this change (so in main?), it would move the cursor to the first unread.</p>\n<p>Typically in my usage that would already be on screen, so no scrolling would happen.</p>",
        "id": 1422957,
        "sender_full_name": "Greg Price",
        "timestamp": 1661192977
    },
    {
        "content": "<p>I will note that our codebase very much has the capability to take you to a specific target message when narrowing not via <code>near</code> view; that was the default model for years before we added <code>near</code> views. The problem is doing so can lose your unread state.</p>",
        "id": 1424728,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661383057
    },
    {
        "content": "<p>I just followed up on this topic thanks to <span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span>,  after the discussion following my proposal of a necessary precursor to the original idea of <a class=\"stream-topic\" data-stream-id=\"2\" href=\"/#narrow/stream/2-general/topic/s.2FS.2Fz.20hotkeys\">#general &gt; s/S/z hotkeys</a>.</p>",
        "id": 1427342,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1661810975
    },
    {
        "content": "<p>As discussed there, this issue sounds like it would support the contextual (near) narrow changes I was looking for, in at least the PM/topic cases.<br>\n(I was hoping for ultimately a more broad change to support stream narrows and potentially others like all-messages)</p>\n<p>In that topic I anticipated the need for a hotkey/UI to switch from contextual to unread views, which seems to be the issue with this design currently? Would that be an acceptable approach?</p>",
        "id": 1427346,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1661811291
    },
    {
        "content": "<p>OK, here's a possible proposal after brainstorming some more with <span class=\"user-mention silent\" data-user-id=\"2187\">Greg Price</span>:</p>\n<ol>\n<li>\n<p>If you are in a search view that does not mark messages as read, the topic bar and <code>Shift+S</code> take you to the <code>near</code> view for the message, as in <a href=\"https://github.com/zulip/zulip/pull/21417\">#21417</a>.</p>\n</li>\n<li>\n<p>Elsewhere,  including \"near\" views, the topic bar and <code>Shift+S</code> has the current behavior of taking you to the topic (i.e. your first unread message or the end of the topic, if all messages are already read).</p>\n</li>\n</ol>\n<p>This would more narrowly solve <a href=\"https://github.com/zulip/zulip/pull/21216\">#21216</a>. It's a little tricky conceptually, but the intuitive idea is that in (1) you're taking a half-step towards viewing the conversation, and in (2) you're getting all the way there. The hope would be that it would just feel to the user like the app is doing the right thing, without them having to think too hard about these definitions. For the purposes of documentation, we could describe the two shortcut key behaviors separately, as they apply in different contexts.</p>\n<p>I'll have to think more about how this interacts with <span class=\"user-mention silent\" data-user-id=\"2406\">Neil Pilgrim (neiljp)</span> 's ideas...</p>",
        "id": 1428064,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661894342
    },
    {
        "content": "<p>It seems like you're solving Greg's shortcut concern by overloading <code>shift+S</code>/topic-bar behavior based on the initial narrow.<br>\nSo from a search, or mentions or similar, that key on a stream message would 1) go to topic near narrow then 2) go to topic narrow (next unread).</p>\n<p>I can understand that this fits with the current Zulip model of viewing a conversation generally meaning going to the next unread message, so going 'half way' first makes sense from that point of view (to a specific message). As a way to resolve the specific issue, it sounds reasonable and it retains Greg's hotkey memory. However, while it may mimic the existing behavior while solving a problem, and it could be a step to a larger change, overloading feels like a confusing UX. The user has to think \"will this key change the context around this message, or change my unreads and move my current position in the narrow?\". While this design/key-usage may be present to a degree already, and it may work fine, supporting it explicitly might also expose it as being confusing (raising the earlier user questions) but also inconsistent - what about all the other narrowing hotkeys/actions? Might<code>S</code> go to the message in stream context, then <code>S</code> again to next unread in the stream?</p>\n<p>My recent followup to <a class=\"stream-topic\" data-stream-id=\"2\" href=\"/#narrow/stream/2-general/topic/s.2FS.2Fz.20hotkeys\">#general &gt; s/S/z hotkeys</a> concerned how for<code>z</code> to be reliable, a required precursor was effectively for narrowing keys (and similar UI elements) to go to 'near' narrows only. The consequence from that was a need for an additional hotkey/UI to bridge the gap between the current behavior and this, namely to perform exactly the second stage noted by Alya or (2) above, ie jump to first unread in this narrow. Later discussion and reading in <a class=\"stream\" data-stream-id=\"101\" href=\"/#narrow/stream/101-design\">#design</a> emphasized this would be likely more accurately going from a not-marking-read view of a narrow, to one that does. </p>\n<p>Discussion in <a class=\"stream-topic\" data-stream-id=\"101\" href=\"/#narrow/stream/101-design/topic/mark.20as.20unread\">#design &gt; mark as unread</a> also indicated the desire for a similar hotkey, to support returning to a marking-read view after entering a not-marking-read view related to taking a marking unread action. While previously I wasn't sure of a UI element equivalent for the hotkey, that discussion mentioned a banner which shows if you're not marking read in the view. I'm unsure of the intent of that banner, but it currently only seems to be at the bottom of a narrow and the button maybe is a shortcut to marking all of the narrow read? If the banner is shown more consistently - which I understand was discussed and/or is planned - then this seems a prime location to also have a 'jump to first unread' button.</p>",
        "id": 1428318,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1661905167
    },
    {
        "content": "<p>I understand there's a desire to resolve a user issue promptly and not upset current behavior too much, which <span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> and <span class=\"user-mention silent\" data-user-id=\"2187\">Greg Price</span>'s proposal supports. As above my concern would be if this set a constraint which limited handling this more cleanly.</p>\n<p>Since there are already other cases of 'near' narrows in Zulip, adding a feature to 'go to first/next unread in this narrow (and start marking read)' seems like a worthy one to add independently, but would also integrate nicely with the issue here. If that feature is sufficiently clear to <span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> or <span class=\"user-mention silent\" data-user-id=\"2187\">Greg Price</span> we could extract further discussion of it into another topic, unless there is desire to integrate it with/prior to the open PR/issue.</p>\n<p>While I do feel that feature alone would support the current Zulip design and the user issue, I also think it would enable opening a wider conversation on enabling greater use of 'near' views of narrows. Among other things, that of course could include if both <code>shift+S</code> and <code>S</code> might go to near views, which would support reliable introduction of <code>z</code>; that as well as  <code>a</code> could then allow seeing messages being sent in a wider context.</p>",
        "id": 1428368,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1661909838
    },
    {
        "content": "<p>Just to clarify a bit: my feedback here wasn't really about retaining a hotkey memory, so much as about having a way to handle this use case with the keyboard at all.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"2187\">Greg Price</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1418031\">said</a>:</p>\n<blockquote>\n<p>A consequence of that is that AFAICT there no longer is any way to get to such a view with the keyboard, and no longer a way to get to such a view without doing something pretty subtle and nonobvious -- like click a second time on the topic in the recipient header.</p>\n</blockquote>",
        "id": 1428936,
        "sender_full_name": "Greg Price",
        "timestamp": 1661992064
    },
    {
        "content": "<p>I'd like to bump this thread, after hearing a couple more user stories from folks struggling to get from search results to conversations. One user didn't know how to do it at all; another hand figured out the workaround of using \"Copy link to message\" in the three-dot menu and opening that in a new tab.</p>",
        "id": 1493266,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674164844
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"21453\">@Evy</span> Perhaps <a href=\"https://github.com/zulip/zulip/pull/21217\">#21217</a> could be an issue for you to take a look at while waiting to get redesign work unblocked?</p>",
        "id": 1493267,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674164923
    },
    {
        "content": "<p>We should also unblock the next iteration on <a href=\"https://github.com/zulip/zulip/pull/21216\">#21216</a>. I think there are roughly two options discussed above.</p>\n<p>Option 1:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1428064\">said</a>:</p>\n<blockquote>\n<ol>\n<li>\n<p>If you are in a search view that does not mark messages as read, the topic bar and <code>Shift+S</code> take you to the <code>near</code> view for the message, as in <a href=\"https://github.com/zulip/zulip/pull/21417\">#21417</a>.</p>\n</li>\n<li>\n<p>Elsewhere,  including \"near\" views, the topic bar and <code>Shift+S</code> has the current behavior of taking you to the topic (i.e. your first unread message or the end of the topic, if all messages are already read).</p>\n</li>\n</ol>\n</blockquote>\n<p>Option 2:</p>\n<ol>\n<li>The topic bar and <code>Shift+S</code>always  take you to the <code>near</code> view for the message, as in <a href=\"https://github.com/zulip/zulip/pull/21417\">#21417</a>.</li>\n<li>We add a <code>z</code> (\"zoom\") keyboard shortcut that takes users to the topic  (i.e. your first unread message or the end of the topic, if all messages are already read).</li>\n</ol>\n<p>(<span class=\"user-mention\" data-user-id=\"2406\">@Neil Pilgrim (neiljp)</span> Correct me if I'm not summarizing this correctly.)</p>\n<p>The second option seems simpler to explain to users, so maybe we should just do that?</p>",
        "id": 1493272,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674165589
    },
    {
        "content": "<p>See also <a href=\"https://github.com/zulip/zulip/pull/24095\">#24095</a> (filed recently).</p>",
        "id": 1493340,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674169654
    },
    {
        "content": "<p>The division of behaviors in option 2 makes sense to me.</p>\n<p>Perhaps in that case the keychords for the shortcuts should be reversed, though? The reason \"narrow to topic/conversation\" is shift+S is that it pairs with \"narrow to stream\", which is S. So we could have:</p>\n<ul>\n<li>S (\"stream\") narrows to stream</li>\n<li>Shift+S (\"stream, but more so\") narrows to topic/conversation</li>\n<li>Z (\"zoom\") goes straight to the message, in a <code>/near/</code> view that doesn't mark as read</li>\n</ul>",
        "id": 1493375,
        "sender_full_name": "Greg Price",
        "timestamp": 1674175316
    },
    {
        "content": "<p>That makes sense to me!</p>",
        "id": 1493397,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674177703
    },
    {
        "content": "<p>I should mention we've in the past discussed swapping s/S, since it's much more common to want to narrow to a topic than to a stream.</p>",
        "id": 1493431,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1674179431
    },
    {
        "content": "<p>I like the idea of \"z\" being \"zoom to conversation in /near/ view centered on the target message\", vs. <code>s</code> being \"Go to this conversation\" (as opposed to the other way around).</p>",
        "id": 1493432,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1674179512
    },
    {
        "content": "<p>One thing to note is that our current s/S hotkeys currently do take you to the selected message (not the end) if there are no unread messages above that point; this detail is part of the interaction design for \"All messages\", though I'm not sure how important it is. </p>\n<p>Specifically, if you're looking at \"All messages\" with a given message M selected and hit <code>S</code>, you'll end up on that message in the narrowed view. If you then use <code>a</code> (or <code>Esc</code>, if All messages is your default view) to go back, and didn't read any messages in the meantime, you'll land back in All Messages with message M selected. (If you read anything in that narrowed view, returning to All Messages will instead take you to the first unread message).</p>\n<p>I am not sure whether the above proposal for the new behavior of the s/S shortcuts would be to remove that behavior and just jump you to place you'd be at if you'd clicked into the topic without a specific message as context.</p>",
        "id": 1493434,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1674179783
    },
    {
        "content": "<p>I think this proposal doesn't need to involve changing behavior in that respect.</p>",
        "id": 1493451,
        "sender_full_name": "Greg Price",
        "timestamp": 1674180624
    },
    {
        "content": "<p>There was a <em>lot</em> of previous discussion here, across various topics. Without rereading everything, the key thing from the perspective of ZT is that <code>z</code> keeps the message context, and zooms in/out. If retaining message context implies a near narrow in the web app, that would be the most compatible in terms of  adding <code>z</code> to the web app.</p>\n<p>In ZT, <code>z</code> is currently defined in the help as <code>Narrow to a topic/private-chat, or stream/all-private-messages</code> (<a href=\"https://github.com/zulip/zulip-terminal/blob/main/docs/hotkeys.md\">https://github.com/zulip/zulip-terminal/blob/main/docs/hotkeys.md</a>). Note that this therefore applies to PMs too.</p>\n<p>That's approximately defined as a difference to the web app at <a href=\"https://github.com/zulip/zulip-terminal#feature-status\">https://github.com/zulip/zulip-terminal#feature-status</a>, though it probably would benefit from being expanded to include that currently <em>all</em> narrowing from a message works that way - vs narrowing via the side panels, where there's clearly no message context.</p>\n<p>ZT's behavior when narrowing based on a focused message, sounds a little like Tim's discussion of all-messages behavior above, except in ZT then it's always contextual (if possible), even if the user reads or moves around before narrowing elsewhere.</p>\n<p>The later summary by Greg/Tim has a closer match to my own/ZT, but:</p>\n<ul>\n<li>it's not clear if these include that <code>z</code> would zoom in <em>and</em> out</li>\n<li>these also work on PMs in ZT</li>\n</ul>",
        "id": 1493452,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674182452
    },
    {
        "content": "<p>As I discussed elsewhere, in ZT and if adopted elsewhere, that does leave a gap for handling contextual-&gt;unread state changes (ie. near-&gt;unread/regular narrows). <code>n</code> could be adapted, assuming it doesn't handle this already, but it would be more consistent for users as a separate key (\"right now, will <code>n</code> change topic? or go to the end?\"). Such an action (key/GUI) already partially exists as a banner, after marking-unread entering a near narrow (to go back to marking read), and I believe was going to be used in the previous PR for the search case - though with no hotkey in either case.</p>",
        "id": 1493490,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674197664
    },
    {
        "content": "<p>I was imagining that <code>z</code> would just zoom in... If it also zoomed out, would that be the equivalent of <code>S/s/a</code>, depending on where you came from?</p>",
        "id": 1493659,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674241128
    },
    {
        "content": "<p>By the way, if we do switch <code>S</code> and <code>s</code>, would it be possible to pop an alert to tell the user about it the first time they use one of these shortcuts after the change is made? We could introduce them to <code>z</code> as well.</p>",
        "id": 1493660,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674241203
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1493267\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"21453\">Evy</span> Perhaps <a href=\"https://github.com/zulip/zulip/pull/21217\">#21217</a> could be an issue for you to take a look at while waiting to get redesign work unblocked?</p>\n</blockquote>\n<p>This feels very related to <a href=\"https://github.com/zulip/zulip/pull/21417\">#21417</a> -- did we end up addressing whatever we didn't like in that PR? I wasn't following that super closely.</p>",
        "id": 1494177,
        "sender_full_name": "Evy",
        "timestamp": 1674283427
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1493659\">said</a>:</p>\n<blockquote>\n<p>I was imagining that <code>z</code> would just zoom in... If it also zoomed out, would that be the equivalent of <code>S/s/a</code>, depending on where you came from?</p>\n</blockquote>\n<p>In ZT, <code>z</code> currently does a toggle between the 'most zoomed in' for that type of message, and the 'next zoomed out'. That is, topic&lt;-&gt;stream, or conversation&lt;-&gt;all-PMs.</p>\n<p>There has been discussion on different ways to incorporate other narrowing keys like <code>a</code>, ie. whether to return to the previous location, but that requires the user to remember which state that was. Right now additional hotkeys in ZT for other narrows like mentions and starred messages (see the linked docs above) behave similarly to <code>a</code> in keeping message context. That's the other reason I mentioned the importance of a hotkey/UI to switch near&lt;-&gt;unread state.</p>",
        "id": 1494196,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674289494
    },
    {
        "content": "<p>I am a bit scarred with single letter hot keys which do things... sometimes people just accidentally hit buttons. I guess it is good that the back button work in Zulip</p>",
        "id": 1494389,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1674327062
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"21453\">Evy</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1494177\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1493267\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"21453\">Evy</span> Perhaps <a href=\"https://github.com/zulip/zulip/pull/21217\">#21217</a> could be an issue for you to take a look at while waiting to get redesign work unblocked?</p>\n</blockquote>\n<p>This feels very related to <a href=\"https://github.com/zulip/zulip/pull/21417\">#21417</a> -- did we end up addressing whatever we didn't like in that PR? I wasn't following that super closely.</p>\n</blockquote>\n<p>The problem that led us not to merge it was <span class=\"user-mention silent\" data-user-id=\"2187\">Greg Price</span>'s observation <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1418031\">here</a>, so I think we'll be able to modify it and merge it once the shortcut keys discussion above is settled. I think we want both <a href=\"https://github.com/zulip/zulip/pull/21217\">#21217</a> and <a href=\"https://github.com/zulip/zulip/pull/21417\">#21417</a> to happen, though.</p>",
        "id": 1495048,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674499936
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"22433\">Vlad Korobov</span> It may be better now that we have mark-unread in the web app. In ZT there is only explicit mark-read, so <code>zz</code> is idempotent.</p>",
        "id": 1495556,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674528005
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"22433\">Vlad Korobov</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1494389\">said</a>:</p>\n<blockquote>\n<p>I am a bit scarred with single letter hot keys which do things... sometimes people just accidentally hit buttons. I guess it is good that the back button work in Zulip</p>\n</blockquote>\n<p>The confusing part is when a hot key accidentally changes which view state you are in (all messages / topic narrow / stream narrow / PM / huddle) without your knowledge. This could be mitigated, so that when you press a key that changes the view state, it announces the action \"Narrow changed to x\" in a hover text.</p>\n<p>Also, what I find confusing is that in general, the only surest way for me to know whether I am in a topic/stream narrow, in the web app, is by looking at the URL. If it is short, then I am in a stream narrow. If it is very long with topic, then I am in a topic narrow. Though in most cases, I usually make sure that I am always in the topic narrow, so that I don't even have to look at the URL.</p>\n<p>On my ZT fork, I have made the view state explicit: <a href=\"#narrow/stream/206-zulip-terminal/topic/mode.20indicator.20like.20vim/near/1249826\">https://chat.zulip.org/#narrow/stream/206-zulip-terminal/topic/mode.20indicator.20like.20vim/near/1249826</a>.</p>",
        "id": 1495858,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1674560090
    },
    {
        "content": "<blockquote>\n<p>Also, what I find confusing is that in general, the only surest way for me to know whether I am in a topic/stream narrow, in the web app, is by looking at the URL</p>\n</blockquote>\n<p>Hm, that's an interesting point. You can tell from the highlighting in the left sidebar, but it's not so clear in the message view part of the window.</p>",
        "id": 1495998,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674581620
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1495998\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>Also, what I find confusing is that in general, the only surest way for me to know whether I am in a topic/stream narrow, in the web app, is by looking at the URL</p>\n</blockquote>\n<p>Hm, that's an interesting point. You can tell from the highlighting in the left sidebar, but it's not so clear in the message view part of the window.</p>\n</blockquote>\n<p>Looking at the left sidebar doesn't work 100% of the time. My laptop screen is small (12.5\"), and so sometimes the highlighted topic is not even visible in the left sidebar.</p>",
        "id": 1496444,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1674614916
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"2328\">Rein Zustand</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1496444\">said</a>:</p>\n<blockquote>\n<p>My laptop screen is small (12.5\"), and so sometimes the highlighted topic is not even visible in the left sidebar.</p>\n</blockquote>\n<p>This is an interesting point. It may be useful for us to do something to fix that — like, when navigating to a different narrow, scroll the left sidebar as necessary so that the highlighted conversation is visible.</p>\n<p>I sometimes run into this myself, and find it a bit disorienting. Now that I think about it, I do seem to run into it more often on my office machine (which has fewer pixels) than on my home desktop with its large monitor…</p>\n<p>(If we discuss this further, it probably belongs in its own topic.)</p>",
        "id": 1496473,
        "sender_full_name": "Greg Price",
        "timestamp": 1674626157
    },
    {
        "content": "<p>We definitely already scroll the topic into view in the left sidebar when you narrow to it; I bet we added that in 2012.</p>",
        "id": 1497036,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1674697419
    },
    {
        "content": "<p>(But you can of course scroll the sidebar elsewhere, so there's no guarantee it stays in that state).</p>",
        "id": 1497037,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1674697442
    },
    {
        "content": "<p>We at some point had a design idea that a topic view would display just the topic, and not the stream, in the second row here:</p>\n<p><a href=\"/user_uploads/2/7b/zx9H8t6ddR8YSiLGpqTMGZCv/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/7b/zx9H8t6ddR8YSiLGpqTMGZCv/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/7b/zx9H8t6ddR8YSiLGpqTMGZCv/image.png\"></a></div><p>I don't think we were ever really sure if that was a better experience, but I think changing that part of the display would make it more clear.</p>",
        "id": 1497038,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1674697549
    },
    {
        "content": "<p>That said, probably this is all a digression from the <code>z</code> keyboard shortcut discussion, so we should get back to that.</p>",
        "id": 1497040,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1674697589
    },
    {
        "content": "<p>I think the proposal currently on the table is:</p>\n<ul>\n<li><code>S</code> narrows to topic or PM conversation   </li>\n<li><code>Shift+S</code> narrows to stream</li>\n<li>[unchanged] <code>Shift + P</code> Narrows to all private messages   </li>\n<li><code>Z</code> (\"zoom\") goes straight to the message, in a <code>/near/</code> view that doesn't mark as read. This should work in streams and PMs.</li>\n</ul>\n<p><span class=\"user-mention silent\" data-user-id=\"2406\">Neil Pilgrim (neiljp)</span> brought up that in ZT, <code>z</code> works as both <code>S</code> and <code>Shift+S</code> in the proposal above; we could consider having <code>S</code> do double duty as well. But I think that would be significantly more awkward to document.</p>",
        "id": 1497140,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674714145
    },
    {
        "content": "<p>The toggle keyboard shortcut has been available in ZT for years. As such, we should be able to poll ZT users on whether they prefer <code>z</code> or <code>S</code>/<code>shift+S</code> for switching between stream and topic narrow.</p>",
        "id": 1497804,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1674786680
    },
    {
        "content": "<p>I do find that a concise description of how <code>Z</code> performs double-duty is challenging.</p>\n<p>However, personally I also find it challenging to remember which keyboard shortcut is for topics vs streams, ie. <code>S</code> vs <code>Shift</code>+<code>S</code>.</p>\n<p>So, it may be easy to document, but if I have to look it up every time it's not great ;)</p>",
        "id": 1498266,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674858529
    },
    {
        "content": "<p>That said, <code>Z</code> on a topic or PM conversation is not the same as <code>Shift</code>+<code>S</code> or <code>Shift</code>+<code>P</code>, at least in ZT, since it retains the near properties.</p>",
        "id": 1498271,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674858877
    },
    {
        "content": "<p>However... I just checked and ZT has topic=<code>shift S</code>, stream=<code>S</code> listed in the hot keys, possibly based on the premise that Tim noted earlier of the web app switching these keys around 'real soon now' (but not yet?).</p>\n<p>[edited to reflect that the proposal differs from current behavior for s/S in the web app]</p>",
        "id": 1498279,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674859342
    },
    {
        "content": "<p>Ah, apologies <span class=\"user-mention\" data-user-id=\"19257\">@Alya Abbott</span>, you stated <code>S</code> doing double duty would be challenging to document, rather than specifically introducing allowing <code>Z</code> to also zoom 'out' with <code>/near/</code>.</p>",
        "id": 1498280,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674859656
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"2406\">Neil Pilgrim (neiljp)</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1498279\">said</a>:</p>\n<blockquote>\n<p>However... I just checked and ZT has topic=<code>shift S</code>, stream=<code>S</code> listed in the hot keys, possibly based on the premise that Tim noted earlier of the web app switching these keys around 'real soon now' (but not yet?).</p>\n<p>[edited to reflect that the proposal differs from current behavior for s/S in the web app]</p>\n</blockquote>\n<p>Yes, the proposal switches <code>S</code> and <code>Shift+S</code>.</p>",
        "id": 1498281,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674859948
    },
    {
        "content": "<p>My preference generally would be that if we do change the keys at all, they move in a direction that would enable reuse and extension down the road.</p>",
        "id": 1498282,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674860020
    },
    {
        "content": "<p>In an ideal world I've considered various options along the lines of having <code>(modifier)</code> (eg shift, or the inverse) visit a larger non-near narrow (stream, all PMs, all-messages, ...), ie. to read next message, and having the inverse of <em>that</em> be the contextual (near) form.</p>",
        "id": 1498303,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674860896
    },
    {
        "content": "<p>Oh, I also missed that this proposed switching S vs. Shift+S:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1497140\">said</a>:</p>\n<blockquote>\n<p>I think the proposal currently on the table is:</p>\n<ul>\n<li><code>S</code> narrows to topic or PM conversation   </li>\n<li><code>Shift+S</code> narrows to stream […]</li>\n</ul>\n</blockquote>\n<p>My version above that had S and Shift+S keeping their current meanings:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"2187\">Greg Price</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1493375\">said</a>:</p>\n<blockquote>\n<p>Perhaps in that case the keychords for the shortcuts should be reversed, though? The reason \"narrow to topic/conversation\" is shift+S is that it pairs with \"narrow to stream\", which is S. So we could have:</p>\n<ul>\n<li>S (\"stream\") narrows to stream</li>\n<li>Shift+S (\"stream, but more so\") narrows to topic/conversation</li>\n<li>Z (\"zoom\") goes straight to the message, in a <code>/near/</code> view that doesn't mark as read</li>\n</ul>\n</blockquote>\n<p>(Perhaps \"should be reversed\" was confusing ­— I meant relative to the proposals before that, which were effectively switching them relative to the status quo.)</p>\n<p>I don't think I have a real strong preference for the status quo there (I might even think we should make that switch), but if we want to change it I feel a bit more discussion would be good.</p>",
        "id": 1498309,
        "sender_full_name": "Greg Price",
        "timestamp": 1674861028
    },
    {
        "content": "<p>The idea to switch s/S came from:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1493431\">said</a>:</p>\n<blockquote>\n<p>I should mention we've in the past discussed swapping s/S, since it's much more common to want to narrow to a topic than to a stream.</p>\n</blockquote>",
        "id": 1498316,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674861143
    },
    {
        "content": "<p>(I don't use any of these keys, so don't have any personal intuition on it.)</p>",
        "id": 1498318,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1674861185
    },
    {
        "content": "<p>Got it, thanks, missed that line earlier.</p>\n<p>Yeah, that reasoning makes sense to me.</p>",
        "id": 1498321,
        "sender_full_name": "Greg Price",
        "timestamp": 1674861300
    },
    {
        "content": "<p>I think making the lower-case letter be for the stream comes from the same early-Zulip design concept as having All Messages be the home view — the idea in that era was that the interleaved views were primary.</p>",
        "id": 1498323,
        "sender_full_name": "Greg Price",
        "timestamp": 1674861359
    },
    {
        "content": "<p>(That reasoning is in fact the same reasoning I had in mind here:)</p>\n<p><span class=\"user-mention silent\" data-user-id=\"2187\">Greg Price</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1498309\">said</a>:</p>\n<blockquote>\n<p>I don't think I have a real strong preference for the status quo there (I might even think we should make that switch),</p>\n</blockquote>",
        "id": 1498325,
        "sender_full_name": "Greg Price",
        "timestamp": 1674861399
    },
    {
        "content": "<p>In terms of <span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span>'s specific proposal, it seems like a good first step.</p>\n<p>Ideally that would allow building upon that to consider consistent:</p>\n<ul>\n<li>near&lt;-&gt;non-near hotkeys/banners</li>\n<li>introducing the inverse use of <code>Z</code></li>\n<li>considering other improvements in hotkey consistency</li>\n<li>possibly how this relates to the go-to-next-unread behavior and similar?</li>\n</ul>",
        "id": 1498326,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674861419
    },
    {
        "content": "<p>I think doing <code>S</code> double duty shouldn't be put out of the table just from the documentation challenge.<br>\nThe current ZT documentation is</p>\n<blockquote>\n<p>Narrow to a topic/private-chat, or stream/all-private-messages</p>\n</blockquote>\n<p>Which technically compresses the current documentation of <code>S</code> and <code>Shift+S</code> into one (it could say \"toggle narrow\" if this clarifies further). And the user can easily try it on the spot to see what the shortcut does.</p>",
        "id": 1498395,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1674865744
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"2328\">Rein Zustand</span> Do you mean <code>S</code> or <code>Z</code> here? These won't be the same in the proposed change, and while <code>ZZ</code> in ZT should change no state, <code>S</code> followed by <code>Shift</code>+<code>S</code> right now can be quite different in the web app.</p>\n<p>I understand you were focusing on the explanation aspect, and I agree this needs addressing if introducing <code>Z</code> to only zoom-in first, with a plan to later consider <code>Z</code> to also zoom back out again. One idea might be to focus on treating not-marking-read as a different (or modified) action to narrowing, either just in documentation or generally, so later we might have <code>Toggle Exploring message in [topic/PM] conversation or wider context</code> (bracketed text optional), and for now perhaps something like <code>Explore message in conversation context</code>?</p>\n<p>Just to clarify for anyone coming from ZT: this may seem simple, since right now ZT doesn't distinguish between the two URL behaviors the web app has in quite the same way. Now (or soon?) my understanding is that in the web app entering a <code>/near/</code> narrow goes to approximately that message and won't mark read (unless explicitly desired), while entering a non-<code>/near/</code> narrow jumps to first unread or the last message. In ZT the behavior is generally like the first case only, except for certain hot keys (or UI elements) jumping to specific unread/last positions (though we need more keys/UI to improve that).</p>",
        "id": 1498501,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674887733
    },
    {
        "content": "<p>Right now, my experience of the web app is that the contextual behavior from a selected message is:</p>\n<ul>\n<li>the stream version (<code>S</code>) does a 'next unread or last message' in the stream (and marking read - unless surrounded by some read?)</li>\n<li>similarly the topic version (<code>Shift</code>+<code>S</code>) does a 'next unread or last message' in the topic</li>\n</ul>\n<p>I was going to say that these did something similar with PMs, but it's kinda nuanced, since:</p>\n<ul>\n<li><code>S</code> will only go to the message if it's in a stream (admittedly as documented)<ul>\n<li>but this means I can't jump from a private conversation to all-PMs without going to a next-unread narrow by using <code>Shift</code>+<code>P</code> first</li>\n</ul>\n</li>\n<li><code>Shift</code>+<code>S</code> seems to zoom in to a PM conversation, as expected.</li>\n</ul>\n<p>After the current (initial) proposal:</p>\n<ul>\n<li><code>Shift</code>+<code>P</code> = next unread/last message in All-PMs (marking-read narrow) [unchanged]</li>\n<li><code>Shift</code>+<code>S</code> = next unread/last message in stream of this message (marking-read narrow)</li>\n<li><code>S</code> = next unread/last message in topic of this message (marking-read narrow) <strong>or</strong> in conversation of this message</li>\n<li><code>Z</code> = this message in zoomed-in/conversation (topic- or PM-conversation) context (near narrow, not marking read)</li>\n</ul>\n<p>The lack of mobility from a PM conversation to its location in All-PMs discussed above would be fixed by applying the follow-up:</p>\n<ul>\n<li><code>Z</code> = [also] this message in zoomed-out/wider (stream or All-PMs) context (near narrow, not marking read)</li>\n</ul>\n<p>It's too late to lay out an alternative right now, but while the proposal (and followup) is a logical direction to take to mirror ZT, I'm wary for the longer-term, with the crux of the issue being that <code>Shift</code>+<code>P</code> is an unconditional change of narrow (there's no message context). That compares to <code>Shift</code>+<code>S</code> which is contextual, but also eg. <code>A</code> which is not.</p>",
        "id": 1498508,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1674891362
    },
    {
        "content": "<p>I thought the current consensus is to:</p>\n<ul>\n<li>eventually swap <code>S</code> and <code>Shift+S</code></li>\n<li>introduce <code>Z</code> for zooming in to <code>/near/</code></li>\n</ul>\n<p>What I had in mind is to:</p>\n<ul>\n<li>port ZT's current <code>Z</code>'s stream/topic behavior to <code>S</code>, for toggling between topic and stream narrow, i.e. the <code>S</code> double duty</li>\n<li>the former then frees up the <code>Z</code> shortcut to be used for zooming in to <code>/near/</code></li>\n</ul>\n<p>Both are regardless of whether there should be a toggle for zooming out of <code>/near</code>, regardless of where the shortcut puts you in the narrow, and regardless of whether the shortcut changes the state irreversibly. Those points also need to be discussed, but what I'm more concerned about, is the missed opportunity of at least having the convenient <code>S</code> doing double duty in the web app.</p>",
        "id": 1498599,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1674913032
    },
    {
        "content": "<p>Ok, I filed <strong>Improve S and Shift+S shortcut keys</strong> <a href=\"https://github.com/zulip/zulip/pull/24226\">#24226</a> with the amended proposal to just use <code>S</code> and get rid of <code>Shift</code>+<code>S</code>. Also filed <strong>Implement <code>z</code> shortcut to zoom to message <code>near</code> view</strong> <a href=\"https://github.com/zulip/zulip/pull/24227\">#24227</a>.</p>",
        "id": 1499382,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1675113477
    },
    {
        "content": "<p>Thanks all for the thoughtful discussion!</p>",
        "id": 1499383,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1675113494
    },
    {
        "content": "<p>Thanks for filing these <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span><br>\nHaving a solid couple of points is useful to implement or compare from.</p>",
        "id": 1499432,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1675117234
    },
    {
        "content": "<p>To clarify the <code>Z</code> issue (<a href=\"https://github.com/zulip/zulip/pull/24227\">#24227</a>), and from rereading the above, the issue is specced to only absolutely turn the 'nearness' on, not to zoom in?</p>",
        "id": 1499437,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1675117754
    },
    {
        "content": "<p>To clarify, I like the idea of removing the confusion between which of <code>S</code>/<code>Shift</code>+<code>S</code> does what, but that's mainly due to both having the same root key.</p>\n<p>Solving that problem in some sense, by making it do double duty, is appealing. However, that a single key then does different things with different stateful changes feels like presenting a bad UX.</p>",
        "id": 1499453,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1675118370
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"2406\">Neil Pilgrim (neiljp)</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1499437\">said</a>:</p>\n<blockquote>\n<p>To clarify the <code>Z</code> issue (<a href=\"https://github.com/zulip/zulip/pull/24227\">#24227</a>), and from rereading the above, the issue is specced to only absolutely turn the 'nearness' on, not to zoom in?</p>\n</blockquote>\n<p>Yes, that's right. I think that's the clearest definition, and the one that offers unique functionality not available with other shortcut keys.</p>",
        "id": 1499472,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1675119748
    },
    {
        "content": "<blockquote>\n<p>Solving that problem in some sense, by making it do double duty, is appealing. However, that a single key then does different things with different stateful changes feels like presenting a bad UX.</p>\n</blockquote>\n<p>I dunno, I don't personally feel strongly about <code>Shift+S</code> vs. <code>S</code> for navigating to an interleaved stream view.</p>\n<p>Note that there is a bit of loss of functionality with  <a href=\"https://github.com/zulip/zulip/pull/24226\">#24226</a>, as it will now require two navigation steps to go from All messages to an interleaved stream (<code>S</code> x 2); I'm guessing this is not an especially common use case.</p>",
        "id": 1499475,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1675120224
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/zulip/pull/24227\">#24227</a>: If it only switches to a non-marking-read version of the narrow around the current message, I understand it's unique functionality, but I'm a little confused:</p>\n<ul>\n<li>The issue and preliminary help text suggests 'zoom'?</li>\n<li>The help text also mentions 'conversation context' - which sounds like a guaranteed zoom-in?</li>\n<li>Isn't it more of a 'bookmark', or something like that?</li>\n<li>If it definitely isn't zooming-in, I understand the issue is a starting point and can be adjusted, eg. to not include 'zoom', but then also the key need not be that either?</li>\n</ul>",
        "id": 1499525,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1675130451
    },
    {
        "content": "<p>Ah, I was confused about what exactly a \"near\" view is. I thought it would automatically narrow it to the conversation. Let me fix up the issue.</p>",
        "id": 1499881,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1675189802
    },
    {
        "content": "<p>I suspect one point of confusion there might be that 'linking to a message' generates a conversation link, even in a stream/all-PMs/all-messages view. That is, not in the same context - ie. narrow.</p>",
        "id": 1499923,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1675192079
    },
    {
        "content": "<p>Yeah, I think that's right.</p>",
        "id": 1499925,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1675192224
    },
    {
        "content": "<p>This is now test-deployed here.</p>",
        "id": 1503868,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1675733274
    },
    {
        "content": "<p>Should this be doing anything even if already in the correct narrow/position? This is adding an entry to the browser history each time it's used.</p>",
        "id": 1503884,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1675735916
    },
    {
        "content": "<p>Yeah, currently <code>/near/</code> views are a different view from the normal conversation views; they're not just a scroll position within it. (This is done this way because they have different behavior involving unread messages). </p>\n<p>The interaction of that detail with this <code>z</code> shortcut does thus navigate you to a different view including adjusting browser history if you hit <code>z</code> (and possibly jumping scroll position, though we could definitely fix that readily) while already in a conversation view of some sort of the topic.</p>",
        "id": 1506553,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1675987996
    },
    {
        "content": "<p>What do we want the <code>z</code> keyboard shortcut to do if you're already looking at a conversation view for the topic (just not a <code>near</code> one)?</p>",
        "id": 1506554,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1675988028
    },
    {
        "content": "<p>I feel like the intent is most likely \"I forgot I was already sorta there\".</p>",
        "id": 1506555,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1675988044
    },
    {
        "content": "<p>I dunno, I think it should work consistently... Maybe you're using <code>z</code> as a way to center a message on your screen, or get its URL.</p>",
        "id": 1506558,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1675988205
    },
    {
        "content": "<p>In case it wasn't clear from my statement above, if one happens to press <code>Z</code> multiple times one after another, it adds an entry to the history repeatedly. While this seems mostly harmless, it's a little odd if one goes back/forth and nothing appears to happen :)</p>\n<p>I noted this since eg. doing <code>A</code> repeatedly does not do something similar. Admittedly that's not a near narrow, but it feels like it should behave similarly?</p>",
        "id": 1506570,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1675989548
    },
    {
        "content": "<p>I was also briefly confused, since apparently <code>DD</code> opens and closes drafts, but the history entry just shows as the narrow name. That seems like a separate issue/improvement though.</p>",
        "id": 1506571,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1675989623
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"2406\">@Neil Pilgrim (neiljp)</span> would you be up for filing follow-up issues for the history oddities you noted? I don't think it's a blocker for merging this feature, but I agree that it's not idea that pressing <code>z</code> twice in a row means you'll have to press \"back\" a couple of times before anything happens.</p>",
        "id": 1510953,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1677017535
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/zulip/pull/24468\">#24468</a> - z shortcut adds duplicate entries to browser history<br>\n<a href=\"https://github.com/zulip/zulip/pull/24469\">#24469</a> - Popups show as previous narrow state in browser history (Drafts, Settings, Streams, Shortcuts)</p>",
        "id": 1512720,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1677200794
    },
    {
        "content": "<p>I wasn't sure about some of the phrasing of the latter, as I'm not sure if there's a glossary for what counts as a popup or if there are other preferred terms, so please feel free to reword accordingly :)<br>\nHaving a glossary would be good too, if we don't have one?</p>",
        "id": 1513847,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1677278247
    },
    {
        "content": "<p>If you are a user of the <code>S/Shift +S</code> shortcuts, please play around with the revised version currently deployed here and note any feedback. </p>\n<p><a href=\"/user_uploads/2/13/f1RC6tBKTUiV7dt2FlMRzxu1/Screen-Shot-2023-05-01-at-7.03.48-AM.png\">Screen-Shot-2023-05-01-at-7.03.48-AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/13/f1RC6tBKTUiV7dt2FlMRzxu1/Screen-Shot-2023-05-01-at-7.03.48-AM.png\" title=\"Screen-Shot-2023-05-01-at-7.03.48-AM.png\"><img src=\"/user_uploads/2/13/f1RC6tBKTUiV7dt2FlMRzxu1/Screen-Shot-2023-05-01-at-7.03.48-AM.png\"></a></div>",
        "id": 1559088,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1682949934
    },
    {
        "content": "<p>When is it supposed to mark unread now? I expected <code>S</code> to go to next unread as (I thought?) before, but that seems different now - <code>SS</code> doesn't mark anything read? Is that intentional? New?</p>",
        "id": 1559143,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1682952843
    },
    {
        "content": "<p>There shouldn't be any changes in marking as read/unread behavior.</p>",
        "id": 1559149,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1682953458
    },
    {
        "content": "<p>Ah, so we still mark read when moving off a message, but <code>S</code> doesn't.</p>",
        "id": 1559179,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1682955345
    },
    {
        "content": "<p>So <code>S</code> is now a toggle between stream and topic read-messages views, but itself doesn't mark a message read.</p>",
        "id": 1559183,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1682955491
    },
    {
        "content": "<p>It also seems to work for direct messages, though only from all-DMs to a DM (zoom in), not backwards (zoom out), which I suppose is consistent with the previous behavior.</p>",
        "id": 1559185,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1682955574
    },
    {
        "content": "<p>However, it does seem to enter compose when using <code>S</code> on a direct message?</p>",
        "id": 1559187,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1682955599
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"2406\">Neil Pilgrim (neiljp)</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1559185\">said</a>:</p>\n<blockquote>\n<p>It also seems to work for direct messages, though only from all-DMs to a DM (zoom in), not backwards (zoom out), which I suppose is consistent with the previous behavior.</p>\n</blockquote>\n<p>Yeah, and that's how we explicitly document it.</p>",
        "id": 1559189,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1682955638
    },
    {
        "content": "<p>I'm not saying it's not consistent with previous behavior or the documentation.</p>",
        "id": 1559193,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1682955761
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"2406\">Neil Pilgrim (neiljp)</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1559187\">said</a>:</p>\n<blockquote>\n<p>However, it does seem to enter compose when using <code>S</code> on a direct message?</p>\n</blockquote>\n<p>I think this is for the same reasons as discussed in <a class=\"stream-topic\" data-stream-id=\"9\" href=\"/#narrow/stream/9-issues/topic/inconsistency.20in.20entering.20DM.20or.20stream\">#issues &gt; inconsistency in entering DM or stream</a> .</p>",
        "id": 1559196,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1682955826
    },
    {
        "content": "<p>I will note if we wanted to not do that only when navigating to a direct message conversation via this hotkey, that's likely only a couple lines of code to implement, so feedback on that detail is appreciated. My personal leaning would be to have <code>s</code> not open compose box when used to navigate to a PM conversation.</p>\n<p>(I feel like if you're using <code>s</code>, you probably also know how to use <code>Enter</code> to open compose, and you're more likely to want to stay in the reading modality for keyboard UI).</p>",
        "id": 1559377,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1682966767
    },
    {
        "content": "<blockquote>\n<p>My personal leaning would be to have <code>s</code> not open compose box when used to navigate to a PM conversation.</p>\n</blockquote>\n<p>Hmm, that seems really random to me given what we decided about not changing it in <a class=\"stream-topic\" data-stream-id=\"9\" href=\"/#narrow/stream/9-issues/topic/inconsistency.20in.20entering.20DM.20or.20stream\">#issues &gt; inconsistency in entering DM or stream</a> . We're still opening the compose box if you use keyboard navigation to get to the DM conversation, and I don't see why pressing \"Enter\" to go to a conversation from \"Recent conversations\" should work differently from <code>s</code>.</p>",
        "id": 1559399,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1682968107
    },
    {
        "content": "<p>I also don't think the argument about familiarity with the <code>Enter</code> shortcut is enough to motivate treating keyboard nav and mouse nav differently in general, with keyboard nav never  to a DM conversation never opening the compose box.</p>",
        "id": 1559400,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1682968135
    },
    {
        "content": "<p>Well the main argument would be that the main downside of popping open the compose box is that it interferes with keyboard navigation, and we know based on the fact that you're using this keyboard shortcut that you're using keyboard navigation, which may adjust the trade-offs.</p>",
        "id": 1559466,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1682971592
    },
    {
        "content": "<p>But I'm certainly content to wait for more feedback from users being happy/unhappy with that interaction detail before changing anything here.</p>",
        "id": 1559467,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1682971610
    },
    {
        "content": "<p>Hey! <span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> and I were just looking over <a href=\"https://github.com/zulip/zulip/pull/25424\">#25424</a>, which makes topic links in search views go to a \"near\" view rather than the topic. This is intended to address the fact that the topic link can put you nowhere near the message you saw in the search results if  the topic has unreads.</p>\n<p>Thinking back to the major user problem that started this conversation (I'm in a search view -- how do I get to the conversation for one of my search results?), we were wondering if it would be better not to modify the message header bar behavior after all. Instead, as some have suggested above,  maybe we should have clicking on the message from a view that does not collapse messages take you to the \"near:\" view for that message.</p>",
        "id": 1561070,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1683142026
    },
    {
        "content": "<p>It's inconsistent in that clicking on a message usually opens the compose box, but:</p>\n<ol>\n<li>If you looking at a search result, it seems much more likely that you want to go to the conversation than that you want to immediately send a message.</li>\n<li>Sending a message from this type of search view is actually pretty risky / not recommended, as you may be missing the latest messages in teh conversation.</li>\n</ol>",
        "id": 1561071,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1683142232
    },
    {
        "content": "<p>If we make this change, it will make it quite tricky to reply to a message from one of these views using only the mouse. You could do it via \"Quote and reply or forward\" (deleting the quote if you want), or by scrolling around until the blue box is on the right message and clicking the \"Message...\" button  (which requires understanding how the blue box works).</p>",
        "id": 1561075,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1683142430
    },
    {
        "content": "<p>Since replying to a message from one of these views is not recommended in the first place, that might be OK? If we really wanted to, we could do something to give the option back, like adding a \"Reply\" (\"Reply to message\"? \"Reply to conversation\"?) button in the three-dot menu.</p>",
        "id": 1561076,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1683142532
    },
    {
        "content": "<p>There was also discussion above as to whether clicking on the message should just go to the conversation, or go to conversation <em>and</em> open the compose box. <span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> perspective is that it should just go to the conversation, as the user most likely just wants to read the conversation, not necessarily respond to it. (I don't have a clear opinion.)</p>",
        "id": 1561077,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1683142611
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"21836\">@Lauryn Menard</span> making sure you see this discussion. :)</p>",
        "id": 1561078,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1683142622
    },
    {
        "content": "<p>I think going to the conversation by clicking on the message from a search-like view makes sense to me.</p>\n<p>This sounds like <a href=\"https://github.com/zulip/zulip/pull/21217\">#21217</a>, which was filed as a part of <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1333002\">this same discussion here</a>.</p>",
        "id": 1562187,
        "sender_full_name": "Lauryn Menard",
        "timestamp": 1683285389
    },
    {
        "content": "<p>I'll say that I agree that clicking should just go to the conversation and not open the compose box. But I'm one who doesn't like that the compose box opens when I navigate to direct messages though, so maybe a biased opinion.</p>",
        "id": 1562189,
        "sender_full_name": "Lauryn Menard",
        "timestamp": 1683285789
    },
    {
        "content": "<p>Ah, yeah, thanks for the pointer! OK, at this point I'd propose:</p>\n<ol>\n<li>Not considering any of these changes as release goals at this point.</li>\n<li>Trying a version of <a href=\"https://github.com/zulip/zulip/pull/21217\">#21217</a> as the next step (rather than continuing with <a href=\"https://github.com/zulip/zulip/pull/25424\">#25424</a>), but without opening the compose box, and without a banner for the initial implementation.</li>\n</ol>\n<p>And then we can play with it on CZO and see how it feels.</p>",
        "id": 1562318,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1683303697
    },
    {
        "content": "<p>The banner is a little tricky, because our other message feed banners have to do with marking messages as read, and get placed at the bottom of the message feed. Whereas a \"Back to search results\" is something you'd probably like to be offered wherever you land, which may be in the middle of a conversation.</p>",
        "id": 1562321,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1683303821
    },
    {
        "content": "<p>Maybe a banner is the wrong form for that \"back\" button to take.</p>",
        "id": 1562322,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1683303861
    },
    {
        "content": "<p>Or maybe what we want is not a \"back\" button, but a way to get the same search query in the search bar again.</p>",
        "id": 1562324,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1683303994
    },
    {
        "content": "<p>That plan sounds good.</p>",
        "id": 1562580,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1683315347
    },
    {
        "content": "<p>In terms of the back button, I think we should just make the browser back button take you back to where you were in terms of selected message and scroll position, which I'm pretty sure we have an open issue for.</p>",
        "id": 1562583,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1683315382
    },
    {
        "content": "<p>I would really like this - there are a number of times where I've made a search, taken a look at a topic/message, realize it's not what I was looking for and go back, only to realize it's dropping me at the end of the search results :/</p>",
        "id": 1562784,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1683327116
    },
    {
        "content": "<p>Yeah, I often find the search view pretty much unusable for that reason. It's OK when the search is easy (there's only a screenful or two of results, or I look at the results and can confidently identify the one conversation I was looking for), but breaks down for anything beyond that.</p>\n<p>The workaround I resort to is to make a new tab and start opening the individual conversations there instead of in the main view.</p>",
        "id": 1562857,
        "sender_full_name": "Greg Price",
        "timestamp": 1683332104
    },
    {
        "content": "<p>I'd thought we had an issue for this, but I'm not finding it.</p>",
        "id": 1562858,
        "sender_full_name": "Greg Price",
        "timestamp": 1683332237
    },
    {
        "content": "<p><strong>Preserve location of blue box (selected message) when navigating \"back\"</strong> <a href=\"https://github.com/zulip/zulip/pull/20066\">#20066</a>, right?</p>",
        "id": 1563481,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1683553707
    },
    {
        "content": "<p>Ah, that looks like the one, thanks!</p>",
        "id": 1564155,
        "sender_full_name": "Greg Price",
        "timestamp": 1683591070
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> mentioned this topic in <strong><a href=\"#narrow/stream/415-chat.zulip.org/topic/experiments/near/1601180\">#chat.zulip.org &gt; experiments</a></strong>.</p>",
        "id": 1601182,
        "sender_full_name": "Topic Bridge Bot",
        "timestamp": 1688064130
    },
    {
        "content": "<p>^ Invalid link from Topic Bridge Bot ?</p>",
        "id": 1601365,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1688068978
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"2406\">@Neil Pilgrim (neiljp)</span> Yup, we'll investigate.  I am pretty sure it's the \" &gt; \" that causes problems, but haven't looked yet.</p>",
        "id": 1601395,
        "sender_full_name": "Steve Howell",
        "timestamp": 1688069617
    },
    {
        "content": "<p>I was going through different results from a search just now, and I'm quite happy with the behavior on clicking on a search result. (I believe there's currently an experiment deployed that's related to this thread.)</p>\n<p>I've forgotten what the status quo was before, so I'm not sure what has changed. But consider this positive feedback for whatever experiment is currently deployed.</p>",
        "id": 1606231,
        "sender_full_name": "Greg Price",
        "timestamp": 1688765680
    },
    {
        "content": "<p>Once I'm done looking at one search result and want to go back to the list of results, that's not so good — the back button is still broken. I guess that's <a href=\"https://github.com/zulip/zulip/pull/20066\">#20066</a>.</p>\n<p>As long as that's the case, the overall experience is broken enough that I personally mostly avoid navigating to a search result in the first place:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"2187\">Greg Price</span> <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1562857\">said</a>:</p>\n<blockquote>\n<p>Yeah, I often find the search view pretty much unusable for that reason. It's OK when the search is easy (there's only a screenful or two of results, or I look at the results and can confidently identify the one conversation I was looking for), but breaks down for anything beyond that.</p>\n<p>The workaround I resort to is to make a new tab and start opening the individual conversations there instead of in the main view.</p>\n</blockquote>",
        "id": 1606232,
        "sender_full_name": "Greg Price",
        "timestamp": 1688765851
    },
    {
        "content": "<p>Yeah, we should figure out a plan for <a href=\"https://github.com/zulip/zulip/pull/20066\">#20066</a>; I'm not sure what's involved in storing the currently selected message ID in the browser history storage, but that's likely the hard part given the existing plumbing we have, so could be valuable for someone to look into.</p>",
        "id": 1609247,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1689267566
    },
    {
        "content": "<p>I'll do the bit of work to integrate <a href=\"https://github.com/zulip/zulip/pull/25873\">#25873</a>, since we had a theory that this was a good improvement, I've found it seems fine myself, and the only feedback has been positive.</p>",
        "id": 1609250,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1689268215
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"21453\">@Evy</span> updated <a href=\"https://github.com/zulip/zulip/pull/25873\">#25873</a> following a review, it'd be great if you can verify my changes.</p>",
        "id": 1609258,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1689269261
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/zulip/pull/20066\">#20066</a> likely requires some sort of fancy tweak to the <code>browser_history.js</code> module to store every navigation with a \"previous pointer\" field, in case that context is helpful for anyone.</p>",
        "id": 1609260,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1689269326
    },
    {
        "content": "<p>Verified!</p>",
        "id": 1610370,
        "sender_full_name": "Evy",
        "timestamp": 1689440430
    },
    {
        "content": "<p>Looping back to this conversation.</p>\n<p>Now that these two issues have been addressed:</p>\n<ul>\n<li><strong>Clicking on a message in search results should go to \"near:\" narrow</strong>, <a href=\"https://github.com/zulip/zulip/pull/21217\">#21217</a></li>\n<li><strong>Preserve location of blue box (selected message) when navigating \"back\"</strong>, <a href=\"https://github.com/zulip/zulip/pull/20066\">#20066</a></li>\n</ul>\n<p>Do we think we'll want to do <strong>Topic link in search results should always go to \"near:\" narrow</strong>, <a href=\"https://github.com/zulip/zulip/pull/21216\">#21216</a>? Or should we close that issue and my linked PR, <a href=\"https://github.com/zulip/zulip/pull/25424\">#25424</a>? </p>\n<p>See <a href=\"#narrow/stream/101-design/topic/navigate.20to.20search.20result/near/1561070\">notes above</a> about the changes in that PR and why we went another direction.</p>",
        "id": 1644547,
        "sender_full_name": "Lauryn Menard",
        "timestamp": 1695306505
    },
    {
        "content": "<p>Hmm, I'm thinking it's still valuable, because we still have the confusing experience described in <a href=\"https://github.com/zulip/zulip/pull/21216\">#21216</a>. Sure, the user can now click on the message itself, and it'll work great. But users will probably still click on the topic and get confused.</p>",
        "id": 1644870,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1695322881
    },
    {
        "content": "<p>Hmmm, I'm not sure; doing that breaks the consistent model that clicking a topic in a recipient bar bar, i.e. asking to go to that topic, always take you to a normal topic view.</p>\n<p>I think we may want to wait to see feedback suggesting the new UI is problematic before making further changes here.</p>",
        "id": 1646347,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1695601766
    },
    {
        "content": "<p>I'm not so sure we'll get clear feedback on this on CZO...</p>\n<p>What do other folks think?</p>",
        "id": 1646379,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1695614333
    },
    {
        "content": "<p>It’s tricky, for sure. I can say that sometimes I’ll search for a particular topic based on some message I remember being posted there—not necessarily the message I’m interested in, but the one I know was part of the topic I’m looking for. Not that that’s the only or even most common use case, but one to consider alongside others.</p>",
        "id": 1646545,
        "sender_full_name": "Karl Stolley",
        "timestamp": 1695649750
    },
    {
        "content": "<p>Yeah, that's a use case for being able to pick what behavior you want. </p>\n<p>I am also just generally not excited about the design direction of taking a component (topic in the recipient bar) and changing it from doing the same thing always (take you to that topic's default conversation view) to instead do something different which is also what clicking on the message itself does (a much larger click target right next to it).</p>",
        "id": 1646720,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1695667951
    },
    {
        "content": "<p>Another common use case is the \"mentions\" narrow -- if you click on the message itself, it'll take you to the message that mentioned you, which is sometimes what you want. But usually I want to read the conversation leading up to the mention in order, and clicking the recipient bar in that search view will start me with the first unread, which is what I want most of the time.</p>",
        "id": 1646723,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1695668046
    },
    {
        "content": "<p>Making the topic link no longer do that would mean we have no UI option for \"let me go read this topic started from where I last read\".</p>",
        "id": 1646725,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1695668104
    }
]