[
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> <a href=\"#narrow/stream/101-design/topic/bottom.20row.20design/near/1173496\">said</a>:</p>\n<blockquote>\n<p>I guess one quirk I want to highlight is the little \"Saved as draft\" notice that we display when closing the compose box looks a little weird following this.</p>\n</blockquote>\n<p>I just want to bump this... I think the way the Reply button changes size when a draft is saved doesn't look good, and also (as mentioned previously) the \"Saved as draft\" notification is really difficult to spot right now. It would be great if we could get this fixed.</p>\n<p>Perhaps the notification should be moved out of the bottom row, and should show up right above it instead?</p>",
        "id": 1176452,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1620406191
    },
    {
        "content": "<p>I think that's the simplest plan; I'm not sure what would look visually good here.  The <code>compose_error</code> infrastructure we have is probably not visually appropriate for this.</p>\n<p>The other problem with this notice is <a href=\"https://github.com/zulip/zulip/issues/17396\">https://github.com/zulip/zulip/issues/17396</a> -- basically if you miss the notice, and you're a new user, you potentially panic and think we lost your message.</p>",
        "id": 1176469,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620406563
    },
    {
        "content": "<p>it's an entirely passive feature --- for example, there's not \"save\" button --- so it's not surprising that people don't discover it</p>",
        "id": 1176473,
        "sender_full_name": "Ken Clary",
        "timestamp": 1620406648
    },
    {
        "content": "<p>then, 2 months later, you notice the \"Drafts (3)\" button and discover memory lane of some old unsent messages...</p>",
        "id": 1176474,
        "sender_full_name": "Ken Clary",
        "timestamp": 1620406688
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/zulip/pull/17557\">PR</a> for showing the draft hotspot when the first-time draft is saved is almost done.<br>\n(When the new user first time encounters this situation, the hotspot will pop up.)</p>\n<p>Here is the <a href=\"https://user-images.githubusercontent.com/63820270/111466411-454d7a80-8749-11eb-819a-b7596449bea6.gif\">demo</a>,</p>\n<div class=\"message_inline_image\"><a href=\"https://user-images.githubusercontent.com/63820270/111466411-454d7a80-8749-11eb-819a-b7596449bea6.gif\" title=\"demo\"><img src=\"/external_content/e4c2e4adaca31f61af3695ef9dd3b5c6bb03b7d8/68747470733a2f2f757365722d696d616765732e67697468756275736572636f6e74656e742e636f6d2f36333832303237302f3131313436363431312d34353464376138302d383734392d313165622d383139612d6237353936343439626561362e676966\"></a></div><p>Though I'll have to rebase the PR now.</p>\n<p>(Tim, can you answer my <a href=\"https://github.com/zulip/zulip/pull/17557#discussion_r605340238\">doubt</a>.)</p>",
        "id": 1176540,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1620408310
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"17964\">@Riken Shah (Riken-Shah)</span> replied, and yeah, you should rebase that.  I think we'll want different text, but that's a model worth playing with.</p>",
        "id": 1176594,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620409789
    },
    {
        "content": "<p>Here, is the current draft hotspot content:</p>\n<p><em>Click here to view all your drafts. When you are typing something and you (intentionally or mistakenly) close the compose box. Don't worry! Your message will be saved, and you can continue it from where you left off.</em></p>",
        "id": 1176604,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1620410014
    },
    {
        "content": "<p>Probably easier for me to just rewrite when looking at it, but I think we want to start with \"Your message was saved as a draft.\".</p>",
        "id": 1176606,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620410077
    },
    {
        "content": "<p>Because that's the thing that just happened that you need to understand, and then we can go into how this works in general.</p>",
        "id": 1176607,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620410097
    },
    {
        "content": "<p>I think it's worth having both a first-time highly visible nofitication, and something small every time. People may forget the initial notice, especially if they don't use Zulip frequently.</p>",
        "id": 1176631,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1620411395
    },
    {
        "content": "<p>For the every-time notice, maybe we can just have a little tooltip size thing appear above the \"Drafts\" element \"Saved a new draft!\" that disappears shortly after?</p>",
        "id": 1176647,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620412214
    },
    {
        "content": "<p>Seems reasonable to me...</p>\n<p>By the way, FWIW, Slack doesn't pop anything up. But their Drafts are at the top of the left side bar, which is a pretty visible placement. <a href=\"/user_uploads/2/68/s72vj4-SCxytk30_1LoIlcZR/Slack___Drafts___AcquiredFM.png\">Slack___Drafts___AcquiredFM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/68/s72vj4-SCxytk30_1LoIlcZR/Slack___Drafts___AcquiredFM.png\" title=\"Slack___Drafts___AcquiredFM.png\"><img src=\"/user_uploads/2/68/s72vj4-SCxytk30_1LoIlcZR/Slack___Drafts___AcquiredFM.png\"></a></div>",
        "id": 1176675,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1620413178
    },
    {
        "content": "<p>maybe we should consider copying that, adding \"Drafts\" below \"Recent Topics\"? would be good to have more visibility for drafts in general, imo.</p>",
        "id": 1176676,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1620413291
    },
    {
        "content": "<p>that would also make the bottom bar less busy, which i think would be a good thing</p>",
        "id": 1176678,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1620413453
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> <a href=\"#narrow/stream/101-design/topic/saved.20as.20draft/near/1176647\">said</a>:</p>\n<blockquote>\n<p>For the every-time notice, maybe we can just have a little tooltip size thing appear above the \"Drafts\" element \"Saved a new draft!\" that disappears shortly after?</p>\n</blockquote>\n<p>Something like this?</p>\n<p><a href=\"/user_uploads/2/fd/P6uqQws0hBm5oCX3IVFU5al6/Screenshot-2021-05-08-at-12.25.39-AM.png\">Screenshot-2021-05-08-at-12.25.39-AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/fd/P6uqQws0hBm5oCX3IVFU5al6/Screenshot-2021-05-08-at-12.25.39-AM.png\" title=\"Screenshot-2021-05-08-at-12.25.39-AM.png\"><img src=\"/user_uploads/2/fd/P6uqQws0hBm5oCX3IVFU5al6/Screenshot-2021-05-08-at-12.25.39-AM.png\"></a></div>",
        "id": 1176681,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1620413777
    },
    {
        "content": "<p>Drafts at the top-left seems reasonable, putting drafts in the same category as sent messages (which we don't have a link for either, though?).<br>\nIt will beg the question of whether they can be searched, though, or whether there's a a drafts \"narrow\", given that's what's up there otherwise. The current drafts popup isn't narrow-like, after all.</p>",
        "id": 1176697,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1620415738
    },
    {
        "content": "<p>i was imagining it as equivalent to recent topics, which also isn't a narrow, and also started its life as a popup.</p>",
        "id": 1176698,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1620415932
    },
    {
        "content": "<p>Sure, I'm not saying it couldn't be restyled - and that could be an improvement. I'm not sure if it would be potentially confusing until server-side drafts are complete, though, which I believe is not yet the case?</p>",
        "id": 1176789,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1620419310
    },
    {
        "content": "<p>Re the comparison to recent topics, I honestly just see that as a different narrow style, though in terms of presentation I would possibly advocate for a separation from the other top-left entries due to that.</p>",
        "id": 1176790,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1620419486
    },
    {
        "content": "<p>ah, i can see how the fact that they're not synced to the server could be confusing with that UI change, yeah</p>",
        "id": 1176792,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1620420441
    },
    {
        "content": "<p>i don't think that users care whether something it technically a \"narrow\" or not, for the most part â€” i think it would be fine to put drafts there once they're synced to the server, even if we don't have <code>is:draft</code> searches or whatever (mostly just since that adds a lot of complexity, and is not something i think that 99% of users would notice/care about)</p>",
        "id": 1176794,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1620420574
    },
    {
        "content": "<p>For recent topics, it's in a \"good enough\" location, but it's a different view and UI to the others nearby, which I feel warrants at least slight separation/distinction.</p>",
        "id": 1176826,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1620421808
    },
    {
        "content": "<p>From a user perspective drafts could easily fit in a \"narrow style\", so I've no qualms with moving them there (potentially with the server-side caveat).</p>",
        "id": 1176827,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1620421869
    },
    {
        "content": "<p>Slack also auto-fills the compose box with drafts, which has advantages (you don't need to wonder where a draft is) but also makes it impossible to send a different message to a place where you have a draft (which one does in Zulip pretty often to send a quick reply while composing something longer).</p>",
        "id": 1176915,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620425074
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/zulip/pull/17396\">#17396</a> has some discussion of that</p>",
        "id": 1176916,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1620425169
    },
    {
        "content": "<p>Maybe the actual solution for us is that we should figure out way to advertise any recent drafts that you have in a given narrow while the compose box is open, e.g. a banner \"You have 2 drafts from the last day for this view\"? </p>\n<p>Not something we can do quickly, though, because it'll likely require a lot of iteration around filtering tiny drafts (which I at least leak a few a day of).</p>",
        "id": 1176917,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620425187
    },
    {
        "content": "<p>i think it's possible to support both usecases, by detecting if the user deletes the draft immediately, and keeping it around as a draft if so, but it's definitely complicated, and would be a bit more annoying for the usecase of trying to keep around a draft</p>",
        "id": 1176919,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1620425269
    },
    {
        "content": "<p>hmm, another bug is that <code>j</code> and <code>k</code> don't work in the drafts screen, which i think contributes to me using the workflow you're describing less (usually, i'll just copy/paste whatever is in the composebox instead of getting it out of drafts, because i thought i couldn't access drafts from my keyboard)</p>",
        "id": 1176922,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1620425354
    },
    {
        "content": "<p>(<a href=\"https://github.com/zulip/zulip/pull/18397\">#18397</a>)</p>",
        "id": 1176923,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1620425458
    },
    {
        "content": "<blockquote>\n<p>(<a href=\"https://github.com/zulip/zulip/pull/18397\">#18397</a>)</p>\n</blockquote>\n<p>Opened <a href=\"https://github.com/zulip/zulip/pull/18408\">#18408</a> to fix it :)</p>",
        "id": 1177275,
        "sender_full_name": "Aryan Shridhar",
        "timestamp": 1620503109
    },
    {
        "content": "<p>So, <a href=\"https://github.com/zulip/zulip/pull/17557\">#17557</a>, aka the PR to show a one-time hotspot notice the first time drafts are saved, we can probably get into a mergeable state for this release.</p>",
        "id": 1177524,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620603850
    },
    {
        "content": "<p>Even if we did that, we still need to decide what we're going to do when saving drafts for later messages.  Do we show a notice or animation of some sort, and if so, where?</p>",
        "id": 1177525,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620603907
    },
    {
        "content": "<p>I think this question is the issue that most needs attention in terms of potentially blocking us from doing a 4.0 release.</p>",
        "id": 1177526,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620603945
    },
    {
        "content": "<p>I think not showing anything (and having folks figure out that drafts exist by finding the \"Drafts\" button) is better than the weird animation we have right now. That might be OK for the release, though it would be great to see a prototype of an animation above the compose area that we could consider.</p>",
        "id": 1178079,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1620681323
    },
    {
        "content": "<p>OK, it's easy enough to do a TippyJS tooltip, I'll do that.</p>",
        "id": 1178904,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620770314
    },
    {
        "content": "<p>Merged a tooltip migration as <a href=\"https://github.com/zulip/zulip/commit/6a374d6d28af07e18d1600f01b64892bac24f0a2\">6a374d6d28af07e18d1600f01b64892bac24f0a2</a>.  I don't think it's perfect, but it's no longer broken looking.</p>",
        "id": 1178909,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620770680
    },
    {
        "content": "<p>Sigh, I've reproduced a bug with the tooltip iteration, where the \"Saved as draft\" notice appears at the left end of the compose box after closing an empty compose box (where no draft is saved).  Probably this is a preexisting bug with when we call the \"Render animation\" function, that just was previously not visible.  Looking.</p>",
        "id": 1179225,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620836480
    },
    {
        "content": "<p>Ahh, OK, I see the bug: It happens when you close the empty compose box while the message you just sent has been locally echoed but not yet delivered.</p>",
        "id": 1179233,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620836760
    },
    {
        "content": "<p>OK, this turned out to be somewhat subtle, but it's fixed in <a href=\"https://github.com/zulip/zulip/commit/b67b9912c4b182019079f7c6ceaffc46e33b36f9\">b67b9912c4b182019079f7c6ceaffc46e33b36f9</a>.</p>\n<p>It turns out that the hook we were using to save drafts was just an incorrect design.</p>",
        "id": 1179510,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1620849279
    },
    {
        "content": "<p>Tim, what did you mean by, </p>\n<blockquote>\n<p>(The most likely change I'd like to do is to show details on drafts for the current recipient when the compose box is open)</p>\n</blockquote>\n<p>in this <a href=\"http://(https://github.com/zulip/zulip/issues/17396#issuecomment-841338279)\">comment</a>?</p>\n<p>Are you suggesting that we show something like \"You have 3 drafts related to this thread.\" above the compose box (opened state)?</p>\n<p>And when the user clicks on it we'd show those three drafts in the drafts modal.</p>",
        "id": 1181317,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1621010513
    },
    {
        "content": "<p>Yeah, that's one idea (or changing the 'Drafts' widget to show a number etc.</p>",
        "id": 1181341,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1621012192
    },
    {
        "content": "<p>The other direction is that we could auto-restore the last draft when you open the compose box using a mechanism that does not autofill content (E.g. the <code>@</code> hotkey would work as-is), and then have something manual you need to do to if you want to compose a new empty message while keeping that draft.</p>",
        "id": 1181343,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1621012276
    },
    {
        "content": "<p>Oh, another idea is we could adjust the placeholder text to say \"Your last draft for this topic was saved at 15 minutes ago.\", maybe as a second line below the main placeholder text.</p>",
        "id": 1181344,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1621012320
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> <a href=\"#narrow/stream/101-design/topic/saved.20as.20draft/near/1181343\">said</a>:</p>\n<blockquote>\n<p>The other direction is that we could auto-restore the last draft when you open the compose box using a mechanism that does not autofill content (E.g. the <code>@</code> hotkey would work as-is), and then have something manual you need to do to if you want to compose a new empty message while keeping that draft.</p>\n</blockquote>\n<p>I think so it will be a bit more complex for the normal user.</p>",
        "id": 1182240,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1621232029
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> <a href=\"#narrow/stream/101-design/topic/saved.20as.20draft/near/1181344\">said</a>:</p>\n<blockquote>\n<p>Oh, another idea is we could adjust the placeholder text to say \"Your last draft for this topic was saved at 15 minutes ago.\", maybe as a second line below the main placeholder text.</p>\n</blockquote>\n<p>This sounds good, but personally, I rarely read the placeholder text. <br>\nAnd <em>I guess</em> most users don't read placeholder text too.</p>\n<p>So, this might not be <em>most effective</em>.</p>",
        "id": 1182241,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1621232322
    },
    {
        "content": "<p>I think so instead of showing <code>You have 3 drafts related to this thread.</code>, we can show something like <code>Your last draft for this topic was saved at 15 minutes ago.</code> above the compose box (opened state). And when the user clicks on it, it will open the drafts modal with that draft focused.</p>\n<p>I also agree that it will be annoying to show this every time, so we can:</p>\n<ul>\n<li>Set the tutorial timer for this for about 1 month, where we will show this <code>tip</code> for 1 month to the new user.  Admins can change this duration though. And normal user can turn it off manually in the settings. Or we can lead the normal user to the settings when we are showing this <code>tip</code>.</li>\n<li>We can add the <code>is_shown_on_tip</code> attribute to the draft message, so we don't show the <code>tip</code> for the same draft more than one time.</li>\n</ul>",
        "id": 1182242,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1621233318
    },
    {
        "content": "<p>For what it's worth, Slack and Discord auto-populate the draft in the compose box when you're in the appropriate context. But I don't see a way to save an ongoing draft and start a new message, which does seem like a useful feature.</p>",
        "id": 1182570,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1621287734
    },
    {
        "content": "<p>I wonder if the right default is to put the latest draft into the compose box, but have some kind of \"Save as draft and clear compose box\" button. Not sure how to do this without having to write so many words explaining the action, though. \"Save and clear\"?</p>",
        "id": 1182572,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1621287897
    },
    {
        "content": "<p>Clicking outside compose box has similar effects(of Save and Clear). But it also closes compose box.</p>",
        "id": 1182678,
        "sender_full_name": "Purushottam Tiwari",
        "timestamp": 1621315094
    },
    {
        "content": "<p>I also liked the \"Save and Clear\" button idea.</p>",
        "id": 1182906,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1621333219
    },
    {
        "content": "<p>Ah, we actually have an issue for something like this change (<a href=\"https://github.com/zulip/zulip/pull/11218\">#11218</a>), and <a href=\"#narrow/stream/137-feedback/topic/Auto-load.20Draft/near/679701\">a prior discussion</a>.</p>\n<p>Adding a user setting for whether drafts get restored (as described in <a href=\"https://github.com/zulip/zulip/pull/11218\">#11218</a>) is an option, but it does add some complexity. <span class=\"user-mention\" data-user-id=\"58\">@Steve Howell (showell)</span> what are your thoughts on it at this point? Would it impede your workflow if drafts were auto-restored? If you don't want to start from the draft, you could either:</p>\n<ol>\n<li>Select the text and delete it, which should actually help the user not leak drafts.</li>\n<li>Click \"Save and clear\" to send a new message and come back to that draft later.</li>\n</ol>",
        "id": 1183151,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1621367078
    },
    {
        "content": "<p>I would need to see it in action.  I think the trickiest piece here is making it easy to permanently dismiss a draft.</p>",
        "id": 1183156,
        "sender_full_name": "Steve Howell",
        "timestamp": 1621367696
    },
    {
        "content": "<p>Is selecting the text and deleting (e.g. ctrl-a + backspace) OK as a way to do that?</p>",
        "id": 1183176,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1621371311
    },
    {
        "content": "<p>Would that actually permanently dismiss the draft?</p>",
        "id": 1183181,
        "sender_full_name": "Steve Howell",
        "timestamp": 1621373739
    },
    {
        "content": "<p>Oh, hrm, I hadn't realized that it currently wouldn't dismiss it; the draft only gets replaced if you edit the text to something other than blank.</p>\n<p>If we have an explicit \"Save and clear\" button, I think editing the text in any other way (including deleting) should permanently dismiss the old draft. Do folks agree?</p>",
        "id": 1183226,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1621379495
    },
    {
        "content": "<p>That seems right to me.</p>",
        "id": 1184377,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1621463134
    },
    {
        "content": "<p>I wrote up a new issue based on the discussion here: <a href=\"https://github.com/zulip/zulip/pull/18555\">#18555</a></p>",
        "id": 1184514,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1621471589
    },
    {
        "content": "<p>I realized that we need to decide the following: should drafts be restored when there is no valid addressee? (e.g. only stream specified, only topic specified, or nothing specified for a stream message or PM)</p>\n<p>Proposal:<br>\na. If the addressee is not blank, restore draft only if it exactly matches. E.g. a compose box with stream=<code>general</code> and no specified topic matches drafts with stream=<code>genera</code>l and no specified topic, but does not match drafts with stream=<code>general</code>/topic=<code>Zulip 4.0</code>.<br>\nb. Do not restore drafts when the addressee is blank.</p>\n<p>What do folks think?</p>",
        "id": 1184516,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1621471698
    },
    {
        "content": "<p>I think \"stream set, topic blank\" should not auto-restore draft content.  It'll be obvious if we prototype that, but effectively doing so will mean that clicking \"new topic\" auto-restores whatever last draft you'd have with no topic specified, which seems unlikely to be what you want.</p>",
        "id": 1185157,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1621542726
    },
    {
        "content": "<p>So I'd just go with the simpler \"auto-restore draft if a full recipient is specified and matches exactly, e.g. stream+topic or PM recipients\".</p>",
        "id": 1185158,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1621542755
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> <a href=\"#narrow/stream/101-design/topic/saved.20as.20draft/near/1185157\">said</a>:</p>\n<blockquote>\n<p>I think \"stream set, topic blank\" should not auto-restore draft content.  It'll be obvious if we prototype that, but effectively doing so will mean that clicking \"new topic\" auto-restores whatever last draft you'd have with no topic specified, which seems unlikely to be what you want.</p>\n</blockquote>\n<p>Yes, i agree to this. But we many a times have a draft that we have prepared or writing from long time and we don't want that to send right now.<br>\nThis will create a problem I feel.</p>",
        "id": 1185160,
        "sender_full_name": "Priyam Seth (Signior-X)",
        "timestamp": 1621542842
    },
    {
        "content": "<p>Well, you're only going to see that if you're looking to reply to the topic where you had that old draft.</p>",
        "id": 1185176,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1621543897
    },
    {
        "content": "<p>We're only going to be able to evaluate that question once we have this prototyped.</p>",
        "id": 1185177,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1621543906
    },
    {
        "content": "<blockquote>\n<p>Yes, i agree to this. But we many a times have a draft that we have prepared or writing from long time and we don't want that to send right now</p>\n</blockquote>\n<p>The \"Save and clear\" button should help with this, though of course it may still be annoying in some cases.</p>",
        "id": 1185200,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1621545917
    },
    {
        "content": "<blockquote>\n<p>So I'd just go with the simpler \"auto-restore draft if a full recipient is specified and matches exactly, e.g. stream+topic or PM recipients\".</p>\n</blockquote>\n<p>Sure, I can update the issue accordingly.</p>",
        "id": 1185225,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1621547198
    },
    {
        "content": "<p>I just had another UX question on this topic come to mind... What exactly should happen when you have a partially composed message, and you change the stream or topic, or the set of PM recipients? There are multiple things that could be happening:</p>\n<ol>\n<li>Part way through writing the message, you realized you wanted to send it somewher else. In that case, you want to keep working on the current message, not see old drafts. Perhaps this is the most likely?</li>\n<li>You haven't started composing or editing an old draft yet and are in the process of setting the destination for you message; you want to see the draft you have saved for the final context you specify.</li>\n<li>Maybe you did start writing a few words before setting the topic/stream or addressees, but the saved draft you have in that context is actually a more written out version of what you were about to say?</li>\n</ol>\n<p>Anyhow, I wonder if we should be explicitly asking whether or not to open the old draft you have when the addressee is changed? If not, what's the right behavior for what situation?</p>",
        "id": 1187231,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1621880461
    },
    {
        "content": "<p>I think the most likely is you want to send your current message to that new place, and we should move the draft.  If you instead want to keep your draft and send a new message to that new place, you should close compose (saving the draft) and start composing a new message.</p>",
        "id": 1187347,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1621885810
    },
    {
        "content": "<p>Maybe that's right... Though when you start composing a new message, by default it'll restore the draft you just saved, so you'll need to explicitly go look for your old draft.</p>",
        "id": 1187348,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1621886234
    },
    {
        "content": "<blockquote>\n<p>I think the most likely is you want to send your current message to that new place, and we should move the draft.</p>\n</blockquote>\n<p>I think so we are already doing it,<br>\n<a href=\"/user_uploads/2/3f/OBp4YH69CieznAG4L0XC8507/draft_addressee_change_behaviour.gif\">draft_addressee_change_behaviour.gif</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/3f/OBp4YH69CieznAG4L0XC8507/draft_addressee_change_behaviour.gif\" title=\"draft_addressee_change_behaviour.gif\"><img src=\"/user_uploads/2/3f/OBp4YH69CieznAG4L0XC8507/draft_addressee_change_behaviour.gif\"></a></div>",
        "id": 1188764,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622029149
    },
    {
        "content": "<p>Cool, updated the issue description accordingly.</p>",
        "id": 1189039,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1622052296
    },
    {
        "content": "<p>I have opened PR <a href=\"https://github.com/zulip/zulip/pull/18613\">#18613</a> for restoring the last draft (The first point of the <a href=\"https://github.com/zulip/zulip/issues/18555#issue-896116019\">list</a>). <br>\nI'd really appreciate the review <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span>.</p>",
        "id": 1189122,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622056295
    },
    {
        "content": "<p>The <code>Saved as draft</code> tooltip appears even after we don't edit our initial draft, right ? Should we only show this again when the previous draft is actually edited.</p>",
        "id": 1189139,
        "sender_full_name": "Gaurav Pandey (ligmitz)",
        "timestamp": 1622056762
    },
    {
        "content": "<p>The actual job of the <code>Saved as draft</code> tooltip is to inform the user that the message is successfully saved as a draft (and the message is not lost).</p>\n<p>So I think so showing the tooltip even if it's not edited makes sense.</p>",
        "id": 1189146,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622056992
    },
    {
        "content": "<p>Playing with the PR... I think in the special case when the compose box is empty, and you change the addressee, it <em>should</em> restore the draft you have for that addressee. (It currently does not.) Do folks agree?</p>",
        "id": 1189178,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1622058372
    },
    {
        "content": "<p>Also, it looks like if I have a draft saved for a new topic, but there are no messages in that topic yet, it doesn't get restored.</p>",
        "id": 1189186,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1622058558
    },
    {
        "content": "<p>Exciting to see the progress! :)</p>",
        "id": 1189192,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1622058773
    },
    {
        "content": "<p>Yeah, I think that empty compose box special case idea is worth trying; if it creates a problem, we'll notice pretty fast.</p>",
        "id": 1189197,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1622059053
    },
    {
        "content": "<p>I have updated the <a href=\"https://github.com/zulip/zulip/pull/18613\">PR</a>, now it also supports restoring the last draft when compose box addressee matches the draft's addressee.</p>",
        "id": 1190795,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622224860
    },
    {
        "content": "<p>Currently, I have implemented to check if the draft can be restored as value changes. <br>\nBut it creates an issue when some topic has a similar name (for eg: <code>topic</code>, <code>topic 2</code>).  <br>\nAs I hit the spacebar after <code>topic</code> it changes the focus to textarea.<br>\nHere is the demo,<br>\n<a href=\"/user_uploads/2/9e/22-NUIDkGOnOyJOvR1BDnL33/issue.gif\">issue.gif</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/9e/22-NUIDkGOnOyJOvR1BDnL33/issue.gif\" title=\"issue.gif\"><img src=\"/user_uploads/2/9e/22-NUIDkGOnOyJOvR1BDnL33/issue.gif\"></a></div><p>Should I change it to check if the draft can be restored after values have been out of focus?</p>",
        "id": 1190804,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622226240
    },
    {
        "content": "<p>Yeah, I checked out the PR, and we definitely can't have the focus jumping away from the topic field like that while one is trying to edit it.</p>",
        "id": 1190901,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1622237003
    },
    {
        "content": "<blockquote>\n<p>Should I change it to check if the draft can be restored after values have been out of focus?</p>\n</blockquote>\n<p>Can you please elaborate what you mean by that?</p>",
        "id": 1190902,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1622237049
    },
    {
        "content": "<p>Something like this,<br>\n<a href=\"/user_uploads/2/5f/DpEqMSogg9MkLkQ4pVkkKihH/focus.gif\">demo.gif</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/5f/DpEqMSogg9MkLkQ4pVkkKihH/focus.gif\" title=\"demo.gif\"><img src=\"/user_uploads/2/5f/DpEqMSogg9MkLkQ4pVkkKihH/focus.gif\"></a></div><p>(It will only restore the draft after the user has finished typing (i.e clicked somewhere else or hit tab).)</p>",
        "id": 1191039,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622272870
    },
    {
        "content": "<p>I have updated the <a href=\"https://github.com/zulip/zulip/pull/18613\">PR</a> with the above changes!</p>",
        "id": 1191293,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622320645
    },
    {
        "content": "<p>We have a clash between two functionality, </p>\n<ol>\n<li>Restoring the last draft when compose box addressee matches the draft's addressee. (<a href=\"https://github.com/zulip/zulip/pull/18613#discussion_r642105284\">Restore the draft when <code>#compose-textarea</code> focuses.</a>)</li>\n<li>Save and Clear button.</li>\n</ol>\n<p>When we click on the \"Save and Clear\" button and we have cleared the text we need to focus back on textarea(<code>#compose-textarea</code>), but as we focus back, it will bring back the last text because of the <code>1.</code> functionality.</p>\n<p>Here is how it'd look, <br>\n<a href=\"/user_uploads/2/a4/m1S2pEQpJqA_QYxFkPxuweGV/clash.gif\">clash.gif</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/a4/m1S2pEQpJqA_QYxFkPxuweGV/clash.gif\" title=\"clash.gif\"><img src=\"/user_uploads/2/a4/m1S2pEQpJqA_QYxFkPxuweGV/clash.gif\"></a></div><p>One possible solution for this would be to restore the draft when the stream, topic, or pm recipient input box gets out of focus, but we can't because it will raise another issue which I have explained <a href=\"https://github.com/zulip/zulip/pull/18613#discussion_r642105284\">here</a>.</p>",
        "id": 1197966,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622398856
    },
    {
        "content": "<p>We can do something like this when focusing back to textarea,</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"c1\">// static/js/compose.js</span>\n<span class=\"o\">+</span>    <span class=\"nx\">$</span><span class=\"p\">(</span><span class=\"s2\">\"#compose\"</span><span class=\"p\">).</span><span class=\"nx\">on</span><span class=\"p\">(</span><span class=\"s2\">\"click\"</span><span class=\"p\">,</span> <span class=\"s2\">\".save_and_clear_message\"</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"nx\">e</span><span class=\"p\">)</span> <span class=\"p\">=&gt;</span> <span class=\"p\">{</span>\n<span class=\"p\">...</span>\n<span class=\"o\">+</span>        <span class=\"nx\">$</span><span class=\"p\">(</span><span class=\"s2\">\"#compose-textarea\"</span><span class=\"p\">).</span><span class=\"nx\">data</span><span class=\"p\">(</span><span class=\"s2\">\"is-saving\"</span><span class=\"p\">,</span> <span class=\"kc\">true</span><span class=\"p\">).</span><span class=\"nx\">trigger</span><span class=\"p\">(</span><span class=\"s2\">\"focus\"</span><span class=\"p\">).</span><span class=\"nx\">data</span><span class=\"p\">(</span><span class=\"s2\">\"is-saving\"</span><span class=\"p\">,</span> <span class=\"kc\">false</span><span class=\"p\">);</span>\n<span class=\"o\">+</span>    <span class=\"p\">});</span>\n\n<span class=\"c1\">// static/js/drafts.js</span>\n <span class=\"k\">export</span> <span class=\"kd\">function</span> <span class=\"nx\">restore_last_draft_based_on_compose_state</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n<span class=\"o\">+</span>    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">$</span><span class=\"p\">(</span><span class=\"s2\">\"#compose-textarea\"</span><span class=\"p\">).</span><span class=\"nx\">data</span><span class=\"p\">(</span><span class=\"s2\">\"is-saving\"</span><span class=\"p\">))</span> <span class=\"p\">{</span>\n         <span class=\"k\">return</span><span class=\"p\">;</span>\n</code></pre></div>\n<p>But I am not sure if this is the best approach?</p>",
        "id": 1198135,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622446907
    },
    {
        "content": "<p>Opened the <a href=\"https://github.com/zulip/zulip/pull/18656\">PR</a> for the delete draft behavior.</p>",
        "id": 1198363,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622489473
    },
    {
        "content": "<p>Mmm, yeah, I think from a user experience perspective, the above looks right -- restore drafts unless the user has just saved the draft ... I'll leave it to other folks to comment on the implementation details. :)</p>",
        "id": 1198704,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1622565433
    },
    {
        "content": "<p>My theory was that we only want to restore the latest draft when opening the compose box afresh to a recipient; if the user had an empty compose box and then edits the topic field, that shouldn't do anything with drafts since the intent appears to be sending something new.</p>",
        "id": 1199623,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1622658432
    },
    {
        "content": "<p>So \"Save and clear\" would clear without closing the compose box.</p>",
        "id": 1199624,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1622658449
    },
    {
        "content": "<p>I'm not sure about that... For example, for starting a new topic, my workflow is usually to click on the stream, open the compose box, and change the topic name to the new one. If I already started a draft for that new topic, I would want to get it restored.</p>",
        "id": 1199638,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1622658875
    },
    {
        "content": "<p>We have one more condition in the new delete draft behavior to discuss,<br>\n\"What should we do if the length of the text is <code>&gt;0</code> and <code>&lt;= 2</code> ?\"</p>\n<p>Currently, we don't save the message/update the draft if the length of the text is <code>&lt;=2</code>. </p>\n<p>We can do the following things,</p>\n<ul>\n<li>Delete the draft if the length of the text is <code>&lt;=2</code>(instead of  <code>0</code> ).</li>\n<li>Save the message/Update the draft if the length of the text is <code>&gt;0</code>(instead of <code>&lt;=2</code>).</li>\n</ul>\n<p>I think so we should go with the first option as it seems natural.</p>",
        "id": 1200221,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622725193
    },
    {
        "content": "<p>Should we add an option to the settings to disable/enable auto-loading of drafts? (As suggested by <span class=\"user-mention silent\" data-user-id=\"17945\">Wesley Aptekar-Cassels</span>  <a href=\"#narrow/stream/101-design/topic/save.20and.20clear.20button.20design/near/1200016\">here</a>.)</p>",
        "id": 1200261,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622727873
    },
    {
        "content": "<blockquote>\n<p>I think so we should go with the first option as it seems natural.</p>\n</blockquote>\n<p>I think that makes sense... The one use case I can think of that it wouldn't work for is if you use drafts as a to-do list (\"messages I have to respond to\"), and are trying to do so by just typing 1-2 characters. But if we haven't heard complaints more generally about drafts &lt;=2 characters not being saved, I think it should be the same here.</p>",
        "id": 1200298,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1622733585
    },
    {
        "content": "<blockquote>\n<p>Riken Shah (Riken-Shah): Should we add an option to the settings to disable/enable auto-loading of drafts? (As suggested by Wesley Aptekar-Cassels here.)</p>\n</blockquote>\n<p>I'm not sure we need to for the MVP... What do folks think?</p>",
        "id": 1200300,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1622733665
    },
    {
        "content": "<p>Yeah, I think that's a think we'd consider adding after testing something on <a href=\"http://chat.zulip.org\">chat.zulip.org</a>.</p>",
        "id": 1200752,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1622766631
    },
    {
        "content": "<p>What do folks think about auto-loading the draft when the topic is filled in an empty compose box.</p>",
        "id": 1201252,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1622823610
    },
    {
        "content": "<p>I think this is the kind of question that will be more intuitive once we've test-deployed.  So my main feedback is we should code things such that it's a 1-line change to adjust our plan on that detail, since it does seem like an atomic decision.</p>",
        "id": 1201275,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1622824282
    },
    {
        "content": "<p>Hello - I'd like to look into this and see if it's possible that we can get something working and maybe even shippable!</p>\n<p>I looked through existing reading including:</p>\n<ul>\n<li>Github Issue: <a href=\"https://github.com/zulip/zulip/pull/18555\">#18555</a></li>\n<li>CZO discussion: <a href=\"#narrow/stream/137-feedback/topic/Auto-load.20Draft/near/679701\">January 2019</a> and <a href=\"#narrow/stream/101-design/topic/saved.20as.20draft\">May 2021</a></li>\n</ul>\n<p>The relevant open issues are:</p>\n<ul>\n<li><a href=\"https://github.com/zulip/zulip/pull/11218\">#11218</a> Add setting to auto-open drafts</li>\n<li><a href=\"https://github.com/zulip/zulip/pull/8969\">#8969</a> Add \"Click on a message to restore\" instruction.</li>\n<li><a href=\"https://github.com/zulip/zulip/pull/17396\">#17396</a> Zulip's drafts behavior made me think it discarded text when I pressed ESC by accident</li>\n</ul>\n<p>Already open PRs:</p>\n<ul>\n<li><a href=\"https://github.com/zulip/zulip/pull/18613\">#18613</a>: compose: Restore the last draft when compose box is opened. <ul>\n<li>I checked this out locally and got it rebased and working for what was implemented so far.</li>\n<li>The clear draft button has not been implemented yet, so it would need to be added to the PR (possibly along with extra logic to get the most recent draft).</li>\n</ul>\n</li>\n<li><a href=\"https://github.com/zulip/zulip/pull/18718\">#18718</a>: compose box: Rotate drafts in compose box.  (experimental, separate from the current proposal)</li>\n</ul>\n<hr>\n<p>Changes that need to be made:</p>\n<ul>\n<li>When a user has an open compose box with at least one draft for the current addressee (either stream/topic or PM), the most recently edited draft for that addressee is auto-restored in the compose box. <em>Status: done</em></li>\n<li>Deleting the text in the compose box deletes the draft instead of keeping it saved. <em>Status: done</em></li>\n<li>Start a new message when there's an existing draft by clicking a new \"Save and clear\" button that saves a draft and clears the box. <em>Status: not started.</em></li>\n</ul>\n<p>Further thoughts on starting a new message when thereâ€™s an existing draft (both mine and others' from above)</p>\n<ul>\n<li>We can do something very simple and implement something like Slack where we allow only one draft per topic, and let users turn off the \"restore drafts\" feature if they donâ€™t like this regression. We can also do this first and let there be more than one draft per topic in the future. Iâ€™m not sure how many users would be okay with this tradeoff, but I'd be interested to find out.</li>\n<li>The existing proposal is to add a new \"save and clear\" button that saves a draft and clears the box. I think if we do this we should make it really clear that this doesn't close the compose box. Most of the time I want to save a draft is when I'm leaving the compose box and want to make sure it was saved. With the existing proposal, if I click the button then the box will clear and stay open. Writing a second draft might happen infrequently enough that it's strange to make a button just for that.</li>\n<li>More complicated proposal (which might confuse user): Save if the user explicitly saved the draft with the button (store in the database). Only open the last draft if it was auto-saved and not explicitly saved with the button, because this is more likely to have been an accidental click away.</li>\n</ul>\n<p>Possible other features:</p>\n<ul>\n<li>Auto-loading a draft when the user types the relevant topic into an empty compose box (including starting with empty topic field).</li>\n<li>If there are saved drafts for that specific topic/message view that arenâ€™t currently in the compose box, show a banner communicating that this is the case. The user can click on this banner to open a dialog with only the relevant drafts.</li>\n<li>Give user an option to turn this feature off.</li>\n</ul>",
        "id": 1355736,
        "sender_full_name": "Evy",
        "timestamp": 1648599798
    },
    {
        "content": "<p>Thanks a lot for writing such a good throughout brief about this feature <span class=\"user-mention silent\" data-user-id=\"21453\">Evy Kassirer</span>.</p>\n<blockquote>\n<ul>\n<li>Start a new message when there's an existing draft by clicking a new \"Save and clear\" button that saves a draft and clears the box. <em>Status: not started.</em></li>\n</ul>\n</blockquote>\n<blockquote>\n<p>The existing proposal is to add a new \"save and clear\" button that saves a draft and clears the box. I think if we do this we should make it really clear that this doesn't close the compose box. Most of the time I want to save a draft is when I'm leaving the compose box and want to make sure it was saved. With the existing proposal, if I click the button then the box will clear and stay open. Writing a second draft might happen infrequently enough that it's strange to make a button just for that.</p>\n</blockquote>\n<p>I don't think so we need <code>Save and Clear</code> button as it will be used very infrequently.<br>\nWhat do folks think about it? Do we need a <code>save and clear</code> button? </p>\n<blockquote>\n<p>Most of the time I want to save a draft is when I'm leaving the compose box and want to make sure it was saved.</p>\n</blockquote>\n<p>To handle this issue maybe we can add an indicator on the top right side of compose box saying <code>Saving as draft</code> and <code>Saved as draft</code>.<br>\nJust like how google docs do it,<br>\n<a href=\"/user_uploads/2/3f/rRVETLr-KVPAREoSlZMC3xM_/Screenshot-2022-04-03-at-5.51.18-PM.png\">Screenshot-2022-04-03-at-5.51.18-PM.png</a> <a href=\"/user_uploads/2/57/WWCRiB8_WOtmq__je90Fndnm/Screenshot-2022-04-03-at-5.51.26-PM.png\">Screenshot-2022-04-03-at-5.51.26-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/3f/rRVETLr-KVPAREoSlZMC3xM_/Screenshot-2022-04-03-at-5.51.18-PM.png\" title=\"Screenshot-2022-04-03-at-5.51.18-PM.png\"><img src=\"/user_uploads/2/3f/rRVETLr-KVPAREoSlZMC3xM_/Screenshot-2022-04-03-at-5.51.18-PM.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/57/WWCRiB8_WOtmq__je90Fndnm/Screenshot-2022-04-03-at-5.51.26-PM.png\" title=\"Screenshot-2022-04-03-at-5.51.26-PM.png\"><img src=\"/user_uploads/2/57/WWCRiB8_WOtmq__je90Fndnm/Screenshot-2022-04-03-at-5.51.26-PM.png\"></a></div><blockquote>\n<p>We can do something very simple and implement something like Slack where we allow only one draft per topic, and let users turn off the \"restore drafts\" feature if they donâ€™t like this regression. We can also do this first and let there be more than one draft per topic in the future. Iâ€™m not sure how many users would be okay with this tradeoff, but I'd be interested to find out.</p>\n</blockquote>\n<p>I am not sure I understand this point.</p>\n<blockquote>\n<p>More complicated proposal (which might confuse user): Save if the user explicitly saved the draft with the button (store in the database). Only open the last draft if it was auto-saved and not explicitly saved with the button, because this is more likely to have been an accidental click away.</p>\n</blockquote>\n<p>I think so this will make UX very confusing. What we can do instead IMO is enable <code>auto-save</code> by default and add an option to switch to \"Save only when <code>Save</code> button is clicked\". The same goes for auto-loading the draft, the default behavior will auto-loading while the user will have the option to switch it off. <br>\nPossible other features:</p>\n<blockquote>\n<p>Auto-loading a draft when the user types the relevant topic into an empty compose box (including starting with empty topic field).</p>\n</blockquote>\n<p>Yeah, we can do this <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span>.</p>\n<blockquote>\n<p>If there are saved drafts for that specific topic/message view that arenâ€™t currently in the compose box, show a banner communicating that this is the case. The user can click on this banner to open a dialog with only the relevant drafts.</p>\n</blockquote>\n<p>Hmm. Maybe?</p>\n<blockquote>\n<p>Give user an option to turn this feature off.</p>\n</blockquote>\n<p>yeah, this definitely sounds like a good option to have.</p>",
        "id": 1359204,
        "sender_full_name": "Riken Shah (Riken-Shah)",
        "timestamp": 1648989944
    },
    {
        "content": "<blockquote>\n<p>I don't think so we need Save and Clear button as it will be used very infrequently.<br>\nWhat do folks think about it? Do we need a save and clear button?</p>\n</blockquote>\n<p>We need some way to start a new draft when the existing draft has been loaded. I think the next big decision to be made is to figure out what exactly that looks like.</p>",
        "id": 1359661,
        "sender_full_name": "Evy",
        "timestamp": 1649094376
    },
    {
        "content": "<blockquote>\n<p>add an indicator on the top right side of compose box saying Saving as draft and Saved as draft.</p>\n</blockquote>\n<p>This might be good! I think starting with something very simple and testing it out on CZO would be good, and adding that later if we still want it after playing around with the more basic version for a bit.</p>",
        "id": 1359663,
        "sender_full_name": "Evy",
        "timestamp": 1649094427
    },
    {
        "content": "<blockquote>\n<blockquote>\n<p>We can do something very simple and implement something like Slack where we allow only one draft per topic, and let users turn off the \"restore drafts\" feature if they donâ€™t like this regression. We can also do this first and let there be more than one draft per topic in the future. Iâ€™m not sure how many users would be okay with this tradeoff, but I'd be interested to find out.</p>\n</blockquote>\n<p>I am not sure I understand this point.</p>\n</blockquote>\n<p>Essentially, if we only allow one draft at a time (not for the whole app, but per conversation thread) then we don't need to design a way to start a new draft when there's already an existing one. This is how Slack and Discord currently work. Zulip has the nice feature of being able to create as many drafts as you want per conversation, though this also adds extra design questions for this feature. Does that make sense? Happy to explain further.</p>\n<p>This is mostly Wesley's idea:</p>\n<p><span class=\"user-mention silent\" data-user-id=\"17945\">Wesley Aptekar-Cassels</span> <a href=\"#narrow/stream/101-design/topic/save.20and.20clear.20button.20design/near/1200016\">said</a>:</p>\n<blockquote>\n<p>This is to unblock us loading drafts into the composebox by default, right? If so, I'm not totally convinced by this approach â€” it's a lot of screen real estate for what I'd imagine is a pretty uncommon action, and one that users probably have more intuitive ways to deal with (copy draft, paste into text editor/doc/etc, write quick reply, copy draft back over). Or even write short response above the draft, cut the draft, send the short response, and paste the draft back into the composebox so it's re-saved.</p>\n<p>This seems like a very niche feature, which is unlikely to be very generally useful or understandable, and my preference would be to just have it so that one can only have one draft per topic (or, if we think that will seriously annoy power users, add an option to disable auto-loading drafts, which we will possibly want to do anyways).</p>\n</blockquote>",
        "id": 1359665,
        "sender_full_name": "Evy",
        "timestamp": 1649094550
    },
    {
        "content": "<blockquote>\n<p>If there are saved drafts for that specific topic/message view that arenâ€™t currently in the compose box, show a banner communicating that this is the case. The user can click on this banner to open a dialog with only the relevant drafts.</p>\n</blockquote>\n<p>To clarify this a bit -- if users can create multiple drafts per conversation, it might be difficult for them to find those drafts. They could do the rotation thing you put up in that PR, and I was suggesting another way for them to discover a collection of drafts -- if they can open a popup, then they can see the full text for all the current drafts for that conversation, and pick the one they want (and also delete ones they don't want).</p>",
        "id": 1359666,
        "sender_full_name": "Evy",
        "timestamp": 1649094728
    },
    {
        "content": "<p>I hadn't read <a class=\"stream-topic\" data-stream-id=\"101\" href=\"/#narrow/stream/101-design/topic/save.20and.20clear.20button.20design\">#design &gt; save and clear button design</a>, so I'll read through that now!</p>",
        "id": 1359667,
        "sender_full_name": "Evy",
        "timestamp": 1649094749
    },
    {
        "content": "<p>Thanks for all these thoughts <span class=\"user-mention\" data-user-id=\"17964\">@Riken Shah (Riken-Shah)</span> ! I'm very excited about this :)</p>",
        "id": 1359668,
        "sender_full_name": "Evy",
        "timestamp": 1649094770
    },
    {
        "content": "<p>Great discussion above!</p>\n<blockquote>\n<p>Auto-loading a draft when the user types the relevant topic into an empty compose box (including starting with empty topic field).</p>\n</blockquote>\n<p>I think I was imagining this as part of the implementation.</p>",
        "id": 1359796,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1649102757
    },
    {
        "content": "<p>This is now feature complete at <a href=\"https://github.com/zulip/zulip/pull/22104\">#22104</a>! The button is a bit ugly because I wasn't sure what the best thing to do with it was, given we haven't made the send dropdown yet (I can make it now if we want?)</p>\n<p>I'd love to hear folks' thoughts on it if you have time to try it out :)</p>",
        "id": 1385351,
        "sender_full_name": "Evy",
        "timestamp": 1653615477
    },
    {
        "content": "<p>Nice! After playing around with this, I'm thinking we should actually have a dropdown attached to <strong>Drafts</strong>, rather than the <strong>Send</strong> button.</p>\n<p>It would have the following options:</p>\n<h2>View N more drafts for this conversation [only shown if N &gt; 0]</h2>\n<ul>\n<li>This would link to Drafts, which would have the new \"Drafts from this conversation\" section at the top.</li>\n<li>It would probably obviate the need for other ways to view/scroll through drafts, at least for the initial version.</li>\n</ul>\n<h2>Save to drafts and start new message</h2>\n<ul>\n<li>This would replace the \"Compose new message\" button</li>\n<li>We can play with the wording, but the advantage is that we don't have to be as succinct since it's a menu option, rather than an always-visible piece of UI.</li>\n</ul>\n<p>Thoughts?</p>",
        "id": 1385629,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1653683022
    },
    {
        "content": "<p>That seems like a reasonable place to put it! Would there still be an option to click to see all drafts? And would the drop-down only be there if a draft is auto restored (as I currently have it)?</p>",
        "id": 1385775,
        "sender_full_name": "Evy",
        "timestamp": 1653692257
    },
    {
        "content": "<p>I think there should still be in all drafts option. Maybe it could be the main part of the button, and there would be the drop-down part on the right?</p>",
        "id": 1385776,
        "sender_full_name": "Evy",
        "timestamp": 1653692283
    },
    {
        "content": "<p>And I'm pretty sure that only showing this when I draft is auto restored is what makes most sense, but down hear other thoughts on it</p>",
        "id": 1385778,
        "sender_full_name": "Evy",
        "timestamp": 1653692321
    },
    {
        "content": "<p>I would leave Save To drafts under Send button drop down.<br>\nFor the Drafts if we have saved drafts in this conversation I would show a counter. Something like:<br>\n<strong>Drafts</strong>  <code>2</code></p>",
        "id": 1385890,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1653703130
    },
    {
        "content": "<p><code>Compose new message</code> should disappear when the person erases the content of the input box</p>",
        "id": 1385891,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1653703227
    },
    {
        "content": "<p>I suggest to discuss this on a call</p>",
        "id": 1385892,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1653703281
    },
    {
        "content": "<p>To sum up the call, our current plan is to move the button to the Drafts popover for now. It's a power user feature that requires quite a few words to explain, and we'd like to get it out of the way for most users. We also discussed potentially adding it to a <strong>Send</strong> button menu once we need that menu for the \"Send later\" feature.</p>",
        "id": 1386835,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1654104433
    },
    {
        "content": "<p><em>(I haven't read most of this topic yet; in case there's relevant context above. Although I searched for \"night\", \"dark\", and \"theme\" here and didn't see anything.)</em></p>\n<p>I'm thinking that the \"Saved as draft\" tooltip might be too easy to miss on the dark theme, although maybe on the light theme as well. This was tangentially prompted by <a class=\"stream-topic\" data-stream-id=\"101\" href=\"/#narrow/stream/101-design/topic/Closing.20compose.20box\">#design &gt; Closing compose box</a>, although it's not really related to the issue there.</p>\n<p>I know a lot of users have had confusion in the past where they thought a message they were writing was lost, when it was actually saved in a draft, and that that was part of the reason for adding a notification in the first place. Then it became a tooltip, but it was still down by the compose bar, so any color contrast issues were lessened because a user's eyes would immediately go down there if the compose box closed unexpectedly, and they'd see the notification. But at the new location in the top left, this works against the user now; their eyes are going to move down toward the compose box, away from the tooltip at the top left.</p>\n<p>Maybe there could be a notification banner above the compose box, in addition to or replacing the existing tooltip? I see that there was <a href=\"#narrow/stream/101-design/topic/saved.20as.20draft/search/banner\">some discussion of banners previously</a>, including showing a banner about existing drafts when the compose box is open, so that's another way to solve this. Having the notification banner â€“ or a persistent banner as also mentioned previously, or anything similar â€“ catches the user sooner though, before they get up in frustration and fume for a while, only to come back ready to start writing the message again and see that it was there the whole time. <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 1440301,
        "sender_full_name": "Cyphase",
        "timestamp": 1663970798
    }
]