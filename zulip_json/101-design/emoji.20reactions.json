[
    {
        "content": "<p>What do folks think about showing the name of the person who reacted, rather than a count of 1, if only one person has reacted to a give message.  E.g. \"<img alt=\":laughing:\" class=\"emoji\" src=\"/static/generated/emoji/images/emoji/unicode/1f606.png\" title=\":laughing:\">: Tim Abbott\"  instead of \"<img alt=\":laughing:\" class=\"emoji\" src=\"/static/generated/emoji/images/emoji/unicode/1f606.png\" title=\":laughing:\">: 1\"</p>",
        "id": 188421,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1492208453
    },
    {
        "content": "<p>The space is there for it, and I feel like 50% of the time when exactly one person has reacted to something, I mouse over it to see who it was</p>",
        "id": 188422,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1492208481
    },
    {
        "content": "<p>That would be useful and should be pretty straightforward fix.</p>",
        "id": 188426,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1492208716
    },
    {
        "content": "<p><a href=\"/user_uploads/2/4b/K96oKcfay_i3a3-rnUcj01Ld/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/4b/K96oKcfay_i3a3-rnUcj01Ld/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/2/4b/K96oKcfay_i3a3-rnUcj01Ld/pasted_image.png\"></a></div>",
        "id": 188427,
        "sender_full_name": "Robert Hönig",
        "timestamp": 1492208755
    },
    {
        "content": "<p>I think it looks pretty good</p>",
        "id": 188428,
        "sender_full_name": "Robert Hönig",
        "timestamp": 1492208769
    },
    {
        "content": "<p>Cool, someone want to take this up?</p>",
        "id": 188433,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1492208916
    },
    {
        "content": "<p>I think <span class=\"user-mention\" data-user-email=\"robhoenig@gmail.com\" data-user-id=\"801\">@Robert Hönig</span> already coded it up? Or was it inspect element</p>",
        "id": 188434,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1492208994
    },
    {
        "content": "<p>The latter <img alt=\":smirk:\" class=\"emoji\" src=\"/static/generated/emoji/images/emoji/unicode/1f60f.png\" title=\":smirk:\"></p>",
        "id": 188437,
        "sender_full_name": "Robert Hönig",
        "timestamp": 1492209019
    },
    {
        "content": "<p>Ahahaha, I'll take it up then</p>",
        "id": 188438,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1492209041
    },
    {
        "content": "<p>PR probably by tonight</p>",
        "id": 188439,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1492209054
    },
    {
        "content": "<p>Do we limit this to the case where there's only one reaction overall?  Or do we add names to each different emoji that has only 1 person?</p>",
        "id": 188443,
        "sender_full_name": "Steve Howell",
        "timestamp": 1492210157
    },
    {
        "content": "<p>I think I might lean towards one total? Partly because I don't think it's desirable to have people using three slightly different reactjis so that all three names show up. (Actually, it might be nice to do the \"Alice, Bob, and three other people\" type thing, up to some UI space limitation. But that's obviously harder.)</p>",
        "id": 188444,
        "sender_full_name": "Alex Dehnert",
        "timestamp": 1492210407
    },
    {
        "content": "<p>Although the new system looks good but I feel that it has a very limited use case and complicates the whole thing unnecessarily.</p>",
        "id": 188446,
        "sender_full_name": "Harshit Bansal",
        "timestamp": 1492210625
    },
    {
        "content": "<p>My thought is that we should only optimize for the very first reaction, and add the name.  I do the hover all the time for the first reaction.  Once multiple people react, I don't really care who reacted individually, since those messages tend to be <img alt=\":tada:\" class=\"emoji\" src=\"/static/generated/emoji/images/emoji/unicode/1f389.png\" title=\":tada:\"> kind of celebrations.</p>",
        "id": 188447,
        "sender_full_name": "Steve Howell",
        "timestamp": 1492210816
    },
    {
        "content": "<p>So, to double check:</p>\n<ul>\n<li>first reaction</li>\n<li>single person reacts</li>\n</ul>\n<p>We should show name with the reaction emoji instead of the number.</p>",
        "id": 188448,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1492210867
    },
    {
        "content": "<p>I think the reason no other app does that is that it adds a lot of noise.</p>",
        "id": 188449,
        "sender_full_name": "Boris Yankov",
        "timestamp": 1492210983
    },
    {
        "content": "<p>Yup, if there is exactly one {reaction, person} pair, show the name, not the number.</p>",
        "id": 188450,
        "sender_full_name": "Alex Dehnert",
        "timestamp": 1492210991
    },
    {
        "content": "<p>I think <span class=\"user-mention\" data-user-email=\"showell@zulipchat.com\" data-user-id=\"58\">@Steve Howell</span> is totally right. Though you can make it hover-able - on hover insta-expand to the proposed version.</p>",
        "id": 188451,
        "sender_full_name": "Boris Yankov",
        "timestamp": 1492211025
    },
    {
        "content": "<p>Or a custom-made tooltip that does not have the inherent delay of the default tooltips.</p>",
        "id": 188452,
        "sender_full_name": "Boris Yankov",
        "timestamp": 1492211078
    },
    {
        "content": "<p>Yea, the delay of the default tooltips is kind of large..</p>",
        "id": 188453,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1492211107
    },
    {
        "content": "<p>yeah, agreed we should start with just optimizing the just-a-single-reaction-to-a-messge case here.</p>",
        "id": 188457,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1492212059
    },
    {
        "content": "<p>Also agreed that it would be worth replacing the default tooltips for for this to make the display faster.  I think we have a jquery tooltip mechanism that can be used for this</p>",
        "id": 188458,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1492212117
    },
    {
        "content": "<p>The reactions display piece should be a small enough change that we can easily undo it if the reaction is generally negative</p>",
        "id": 188463,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1492212228
    },
    {
        "content": "<p>I'm able to create the change when a user initially reacts to a message (so frontend only). But when I refresh, my changes are discarded and you just have a regular \"1\" again. I can't find where reaction counts are rendered so if anyone can point me in the right direction, that'll be awesome.</p>",
        "id": 188553,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1492237860
    },
    {
        "content": "<p>There's some code in message_list_view that renders <code>single_message</code>, which in turn renders <code>message_reactions</code> as a partial.  Is that what you're asking about?</p>",
        "id": 188559,
        "sender_full_name": "Steve Howell",
        "timestamp": 1492250913
    },
    {
        "content": "<p>Yeah, there's 2 code paths, both of which use the <code>message_reactions</code> template.  One is the message rendering code path which Steve pointed to, and the other is the \"updated reactions\" code path, using <code>exports.add_reaction</code>.  You'll need to update both</p>",
        "id": 188563,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1492268233
    },
    {
        "content": "<p>I think it's very possible that the existing code should be refactored to have a more declarative structure as part of this process, where one just rerenders the entire HTML for the <code>.message_reactions</code> section of a message and replaces it wholesale in <code>add_reaction</code> and <code>remove_reaction</code>, rather than the incremental updates that are present currently, since this feature will involve even more complexity for the \"incremental updates\" approach</p>",
        "id": 188564,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1492268339
    },
    {
        "content": "<p>Yeah, incremental updates seem like unnecessary complexity given the amount of data to be rendered per message.</p>",
        "id": 188566,
        "sender_full_name": "Steve Howell",
        "timestamp": 1492269006
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-email=\"tabbott@zulipchat.com\" data-user-id=\"7\">@Tim Abbott</span> <span class=\"user-mention\" data-user-email=\"showell@zulipchat.com\" data-user-id=\"58\">@Steve Howell</span>. Worked! Just need to deal with the case where there are multiple reactions now.</p>",
        "id": 188604,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1492284113
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/zulip/pull/4520\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/4520\">#4520</a></p>",
        "id": 188641,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1492326154
    },
    {
        "content": "<p>I added a comment to <a href=\"https://github.com/zulip/zulip/pull/4520\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/4520\">#4520</a>, <span class=\"user-mention\" data-user-email=\"joshuapan8@gmail.com\" data-user-id=\"857\">@Joshua Pan</span>.  My reading of the code suggests that you are still doing incremental updates there, whereas I think you should first make the code work as Tim suggested a few messages ago--have <code>add_reaction</code> and <code>remove_reaction</code> do <strong>wholesale</strong> replacements of the rendered content.  (emphasis added by me)</p>",
        "id": 188654,
        "sender_full_name": "Steve Howell",
        "timestamp": 1492343023
    },
    {
        "content": "<p>Ah, yes. I misunderstood. Will fix it.</p>",
        "id": 188661,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1492358460
    },
    {
        "content": "<p>Currently, we rerender emoji reactions in a hardcoded way (seems like alphabetical) when we refresh the page, losing the original ordering of the emoji reactions. It's brought up in <a href=\"https://github.com/zulip/zulip/pull/4712\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/4712\">#4712</a> that we may want to keep the original ordering.</p>",
        "id": 197289,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1494259229
    },
    {
        "content": "<p>It seems like we may want to change some emoji reactions code for this then.</p>",
        "id": 197290,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1494259262
    },
    {
        "content": "<p>We don't currently have a date field on Reaction, so we'd have to add a migration for this if we want the canonical order to be time-based.  Another solution here is to immediately alphabetize them when you add a new one (and slide it in as needed).  It doesn't allow for \"fun\" reaction orders, though, although you could always just reply with a message for stuff like  \"2 cool for school.\"</p>",
        "id": 197291,
        "sender_full_name": "Steve Howell",
        "timestamp": 1494259727
    },
    {
        "content": "<p>Yea, I was thinking of just alphabetizing it, but it seems like people want to keep the original ordering.</p>",
        "id": 197292,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1494259848
    },
    {
        "content": "<p>slack keeps the ordering, and I do think it is nice. It gives a sense of timing (e.g. who reacted first in a series of reactions).</p>",
        "id": 197333,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1494264215
    },
    {
        "content": "<p>Fair enough.  I think the thing to do here, then, is to add a timestamp field to the DB.  That might be good to have for archiving purposes eventually, too.  I could see cleaning out reactions that are more than N months old.  There may be other ways to do this, too, like more a sequence field approach, but I think timestamps are ultimately simplest.</p>",
        "id": 197339,
        "sender_full_name": "Steve Howell",
        "timestamp": 1494264441
    },
    {
        "content": "<p>cool, timestamps seem a good solution to me.</p>",
        "id": 197345,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1494265244
    },
    {
        "content": "<p>Is anyone working on this? I probably should open an issue for this.</p>",
        "id": 197484,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1494307200
    },
    {
        "content": "<p>I don't think anyone's working on this, there's some discussion on <a href=\"https://github.com/zulip/zulip/pull/4712\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/4712\">#4712</a>.</p>",
        "id": 197485,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1494307358
    },
    {
        "content": "<p>I'm definitely interested in thoughts on that question :)</p>",
        "id": 197486,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1494307374
    },
    {
        "content": "<p>Hmm, both ways of storing reactions seem to fit what the OP wanted, which is preserving the order.</p>",
        "id": 197487,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1494307648
    },
    {
        "content": "<p>I think I might want to play with this on slack and see how they approach this.</p>",
        "id": 197488,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1494307678
    },
    {
        "content": "<p>Ah interesting! <span class=\"user-mention\" data-user-email=\"tabbott@zulipchat.com\" data-user-id=\"7\">@Tim Abbott</span> the way Slack reactions work is just how you explained the first method with the Person A,B,C example.</p>",
        "id": 197489,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1494308117
    },
    {
        "content": "<ul>\n<li>Person A reacts with emoji1</li>\n<li>Person B reacts with emoji2</li>\n<li>Person C reacts with emoji1</li>\n<li>Person A unreacts with emoji1</li>\n<li>Person A reloads their browser</li>\n</ul>\n<p>Ordering: (emoji1, emoji2) <strong>before refresh</strong> and (emoji2, emoji1) <strong>after refresh</strong></p>",
        "id": 197491,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1494308168
    },
    {
        "content": "<p>This also makes the most sense, so I think we should go with this path.</p>",
        "id": 197492,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1494308197
    },
    {
        "content": "<p>hm, Tim's last suggestion ((message, emoji) tuples mapping to a list of users, and then garbage-collecting when the list of users becomes empty) is what I would choose if the implementation work were the same. (But am totally sensitive to the fact that the implementation work is not the same.)</p>",
        "id": 197493,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1494308259
    },
    {
        "content": "<p>Yea, (message, emoji) tuples -&gt; list of users is a little bit more work.</p>",
        "id": 197494,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1494308310
    },
    {
        "content": "<p>But, I found it interesting that Slack worked as Tim's first suggestion</p>",
        "id": 197495,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1494308354
    },
    {
        "content": "<p>I suggested on <a href=\"https://github.com/zulip/zulip/pull/4712\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/4712\">#4712</a> that we keep the current table as-is to track <strong>who</strong> reacted, and then create a new table to track <strong>when</strong> an emoji  appeared.</p>",
        "id": 197538,
        "sender_full_name": "Steve Howell",
        "timestamp": 1494338746
    },
    {
        "content": "<p>I would like to work on this. Can I?</p>",
        "id": 390852,
        "sender_full_name": "Shreyansh Dwivedi",
        "timestamp": 1513379803
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"joshuapan8@gmail.com\" data-user-id=\"857\">@Joshua Pan</span>  ^^</p>",
        "id": 390854,
        "sender_full_name": "Shreyansh Dwivedi",
        "timestamp": 1513379835
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"shreyanshdwivedi1997@gmail.com\" data-user-id=\"3958\">@Shreyansh Dwivedi</span> you don't need to ask me for each issue :) Just check the issue on GitHub and see if the issue has anyone working on it.</p>",
        "id": 390863,
        "sender_full_name": "Joshua Pan",
        "timestamp": 1513380030
    },
    {
        "content": "<p>Okk. <span class=\"emoji emoji-1f605\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 390867,
        "sender_full_name": "Shreyansh Dwivedi",
        "timestamp": 1513380147
    },
    {
        "content": "<p>haha, agreed, though in this case I think this is going to be a hard issue to work on. I removed the <code>good first issue</code> label :).</p>",
        "id": 390882,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1513380591
    },
    {
        "content": "<p>I asked just to be sure abt this. Thanks<span class=\"emoji emoji-1f604\" title=\"smile\">:smile:</span></p>",
        "id": 390890,
        "sender_full_name": "Shreyansh Dwivedi",
        "timestamp": 1513380849
    },
    {
        "content": "<p>just bumping <a href=\"https://github.com/zulip/zulip/pull/4712\">#4712</a> (Ordering of emoji reactions are not preserved) in case anyone is interested in taking on this issue (it might be a good GSoC project, if someone wants to write a proposal for it?)</p>\n<p>it came up in <a href=\"#narrow/stream/243-mobile-team/topic/emoji.20list/near/1136509\">#mobile-team&gt;emoji list</a>, and i think it'd be really good to have.</p>",
        "id": 1137491,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1616217285
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"17945\">@Wesley Aptekar-Cassels</span> thanks for your suggestion I want to take it for my gsoc proposal</p>",
        "id": 1137492,
        "sender_full_name": "Abhishek sharma 05",
        "timestamp": 1616217661
    }
]