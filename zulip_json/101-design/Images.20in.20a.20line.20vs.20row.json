[
    {
        "content": "<p>Hi there. Just suggesting this as a possible positive design change. Any reason why not to inline attached images?</p>\n<p><a href=\"/user_uploads/2/c7/tgDpd_D6oDLVycZOkEoJSjSl/Currently.PNG\">Here's</a>  what it looks like currently, and <a href=\"/user_uploads/2/59/vI1vWC1hIpjFlV2fdBmVEtya/Example.PNG\">here's</a>  what might be more desirable.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/c7/tgDpd_D6oDLVycZOkEoJSjSl/Currently.PNG\" title=\"Here's\"><img src=\"/user_uploads/2/c7/tgDpd_D6oDLVycZOkEoJSjSl/Currently.PNG\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/59/vI1vWC1hIpjFlV2fdBmVEtya/Example.PNG\" title=\"here's\"><img src=\"/user_uploads/2/59/vI1vWC1hIpjFlV2fdBmVEtya/Example.PNG\"></a></div>",
        "id": 1316158,
        "sender_full_name": "Jore",
        "timestamp": 1643176794
    },
    {
        "content": "<p>Agree</p>",
        "id": 1316297,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1643199062
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"20503\">@Jore</span> <span class=\"user-mention\" data-user-id=\"22433\">@Vlad Korobov</span> this is subtle technical issue that has to do with how browsers do layout.</p>",
        "id": 1316552,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1643232455
    },
    {
        "content": "<p>(I agree we'd like to change this)</p>",
        "id": 1316553,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1643232501
    },
    {
        "content": "<p>We need browser to be able to lay out a message without having fully fetched the image -- if one doesn't do that, you get a bad experience where the scroll position jumps around apparently randomly as images load (potentially offscreen).</p>",
        "id": 1316554,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1643232525
    },
    {
        "content": "<p>And at present, we don't have a way to statically know the dimensions of an image referenced in a message, without waiting for the browser to fetch it from the appropriate server, since we're not doing any image processing/thumbnailing ourselves that would be able to return that information.</p>",
        "id": 1316555,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1643232572
    },
    {
        "content": "<p>The way we currently solve this set of problems is that we places images with <code>100px</code> height and don't specify the width.  As a result, the browser knows that the image will be on a line by itself, and thus can lay out the message without knowing the dimensions of the image.</p>",
        "id": 1316556,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1643232656
    },
    {
        "content": "<p>There's a few options for how we can address this:</p>\n<ul>\n<li>Set a fixed width, something like 150px, for the width of the container for an image displayed in the message feed.  Ideally we'd have the CSS arrange for the image to be just cut off symmetrically at both edges rather than being scaled.  This would then allow essentially a grid layout.</li>\n<li>Complete our plans to add thumbnailing, have that return image dimensions, and then use that the HTML/CSS generated for the message to ensure the layout we want.</li>\n</ul>",
        "id": 1316557,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1643232797
    },
    {
        "content": "<p>I think the first option is probably the best way to do this visually; one might not actually want a non-grid layout if you past N images with varied dimensions anyway.</p>",
        "id": 1316559,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1643232909
    },
    {
        "content": "<p>I don't know concretely what options we have with HTML/CSS for creating the sort of cropped effect we want here.</p>",
        "id": 1316560,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1643232965
    },
    {
        "content": "<p>I think there is a way to make the trick with CSS only. We could enlarge the rectangle of the picture and make it like 128x128 and use the Picture tag <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture\">https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture</a> which provides object-fit property <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit\">https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit</a></p>",
        "id": 1316894,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1643295525
    },
    {
        "content": "<p>And we could make object-fit: contain; if priority is to see the whole image or object-fit: cover; if priority is to fill the rectangle</p>",
        "id": 1316895,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1643295564
    },
    {
        "content": "<p>the row of the images could be inside flexbox container... Not sure if it helps but it takes object line-wrapping task on itself</p>",
        "id": 1316896,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1643295626
    },
    {
        "content": "<p>Yeah, this sounds doable.  We'd want to tweak the <code>rendered_markdown.js</code>  system to rewrite the <code>message_inline_image</code> elements to whatever structure we need, since we don't want to change the client/server Markdown API for this sort of rendering detail.</p>",
        "id": 1318275,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1643409979
    },
    {
        "content": "<p>We should serialize this to an issue at this point.</p>",
        "id": 1318276,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1643410073
    },
    {
        "content": "<p>Filed <a href=\"https://github.com/zulip/zulip/pull/20975\">#20975</a>.</p>",
        "id": 1318358,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1643414383
    },
    {
        "content": "<p>Awesome <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 1318888,
        "sender_full_name": "Jore",
        "timestamp": 1643496125
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/zulip/pull/21068\">PR#21068</a> open for review!</p>",
        "id": 1324810,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644346113
    },
    {
        "content": "<blockquote>\n<p>And we could make object-fit: contain; if priority is to see the whole image or object-fit: cover; if priority is to fill the rectangle</p>\n</blockquote>\n<p>About this -- now that we have <a href=\"https://github.com/zulip/zulip/pull/21068\">#21068</a> open we should have a discussion about which way we need to go. We have some dialogue already in the comments for the PR. PTAL:</p>\n<ul>\n<li><a href=\"https://github.com/zulip/zulip/pull/21068#discussion_r801969849\">crop vs no-crop</a></li>\n<li><a href=\"https://github.com/zulip/zulip/pull/21068#issuecomment-1033399975\">images with extreme dimensions</a></li>\n</ul>",
        "id": 1325358,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644389001
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"22433\">@Vlad Korobov</span> <span class=\"user-mention\" data-user-id=\"20503\">@Jore</span> ^^</p>\n<p>Apologies for the tags; still learning about Zulip etiquette. Please let me know if its appropriate and if continuing in this topic is okay for engagement.</p>",
        "id": 1325359,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644389139
    },
    {
        "content": "<p>Thanks for posting! Discussing here is great. :)</p>\n<p>I guess with the crop approach, it bothers me that you might not realize that you're only seeing part of an image. This makes me prefer the no-crop approach, though there my also be other creative ways to address this concern. Curious what other folks think.</p>",
        "id": 1325366,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1644392027
    },
    {
        "content": "<p>With the no-crop approach, the black background feels too stark to me, but maybe we could experiment with something closer to the overall background color, or just a border around each image.</p>",
        "id": 1325367,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1644392142
    },
    {
        "content": "<p>Grey background should be ok</p>",
        "id": 1325437,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644414521
    },
    {
        "content": "<p>Or we could do a transparent background with a thin border <a href=\"/user_uploads/2/4e/Q_GVv_tWby8gO17QssfPU0rJ/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/4e/Q_GVv_tWby8gO17QssfPU0rJ/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/4e/Q_GVv_tWby8gO17QssfPU0rJ/image.png\"></a></div>",
        "id": 1325958,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644469918
    },
    {
        "content": "<p>On another note, how about a border radius?<br>\n<a href=\"/user_uploads/2/f6/lyMPx9Kqk-OAlA0Fp8WZZFRZ/image.png\">image.png</a> <br>\n<a href=\"/user_uploads/2/c1/fBn6ucVsg88PDactzTFqkzSS/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/f6/lyMPx9Kqk-OAlA0Fp8WZZFRZ/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/f6/lyMPx9Kqk-OAlA0Fp8WZZFRZ/image.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/c1/fBn6ucVsg88PDactzTFqkzSS/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/c1/fBn6ucVsg88PDactzTFqkzSS/image.png\"></a></div><p>I'm not sure if it fits with the design philosophy but I personally like it.</p>",
        "id": 1325959,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644470053
    },
    {
        "content": "<p>I think the border without a background change is too faint to look like anything other than a mistake, like some kind of texture seam. Admittedly, this also describes many of the lines in our current interface.</p>\n<p>What if we copy the background color from the lightbox (<code>hsl(227, 40%, 16%)</code>)? That would provide a nice continuity with what youâ€™ll see when you click on it.</p>",
        "id": 1325963,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644470756
    },
    {
        "content": "<p>Solid feels to stark to me<br>\n<a href=\"/user_uploads/2/11/_gtqqzhWUhVli6uN-fz4R-IC/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/11/_gtqqzhWUhVli6uN-fz4R-IC/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/11/_gtqqzhWUhVli6uN-fz4R-IC/image.png\"></a></div><p>Reduced alpha<br>\n<a href=\"/user_uploads/2/34/Iv50x0f3qploi9_tObese4q-/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/34/Iv50x0f3qploi9_tObese4q-/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/34/Iv50x0f3qploi9_tObese4q-/image.png\"></a></div>",
        "id": 1325966,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644471741
    },
    {
        "content": "<p>use 20% black <code>rgba(0,0,0,0.2)</code></p>",
        "id": 1325970,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644472353
    },
    {
        "content": "<p>should work in the dark and light themes</p>",
        "id": 1325971,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644472362
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"23057\">@Tushar</span></p>",
        "id": 1325973,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644472444
    },
    {
        "content": "<p>I like this!<br>\n<a href=\"/user_uploads/2/d2/BTVDO9RsuKSWJEkvsGcektGX/image.png\">image.png</a> <br>\n<a href=\"/user_uploads/2/32/k1DMj1yt7S0hiOwazNx4Gz3u/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/d2/BTVDO9RsuKSWJEkvsGcektGX/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/d2/BTVDO9RsuKSWJEkvsGcektGX/image.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/32/k1DMj1yt7S0hiOwazNx4Gz3u/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/32/k1DMj1yt7S0hiOwazNx4Gz3u/image.png\"></a></div><p>But 10% alpha may look even better I think<br>\n<a href=\"/user_uploads/2/69/8PTWlV4hJgFK7ZmwxGBEJ415/image.png\">image.png</a> <br>\n<a href=\"/user_uploads/2/24/jTgis5o9378i5CxMbGFFpzbU/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/69/8PTWlV4hJgFK7ZmwxGBEJ415/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/69/8PTWlV4hJgFK7ZmwxGBEJ415/image.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/24/jTgis5o9378i5CxMbGFFpzbU/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/24/jTgis5o9378i5CxMbGFFpzbU/image.png\"></a></div>",
        "id": 1325975,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644473227
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"23057\">@Tushar</span> no borders please</p>",
        "id": 1325979,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644473507
    },
    {
        "content": "<p>no border, rounded edge (4px)<br>\n<a href=\"/user_uploads/2/43/dnRhPetbtr6p7TxxZ2qIFaUV/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/43/dnRhPetbtr6p7TxxZ2qIFaUV/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/43/dnRhPetbtr6p7TxxZ2qIFaUV/image.png\"></a></div><p>no border, sharp edge<br>\n<a href=\"/user_uploads/2/c2/wLhxAbJtlTfLIr36e42WRTYI/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/c2/wLhxAbJtlTfLIr36e42WRTYI/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/c2/wLhxAbJtlTfLIr36e42WRTYI/image.png\"></a></div>",
        "id": 1325983,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644474525
    },
    {
        "content": "<p>If we rounding border we should round the images too, so container box which holds the image has border-radius and image can not exit it. I think we should do radius 3px</p>",
        "id": 1325988,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644474783
    },
    {
        "content": "<p>We should not round the images. Form needs to follow function here; we have no way of knowing that the corners arenâ€™t an important part of the userâ€™s image.</p>",
        "id": 1325993,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644474979
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> it is 3 px rounding, basicly 1.5 square pixels from every corner. Rarely image fits the container perfectly, so we aren't loosing much here.</p>",
        "id": 1325995,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644475057
    },
    {
        "content": "<p>And it is usually preview not a whole image of 100%. So rounding corners of containers is not so critical</p>",
        "id": 1325996,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644475121
    },
    {
        "content": "<p>In Tushar's example we don't even see such case</p>",
        "id": 1325997,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644475184
    },
    {
        "content": "<p>That logic would be fine if it were your image to chop up, but itâ€™s the userâ€™sâ€”it could be anything.</p>",
        "id": 1325998,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644475192
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> give me a single example when chopping image as I suggest would be bad.</p>",
        "id": 1326001,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644475378
    },
    {
        "content": "<p>An image that demonstrates the difference between pointy and rounded rectangles.</p>",
        "id": 1326003,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644475441
    },
    {
        "content": "<p>What kind of image is that?</p>",
        "id": 1326004,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644475477
    },
    {
        "content": "<p>3px</p>\n<p><a href=\"/user_uploads/2/4b/QiKCo0aGhcNhGXrWN2QcFBFN/image.png\">image.png</a> <br>\n<a href=\"/user_uploads/2/49/QhwW2sqermPebd2wEcrokJLx/image.png\">image.png</a> <br>\n<a href=\"/user_uploads/2/92/Cb6MTFogtQden13W3rIFnetH/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/4b/QiKCo0aGhcNhGXrWN2QcFBFN/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/4b/QiKCo0aGhcNhGXrWN2QcFBFN/image.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/49/QhwW2sqermPebd2wEcrokJLx/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/49/QhwW2sqermPebd2wEcrokJLx/image.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/92/Cb6MTFogtQden13W3rIFnetH/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/92/Cb6MTFogtQden13W3rIFnetH/image.png\"></a></div>",
        "id": 1326005,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644475488
    },
    {
        "content": "<p>There are other ways to make sure the image doesnâ€™t overlap a rounded containerâ€”you can just confine it to a slightly smaller rectangle thatâ€™s guaranteed to fit.</p>",
        "id": 1326007,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644475512
    },
    {
        "content": "<p>I think that the latest Tushar example is ok.<br>\n<span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> you are suggesting to optimize some very very very rare edge case in exchange for unnecessary border around all images at all times. Lets roll that change to CZO and I'm open to see a single case when rounding corners damage something...</p>",
        "id": 1326009,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644475666
    },
    {
        "content": "<p>This looks good IMO.</p>",
        "id": 1326011,
        "sender_full_name": "Aman (amanagr)",
        "timestamp": 1644475693
    },
    {
        "content": "<p>I could equally say that youâ€™re suggesting to optimize some very rare edge case where the image partially but not fully overlaps the rounded corner (because if the overlap is full, thereâ€™s no visible problem).</p>\n<p>But my argument is not that some cases are rarer than others, itâ€™s that we should display what the user posted.</p>",
        "id": 1326013,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644475805
    },
    {
        "content": "<p>If you want to display what the user posted display it in 100% scale, otherwise information is lossy anyway</p>",
        "id": 1326019,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644475928
    },
    {
        "content": "<blockquote>\n<p>What kind of image is that?</p>\n</blockquote>\n<p>Perhaps the users are having a conversation about the difference between these two images: <a href=\"/user_uploads/2/3c/3bS3kAbfJu1YU8Ju61LvfotI/a.png\">a.png</a>, <a href=\"/user_uploads/2/46/d-tK2895bZk_w2mNWR5i9fZT/b.png\">b.png</a>. Someoneâ€™s going to be confused if they look identical.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/3c/3bS3kAbfJu1YU8Ju61LvfotI/a.png\" title=\"a.png\"><img src=\"/user_uploads/2/3c/3bS3kAbfJu1YU8Ju61LvfotI/a.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/46/d-tK2895bZk_w2mNWR5i9fZT/b.png\" title=\"b.png\"><img src=\"/user_uploads/2/46/d-tK2895bZk_w2mNWR5i9fZT/b.png\"></a></div>",
        "id": 1326023,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644476031
    },
    {
        "content": "<p>Also, rounding can have an ugly effect on images that have a built-in <a href=\"/user_uploads/2/2a/HgNPszbNgyyW827y05j3ETbj/border.png\">border</a>.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/2a/HgNPszbNgyyW827y05j3ETbj/border.png\" title=\"border\"><img src=\"/user_uploads/2/2a/HgNPszbNgyyW827y05j3ETbj/border.png\"></a></div>",
        "id": 1326028,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644476289
    },
    {
        "content": "<p>Users have conversations about designing rounding corner and they show 2 images without any border and upload the as a separate images. I'm sure the participants would open each image to see it in 100% scale</p>",
        "id": 1326030,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644476377
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"699\">Anders Kaseorg</span> <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1326028\">said</a>:</p>\n<blockquote>\n<p>Also, rounding can have an ugly effect on images that have a built-in <a href=\"/user_uploads/2/2a/HgNPszbNgyyW827y05j3ETbj/border.png\">border</a>.</p>\n</blockquote>\n<p>I wouldn't say that example you gave is ugly. But again it's a very rare case. But if you insist on having rectangular corners for a background placeholder container and believe that it improves lives keep in mind that my approach might decrease the mental load of a user <a href=\"https://uxmovement.com/thinking/why-rounded-corners-are-easier-on-the-eyes/\">https://uxmovement.com/thinking/why-rounded-corners-are-easier-on-the-eyes/</a></p>\n<p>Andres, I'm not inventing something crazy here. Popular apps around the world do round corners of images significantly. </p>\n<p>I agree that if people are discussing rounding corners of 2 exactly same rectangles and the upload them as separate images perfectly fitting Zulip's preview proportions will not see the difference and would be OMG forced to open them in a 100% scale to actually see the radius of rounding corners they are discussing.</p>",
        "id": 1326032,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644476825
    },
    {
        "content": "<p>And you know what kind of problem they will have? Not a white or black background under their images with transparent corners.</p>",
        "id": 1326033,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644476869
    },
    {
        "content": "<p>lack of white or black background is a bigger problem for some image corners judgement than cutting them in a preview</p>",
        "id": 1326034,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644476927
    },
    {
        "content": "<p>I have a technical question and maybe <span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> knows the answer. Why do we need to have fixed width of an image? We don't hav fixed width for a text and it word-wraps fine. Do you think it's possible for preview to fix only the height but width would be according to the image ratio? I understand that we should have min and max widths for previews</p>",
        "id": 1326226,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644503133
    },
    {
        "content": "<p>Itâ€™s related to what Tim <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1316554\">explained</a>: if you donâ€™t know the image widths at message load time, then the images might rewrap once they load, changing the message height.</p>",
        "id": 1326363,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644517823
    },
    {
        "content": "<p>I think the right long-term solution is for the server to remember the actual image dimensions. But we donâ€™t have that yet.</p>",
        "id": 1326364,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644517908
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"22433\">Vlad Korobov</span> <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1326226\">said</a>:</p>\n<blockquote>\n<p>I have a technical question and maybe <span class=\"user-mention silent\" data-user-id=\"699\">Anders Kaseorg</span> knows the answer. Why do we need to have fixed width of an image? We don't hav fixed width for a text and it word-wraps fine. Do you think it's possible for preview to fix only the height but width would be according to the image ratio? I understand that we should have min and max widths for previews</p>\n</blockquote>\n<p>There is a way we can do that subject to existing technical constraints -- by having the row of images get a scrollbar if there are too many, rather than wrapping.</p>",
        "id": 1326524,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644530594
    },
    {
        "content": "<p>We tend to try to avoid scrollbars in the message feed since they're a bit ugly, and we probably just want vertical layout only in mobile sizes if we do the scrollbar thing, but it's an option if we want your incredibly wide image to display as incredibly wide (etc.)</p>",
        "id": 1326527,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644530754
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"699\">Anders Kaseorg</span> <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1326364\">said</a>:</p>\n<blockquote>\n<p>I think the right long-term solution is for the server to remember the actual image dimensions. But we donâ€™t have that yet.</p>\n</blockquote>\n<p>Yeah, and in particular waiting for the server to add that is how we've ended up with the current very suboptimal design being unaddressed for years, so we should do the best we can do subject to the constraints of browsers. <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 1326534,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644530841
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"699\">Anders Kaseorg</span> <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1326363\">said</a>:</p>\n<blockquote>\n<p>Itâ€™s related to what Tim <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1316554\">explained</a>: if you donâ€™t know the image widths at message load time, then the images might rewrap once they load, changing the message height.</p>\n</blockquote>\n<p>And to explain what this means a bit more -- what happens if we can't fix the message's height when first rendering it to the DOM  is you click on a view and then like 1-2s after you clicked when the images loaded, your scroll position jumps in a very annoying fashion.</p>",
        "id": 1326535,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644530903
    },
    {
        "content": "<p>There are alternative technical options (E.g. have the browser load all images before displaying a message) but those have very real other costs.own.</p>",
        "id": 1326536,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644530937
    },
    {
        "content": "<p>Iâ€™m not actually convinced that would happen in modern browsers. Theyâ€™ve gotten a lot better at preserving your scroll position.</p>",
        "id": 1326537,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644530942
    },
    {
        "content": "<p>Yeah, it's potentially worth testing.  I'm fairly confident they didn't handle this properly in like 2018, because we accidentally broken the fixed-height property at some point around then and indeed had this issue at that point, but that's still a while ago.</p>",
        "id": 1326542,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644531035
    },
    {
        "content": "<p>I think we should move any further discussion of rounded corners to its own topic; it's essentially orthogonal to changing the arrangement, and I don't want us to get distracted from the arrangement change, which is complex enough as a discussion.</p>",
        "id": 1326549,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644531414
    },
    {
        "content": "<p>For the arrangement issue I think we have basically a few options:</p>\n<ul>\n<li>We can make images fixed-height with variable width (perhaps with a maximum so a 1000x1 image isn't silly), so that they preserve their proportions, and use a scrollbar if they get too wide.  Main downside is that if you upload like 20 images you might prefer that they be in a grid in some settings (In others, you might not, since it'd make your message extremely tall!).  I suspect the user could control the layout to generate a grid by just arranging a paragraph break in between groups of images within a message if they didn't want a scrollbar.</li>\n<li>We can place the images inside a fixed size both as detailed above, either with or without a border area.  </li>\n<li>We can test whether all major browsers have changed their layout/loading algorithms to avoid a scroll when images load above the fold, and then consider additional options.  I think the test process isn't too crazy; just arrange a <code>sleep()</code> when fetching images so you can make only them load slow, edit some images into a message a few screens up in \"All messages\", and so some strategic reloads</li>\n<li>Are there other options?</li>\n</ul>",
        "id": 1326552,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644531750
    },
    {
        "content": "<p>We want to do something reasonable for small images as well as large ones. When someone posts a 16Ã—16 favicon, we donâ€™t actually want to blow it up to 100Ã—100.</p>",
        "id": 1326555,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644532232
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1326552\">said</a>:</p>\n<blockquote>\n<ul>\n<li>We can test whether all major browsers have changed their layout/loading algorithms to avoid a scroll when images load above the fold, and then consider additional options.  I think the test process isn't too crazy; just arrange a <code>sleep()</code> when fetching images so you can make only them load slow, edit some images into a message a few screens up in \"All messages\", and so some strategic reloads</li>\n</ul>\n</blockquote>\n<p>I just did this test for Chrome with these changes:</p>\n<div class=\"codehilite\"><pre><span></span><code>$ git diff\ndiff --git a/static/styles/rendered_markdown.css b/static/styles/rendered_markdown.css\nindex 2d074af7f5..e0acd150e3 100644\n--- a/static/styles/rendered_markdown.css\n+++ b/static/styles/rendered_markdown.css\n@@ -308,7 +308,6 @@\n         position: relative;\n         margin-bottom: 5px;\n         margin-left: 5px;\n-        height: 100px;\n         display: block !important;\n         border: none !important;\n     }\ndiff --git a/zerver/views/upload.py b/zerver/views/upload.py\nindex fac2b4fbfb..cd68ff0f20 100644\n--- a/zerver/views/upload.py\n+++ b/zerver/views/upload.py\n@@ -89,6 +89,9 @@ def serve_file(\n     filename: str,\n     url_only: bool = False,\n ) -&gt; HttpResponse:\n+    import time\n+\n+    time.sleep(5)\n     path_id = f&quot;{realm_id_str}/{filename}&quot;\n     is_authorized = validate_attachment_request(user_profile, path_id)\n</code></pre></div>\n<p>It does better than it used to: In Chrome, you don't lose your place by the image height (a full screenful) but there is like a 2px visual jump and then back when the images load at the 5 second mark, which is a bit distracting. In Firefox, it's more like a 100px jump and back, which is a level of glitch I'd call unacceptable.</p>",
        "id": 1326556,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644532270
    },
    {
        "content": "<p>Here's video of the Firefox experience: <a href=\"/user_uploads/2/38/8iiKL7CZQ68Vz3X7rpZypnPZ/Peek-2022-02-10-14-32.gif\">Peek-2022-02-10-14-32.gif</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/38/8iiKL7CZQ68Vz3X7rpZypnPZ/Peek-2022-02-10-14-32.gif\" title=\"Peek-2022-02-10-14-32.gif\"><img src=\"/user_uploads/2/38/8iiKL7CZQ68Vz3X7rpZypnPZ/Peek-2022-02-10-14-32.gif\"></a></div>",
        "id": 1326558,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644532378
    },
    {
        "content": "<p>Okay. We should re-test with <a href=\"https://github.com/zulip/zulip/pull/16411\">#16411</a> when we finish that.</p>",
        "id": 1326561,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1644532644
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"699\">Anders Kaseorg</span> <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1326555\">said</a>:</p>\n<blockquote>\n<p>We want to do something reasonable for small images as well as large ones. When someone posts a 16Ã—16 favicon, we donâ€™t actually want to blow it up to 100Ã—100.</p>\n</blockquote>\n<p>Agreed.</p>",
        "id": 1326587,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644535366
    },
    {
        "content": "<p>As a sidenote, I've been finding the current experiment that we have deployed (which is the version that uses the full space but crops) pretty annoying in my daily work -- because it's not obvious when screenshots are cropped, and so for screenshots that appear at about actual size (where you can read them without clicking), I often find myself confused because the thing the person is talking about doesn't appear in the image.</p>\n<p>I'm going to pull the experiment off for now.  I'm happy to deploy a next experiment here and don't think it matters what choice we make on rounding corners for that experiment -- we'll want to think hard about that detail before merging, but it's a minor detail that's orthogonal to the layout.</p>\n<p>(Well, not totally -- if we go with the scrollbar option we won't need the background that made us think about it)</p>",
        "id": 1326588,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644535423
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"699\">Anders Kaseorg</span> <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1326561\">said</a>:</p>\n<blockquote>\n<p>Okay. We should re-test with <a href=\"https://github.com/zulip/zulip/pull/16411\">#16411</a> when we finish that.</p>\n</blockquote>\n<p>Added a note on the PR to that effect.</p>",
        "id": 1326590,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644535496
    },
    {
        "content": "<p>Thank you guys, that is very helpful to know. As I understand the problem in cumulative load of images which can significantly shift the height with some unpredictable delay even in the current viewport.<br>\nI like the idea which Tim suggested... just to dedicate a line for an image if there are many images, let the user scroll. Horizontal scroll is a challenge (just don't have an appropriate mouse or don't know about shift+scroll) and we might return to that issue later.</p>",
        "id": 1326642,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644541938
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> <br>\nI updated the PR with the latest experiment -- no crops and no up-scaling, 10% opaque black background. Corners are 3px rounded, but as you said if it doesn't matter please feel free to deploy. I'll squash the commits if that's a requirement.</p>",
        "id": 1326828,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644571946
    },
    {
        "content": "<p>Test-deploying <a href=\"https://github.com/zulip/zulip/pull/21068\">#21068</a> again.</p>",
        "id": 1327312,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644624922
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> I'm using your improvement right now and its sooooo nice. Very helpful to see the whole image.</p>",
        "id": 1327612,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644708128
    },
    {
        "content": "<p>I didn't do the extra lines and having images in a line here <a href=\"#narrow/stream/101-design/topic/All.20Messages.20design.20test-drive/near/1327611\">https://chat.zulip.org/#narrow/stream/101-design/topic/All.20Messages.20design.20test-drive/near/1327611</a><br>\nIn the past I would go back and edit the message, but with images in a line isn' that bad.</p>",
        "id": 1327614,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644708225
    },
    {
        "content": "<p>Glad to hear it's working out!</p>",
        "id": 1327629,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644722376
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> I have to admit that <span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> was right about the border. <br>\nWhen we have white image it makes the image rectangle visually as 3 rectangles: grey-white-grey.<br>\nSo I what to suggest a small fix: 1px transparent border<br>\n<a href=\"/user_uploads/2/cf/tLQ_e8ISilR498B0iXoq1jUi/image.png\">image.png</a> <br>\ntransparent border will increase the size of the rectangle but since border is on top of the background we should make it transparent, which will increase the size of the background by 1 px around the image</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/cf/tLQ_e8ISilR498B0iXoq1jUi/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/cf/tLQ_e8ISilR498B0iXoq1jUi/image.png\"></a></div>",
        "id": 1327631,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644722894
    },
    {
        "content": "<p>with this approach we are also cutting maximum 1 px on the corner. Because 3 px radius which has 1px border ver. and hor. can cut only 1 px of an image if it fits perfectly into the placeholder</p>",
        "id": 1327632,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644723068
    },
    {
        "content": "<p>Suggestion sounds good to me.<br>\nHere's <code>1px transparent</code> vs <code>1px #00000019</code> (I have a slight preference for the latter)<br>\n<a href=\"/user_uploads/2/7b/VrsQQCUWKdwx4tI3H7lzNCOt/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/7b/VrsQQCUWKdwx4tI3H7lzNCOt/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/7b/VrsQQCUWKdwx4tI3H7lzNCOt/image.png\"></a></div>",
        "id": 1327634,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644724599
    },
    {
        "content": "<p>great, please let's use the first 100% transparent version. A border here is a trick to enlarge a background.</p>",
        "id": 1327636,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644724889
    },
    {
        "content": "<p>but can we actually do anything with the first padding on the image? <a href=\"/user_uploads/2/16/WwGft_yp7aNHZcbxeAZ5AbP3/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/16/WwGft_yp7aNHZcbxeAZ5AbP3/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/16/WwGft_yp7aNHZcbxeAZ5AbP3/image.png\"></a></div>",
        "id": 1327637,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644724916
    },
    {
        "content": "<p>it would be nice if an image be aligned with a text on the left side</p>",
        "id": 1327638,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644724934
    },
    {
        "content": "<p><code>object-position: left</code> seems to accomplish that <br>\n<a href=\"/user_uploads/2/9b/WYcwc_vhVZuEKSnhUDxDGl5K/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/9b/WYcwc_vhVZuEKSnhUDxDGl5K/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/9b/WYcwc_vhVZuEKSnhUDxDGl5K/image.png\"></a></div>",
        "id": 1327641,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644728109
    },
    {
        "content": "<p>hmm from your image it is still looks mis aligned</p>",
        "id": 1327660,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644729277
    },
    {
        "content": "<p>Could this be a solution? <a href=\"/user_uploads/2/3b/UBeRk_VcZWbHDtpmrTyTOlgF/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/3b/UBeRk_VcZWbHDtpmrTyTOlgF/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/3b/UBeRk_VcZWbHDtpmrTyTOlgF/image.png\"></a></div>",
        "id": 1327664,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644729332
    },
    {
        "content": "<p>I removed left margin but added a right margin, so 2 images wouldn't be stick together</p>",
        "id": 1327668,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644729476
    },
    {
        "content": "<p>Oops I definitely misinterpreted the question-- the <code>object-position</code> aligns the image within the container. Your solution looks perfect!</p>",
        "id": 1327688,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644732527
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> could you do a pull request for that?</p>",
        "id": 1327699,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1644738620
    },
    {
        "content": "<p>Yes, sure thing</p>",
        "id": 1327756,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644767962
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/zulip/pull/21123\">#21123</a> open</p>",
        "id": 1328087,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1644851692
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"23057\">Tushar ðŸ‘¾</span> <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1328087\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://github.com/zulip/zulip/pull/21123\">#21123</a> open</p>\n</blockquote>\n<p>Merged, thanks!  It's possible it was originally a visual choice to do the 5px of spacing there -- but it was a choice made in the very first iteration of having images in Zulip messages at all (<a href=\"https://github.com/zulip/zulip/commit/02bf89c3c3d1d4c8909124452d7e2566bfae5a86\">02bf89c3c3d1d4c8909124452d7e2566bfae5a86</a>), so I don't think we should feel any obligation to defer to that choice <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span>.</p>",
        "id": 1328313,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1644868198
    },
    {
        "content": "<p>Had an inkling, Vlad was spot on though that this the better visual choice now. Thanks for the merge!</p>",
        "id": 1329953,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1645014569
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/zulip/pull/21068\">#21068</a> updated with the border.</p>",
        "id": 1329954,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1645014616
    },
    {
        "content": "<p>Looks great!</p>",
        "id": 1330055,
        "sender_full_name": "Evy",
        "timestamp": 1645036290
    },
    {
        "content": "<p>Deploying the updated version of this.</p>",
        "id": 1330415,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645054918
    },
    {
        "content": "<p>Do we have messages in <a class=\"stream\" data-stream-id=\"7\" href=\"/#narrow/stream/7-test-here\">#test here</a> that are a good demonstration, e.g. with various image dimensions and such? If not, <span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> would you be up for setting that up?</p>",
        "id": 1330541,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645060006
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> and <span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> thank you for collaboration on this. I very much like the result! <br>\n<span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> thank you very much for handling it until it's great.<br>\nI guess this is the first \"designed\" element I see in Zulip since I joined to help. And I even didn't draw any of that!</p>",
        "id": 1330560,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1645064836
    },
    {
        "content": "<p>Here we go <span aria-label=\"cowboy\" class=\"emoji emoji-1f920\" role=\"img\" title=\"cowboy\">:cowboy:</span> <br>\n<a href=\"#narrow/stream/7-test-here/topic/images_in_a_row\">https://chat.zulip.org/#narrow/stream/7-test-here/topic/images_in_a_row</a></p>",
        "id": 1330789,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1645127279
    },
    {
        "content": "<p>Now I want mobile to support it <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 1330831,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1645129905
    },
    {
        "content": "<p>This feels like a huge improvement!</p>",
        "id": 1330988,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645141052
    },
    {
        "content": "<p>I think I don't love the grey boxes in light mode. They give me a bit of a \"something is wrong here, and so it's greyed out\" feel. They are also just a tad different from topic bars -- the colors seem too close (or else they should be the same).</p>\n<p><a href=\"/user_uploads/2/47/FJ7y4eB2jIi3d3fc3ECSPXrT/Screen-Shot-2022-02-17-at-3.38.29-PM.png\">Screen-Shot-2022-02-17-at-3.38.29-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/47/FJ7y4eB2jIi3d3fc3ECSPXrT/Screen-Shot-2022-02-17-at-3.38.29-PM.png\" title=\"Screen-Shot-2022-02-17-at-3.38.29-PM.png\"><img src=\"/user_uploads/2/47/FJ7y4eB2jIi3d3fc3ECSPXrT/Screen-Shot-2022-02-17-at-3.38.29-PM.png\"></a></div><p>I wonder if we could try making the grey lighter? The more subtle boxes in dark mode work better for me.</p>",
        "id": 1330998,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645141327
    },
    {
        "content": "<p>Yeah, I think this feels like a good checkpoint to integrate, having only looked at it in the dark theme.  It'll be nice when we can merge this, since I'm interested in reducing the number of branches we have running but unmerged.</p>",
        "id": 1331032,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645142230
    },
    {
        "content": "<p>Yeh, sorry this is my bad, I was just telling a rough number which would work. 10% black is probably too much. We can try 5%:<br>\n<a href=\"/user_uploads/2/31/MOi2pTakDF6LSVkTxw2wlJN8/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/31/MOi2pTakDF6LSVkTxw2wlJN8/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/31/MOi2pTakDF6LSVkTxw2wlJN8/image.png\"></a></div>",
        "id": 1331155,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1645146862
    },
    {
        "content": "<p>Sure, that seems like a reasonable tweak to me. <span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> is it easy for you to change that and redeploy?</p>",
        "id": 1331209,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1645170983
    },
    {
        "content": "<p>Can you test in dark mode too? 10% black on our dark background color is much less contrast than 10% black on white, and already almost invisible at non-blinding screen brightness.</p>",
        "id": 1331213,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1645171350
    },
    {
        "content": "<p>Iâ€™m not even convinced <em>n</em>% black is the right direction for dark modeâ€”boxes in dark mode should be lighter than ambient, not darker, although our existing theme violates this all over the place and looks weird.</p>",
        "id": 1331217,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1645171544
    },
    {
        "content": "<p>If the images are in a row, does that mean I can post 20 images in 1 post, and all the thumbnails will be rendered? This is not possible with the vertical line version. Usually, for my script to auto-upload pics, I have to batch them in a group of 5.</p>",
        "id": 1333175,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1645579514
    },
    {
        "content": "<p>The limit that gets expanded is currently 20, but you could override that:<br>\n<a href=\"https://github.com/zulip/zulip/blob/4d858b874e4eb74ef97e223b8c2ddd88e2409857/zerver/lib/markdown/__init__.py#L626\">https://github.com/zulip/zulip/blob/4d858b874e4eb74ef97e223b8c2ddd88e2409857/zerver/lib/markdown/__init__.py#L626</a></p>",
        "id": 1333178,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1645579729
    },
    {
        "content": "<p>But under that limit, all thumbnails will show up, yes.  This isn't related to horizontal vs vertical.</p>",
        "id": 1333179,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1645579764
    },
    {
        "content": "<p>How are folks feeling about this change as currently deployed here?  It feels to me like it's substantially better than what's in <code>main</code>, so I'd like to merge it; and I don't think we've had reports of any bugs in the last week.</p>",
        "id": 1334391,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645732793
    },
    {
        "content": "<p>I guess my main worry here is whether this could be responsible for <a class=\"stream-topic\" data-stream-id=\"9\" href=\"/#narrow/stream/9-issues/topic/performance.20regression\">#issues &gt; performance regression</a>.</p>",
        "id": 1334392,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645732865
    },
    {
        "content": "<p>I haven't seen that recur, and the only reasons to suspect this change as related are recency and this modifying message feed CSS.</p>",
        "id": 1334394,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645732949
    },
    {
        "content": "<p>Oh, I don't think we actually attempted the last proposal by <span class=\"user-mention silent\" data-user-id=\"22433\">Vlad Korobov</span> above for the background.  <span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> can you comment on the state of that? Could be good to do that tweak in a new commit that we can keep or drop.</p>",
        "id": 1334396,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645733085
    },
    {
        "content": "<p>Playing around with what we currently have deployed in the light theme, there are cases where the background looks weird (this is a screenshot of a screenshot of this design detail). I'm not sure if having some sort of a border would help:</p>\n<p><a href=\"/user_uploads/2/2a/h8KISIHZMTbcUfjwLZ3etyvG/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/2a/h8KISIHZMTbcUfjwLZ3etyvG/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/2a/h8KISIHZMTbcUfjwLZ3etyvG/image.png\"></a></div>",
        "id": 1334399,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645733257
    },
    {
        "content": "<p>(Kinda a situation one won't often see in practice because one probably won't be using the precise colors we are using often.)</p>",
        "id": 1334400,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645733302
    },
    {
        "content": "<p>I still <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1331213\">claim</a> that proposal needs an adjustment for the dark theme.</p>",
        "id": 1334410,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1645733901
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> sorry my mobile zulip just opens a topic view by your provided link. Could you quote your claim?</p>",
        "id": 1334491,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1645737207
    },
    {
        "content": "<p>Oh, I see. I guess for the dark theme we should make it 20%?</p>",
        "id": 1334493,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1645737259
    },
    {
        "content": "<blockquote>\n<p>Oh, I don't think we actually attempted the last proposal by <span class=\"user-mention silent\" data-user-id=\"22433\">Vlad Korobov</span> above for the background.  <span class=\"user-mention silent\" data-user-id=\"23057\">Tushar ðŸ‘¾</span> can you comment on the state of that? Could be good to do that tweak in a new commit that we can keep or drop.</p>\n</blockquote>\n<p>Missed it somehow! Will push another commit and tag you once it's there.</p>",
        "id": 1334759,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1645756146
    },
    {
        "content": "<p>5% black with light theme<br>\n<a href=\"/user_uploads/2/e6/rJJrgIHtiAy8FiAok7nbnZ5s/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/e6/rJJrgIHtiAy8FiAok7nbnZ5s/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/e6/rJJrgIHtiAy8FiAok7nbnZ5s/image.png\"></a></div>",
        "id": 1335411,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1645841034
    },
    {
        "content": "<p>10% white vs 10% black (current) vs 20% black with dark theme<br>\n<span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> <span class=\"user-mention\" data-user-id=\"22433\">@Vlad Korobov</span> <br>\n<a href=\"/user_uploads/2/a3/gYG5xaSSi7Jt7Yt6Ideyf5Qg/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/a3/gYG5xaSSi7Jt7Yt6Ideyf5Qg/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/a3/gYG5xaSSi7Jt7Yt6Ideyf5Qg/image.png\"></a></div>",
        "id": 1335412,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1645841468
    },
    {
        "content": "<p>Oh thank you <span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> .<br>\n<span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> so you are saying 10% black in dark theme is not visible and you want it darker?</p>",
        "id": 1335414,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1645842934
    },
    {
        "content": "<p>to me it looks like 10% black is working fine from the pictures that <span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> is showing</p>",
        "id": 1335415,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1645842993
    },
    {
        "content": "<p>One question, perhaps rather silly but if we want a different scheme for the light theme can the dark theme override only go into <code>static/styles/dark_theme.css</code> ?</p>",
        "id": 1335561,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1645886278
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> Yes, that's our convention for now.  My two cents is that we eventually want to get away from having a single <code>dark_theme.css</code>, but that would require some discussion.</p>",
        "id": 1335562,
        "sender_full_name": "Steve Howell",
        "timestamp": 1645886355
    },
    {
        "content": "<p>Thanks! I'm definitely in favor of moving away from a single file. Look forward to seeing that eventually. :)</p>",
        "id": 1335563,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1645886449
    },
    {
        "content": "<p>Apart from the obvious benefit of having all the dark-theme stuff in one file, I think there are some technical details where the one-file scheme makes it easier to switch modes.  But I still think it's better if we can get away from that scheme, so if you are interested in starting that discussion, I would ask on <a class=\"stream\" data-stream-id=\"6\" href=\"/#narrow/stream/6-frontend\">#frontend</a>.</p>",
        "id": 1335564,
        "sender_full_name": "Steve Howell",
        "timestamp": 1645886451
    },
    {
        "content": "<p>Calls for further discussion around this<br>\n<a href=\"#narrow/stream/6-frontend/topic/dark-mode-single-file-css\">https://chat.zulip.org/#narrow/stream/6-frontend/topic/dark-mode-single-file-css</a></p>",
        "id": 1335566,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1645887128
    },
    {
        "content": "<p>It's not that obvious guys. Sometimes its better to have all styles about a \"thing\" next to that \"thing\".  <br>\nHaving styles of 1 things spread across multiple files can cause \"bugs\"</p>",
        "id": 1335700,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1645919643
    },
    {
        "content": "<p>See the other discussion <span class=\"user-mention\" data-user-id=\"22433\">@Vlad Korobov</span></p>",
        "id": 1335721,
        "sender_full_name": "Steve Howell",
        "timestamp": 1645925837
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> pushed commit <code>3217032</code> to the <a href=\"https://github.com/zulip/zulip/pull/21068\">PR</a> with reduced opacity against the light theme.</p>",
        "id": 1335754,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1645943480
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"23057\">Tushar ðŸ‘¾</span> <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1335412\">said</a>:</p>\n<blockquote>\n<p>10% white vs 10% black (current) vs 20% black with dark theme<br>\n<span class=\"user-mention silent\" data-user-id=\"699\">Anders Kaseorg</span> <span class=\"user-mention silent\" data-user-id=\"22433\">Vlad Korobov</span> <br>\n<a href=\"/user_uploads/2/a3/gYG5xaSSi7Jt7Yt6Ideyf5Qg/image.png\">image.png</a></p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> is 10% white along the lines of what you were proposing? It seems OK to try, but it's hard for me to visualize exactly what it'll look like next to other things. I could try it out in dev if the change is made on the PR, or we could test it here.</p>",
        "id": 1337538,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1646182368
    },
    {
        "content": "<p>Yeah that seems plausible.</p>",
        "id": 1337539,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1646182455
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> if you could update the PR with that, that would be great.</p>",
        "id": 1337554,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1646185581
    },
    {
        "content": "<p>Updated with <a href=\"https://github.com/zulip/zulip/pull/21068/commits/9c760c20cec3ffcdf528650f6ee55ec49477fd87\">9c760c2</a></p>",
        "id": 1337685,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1646208241
    },
    {
        "content": "<p>I'm deploying here this hopefully final version now. Feedback on details, especially the background colors and any bugs you observe looking at images in Zulip, is appreciated!  In additional to the background color changes, I removed a <code>!important</code> CSS declaration that I think was incorrect.</p>",
        "id": 1338131,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1646267101
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> I thought the images were centered within the containers, but I don't see that now on <a href=\"http://chat.zulip.org\">chat.zulip.org</a>.</p>\n<p>Edit: Oops, that's because I had toggled a few CSS properties while investigating a potential bug; ignore that.</p>",
        "id": 1338621,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1646338433
    },
    {
        "content": "<p>One other thing we may want to tune is the aspect ratio of our boxes. We currently are doing 100px height and 150px width, but there's been no actual discussion of the 1.5 aspect ratio, and I wonder if it'd be better to do something different.  E.g. a lot of computer monitors are 16x9, which is wider than 150x100.</p>",
        "id": 1338625,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1646338694
    },
    {
        "content": "<p>Also I guess <span class=\"user-mention\" data-user-id=\"22433\">@Vlad Korobov</span> FYI, we're running the latest variant, if you want to verify the colors etc.</p>",
        "id": 1338630,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1646338793
    },
    {
        "content": "<p>I think my current feeling is that I like the layout but I kinda feel like the background is more distracting than helpful -- I'm constantly noticing the backgrounds when looking at screenshots, and that's what caused me to think about the aspect ratio question posted above. E.g. here's screenshots of our <a href=\"#narrow/stream/7-test-here/topic/images_in_a_row\">test conversation</a> with the background CSS rules with/without the background CSS rule enabled:</p>\n<p><a href=\"/user_uploads/2/93/KsL-ZMvW4O5E6NYvluoflXxc/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/93/KsL-ZMvW4O5E6NYvluoflXxc/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/93/KsL-ZMvW4O5E6NYvluoflXxc/image.png\"></a></div><p><a href=\"/user_uploads/2/f1/ogJCOPgJYX923nTKFGaAzthm/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/f1/ogJCOPgJYX923nTKFGaAzthm/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/f1/ogJCOPgJYX923nTKFGaAzthm/image.png\"></a></div>",
        "id": 1338637,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1646339286
    },
    {
        "content": "<p>We could tone the opacity-10% white down to opacity-5% white. (On a black background, this is still much more visible than opacity-5% black).</p>",
        "id": 1338657,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1646341199
    },
    {
        "content": "<p>Here's what that looks like:</p>\n<p><a href=\"/user_uploads/2/d9/yLlQIoD6Kp7yhrgr79WhXmx7/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/d9/yLlQIoD6Kp7yhrgr79WhXmx7/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/d9/yLlQIoD6Kp7yhrgr79WhXmx7/image.png\"></a></div><p>I agree that's substantially less distracting.  I'm still not sure it's better than no background for my preferences.</p>",
        "id": 1338663,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1646341586
    },
    {
        "content": "<p>Well, the other case that should be considered is when someone posted just one image, but itâ€™s too small, tall, or wide to fit well into the allocated space. Without the background and without the context of a grid of a dozen images, the viewer is left wondering why thereâ€™s so much empty space around it.</p>",
        "id": 1338666,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1646341760
    },
    {
        "content": "<p>Yeah, I think we see that with the 3rd column of our sample, and I agree we don't want users to feel the need to ask themselves that question.</p>",
        "id": 1338676,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1646342258
    },
    {
        "content": "<p>Here's 2.5%, just to give another variant to consider:</p>\n<p><a href=\"/user_uploads/2/c4/T-3ziQeUuv49Vt6rsumPnLzp/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/c4/T-3ziQeUuv49Vt6rsumPnLzp/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/c4/T-3ziQeUuv49Vt6rsumPnLzp/image.png\"></a></div>",
        "id": 1338677,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1646342276
    },
    {
        "content": "<p>I think based on these tests, my preference is probably opacity in the 3-5% range -- aka a pretty subtle background.</p>",
        "id": 1338680,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1646342319
    },
    {
        "content": "<p>Guys I didnâ€™t suggest that bg in dark mode</p>",
        "id": 1338880,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1646367333
    },
    {
        "content": "<p>I suggested it to be black</p>",
        "id": 1338881,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1646367341
    },
    {
        "content": "<p>But in general both would require retuning for the new design</p>",
        "id": 1338882,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1646367423
    },
    {
        "content": "<p>Also, no background is working fine if we do hover bg</p>",
        "id": 1338883,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1646367474
    },
    {
        "content": "<p>Yeah, <span class=\"user-mention silent\" data-user-id=\"699\">Anders Kaseorg</span> suggested the slightly lightened background in dark mode, and we wanted to try it. (I think we tried black earlier?)</p>",
        "id": 1338886,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1646369193
    },
    {
        "content": "<p>Like <span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> , I find the background to be a bit distracting, though it's not bad as light as it is now (I use light mode. The background on hover idea is interesting.</p>",
        "id": 1338887,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1646369322
    },
    {
        "content": "<p>If we do background on hover - there is no need to round corners at all</p>",
        "id": 1339004,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1646403526
    },
    {
        "content": "<p>The last screen shot in dark theme looks ok to me.</p>",
        "id": 1339006,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1646403565
    },
    {
        "content": "<p>I still think that dark bg would work better, since it usually increases the contrast with an image</p>",
        "id": 1339008,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1646403605
    },
    {
        "content": "<p>anyway, its not super critical now</p>",
        "id": 1339009,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1646403618
    },
    {
        "content": "<p>good enough</p>",
        "id": 1339010,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1646403623
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> would you be up for implementing the background on hover idea for us to try out?</p>",
        "id": 1339099,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1646419805
    },
    {
        "content": "<p>Also, could someone post a screenshot of the  3-5% dark mode background in a PM? I'm wondering if the contrast will be too faint there.</p>",
        "id": 1339415,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1646435961
    },
    {
        "content": "<p>Since I was doing a deploy, I've changed 10%/5% for dark/light to 4%/4% so folks can play with something in that range.</p>",
        "id": 1339566,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1646444872
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"19257\">@Alya Abbott</span> sure thing. Just to confirm, does this mean no background normally -&gt; background on hover?</p>",
        "id": 1340434,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1646707434
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"23057\">@Tushar ðŸ‘¾</span> I think so.</p>",
        "id": 1340471,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1646717471
    },
    {
        "content": "<p>Yep, thanks!</p>",
        "id": 1340717,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1646758391
    },
    {
        "content": "<p>Background on hover pushed with <a href=\"https://github.com/zulip/zulip/pull/21068/commits/6c1b737d47928d93dfe3f4607473edcafba35ead\">6c1b737</a></p>",
        "id": 1342808,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1646978224
    },
    {
        "content": "<p>Nice! After playing with it on dev, I'm excited to try it here.</p>",
        "id": 1343046,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1647023730
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> FYI</p>",
        "id": 1343047,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1647023754
    },
    {
        "content": "<p>OK, doing a deployment with that version now.</p>",
        "id": 1343159,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1647030270
    },
    {
        "content": "<p>I think there is no need of corner rounding of the background. and I suggest to add very light shadow on the images</p>",
        "id": 1343614,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1647107518
    },
    {
        "content": "<p>Something like:</p>\n<div class=\"codehilite\"><pre><span></span><code>/* image shadow light theme */\nfilter: drop-shadow(0px 0px 2px rgba(0, 0, 0, 0.15)) drop-shadow(0px 1px 8px rgba(0, 0, 0, 0.1));\n</code></pre></div>",
        "id": 1343616,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1647108483
    },
    {
        "content": "<p>Overall, I'm liking the hover approach so far! I had been finding the background on every image distracting, and that experience is gone. Using this here is also reminding me that while we need to keep in mind situations like attaching five images to a message, all different sizes, the most common situation is just one attachment. So we should really make sure we're happy with that case.</p>",
        "id": 1344007,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1647276849
    },
    {
        "content": "<p>Yeah, the hover behavior is also nice for indicating something will happen if you click the image.  We need to fix missing <code>cursor: pointer</code>, though.</p>",
        "id": 1344523,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1647304608
    },
    {
        "content": "<p>Iâ€™m not sure the hover-only background suffices to rationalize the egregious amount of whitespace in messages with one image thatâ€™s very <a href=\"#narrow/stream/101-design/topic/UI.20redesign.3A.20compose.20icons/near/1328928\">small</a> or <a href=\"#narrow/stream/101-design/topic/bulk.20delete.20drafts.20.2319943/near/1309832\">wide</a> or <a href=\"#narrow/stream/101-design/topic/pronouns.20in.20profile.20card/near/1340676\">tall</a>.</p>",
        "id": 1344527,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1647305255
    },
    {
        "content": "<p>On another note, I don't think the current tooltip is right.<br>\n<a href=\"/user_uploads/2/ac/nxd38jdiWwjhTK6PZn3QZ9b2/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/ac/nxd38jdiWwjhTK6PZn3QZ9b2/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/ac/nxd38jdiWwjhTK6PZn3QZ9b2/image.png\"></a></div>",
        "id": 1344656,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1647316053
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"19257\">@Alya Abbott</span> <span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> <br>\nI completely agree, although unsure of how we should approach the single image situation. I'm not aware of a CSS-only way to achieve it but we <em>could</em> use JS to change things when we have a single image. It's very possible that causes the page to jump around though and I don't know how we'd mitigate that without having metadata from the server.</p>",
        "id": 1344663,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1647316450
    },
    {
        "content": "<p>The point is not that we should write specific rules for the single-image case. The point is that we should keep the single-image case in mind when designing the general rules.</p>",
        "id": 1344665,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1647316570
    },
    {
        "content": "<p>The single-image case looks particularly silly because the user has no way to see the invisible grid that rationalizes the extra whitespace. This is just one case of the problem that the extra whitespace needs to be rationalized in general, but itâ€™s an important case.</p>",
        "id": 1344667,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1647316758
    },
    {
        "content": "<p>Hard to disagree with that. I'm really disliking the outcome with single small images. I did like how borders helped rationalize the grid.</p>",
        "id": 1344671,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1647317231
    },
    {
        "content": "<p>Did we end up having a discussion about the rounded corners? (I saw a mention above of perhaps doing that on another thread, but then if there was another thread about it I didn't see it linked from here.)</p>\n<p>I think it would be better to leave the corners unrounded. In particular, as it stands, they're inconsistently there anyway: <a href=\"/user_uploads/2/3c/4Kt2YRdix3Xm3Amd45xWC-2s/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/3c/4Kt2YRdix3Xm3Amd45xWC-2s/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/3c/4Kt2YRdix3Xm3Amd45xWC-2s/image.png\"></a></div><p>Three of those photos get their corners rounded, while the other doesn't. I think what's happening is that the first three happen to have the same aspect ratio as the box we're showing the image in, and the other one doesn't.</p>",
        "id": 1345583,
        "sender_full_name": "Greg Price",
        "timestamp": 1647385493
    },
    {
        "content": "<p><a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1325993\">Yes</a>. (I still think they should not be rounded.)</p>",
        "id": 1345586,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1647385674
    },
    {
        "content": "<p>Ah, yeah, I saw that discussion. But it didn't reach a firm conclusion, and then <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1326549\">later</a> <span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> suggested discussing it in its own topic as an orthogonal question.</p>",
        "id": 1345592,
        "sender_full_name": "Greg Price",
        "timestamp": 1647385925
    },
    {
        "content": "<p>Yeah, I think my current opinion is we should not round corners, and then if folks want to try to get rounded corners working, we should do that as a separate follow-up, since they are finicky and this change is complex enough as it is</p>",
        "id": 1345616,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1647386483
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"23057\">Tushar ðŸ‘¾</span> <a href=\"#narrow/stream/101-design/topic/Images.20in.20a.20line.20vs.20row/near/1344656\">said</a>:</p>\n<blockquote>\n<p>On another note, I don't think the current tooltip is right.<br>\n<a href=\"/user_uploads/2/ac/nxd38jdiWwjhTK6PZn3QZ9b2/image.png\">image.png</a></p>\n</blockquote>\n<p>Yep, thanks for the callout! Tooltips are being redone in <a href=\"https://github.com/zulip/zulip/pull/21333\">#21333</a>.</p>",
        "id": 1345623,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1647386652
    },
    {
        "content": "<p>We can go with not-rounded corners. If we keep the background-on-hover approach, that's <span class=\"user-mention silent\" data-user-id=\"22433\">Vlad Korobov</span> 's suggestion above in any case.</p>",
        "id": 1345629,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1647386824
    },
    {
        "content": "<p>yeah, there is no need to round corners of the utility rectangles that we don't see</p>",
        "id": 1345730,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1647390661
    },
    {
        "content": "<p>I've updated the PR to remove rounded borders with <a href=\"https://github.com/zulip/zulip/pull/21068/commits/e1b2fa20854c1ddbf58f43bbdeec9234259cee56\">e1b2fa2</a></p>",
        "id": 1348575,
        "sender_full_name": "Tushar ðŸ‘¾",
        "timestamp": 1647792259
    },
    {
        "content": "<p>I merged this with the following changes:</p>\n<ul>\n<li>Changed the transition from 0.4s to 0.3s, since that's our default transition time for animations.</li>\n<li>Kept the rounded borders removed as discussed.</li>\n<li>Went with a hybrid of the two background colors: 3% always present, increasing to 15% on hover.</li>\n</ul>\n<p>I don't want to close off the potential for further refinements here, but I found the 3% background is essentially invisible for images with a normal aspect ratio, but ends up being much more visible and thus very helpful for the oddly shaped test cases on our mind. </p>\n<p>I'm open to deleting the 15% background on hover, but it felt to me like it was helpful both for indicating that the image is a click target to get to the lightbox (though we have a tooltip for that) and also for making it easy to see what's going on with oddly shaped images and thus avoid confusion.</p>",
        "id": 1350555,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1648014098
    },
    {
        "content": "<p>I'll be deploying the merged version before we go to sleep so folks can experience it -- it's easy to tune those two percentage parameters if we want to.</p>",
        "id": 1350558,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1648014156
    },
    {
        "content": "<p>I've been pretty happy with it (in light mode). What do folks think?</p>",
        "id": 1352579,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1648182730
    },
    {
        "content": "<p>I've been pretty happy with it, though I do worry a bit that the hover behavior (including tooltip) has things appear too quickly when mousing past an image.</p>",
        "id": 1352589,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1648183130
    }
]