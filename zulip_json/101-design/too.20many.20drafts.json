[
    {
        "content": "<p>This is regarding issue <a href=\"https://github.com/zulip/zulip/pull/11217\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11217\">#11217</a> that <span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span> created.</p>\n<p>There can be two reasons for cluttering of drafts box:<br>\n1. Writing something and getting distracted, so clicking outside compose box (which in turn saves the message as a draft)<br>\n2. People who just store too many drafts (but they do care about them)</p>\n<p>It is indeed required to clear up the draft box but setting a limit based on number seems a bit irrational here.<br>\nThe option where we can keep the most recent drafts (say 4 or 5) in the box and show others when the user clicks “Show more” seems reasonable.</p>\n<p>It also seems necessary to clear up the clutter. One solution that I thought of was to notify the user after a certain time (less than 30 days) (but that just seems too much for just drafts). <br>\n<strong><em>Maybe a subtle way to do this is by sending a private message to the user to check for unnecessary drafts.</em></strong></p>\n<p>Any thoughts?</p>",
        "id": 689296,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548446331
    },
    {
        "content": "<p>I like the \"show more\" proposal.  If we do that, then I'm not sure we'd really need to nag the users to do cleanup.</p>",
        "id": 689303,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548446622
    },
    {
        "content": "<p>What if we put a \"sort of\" badge near or inside the <code>Drafts</code> button indicating the drafts exceeding by a certain number? Would it be too distracting?</p>",
        "id": 689317,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548447007
    },
    {
        "content": "<blockquote>\n<p>What if we put a \"sort of\" badge near or inside the <code>Drafts</code> button indicating the drafts exceeding by a certain number? Would it be too distracting?</p>\n</blockquote>\n<p>Interesting idea.  We could style it to be super subtle.  I do think the bounce from zero to one might help people to discover the feature.</p>",
        "id": 689320,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548447105
    },
    {
        "content": "<p>Yeah! Maybe we should wait for some more opinions on this. I think this might induce the habit of clearing up the clutter in users itself. Also adding the \"show more\" option, which just seems necessary.</p>",
        "id": 689323,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548447246
    },
    {
        "content": "<p>I feel like I've heard enough discussion about this over the years to know that \"show more...\" has some backing and will likely be popular.  So I'd consider starting with that.  (You'll want to rebase off of my pending PR that I mentioned in PMs.)</p>",
        "id": 689336,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548447482
    },
    {
        "content": "<p>But I definitely like the thought process behind helping folks clear out old drafts, too (with the added benefit of knowing they even have them).</p>",
        "id": 689338,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548447535
    },
    {
        "content": "<p>So I'll start working on the \"show more\" option for now. Let's wait and see the community has to say about the badge then.</p>",
        "id": 689341,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548447612
    },
    {
        "content": "<p>I would also look for code-cleanup opportunities in <code>drafts.js</code>.  There are probably a few commits that you could do to improve var names, extract helpers, etc.</p>",
        "id": 689345,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548448090
    },
    {
        "content": "<p>(and do those before adding the feature, of course)</p>",
        "id": 689346,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548448107
    },
    {
        "content": "<p>we already remove drafts after 30 days, which I think is sufficient cleanup?</p>",
        "id": 689354,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1548448867
    },
    {
        "content": "<blockquote>\n<p>we already remove drafts after 30 days, which I think is sufficient cleanup?</p>\n</blockquote>\n<p>Probably.  Long term I like the idea of supporting people who have the zero-inbox mentality.  So, if you had a badge on drafts saying how many there were, you'd occasionally clean your drafts (both to satisfy your OCD and also to make sure you haven't forgotten to send anything important).</p>\n<p>But I think those ideas can be put on hold for now.</p>",
        "id": 689355,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548448997
    },
    {
        "content": "<blockquote>\n<p>we already remove drafts after 30 days, which I think is sufficient cleanup?</p>\n</blockquote>\n<p>Just to be clear, <span class=\"user-mention\" data-user-id=\"131\">@Rishi Gupta</span>, you're responding to \"draft cleanup\" idea, not \"code cleanup\", correct?</p>",
        "id": 689356,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548449141
    },
    {
        "content": "<p>yeah :)</p>",
        "id": 689359,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1548449191
    },
    {
        "content": "<p>30 days still feels like a really long time to me, considering how many drafts I can abort in a single day.  I suspect I'm an extreme case, though:</p>\n<p><a href=\"/user_uploads/2/bf/fBOIfsoxOYzQOGIjqTtrfAh8/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/bf/fBOIfsoxOYzQOGIjqTtrfAh8/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/2/bf/fBOIfsoxOYzQOGIjqTtrfAh8/pasted_image.png\"></a></div>",
        "id": 689360,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548449510
    },
    {
        "content": "<p>+1 on \"30 days being too long\" yet at the same time it is reasonable too (which lead me to think about badges)</p>",
        "id": 689364,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548450926
    },
    {
        "content": "<p>why does it matter if there are 100s of open drafts, though?</p>",
        "id": 689367,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1548453168
    },
    {
        "content": "<p>It makes the app feel bloated.</p>",
        "id": 689368,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548453797
    },
    {
        "content": "<blockquote>\n<p>I would also look for code-cleanup opportunities in <code>drafts.js</code>.  There are probably a few commits that you could do to improve var names, extract helpers, etc.</p>\n</blockquote>\n<p>Hey <span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span>! Could you give me an example of improvements in the code you're referring to here?</p>",
        "id": 690839,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548776686
    },
    {
        "content": "<p>I didn't have anything specific in mind.  Actually, after our chat from a couple days ago, I looked at the code, and it's gotten more readable over time.</p>",
        "id": 690841,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548777687
    },
    {
        "content": "<p>So I would just try to look out for confusing sections, and if you have ideas to improve the code, make suggestions here or just do it in a PR.</p>",
        "id": 690842,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548777721
    },
    {
        "content": "<p>but if you don't find anything super confusing, leaving it alone is fine too</p>",
        "id": 690843,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548777739
    },
    {
        "content": "<p>Sure <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>",
        "id": 690844,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548777757
    },
    {
        "content": "<p>There are two pretty complex functions, but I'm not totally clear how to break them up without just having more indirection.</p>",
        "id": 690845,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548777780
    },
    {
        "content": "<p>Which functions are you talking about?</p>",
        "id": 690846,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548777839
    },
    {
        "content": "<p>Another way to help clean up the code is to just add comments.  If you read one of the long functions, and it seems unclear at first, but then you find a way to summarize what it's doing, you can add a comment.</p>",
        "id": 690847,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548777859
    },
    {
        "content": "<p><code>drafts_handle_events</code> is pretty long</p>",
        "id": 690849,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548777881
    },
    {
        "content": "<p><code>drafts_scroll</code></p>",
        "id": 690850,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548777916
    },
    {
        "content": "<blockquote>\n<p><code>drafts_handle_events</code> is pretty long</p>\n</blockquote>\n<p>Yeah! Other parts of this do have comments but I think you probably are talking about the \"delete\" part right?</p>",
        "id": 690851,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548777946
    },
    {
        "content": "<p>Indeed!</p>",
        "id": 690852,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548778015
    },
    {
        "content": "<p>In <code>drafts.js</code>, on delete three things happen:<br>\n1. the draft gets deleted<br>\n2. draft is removed from the ui<br>\n3. drafts list is checked, if empty, \"no drafts\" message appears<br>\nThis is used twice in the code, once when clicking the delete button and once on hitting the delete key.<br>\nI could write a <code>remove_draft</code> function which can be used in both the places. Rest, I'll add comments to increase readability.<br>\n<span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span> ^</p>",
        "id": 690856,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548779244
    },
    {
        "content": "<p>Sounds great!</p>",
        "id": 690859,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548779651
    },
    {
        "content": "<p>Rest of the code seems fine. <code>drafts_scroll</code> is also properly commented. Made the changes. You can see them here: <a href=\"https://github.com/zulip/zulip/pull/11385\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11385\">#11385</a>.<br>\n<span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span> ^</p>",
        "id": 691178,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548786470
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"5593\">@Vaibhav</span> I had a small comment on <a href=\"https://github.com/zulip/zulip/pull/11385\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11385\">#11385</a>.</p>",
        "id": 691350,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548795557
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span> replied to your comment on <a href=\"https://github.com/zulip/zulip/pull/11385\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11385\">#11385</a>.</p>",
        "id": 691371,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548796815
    },
    {
        "content": "<p>Ok, I think the next step is for Tim to review.</p>",
        "id": 691375,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548797078
    },
    {
        "content": "<p>Okay! I'll add a commit to change the <code>delete_id</code> variable name. That sounds absurd now that I looked at it.</p>",
        "id": 691376,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548797140
    },
    {
        "content": "<p>I've probably skimmed that code at least three times and never noticed it!</p>",
        "id": 691377,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548797168
    },
    {
        "content": "<p>Yeah, it's easy to skip when you understand what's happening in the code.</p>",
        "id": 691378,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548797287
    },
    {
        "content": "<p>exactly...I kind of gleaned what it what doing despite the bad name</p>",
        "id": 691379,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548797431
    },
    {
        "content": "<p>but your extraction of the the helper function made it nice and clear</p>",
        "id": 691380,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548797445
    },
    {
        "content": "<p>I encourage you to really bang on the keyboard handling to see if there are any edge-case bugs.</p>",
        "id": 691381,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548797465
    },
    {
        "content": "<p>Sure. I don't think any thing should fall apart, but I'll still have another look.</p>",
        "id": 691382,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548797547
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span> I added two new commits to <a href=\"https://github.com/zulip/zulip/pull/11385\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11385\">#11385</a>.<br>\n1. Renaming <code>delete_id</code><br>\n2. Adding selector <code>.draft_row</code> when focusing previous or next element.<br>\nThe second felt necessary when I was trying to add the \"show more\".<br>\nPlease take a look.</p>",
        "id": 691880,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548871216
    },
    {
        "content": "<p>Yeah, I think I agree with the <code>.draft_row</code> addition.</p>",
        "id": 691886,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548871638
    },
    {
        "content": "<p>I would consider having helper here called <code>row_before_focus</code> and <code>row_after_focus</code>.  Then in the console you could do <code>drafts.row_before_focus().css('background', 'blue')</code> as a sanity check.  And we could hide some of that ugliness.  (You'd need to duplicate the one-liner to get the focused row, which is no big deal.)</p>",
        "id": 691888,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548871817
    },
    {
        "content": "<p>You could have three helpers, actually:</p>\n<ul>\n<li>row_with_focus</li>\n<li>row_after_focus</li>\n<li>row_before_focus</li>\n</ul>",
        "id": 691890,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548871861
    },
    {
        "content": "<p>Once those are solid, you never need to fuss with all the selector details again.</p>",
        "id": 691891,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548871891
    },
    {
        "content": "<p>Yes, I agree.</p>",
        "id": 691896,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548872097
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span> I added the helpers (<a href=\"https://github.com/zulip/zulip/pull/11385\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11385\">#11385</a>). The code does look better now.</p>",
        "id": 691978,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548875966
    },
    {
        "content": "<p>It does indeed!  I wonder if we want <code>draft_id_to_be_focused</code> (adding <code>_id</code> to your name)?</p>",
        "id": 691996,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548876906
    },
    {
        "content": "<p>Added <code>_id</code> at the end.</p>",
        "id": 692285,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548932758
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span> Please see <a href=\"https://github.com/zulip/zulip/pull/11412\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11412\">#11412</a>. I still have to modify (or maybe even add some) tests. If you can, please test it locally.</p>",
        "id": 692447,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548960335
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"5593\">@Vaibhav</span> about to test it...</p>",
        "id": 692469,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548962272
    },
    {
        "content": "<p>It feels a little funny when you have more than N drafts and you delete the Nth draft.  I see your logic of still showing N, but it just feels funny for some reason.</p>\n<p>I think we also need to think about keyboard handling.  If I arrow down past the Nth element, I feel like it should focus on the \"Show more.\"</p>\n<p>I also think N=3 might be better; otherwise, for me, I was still going offscreen, which meant no real reduction in clutter.</p>",
        "id": 692472,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548962625
    },
    {
        "content": "<p>So you're saying what we should do is show all the drafts when deleting or show N-1 drafts?</p>\n<p>And I explicitly did that when you're using the arrow keys it should not go to \"show more\" (for me it made sense to go there using <code>tab</code>) but maybe it should focus on show more using the arrow keys too...</p>\n<p>I'll change the value of N.</p>",
        "id": 692486,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548963013
    },
    {
        "content": "<p>I think each delete does N-1, N-2, N-3?  And then if you exhaust all the original ones, the focus is on \"show more\"?</p>",
        "id": 692496,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548963176
    },
    {
        "content": "<p>I wonder if we can find a similar widget in another product?  just to see what choices they made  (Obviously, Google has a \"show more\" interface, but I don't believe you can delete links.)</p>",
        "id": 692498,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548963217
    },
    {
        "content": "<p>Hmm, we could look at some other examples. Though I see why it might seem funny that it shows N drafts even after deleting.</p>",
        "id": 692503,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548963306
    },
    {
        "content": "<p>So gmail does what your PR does now.  I also find it kind of clunky in gmail.  It's not exactly the same scenario, as they have true paging.  Maybe your way is better, and we could fix it with a small animation effect?  Although I kinda hate to do that, too.</p>",
        "id": 692533,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548963700
    },
    {
        "content": "<p>It might not look as bad with N=3, too.  I think part of the problem was that I was scrolled off the screen.</p>",
        "id": 692537,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548963903
    },
    {
        "content": "<p>I think it feels funny here because it takes some time to delete the emails. It happens so instantly here that it seems weird.</p>",
        "id": 692538,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548963938
    },
    {
        "content": "<p>I don't want to send you too far down the rabbit hole on this, either.  There's no guarantee we'll actually go with this design, although it's time well spent to have a working example we can at least play with.</p>",
        "id": 692539,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548963963
    },
    {
        "content": "<blockquote>\n<p>I think it feels funny here because it takes some time to delete the emails. It happens so instantly here that it seems weird.</p>\n</blockquote>\n<p>Oh, interesting.  Are you seeing lags?  (It <strong>should</strong> be fast, since everything is local, correct?)</p>",
        "id": 692541,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548963999
    },
    {
        "content": "<p>No, that's what I meant. Locally everything is fast and hence it seems weird.</p>",
        "id": 692542,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548964037
    },
    {
        "content": "<p>Part of the problem here is that I have some PM drafts.  And our color for the \"selected\" draft doesn't stand out from the background of PMs.  So it's very disorienting.  That's another path to explore.</p>",
        "id": 692544,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548964069
    },
    {
        "content": "<p>I also don't think the messages need to be so wide.  (That's just a nit unrelated to the other changes.)</p>",
        "id": 692545,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548964127
    },
    {
        "content": "<blockquote>\n<p>No, that's what I meant. Locally everything is fast and hence it seems weird.</p>\n</blockquote>\n<p>So you're saying it's slow here?  Or are you saying it's always fast?</p>",
        "id": 692546,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548964200
    },
    {
        "content": "<p>It's quite fast.</p>\n<p>The lag is while deleting emails <strong>not drafts</strong>.</p>",
        "id": 692550,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548964252
    },
    {
        "content": "<p>Oh! gotcha</p>",
        "id": 692568,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548964651
    },
    {
        "content": "<p>Duh, now I get your point.  I kinda feel the gmail use case is a bit apples/oranges here, but it's at least a data point.</p>",
        "id": 692569,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548964679
    },
    {
        "content": "<p>lag in drafts &lt; lag in gmail &lt; lag in Steve's brain</p>",
        "id": 692572,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548964721
    },
    {
        "content": "<p>I think we need more people to join in about what to do here (rather than thinking ourselves).</p>",
        "id": 692574,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1548964815
    },
    {
        "content": "<p>yeah, agreed.  I also think the most glaring problem with drafts is still the design.  If it were a bit more pleasant to look at, I don't think people would mind the zillion drafts as much.</p>",
        "id": 692582,
        "sender_full_name": "Steve Howell",
        "timestamp": 1548965076
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span>! I was wondering if there was any progress here. (Was offline for the past few days, was feeling under the weather).</p>",
        "id": 693907,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1549303221
    },
    {
        "content": "<p>Not really, I haven't seen any discussion of alternatives.</p>",
        "id": 693908,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549303619
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"5593\">@Vaibhav</span> If you feel like working on drafts a bit, I wonder if you can try some styling changes?</p>",
        "id": 693909,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549303650
    },
    {
        "content": "<p>Hmm, yeah I could do that. Meanwhile, I did claim <a href=\"https://github.com/zulip/zulip/pull/11438\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11438\">#11438</a>, was working on it.</p>",
        "id": 693910,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1549303741
    },
    {
        "content": "<p>A couple suggestions would be:</p>\n<ul>\n<li>make the messages not so wide</li>\n<li>make the modal feel less crowded by having a bit more whitespace padding around the items (mostly on the sides)</li>\n<li>figure out how to make the selected draft stand out from PM drafts</li>\n</ul>",
        "id": 693911,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549303757
    },
    {
        "content": "<p>Cool, staying on <a href=\"https://github.com/zulip/zulip/pull/11438\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11438\">#11438</a> is probably higher priority.</p>",
        "id": 693913,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549303786
    },
    {
        "content": "<p>but if you get to a stopping point there, I do think there might be quick styling changes that will help a lot</p>",
        "id": 693914,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549303814
    },
    {
        "content": "<p>That won't be a problem, I'll be able to work on both, <a href=\"https://github.com/zulip/zulip/pull/11438\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11438\">#11438</a> shouldn't take long <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 693915,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1549303905
    },
    {
        "content": "<p>I do feel like the most important thing here is to just make it so that you have to go to drafts less frequently, by having a keyboard shortcut that's \"restore last draft\"</p>",
        "id": 693916,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1549303923
    },
    {
        "content": "<p>What key did you have in mind?  Did we try this at one point?  FWIW control-d is not used by Zulip, but it does save bookmarks in FF.</p>",
        "id": 693918,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549304112
    },
    {
        "content": "<p>Maybe we tried control-r then rejected it due to refresh?  Or maybe it's all in my imagination. <span aria-label=\"smile\" class=\"emoji emoji-263a\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 693920,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549304214
    },
    {
        "content": "<p>Ah, <a href=\"https://github.com/zulip/zulip/pull/9647\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/9647\">https://github.com/zulip/zulip/pull/9647</a></p>",
        "id": 693922,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549304448
    },
    {
        "content": "<p>We tried \"D\", which was used by A/D.  I think we need a control character so you can call it when the compose box is open.</p>",
        "id": 693923,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549304477
    },
    {
        "content": "<p>s/was used/is used/</p>",
        "id": 693925,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549304510
    },
    {
        "content": "<p><code>Ctrl</code> + <code>Shift</code> + <code>d</code> (or <code>Ctrl</code> + <code>D</code>) seems fine...</p>",
        "id": 693927,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1549304561
    },
    {
        "content": "<p>I was thinking <code>D</code>(or possibly <code>d</code>). <br>\nI think this is one of the ones where we don't need to call it when the compose box is open; e.g. what should we do if there's already stuff in the compose box?</p>",
        "id": 693948,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1549305365
    },
    {
        "content": "<p>it's gated on a larger set of keyboard shortcuts changes that we should do anyway</p>",
        "id": 693949,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1549305384
    },
    {
        "content": "<p>where going to the drafts modal would be <code>g + d</code></p>",
        "id": 693950,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1549305414
    },
    {
        "content": "<p>I personally like d/enter to restore the last draft (and be able to see it before I restore it).  So I'd probably be giving slightly negative feedback on <code>g + d</code>.</p>",
        "id": 693952,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549305557
    },
    {
        "content": "<blockquote>\n<p>figure out how to make the selected draft stand out from PM drafts</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span> what about the same design as the selected message in the list, something like this:<br>\n<a href=\"/user_uploads/2/10/Okj6wxeIpnVV-TbyFQukVmaH/Screenshot-2019-02-13-at-12.12.45-AM.png\" target=\"_blank\" title=\"Screenshot-2019-02-13-at-12.12.45-AM.png\">Screenshot-2019-02-13-at-12.12.45-AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/10/Okj6wxeIpnVV-TbyFQukVmaH/Screenshot-2019-02-13-at-12.12.45-AM.png\" target=\"_blank\" title=\"Screenshot-2019-02-13-at-12.12.45-AM.png\"><img src=\"/user_uploads/2/10/Okj6wxeIpnVV-TbyFQukVmaH/Screenshot-2019-02-13-at-12.12.45-AM.png\"></a></div>",
        "id": 698622,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1549997006
    },
    {
        "content": "<p>Ha! Interesting!  I like this solution, although I kinda want to make drafts look <strong>less</strong> like a message feed, because I think that's a confusing UI.</p>",
        "id": 698634,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549997306
    },
    {
        "content": "<p>It's clearly an improvement, despite my objections.</p>",
        "id": 698635,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549997334
    },
    {
        "content": "<p>Hmm, I thought drafts were deliberately made to look like the message feed</p>",
        "id": 698636,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1549997394
    },
    {
        "content": "<blockquote>\n<p>Hmm, I thought drafts were deliberately made to look like the message feed</p>\n</blockquote>\n<p>They are.  I just personally think this was and is a bad idea.</p>",
        "id": 698637,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549997419
    },
    {
        "content": "<p>But insofar as this is our paradigm, your changes are the way to go here.</p>",
        "id": 698641,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549997461
    },
    {
        "content": "<p>I also changed the padding by 10px. Does make a huge difference, feels a lot cleaner.<br>\n<a href=\"/user_uploads/2/59/RkFsqzCIgjALCdVJGXuSf09w/Screenshot-2019-02-13-at-12.22.30-AM.png\" target=\"_blank\" title=\"Screenshot-2019-02-13-at-12.22.30-AM.png\">Screenshot-2019-02-13-at-12.22.30-AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/59/RkFsqzCIgjALCdVJGXuSf09w/Screenshot-2019-02-13-at-12.22.30-AM.png\" target=\"_blank\" title=\"Screenshot-2019-02-13-at-12.22.30-AM.png\"><img src=\"/user_uploads/2/59/RkFsqzCIgjALCdVJGXuSf09w/Screenshot-2019-02-13-at-12.22.30-AM.png\"></a></div>",
        "id": 698648,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1549997646
    },
    {
        "content": "<p>I'd go even slightly higher on the padding.</p>",
        "id": 698653,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549997732
    },
    {
        "content": "<p>how does 15px look to you?  (I don't need a screenshot, but it would be nice)</p>",
        "id": 698654,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549997753
    },
    {
        "content": "<p>or even 25px</p>",
        "id": 698655,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549997778
    },
    {
        "content": "<p>Yup, trying that</p>",
        "id": 698656,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1549997800
    },
    {
        "content": "<p>Sort of a tangent:  You had some nice refactoring at the beginning of the PR that just clean up the code without altering behavior.  Have those been merged yet?</p>",
        "id": 698662,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549997977
    },
    {
        "content": "<p>Increasing it by 15 does look good, more than that, it just looks weird. I thought maybe because of the vertical padding but even after increasing that, I don't seem to like it. Feels like we're moving from good clean to bad clean on increasing more padding</p>",
        "id": 698663,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1549998053
    },
    {
        "content": "<blockquote>\n<p>Sort of a tangent:  You had some nice refactoring at the beginning of the PR that just clean up the code without altering behavior.  Have those been merged yet?</p>\n</blockquote>\n<p>No... I did leave a comment on Github mentioning Tim. Figured he must be busy.</p>",
        "id": 698664,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1549998097
    },
    {
        "content": "<p>Let's go with 15px then.</p>",
        "id": 698665,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549998105
    },
    {
        "content": "<p>The other thing to explore is making the modal itself a tad more narrow.</p>",
        "id": 698667,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549998221
    },
    {
        "content": "<p>it's 60% now...I think 58% is slightly less gaudy</p>",
        "id": 698674,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549998405
    },
    {
        "content": "<p>if you make it too narrow, you have the message feed behind you, which looks a bit funny given how much we try to make the drafts look like a message feed</p>",
        "id": 698676,
        "sender_full_name": "Steve Howell",
        "timestamp": 1549998440
    },
    {
        "content": "<p>Even at 60%, I can still see message feed behind the modal</p>",
        "id": 698736,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550001010
    },
    {
        "content": "<p>Huh, I'm not sure how much it really matters.  It's possible we should just set a width in pixels that looks nice.</p>",
        "id": 698747,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550002279
    },
    {
        "content": "<p>But won't that interfere with the web app being responsive</p>",
        "id": 698751,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550002424
    },
    {
        "content": "<p>oh, good point</p>",
        "id": 698753,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550002455
    },
    {
        "content": "<p>It's not completely responsive now, to be fair.</p>",
        "id": 698754,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550002492
    },
    {
        "content": "<p>since the 60% either shows or doesn't show the message feed beneath it, depending on your screen width</p>",
        "id": 698755,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550002531
    },
    {
        "content": "<p>I think the thing to do here is set a reasonable width that looks nice on most large screens, and then add a media query to make sure it doesn't look bad on small screens.</p>",
        "id": 698757,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550002579
    },
    {
        "content": "<p>I still think setting the width in percentage is more reasonable as all the widths: message feed and both the sidebars have their widths set in percentage. Just for the sake of consistency (both design and code)</p>",
        "id": 698761,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550002713
    },
    {
        "content": "<p>[edit]: or in relative terms (if not percentage)...</p>",
        "id": 698762,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550002754
    },
    {
        "content": "<p>sure, I'm fine to tweak it down a bit to 58%</p>",
        "id": 698765,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550002824
    },
    {
        "content": "<p>or do a smarter calculation in CSS</p>",
        "id": 698766,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550002851
    },
    {
        "content": "<p>The message feed, for example, isn't really a fixed percentage; it's a relative calculation, I believe.</p>",
        "id": 698767,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550002897
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span> made some changes... <a href=\"https://github.com/zulip/zulip/pull/11550\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11550\">#11550</a></p>",
        "id": 699166,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550077301
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span>  ^</p>",
        "id": 699333,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550081810
    },
    {
        "content": "<p>about to look...</p>",
        "id": 699334,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550081983
    },
    {
        "content": "<p>First of all, good decision to break out the pure styling changes to its own PR.  A brief skim of the code--code seems straightforward.  About to UI test a bit...</p>",
        "id": 699338,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550082051
    },
    {
        "content": "<p>I think you've convinced me on the blue box.</p>",
        "id": 699340,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550082213
    },
    {
        "content": "<p>I honestly would still want a tad more padding, but I think we should merge as is.  I'll comment as such on the PR.  We can always tweak it more later.</p>",
        "id": 699342,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550082245
    },
    {
        "content": "<blockquote>\n<p>I think you've convinced me on the blue box.</p>\n</blockquote>\n<p>It does look good in the message feed, hence... <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>",
        "id": 699343,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550082277
    },
    {
        "content": "<blockquote>\n<p>I honestly would still want a tad more padding, but I think we should merge as is.  I'll comment as such on the PR.  We can always tweak it more later.</p>\n</blockquote>\n<p>yeah, we can also wait and see if people notice a difference on czo</p>",
        "id": 699345,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550082369
    },
    {
        "content": "<p>I think the blue box is a bit thick, but that's just me.</p>",
        "id": 699346,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550082381
    },
    {
        "content": "<p>(update) PR with current changes: <a href=\"https://github.com/zulip/zulip/pull/11552\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11552\">#11552</a><br>\nFurther, as commented by Tim on GH:</p>\n<blockquote>\n<p>I agree with using a blue box. think we should have the blue box surround the whole thing, not just the message content; makes it stand out more.</p>\n</blockquote>\n<p>Changes will be made in the above mentioned PR</p>",
        "id": 699501,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550090663
    },
    {
        "content": "<p>Makes sense</p>",
        "id": 699502,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550090693
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"5593\">@Vaibhav</span> let me know when ready.</p>",
        "id": 699558,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1550094665
    },
    {
        "content": "<p>He is sleeping. <span aria-label=\"smile\" class=\"emoji emoji-263a\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 699559,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550094724
    },
    {
        "content": "<p>Oh, right <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 699563,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1550094832
    },
    {
        "content": "<p>I added the blue border to full box, it looks like this:<br>\n<a href=\"/user_uploads/2/93/A9aSR8sgSME2HKL0Co_hPtM2/Screenshot-2019-02-14-at-7.10.13-PM.png\" target=\"_blank\" title=\"Screenshot-2019-02-14-at-7.10.13-PM.png\">Screenshot-2019-02-14-at-7.10.13-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/93/A9aSR8sgSME2HKL0Co_hPtM2/Screenshot-2019-02-14-at-7.10.13-PM.png\" target=\"_blank\" title=\"Screenshot-2019-02-14-at-7.10.13-PM.png\"><img src=\"/user_uploads/2/93/A9aSR8sgSME2HKL0Co_hPtM2/Screenshot-2019-02-14-at-7.10.13-PM.png\"></a></div>",
        "id": 699965,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550152174
    },
    {
        "content": "<p>There are a few problems with this:</p>\n<ul>\n<li>If you see carefully at the top right corner, the border isn't of the same color as the rest of it, it is somewhat transparent (still trying to figure out why... shouldn't be like this)</li>\n<li>The stream label on the top left doesn't look right (as suddenly it's spacing is changed) and the colors of border and stream label differ</li>\n<li>Code is also a bit \"hacky\"</li>\n</ul>\n<p>I tried a couple of other things:</p>\n<ul>\n<li>Tried to make the color of stream label same as the border but:<ul>\n<li>The stream label color is defined in the templates and it is an inline style, the change will require js (won't be done just by changing the CSS of \"active\" elements).</li>\n<li>It just looks wrong...</li>\n</ul>\n</li>\n<li>Also added a border outside (rather than inside or <code>inset</code>) but that doesn't go with the current design, it looked quite odd</li>\n</ul>\n<p>The screenshot that I sent is the best option according to me if we want to add a blue border around all of the box.</p>\n<p><strong>My personal opinion is to go with the blue box exactly like the one in the message feed; I'm looking for ways in which we could highlight the recipient bar too to go with this</strong></p>",
        "id": 699969,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550153053
    },
    {
        "content": "<p>I wonder if you remove the yellow left border under Verona (and all similar border), so the design is a bit less heavy.  And then maybe just have the blue as the left border, rather than an entire box.  It's a bit more subtle, but I don't think folks using the arrow keys need a super huge cue to what they're looking at.</p>",
        "id": 699971,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550153324
    },
    {
        "content": "<p>BTW I just noticed something that precedes your change.  In day mode, we don't always use the correct foreground color on the recipient bars.  For dark stream colors, we still use black text.</p>",
        "id": 699972,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550153461
    },
    {
        "content": "<blockquote>\n<p>I wonder if you remove the yellow left border under Verona (and all similar border), so the design is a bit less heavy.  And then maybe just have the blue as the left border, rather than an entire box.  It's a bit more subtle, but I don't think folks using the arrow keys need a super huge cue to what they're looking at.</p>\n</blockquote>\n<p>I can try, but so far (as I've been experimenting) I am sure that the left-border will still be in conflict with the stream label. Then rather  than adding just a left border in message content, we can already add border around all of the message content which itself looks good.</p>\n<p>Also, I am quite in favour of dropping the left border (like yellow in verona) from drafts</p>",
        "id": 699973,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550153636
    },
    {
        "content": "<blockquote>\n<p>BTW I just noticed something that precedes your change.  In day mode, we don't always use the correct foreground color on the recipient bars.  For dark stream colors, we still use black text.</p>\n</blockquote>\n<p>Which stream colors are you talking about? (So far I feel black works well with all the stream colors)</p>\n<p>(edit) Never mind, I just went through streams here on czo</p>",
        "id": 699974,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550153742
    },
    {
        "content": "<p><a href=\"/user_uploads/2/34/pRErZROTjMoJmdhXN2IVCX0z/pasted_image.png\" target=\"_blank\" title=\"pasted_image.png\">pasted image</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/34/pRErZROTjMoJmdhXN2IVCX0z/pasted_image.png\" target=\"_blank\" title=\"pasted image\"><img src=\"/user_uploads/2/34/pRErZROTjMoJmdhXN2IVCX0z/pasted_image.png\"></a></div>",
        "id": 699975,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550153893
    },
    {
        "content": "<p>That darkish red background looks better with white text.</p>",
        "id": 699976,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550153921
    },
    {
        "content": "<p>Yeah, I saw that and edited my message the same moment you sent this message <span aria-label=\"joy\" class=\"emoji emoji-1f602\" role=\"img\" title=\"joy\">:joy:</span></p>",
        "id": 699977,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550153959
    },
    {
        "content": "<p>There's a function called <code>stream_color.get_color_class</code>.</p>",
        "id": 699978,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550153967
    },
    {
        "content": "<p>You pass it in something like <code>sub.color</code> and it returns either <code>light_background</code> or <code>dark_background</code>.  And then it's slightly tricky to figure out night mode stuff.</p>",
        "id": 699979,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154021
    },
    {
        "content": "<p>But in theory you can read the message-related code that does it and just add a selector to any relevant CSS class.</p>",
        "id": 699980,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154067
    },
    {
        "content": "<blockquote>\n<p>Also, I am quite in favour of dropping the left border (like yellow in verona) from drafts</p>\n</blockquote>\n<p>Cool!  Let's try it.  I think that might be what makes the dialog feel so busy and cluttered.</p>",
        "id": 699981,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154171
    },
    {
        "content": "<p>I assume you are rebased on top of all the latest master commits, correct?</p>",
        "id": 699982,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154239
    },
    {
        "content": "<p>Not right now...</p>",
        "id": 699983,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550154263
    },
    {
        "content": "<p>Oh wait, I am. I pulled the latest master today and forgot <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 699985,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550154352
    },
    {
        "content": "<blockquote>\n<p>But in theory you can read the message-related code that does it and just add a selector to any relevant CSS class.</p>\n</blockquote>\n<p>Can you elaborate? I did not get your point here</p>",
        "id": 699986,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550154479
    },
    {
        "content": "<p>All of these calls are just returning a CSS class to put in the HTML:</p>\n<div class=\"codehilite\"><pre><span></span>$ git grep stream_color.get_color_class\nstatic/js/compose_actions.js:        .addClass(stream_color.get_color_class(color));\nstatic/js/message_list_view.js:        group.color_class = stream_color.get_color_class(group.background_color);\nstatic/js/stream_list.js:    args.dark_background = stream_color.get_color_class(args.color);\nstatic/js/stream_list.js:    var dark_background = stream_color.get_color_class(sub.color);\nstatic/js/tab_bar.js:        var stream_dark = stream_color.get_color_class(color_for_stream);\n</pre></div>",
        "id": 699987,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154578
    },
    {
        "content": "<p>And then return either <code>''</code> or <code>'dark_background'</code>.</p>",
        "id": 699988,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154622
    },
    {
        "content": "<p>And then there's lots of night-mode stuff we do:</p>\n<div class=\"codehilite\"><pre><span></span>$ git grep dark_background\nfrontend_tests/node_tests/stream_list.js:        assert.equal(data.dark_background, &#39;dark_background&#39;);\nfrontend_tests/node_tests/stream_list.js:            dark_background: payload.dark_background,\nfrontend_tests/node_tests/templates.js:        dark_background: &quot;maroon&quot;,\nstatic/js/stream_color.js:exports.color_classes = &#39;dark_background&#39;;\nstatic/js/stream_color.js:    return lightness &lt; lightness_threshold ? &#39;dark_background&#39; : &#39;&#39;;\nstatic/js/stream_list.js:    args.dark_background = stream_color.get_color_class(args.color);\nstatic/js/stream_list.js:    var dark_background = stream_color.get_color_class(sub.color);\nstatic/js/stream_list.js:        dark_background: dark_background,\nstatic/styles/night_mode.scss:    .dark_background a,\nstatic/styles/night_mode.scss:    a.dark_background:hover,\nstatic/styles/night_mode.scss:    .dark_background,\nstatic/styles/night_mode.scss:    .message_header:not(.dark_background) a.stream_label:not(.dark_background):hover,\nstatic/styles/night_mode.scss:    #tab_list li.stream:not(.dark_background) {\nstatic/styles/zulip.scss:.dark_background a,\nstatic/styles/zulip.scss:.dark_background a:hover,\nstatic/styles/zulip.scss:a.dark_background:hover,\nstatic/styles/zulip.scss:.dark_background {\nstatic/styles/zulip.scss:.dark_background a.message_label_clickable:hover {\nstatic/templates/draft.handlebars:        &lt;div class=&quot;message_header message_header_private_message dark_background&quot;&gt;\nstatic/templates/recipient_row.handlebars:&lt;div class=&quot;message_header message_header_private_message dark_background&quot;&gt;\n</pre></div>",
        "id": 699989,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154644
    },
    {
        "content": "<p>Oh so I can just specify for <code>dark_background</code> to set foreground to white color</p>",
        "id": 699990,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550154658
    },
    {
        "content": "<p>Yeah.</p>",
        "id": 699991,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154666
    },
    {
        "content": "<p>But it's sort of vice versa for night mode.</p>",
        "id": 699992,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154676
    },
    {
        "content": "<p>Or maybe not.</p>",
        "id": 699993,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154680
    },
    {
        "content": "<p>I can't remember the permutations.</p>",
        "id": 699994,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154691
    },
    {
        "content": "<p>But I guess we don't need that here (for stream labels) as they are independent of night mode or day mode</p>",
        "id": 699995,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550154746
    },
    {
        "content": "<p>What I'd do is view all four cases in the message feed:</p>\n<ul>\n<li>dark stream, day mode</li>\n<li>light stream, day mode</li>\n<li>dark stream, night mode</li>\n<li>light stream, night mode</li>\n</ul>\n<p>And use the inspector to see what styles are applied.</p>",
        "id": 699996,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154774
    },
    {
        "content": "<p>Simply for stream label with <code>dark_background</code> I can specify white foreground</p>",
        "id": 699997,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550154777
    },
    {
        "content": "<p>I think it might be that simple, although I think there are strange things where you need to explicitly override a more global CSS setting.</p>",
        "id": 699998,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154807
    },
    {
        "content": "<p>For example, in night mode text is white by default.</p>",
        "id": 699999,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154819
    },
    {
        "content": "<p>So it's actually streams with light backgrounds where you have to force the text to black.</p>",
        "id": 700000,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154839
    },
    {
        "content": "<p>Whereas in day more you have to fix streams with dark backgrounds and force the text to black.</p>",
        "id": 700001,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154857
    },
    {
        "content": "<p>Hmm, I'll have to see because the text is already black in night mode now, right?</p>",
        "id": 700002,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550154896
    },
    {
        "content": "<p>I find the whole system a bit overly complicated as it's written now, but it should still be like a 3-line fix.</p>",
        "id": 700003,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154900
    },
    {
        "content": "<blockquote>\n<p>Hmm, I'll have to see because the text is already black in night mode now, right?</p>\n</blockquote>\n<p>Ha, interesting.</p>",
        "id": 700004,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154917
    },
    {
        "content": "<p>And just to be on the same page, we're talking about the stream labels in draft modal?</p>",
        "id": 700006,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550154928
    },
    {
        "content": "<p>correct</p>",
        "id": 700007,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154961
    },
    {
        "content": "<p>So yeah I'd just make sure all 4 cases work, and you may just have to fiddle with thing.</p>",
        "id": 700008,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550154994
    },
    {
        "content": "<p>Yeah, so there the text in night mode too is already black</p>",
        "id": 700009,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550155000
    },
    {
        "content": "<p>Also, make sure you have a PM draft.</p>",
        "id": 700010,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550155004
    },
    {
        "content": "<p>Because PM drafts are hard coded, I believe (since they don't have stream colors to worry about).</p>",
        "id": 700011,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550155023
    },
    {
        "content": "<p>So in both day and night, check:</p>\n<ul>\n<li>dark stream</li>\n<li>light stream</li>\n<li>PM</li>\n</ul>",
        "id": 700013,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550155040
    },
    {
        "content": "<p>PM colors are correct (I'll see once again still)</p>",
        "id": 700014,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550155055
    },
    {
        "content": "<p>Yeah, definitely do a final pass of QA after you make all your changes.  And quickly check the message feed, too, just to make sure any selectors you added didn't have unintended consequences.</p>",
        "id": 700019,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550155416
    },
    {
        "content": "<p>Yup, for both nigh mode and day mode, for:</p>\n<ul>\n<li>dark stream =&gt; black foreground <span aria-label=\"incorrect\" class=\"emoji emoji-274c\" role=\"img\" title=\"incorrect\">:incorrect:</span></li>\n<li>light stream =&gt; black foreground <span aria-label=\"check mark\" class=\"emoji emoji-2714\" role=\"img\" title=\"check mark\">:check_mark:</span> </li>\n<li>PM =&gt; white foreground on black background <span aria-label=\"check mark\" class=\"emoji emoji-2714\" role=\"img\" title=\"check mark\">:check_mark:</span></li>\n</ul>",
        "id": 700020,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550155449
    },
    {
        "content": "<p>ah, cool</p>",
        "id": 700021,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550155480
    },
    {
        "content": "<p>so not too far broken</p>",
        "id": 700022,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550155504
    },
    {
        "content": "<p>Yes! so I guess a setting white foreground for <code>dark_background</code> will work fine now</p>",
        "id": 700023,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550155555
    },
    {
        "content": "<p>cool</p>",
        "id": 700024,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550156118
    },
    {
        "content": "<p>how big a change was it?</p>",
        "id": 700025,
        "sender_full_name": "Steve Howell",
        "timestamp": 1550156127
    },
    {
        "content": "<p>Sorry, had gone for dinner. Doing it now...</p>",
        "id": 700028,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550157575
    },
    {
        "content": "<p>It was a 4 line change...</p>",
        "id": 700031,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550158281
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"58\">@Steve Howell</span> I needed some feedback on this:<br>\n<a href=\"/user_uploads/2/b6/-7Cpkq6EtIm12S9eCn2d6nQs/ezgif-4-27237eddf8ad.gif\" target=\"_blank\" title=\"ezgif-4-27237eddf8ad.gif\">ezgif-4-27237eddf8ad.gif</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/b6/-7Cpkq6EtIm12S9eCn2d6nQs/ezgif-4-27237eddf8ad.gif\" target=\"_blank\" title=\"ezgif-4-27237eddf8ad.gif\"><img src=\"/user_uploads/2/b6/-7Cpkq6EtIm12S9eCn2d6nQs/ezgif-4-27237eddf8ad.gif\"></a></div><p>I removed the left border and added the blue border (outside the box) all around the box. It's a lot cleaner but differs from the current design.</p>",
        "id": 700044,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550160612
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"5593\">@Vaibhav</span> BTW, it'd be great in the future if after a longer discussion like this, you linked back to it in a comment in the PR; that makes it easy to ensure that folks reading the PR have the context (I ended up spending more time on the review because I hadn't seen this)</p>",
        "id": 700601,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1550175971
    },
    {
        "content": "<p>Okay, I'll take care of it next time <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 700603,
        "sender_full_name": "Vaibhav Rabber",
        "timestamp": 1550176022
    }
]