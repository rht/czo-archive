[
    {
        "content": "<p>Interesting conversation on <a class=\"stream\" data-stream-id=\"48\" href=\"/#narrow/stream/mobile\">#mobile</a>: <a href=\"https://chat.zulip.org/#narrow/stream/mobile/subject/Mark.20as.20Unread/near/300608\" target=\"_blank\" title=\"https://chat.zulip.org/#narrow/stream/mobile/subject/Mark.20as.20Unread/near/300608\">https://chat.zulip.org/#narrow/stream/mobile/subject/Mark.20as.20Unread/near/300608</a></p>",
        "id": 300923,
        "sender_full_name": "Steve Howell",
        "timestamp": 1508432398
    },
    {
        "content": "<p>Out lack of mark-as-unread feature is not a huge problem for me, because I just star the messages that I need to come back to.  But I don't really like to do that; I would much rather have true mark-as-unread.  This is a problem for me in two situations:</p>\n<ul>\n<li>If I'm on mobile web, I don't have a good mechanism for adding todos.  I can use the iPhone notes feature, but typing's a pain on the phone, and I still need to remember to check the notes.</li>\n<li>Even if I'm on a laptop, if I'm super busy and five things are happening at once, I need a way to pop stuff off my stack, and mark-as-unread is designed for that.</li>\n</ul>\n<p>I'm also sympathetic to the argument that email has gotten this right for at least a couple decades, so the no-brainer approach to me here is to follow email.  (But the <a class=\"stream\" data-stream-id=\"48\" href=\"/#narrow/stream/mobile\">#mobile</a> thread has some good ideas as well.)</p>",
        "id": 300926,
        "sender_full_name": "Steve Howell",
        "timestamp": 1508432811
    },
    {
        "content": "<p>There are two good examples of how mark as read/unread can work: Google GMail/Inbox and Feedly.</p>",
        "id": 300931,
        "sender_full_name": "Boris Yankov",
        "timestamp": 1508434448
    },
    {
        "content": "<p>GMail shows subject plus some short message preview, so you have a basic idea what the message is about before viewing it. When opening it, then it is read, and you can mark as unread.</p>",
        "id": 300933,
        "sender_full_name": "Boris Yankov",
        "timestamp": 1508434590
    },
    {
        "content": "<p>Feedly marks as read as you move away, so in our case - when you leave the current narrow.</p>",
        "id": 300934,
        "sender_full_name": "Boris Yankov",
        "timestamp": 1508434621
    },
    {
        "content": "<p>Actually, Inbox is a third option and one we should definitely consider too: there is no mark as unread, and the organization itself is a replacement for unread.</p>",
        "id": 300937,
        "sender_full_name": "Boris Yankov",
        "timestamp": 1508434668
    },
    {
        "content": "<p>I definitely 'pin' messages if I want to get back to them and haven't found the need to mark as unread up till now.</p>",
        "id": 300938,
        "sender_full_name": "Boris Yankov",
        "timestamp": 1508434697
    },
    {
        "content": "<p>Maybe a good option is to enhance our 'star' system by first renaming it 'pin' which is, I think, a bit more logical, as usually I don't want to 'favor' a message, but to save it for later reference.</p>",
        "id": 300940,
        "sender_full_name": "Boris Yankov",
        "timestamp": 1508434744
    },
    {
        "content": "<p>Then we can, in addition to what we do now, show pinned messages on top of the respective narrow, actually pinned.</p>",
        "id": 300942,
        "sender_full_name": "Boris Yankov",
        "timestamp": 1508434771
    },
    {
        "content": "<p>I don't think Feedly actually solves my main use case, since it's exactly when I get pulled away from a narrow to deal with something more urgent that I <strong>don't</strong> want messages to be assumed to be read.</p>",
        "id": 300945,
        "sender_full_name": "Steve Howell",
        "timestamp": 1508434868
    },
    {
        "content": "<p>For me the most natural mechanism to mark messages unread is \"scroll up\".</p>",
        "id": 300948,
        "sender_full_name": "Steve Howell",
        "timestamp": 1508435151
    },
    {
        "content": "<p>Hmmmm, that is definitely a better idea in a log of cases, I like it a lot. I can see some cases where it isn't.</p>",
        "id": 300964,
        "sender_full_name": "Boris Yankov",
        "timestamp": 1508435599
    },
    {
        "content": "<p>Yeah, probably the main problem with scroll-up-marks-as-unread is when you're going back to find an old message, but you still consider yourself caught up.  I don't view that as a dealbreaker, though.</p>",
        "id": 301007,
        "sender_full_name": "Steve Howell",
        "timestamp": 1508436475
    },
    {
        "content": "<p>I think we could potentially do something with swiping for \"mark as unread\" as well.</p>",
        "id": 301010,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1508436594
    },
    {
        "content": "<p>Yeah, the Feedly solution works great for Feedly partly because, as an RSS reader, the app is one that is never itself a source of interrupts -- so if I navigate elsewhere within the app, that's virtually never because of an interrupt. (There's also an explicit \"mark as unread\" that I can use when I do want to navigate elsewhere within the app for some reason and come back later.)</p>",
        "id": 301515,
        "sender_full_name": "Greg Price",
        "timestamp": 1508457799
    },
    {
        "content": "<p>I think the same behavior would still be quite helpful for Zulip, because I get plenty of interrupts on my phone from elsewhere (like Facebook Messenger), or interrupts from elsewhere that I handle on my phone outside Zulip. But it won't be as near-complete a solution.</p>",
        "id": 301519,
        "sender_full_name": "Greg Price",
        "timestamp": 1508457897
    },
    {
        "content": "<p>For me I think it would still be like a 95% solution now, because I use Zulip only for discussing/developing Zulip, and I rarely get interrupts on that while not at my laptop. Might be a 75% solution in a world where I used Zulip like a lot of people in the SF tech industry use Slack now, with an org for every friend group, hobby, and professional interest.</p>",
        "id": 301526,
        "sender_full_name": "Greg Price",
        "timestamp": 1508458165
    },
    {
        "content": "<p>Bumping this topic in light of <a class=\"stream-topic\" data-stream-id=\"6\" href=\"/#narrow/stream/6-frontend/topic/mark-as-unread\">#frontend &gt; mark-as-unread</a> and <a href=\"#narrow/stream/65-checkins/topic/wesleyac/near/1204080\">starting to work on this on mobile</a>.</p>\n<p>The big question that I have is whether we should offer the ability to mark individual messages as unread, or if marking a message unread should also mark all later messages unread.</p>\n<p>I'm leaning towards the latter (at the very least, in stream narrows), but I'm open to discussion :)</p>",
        "id": 1204133,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1623178571
    },
    {
        "content": "<p>I think from an API perspective, we absolutely want to support marking a set of messages as unread.</p>",
        "id": 1204135,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623178638
    },
    {
        "content": "<p>But from a UI standpoint, I think \"Mark unread from here\" is what we're most likely to expose to users.</p>",
        "id": 1204137,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623178653
    },
    {
        "content": "<p>Which might also navigate you away from the view to the default view, e.g. in the webapp, moving you to \"Recent topics\", so as to avoid your marking the messages as read soon after through scrolling or whatnot.</p>",
        "id": 1204139,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623178720
    },
    {
        "content": "<p>I think it could be better to just set a flag that stops marking messages in that narrow as read until you navigate away and back, since that seems less confusing than just dropping the user somewhere else.</p>",
        "id": 1204153,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1623178794
    },
    {
        "content": "<p>I think the main use cases for \"mark as unread\" would be handled well by that:</p>\n<ul>\n<li>You clicked into a topic/PM view and realize you want to come back to it later.</li>\n<li>You accidentally marked everything as read in an interleaved view, and want to scroll to where that happened and mark everything in that interleaved view as unread so that you can browser normally.</li>\n</ul>",
        "id": 1204156,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623178808
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"17945\">Wesley Aptekar-Cassels</span> <a href=\"#narrow/stream/101-design/topic/mark.20as.20unread/near/1204153\">said</a>:</p>\n<blockquote>\n<p>I think it could be better to just set a flag that stops marking messages in that narrow as read until you navigate away and back, since that seems less confusing than just dropping the user somewhere else.</p>\n</blockquote>\n<p>Yeah, that is probably the direction we'll go as a near-term v2, which will probably end up being the same flag we use when you're looking at a search or \"Copy link to message\" <code>near:</code> view, with corresponding UI to turn the flag off if desired.</p>",
        "id": 1204157,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623178854
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/zulip/pull/18743\">#18743</a> is worth playing around with now.  I find the jumping-to-recent-topics approach kind of jarring at first.</p>",
        "id": 1204158,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623178880
    },
    {
        "content": "<p>It's possible we should consider better support for \"Views with marking unread disabled\" to be structurally part of this feature.</p>",
        "id": 1204160,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623178927
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> <a href=\"#narrow/stream/101-design/topic/mark.20as.20unread/near/1204160\">said</a>:</p>\n<blockquote>\n<p>It's possible we should consider better support for \"Views with marking unread disabled\" to be structurally part of this feature.</p>\n</blockquote>\n<p>That's where I am leaning.</p>",
        "id": 1204161,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623178948
    },
    {
        "content": "<p>meta: It would help to have a short, cute term for a view that's essentially \"frozen\" in terms of unread status.  I'll use \"frozen\" till somebody suggest something better.</p>",
        "id": 1204168,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623179187
    },
    {
        "content": "<p>If we want to freeze a view, it's conceptually just a simple boolean on <code>MessageListData</code>, correct?  And we just need to make sure all of our scroll handlers respect it.</p>",
        "id": 1204171,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623179310
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"58\">@Steve Howell (showell)</span> we actually have <code>filter.can_mark_messages_read</code> as a property that controls this behavior for search narrows today (without the UI to tell you about the state).</p>",
        "id": 1204175,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623179434
    },
    {
        "content": "<p>Which is already exposed on <code>message_list.current.can_mark_messages_read</code> in some form.</p>",
        "id": 1204176,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623179474
    },
    {
        "content": "<p>I think we'd want the togglable boolean property to live on <code>MessageListView</code> or <code>MessageList</code> -- in that the <code>MessageListData</code> data structures are intended to be something we can preserve when leaving a view in a long-term cache.</p>\n<p>(And rename the <code>filter</code> property to <code>can_mark_messages_read_default</code> or something, to make clear one shouldn't use it directly)</p>",
        "id": 1204179,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623179561
    },
    {
        "content": "<p>Ok, I'll play around with that approach.  (It's pretty easy to stack on top of the go-back-to-RT approach so we can compare/contrast.)</p>",
        "id": 1204201,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623180118
    },
    {
        "content": "<p>While this latter part of discussion has I think focused on the \"what happens when marking unread\" (eg. single or here-onwards as unread), I think it's worth addressing that \"I accidentally marked this read by visiting this narrow\" behavior. While we may work around messages being marked read in certain situations, can we track the \"reading\" process, so that we can simply undo that - on the latest narrow basis, at least, perhaps on a per-message or group-of-messages basis?</p>",
        "id": 1204225,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1623180656
    },
    {
        "content": "<p>Yeah, we're definitely going to do <a href=\"https://github.com/zulip/zulip/pull/10886\">#10886</a> in addition to this.</p>",
        "id": 1204267,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623181768
    },
    {
        "content": "<p>Hmmm, one thought here is that the label in the UI should probably be \"Mark unread\" (rather than \"Mark as unread\"), as is the convention in other apps (Slack, Discord, etc).</p>",
        "id": 1204462,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1623193964
    },
    {
        "content": "<p>Sure, or possibly \"Mark unread from here\" if needed to clarify that it's not just this message being marked as read.</p>",
        "id": 1204507,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623195860
    },
    {
        "content": "<p>We can sweat those details later.  BTW it won’t be quite at the top of the actions menu permanently.  But maybe second, if it hits a chord during test deployments?</p>",
        "id": 1204510,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623195980
    },
    {
        "content": "<p>I was thinking Third (and we should move Collapse to second-to-last, since that's probably the worst position).</p>",
        "id": 1204513,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623196145
    },
    {
        "content": "<p>I would definitely put the collapse feature in the category of “infrequently used but still important”.</p>",
        "id": 1204548,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623197726
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> <a href=\"#narrow/stream/101-design/topic/mark.20as.20unread/near/1204160\">said</a>:</p>\n<blockquote>\n<p>It's possible we should consider better support for \"Views with marking unread disabled\" to be structurally part of this feature.</p>\n</blockquote>\n<p><a href=\"https://github.com/zulip/zulip/pull/18743\">#18743</a> now keeps you in the same view, which is much less jarring.  To add polish, I think we just need a banner that above the view with a button that lets you go back into read mode.  <span class=\"user-mention\" data-user-id=\"19257\">@Alya Abbott</span> Do we have somebody working on making reading-prevented views more obvious?</p>",
        "id": 1204923,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623240619
    },
    {
        "content": "<p>For testing you can type \"N\" to resume reading.</p>",
        "id": 1204967,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623245109
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"58\">Steve Howell (showell)</span> <a href=\"#narrow/stream/101-design/topic/mark.20as.20unread/near/1204158\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://github.com/zulip/zulip/pull/18743\">#18743</a> is worth playing around with now.  I find the jumping-to-recent-topics approach kind of jarring at first.</p>\n</blockquote>\n<p>I'm making an executive decision that jumping-to-recent-topics is definitely not the way to go here, so I squashed out any relic of that experiment.</p>",
        "id": 1205067,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623248617
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"19257\">@Alya Abbott</span> <a href=\"https://github.com/zulip/zulip/pull/18743\">#18743</a> is an early prototype for mark-as-unread.  It's still pretty raw, but it's functional at this point for a single client, if you want to play around with it a bit. You can use \"m\" to mark-as-unread-from-here and \"N\" to resume reading.  There's also an option in the message actions menu.</p>",
        "id": 1205074,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623251188
    },
    {
        "content": "<p>Cool, I'll play around with it!</p>",
        "id": 1205099,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1623252221
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"58\">Steve Howell (showell)</span> <a href=\"#narrow/stream/101-design/topic/mark.20as.20unread/near/1204923\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> <a href=\"#narrow/stream/101-design/topic/mark.20as.20unread/near/1204160\">said</a>:</p>\n<blockquote>\n<p>It's possible we should consider better support for \"Views with marking unread disabled\" to be structurally part of this feature.</p>\n</blockquote>\n<p><a href=\"https://github.com/zulip/zulip/pull/18743\">#18743</a> now keeps you in the same view, which is much less jarring.  To add polish, I think we just need a banner that above the view with a button that lets you go back into read mode.  <span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> Do we have somebody working on making reading-prevented views more obvious?</p>\n</blockquote>\n<p>Not yet; I'll write up an issue to cover this and <a href=\"#narrow/stream/9-issues/topic/Unread.20message.20count.20stuck/near/1203379\">the search situation</a>.</p>",
        "id": 1205102,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1623252329
    },
    {
        "content": "<p>Hm, looks like I can get weird behavior when marking as unread and then using \"N\". If I mark a bunch of messages as unread, scroll down, press \"N\", and then scroll down some more, messages above (which I can't see) get marked as read again.</p>",
        "id": 1205140,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1623253834
    },
    {
        "content": "<p>Also, more of a question: is there a reason the selected message jumps down one when I press \"N\"?</p>",
        "id": 1205143,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1623253933
    },
    {
        "content": "<p>Did you mean to say “marking as unread”?</p>",
        "id": 1205155,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623254519
    },
    {
        "content": "<p>Yeah, sorry! Fixed above.</p>",
        "id": 1205156,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1623254601
    },
    {
        "content": "<p>The jump-down-one is just feedback that you have implicitly read the current message.  We can turn that off once we have a better way to indicate a message view is locked for reading.</p>",
        "id": 1205167,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623254712
    },
    {
        "content": "<p>How are you observing that the messages you can’t see are becoming “read” again?</p>",
        "id": 1205178,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623254803
    },
    {
        "content": "<p>By looking at the unread count in the left sidebar.</p>",
        "id": 1205181,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1623254965
    },
    {
        "content": "<p>I think this might be the normal behavior.</p>",
        "id": 1205182,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623255020
    },
    {
        "content": "<p>All the N key really does is flip a Boolean to let the normal code work again.</p>",
        "id": 1205183,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623255103
    },
    {
        "content": "<p>The glitch might be in the transition, I suppose.</p>",
        "id": 1205184,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623255152
    },
    {
        "content": "<p>It might be a funky behavior unrelated to this feature that normally doesn't come up. I'm not sure how to end up in the appropriate state to test it.</p>",
        "id": 1205186,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1623255247
    },
    {
        "content": "<p>I think the trickiest things here are gonna be related to the selected message…</p>",
        "id": 1205188,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623255392
    },
    {
        "content": "<p>When we mark it as unread, I currently move the selection up one (if possible), so you can clearly see that it’s now “unread”.</p>",
        "id": 1205189,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623255464
    },
    {
        "content": "<p>Our current UI doesn’t really have a good way to show that a message is selected, yet still unread….</p>",
        "id": 1205191,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623255511
    },
    {
        "content": "<p>…because that combo is impossible and nonsensical in our current UI.</p>",
        "id": 1205192,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623255546
    },
    {
        "content": "<p>…and I am not sure it should ever be allowed, except in the edge case of a single-message narrow or when you are at top message</p>",
        "id": 1205193,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623255644
    },
    {
        "content": "<p>I also think there may be some logic that when we hit “m”, instead of making the current message be the first unread, make it instead be the last read.</p>",
        "id": 1205196,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623255759
    },
    {
        "content": "<p>(And likewise for the action menu)</p>",
        "id": 1205198,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623255836
    },
    {
        "content": "<p>Another thought process would just be to embrace the notion of an unread selected message as a possibility and figure out how to render it.  But I think I prefer the previous line of thinking.</p>",
        "id": 1205201,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623255992
    },
    {
        "content": "<p>clearly zulip should incorporate eye-tracking technology ;)</p>",
        "id": 1205203,
        "sender_full_name": "Ken Clary",
        "timestamp": 1623256374
    },
    {
        "content": "<p>So the reason it's ugly if a message is both selected and unread is that we show selection by the entire border and we show unreadness with the left border, and it looks like this ugliness if both are true:</p>\n<p><a href=\"/user_uploads/2/21/MpeO6xOQc4H9E_53LqDN2bC7/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/21/MpeO6xOQc4H9E_53LqDN2bC7/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/21/MpeO6xOQc4H9E_53LqDN2bC7/image.png\"></a></div>",
        "id": 1205217,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623257693
    },
    {
        "content": "<p>...but I think an easy solution to this is if a message goes into the newly-possible selected-but-unread state, we can just eliminate the left border effect, and then change the entire selection border to be the green color that we use for unreadness.  I would want to see it in practice, of course, but I suspect the visual cue will kinda make sense in the mark-as-unread context.</p>",
        "id": 1205218,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623257794
    },
    {
        "content": "<p>Also, after thinking about it more, the go-one-up-when-you-hit-m and go-down-one-when-you-hit-N paradigm is just gonna feel too janky, and the so-called edge case of being at the top of the narrow is actually gonna be fairly common.</p>",
        "id": 1205222,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623258301
    },
    {
        "content": "<p>Another thing that I'd like feedback from <span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> on (and others):</p>\n<p>When we go into the cannot-read mode after hitting \"m\", I wanted some way to show that the view is in that mode.  I decided that a subtle but effective way to show that was to change the left-border-color for unread messages.  But I don't want the current red color I prototyped, which is literally HTML \"red\".  If you like this approach, then we need a better color here.  I think the red family is good, but a nicer shade of red.</p>\n<p>It's also possible that we should indicate the view's cannot-read-ness in some other way too.  If we can put some banner on the top, that will also allow us to go back into can-actually-read mode without knowing about the \"N\" key.  The banner could say something like \"Click to begin marking messages as read again\" (but better wording).</p>",
        "id": 1205224,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623258518
    },
    {
        "content": "<p><del>It's also possible that we should just let any motion key from the keyboard put you back into read mode.  And then maybe allow scrolling to also put you into read mode, after a few hundred milliseconds or something.</del></p>",
        "id": 1205227,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623258662
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"58\">Steve Howell (showell)</span> <a href=\"#narrow/stream/101-design/topic/mark.20as.20unread/near/1205227\">said</a>:</p>\n<blockquote>\n<p>It's also possible that we should just let any motion key from the keyboard put you back into read mode.  And then maybe allow scrolling to also put you into read mode, after a few hundred milliseconds or something.</p>\n</blockquote>\n<p>I'm kinda not crazy about this idea, since you may actually want to keep reading down the feed while still keeping the messages unread.</p>",
        "id": 1205232,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623258858
    },
    {
        "content": "<p>Here are my design goals.  After I hit \"m\"...</p>\n<ul>\n<li>I should see pretty clearly that the desired messages have become unread.</li>\n<li>I should be able to know that I'm now in a mode where I can read messages without updating the read-ness of messages.</li>\n<li>I should be able to get back into a normal mode easily.</li>\n</ul>",
        "id": 1205234,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623258972
    },
    {
        "content": "<blockquote>\n<p>…because that combo is impossible and nonsensical in our current UI.</p>\n</blockquote>\n<p>Doesn't this happen already in a search narrow?</p>",
        "id": 1205239,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1623259326
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"17945\">Wesley Aptekar-Cassels</span> <a href=\"#narrow/stream/101-design/topic/mark.20as.20unread/near/1205239\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>…because that combo is impossible and nonsensical in our current UI.</p>\n</blockquote>\n<p>Doesn't this happen already in a search narrow?</p>\n</blockquote>\n<p>Hrm, probably.  And it probably looks ugly.</p>",
        "id": 1205247,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623259647
    },
    {
        "content": "<p>Yeah, it happens in a search narrow today and is a bit ugly.</p>",
        "id": 1205660,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1623283346
    },
    {
        "content": "<p>I am gonna try to fix that tomorrow.  Both as prep for the upcoming feature and for the current views.</p>",
        "id": 1205663,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623283652
    },
    {
        "content": "<p>The red color didn't connect to a special property about the view for me... Perhaps it's train-able, but I think we may need a more explicit (banner) approach.</p>",
        "id": 1205669,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1623284285
    },
    {
        "content": "<p>Yup</p>",
        "id": 1205671,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623284651
    },
    {
        "content": "<p>I filed <a href=\"https://github.com/zulip/zulip/pull/18768\">#18768</a> for the banner. I'm not sure about the wording either; happy to take suggestions. The draft wording in the issue is:  <code>Switch to marking viewed messages as read?</code>, with a <code>Yes</code> button.</p>",
        "id": 1205681,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1623285556
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"19257\">@Alya Abbott</span> Do you have time to give <a href=\"https://github.com/zulip/zulip/pull/18743\">#18743</a> another look? (I've made a few changes.)</p>",
        "id": 1206034,
        "sender_full_name": "Steve Howell",
        "timestamp": 1623343895
    },
    {
        "content": "<p>I have a meeting starting now, but I can take a look in a couple of hours -- thanks!</p>",
        "id": 1206060,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1623344460
    },
    {
        "content": "<p>I like not having the message selection move around. What else should I pay attention to?</p>",
        "id": 1206536,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1623360375
    },
    {
        "content": "<p>FYI <span class=\"user-mention\" data-user-id=\"58\">@Steve Howell (showell)</span> I just got back to <a href=\"https://github.com/zulip/zulip-mobile/pull/4790\">#M4790</a>, which adds support for the mark as unread API to mobile — I'm curious how much work you think it'd be to pick back up <a href=\"https://github.com/zulip/zulip/pull/19307\">#19307</a> / <a href=\"https://github.com/zulip/zulip/pull/18743\">#18743</a></p>",
        "id": 1328925,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1644928013
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"17945\">@Wesley Aptekar-Cassels</span> I am not gonna have any time to focus on mark-as-unread this week, but I can try to answer quick questions.  It seems that <a href=\"https://github.com/zulip/zulip/pull/19307\">#19307</a>, which is the backend piece for mark-as-unread, is in reasonably good shape as far as mobile testing goes.  I think if you apply that to your server, you should be able to mostly pick up where you left off earlier.  (The APIs may change in some ways once I get back into it, but I don't think any of the remaining  changes should be super disruptive.)</p>",
        "id": 1328948,
        "sender_full_name": "Steve Howell",
        "timestamp": 1644932516
    },
    {
        "content": "<p>The other PR is  <a href=\"https://github.com/zulip/zulip/pull/18743\">#18743</a>, which is the webapp UI piece.  I suppose that piece can be helpful for mobile development, but is it an actual blocker for you?</p>",
        "id": 1328950,
        "sender_full_name": "Steve Howell",
        "timestamp": 1644932618
    },
    {
        "content": "<p>Yeah, I tested <a href=\"https://github.com/zulip/zulip-mobile/pull/4790\">#M4790</a> by spinning up a server running <a href=\"https://github.com/zulip/zulip/pull/18743\">#18743</a>, which seemed to work fine — I'm not blocked on anything, I just wanted to let you know that I'd picked up the mobile work again, so we can coordinate about when we want to try to get the server side of things merged.</p>",
        "id": 1328953,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1644932727
    },
    {
        "content": "<p>Our plans around that are also relevant to whether I should start working on the mark as unread UI on mobile once <a href=\"https://github.com/zulip/zulip-mobile/pull/4790\">#M4790</a> is merged (which I expect should happen soon), or whether it'll make more sense to put that on hold for the moment.</p>",
        "id": 1328956,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1644932912
    },
    {
        "content": "<p>(I guess it's likely that this will be a post-5.0 thing — I haven't caught up on the planning for the release cycle yet, so I'm missing some context there)</p>",
        "id": 1328960,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1644933041
    },
    {
        "content": "<p>I'm glad you're not blocked.  I am definitely kinda tied up until we release 5.0, and I think it's 99% decided that mark-as-unread won't make it into that release, but I am definitely hoping to turn my attention back to it as soon as I can, especially if you're also active on it.</p>\n<p>Feel free to ping me weekly or so.</p>",
        "id": 1328981,
        "sender_full_name": "Steve Howell",
        "timestamp": 1644933898
    },
    {
        "content": "<p>Some of the things that was holding up mark-as-unread last summer were UI details related to the blue box and green left borders in the message feed, and we didn't have a full-time designer then.  Now we're making more progress on that, which is good.</p>",
        "id": 1328982,
        "sender_full_name": "Steve Howell",
        "timestamp": 1644934040
    },
    {
        "content": "<p>That's reasonable, sounds good <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span> </p>\n<p>One thing to consider — if the API + just the part of the JS that handle receiving \"mark as unread\" messages is easy to merge, getting that into 5.0 would mean that selfhosters would have mark-as-unread in mobile on 5.0, which could be nice. But it also seems totally fine not to do that, I understand that you're quite busy :)</p>",
        "id": 1328991,
        "sender_full_name": "Wesley Aptekar-Cassels",
        "timestamp": 1644934573
    },
    {
        "content": "<p>I think the main thing this needs attention on is the details of how we encode the new information in the API; <span class=\"user-mention\" data-user-id=\"17945\">@Wesley Aptekar-Cassels</span> want to bump and summarize the <a class=\"stream\" data-stream-id=\"378\" href=\"/#narrow/stream/378-api-design\">#api design</a> thread related to that?</p>",
        "id": 1333135,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1645577542
    },
    {
        "content": "<p>There is a design question about the \"mark as an unread\" feature that would be great to get some feedback on.</p>\n<p>The question is how the feature should interact with the <code>n</code> navigation key. In particular, if we do nothing special, you can have the following experience:</p>\n<ol>\n<li>Go to a topic and mark messages in it as unread.</li>\n<li>Use <code>n</code> to navigate to the next unread topic in the same stream.</li>\n<li>Use <code>n</code> again.  Since <code>n</code> cycles through topics, if you were on the last unread topic, you're now back to the topic in step (1). The messages you just marked as unread are now read again <span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span></li>\n</ol>",
        "id": 1355596,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1648591927
    },
    {
        "content": "<p>Here's a possible proposal:</p>\n<ol>\n<li><code>n</code> should skip over topics that had any messages in them marked as unread until you navigate away from the stream. This would apply in you mark as unread from a stream or topic view.</li>\n<li><code>p</code> would work just like <code>n</code>.</li>\n<li>We wouldn't do anything special if you mark as unread from <code>All messages</code>.</li>\n</ol>\n<p>Thoughts?</p>\n<p>CC <span class=\"user-mention\" data-user-id=\"58\">@Steve Howell (showell)</span></p>",
        "id": 1355600,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1648592047
    },
    {
        "content": "<p>It's probably as simple as that.</p>",
        "id": 1355609,
        "sender_full_name": "Steve Howell",
        "timestamp": 1648592326
    },
    {
        "content": "<blockquote>\n<p><code>p</code> would work just like <code>n</code>.</p>\n</blockquote>\n<p>Hm, I just realized that we should be more explicit with this one, since it's not totally obvious what it means (i.e. what's the equivalent of a stream?). I guess we should keep track of what's being skipped until you navigate away from PMs?</p>",
        "id": 1355619,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1648592715
    },
    {
        "content": "<p>I think it's that simple, but I might have questions when I get more into the weeds of it.</p>",
        "id": 1355624,
        "sender_full_name": "Steve Howell",
        "timestamp": 1648592974
    },
    {
        "content": "<p>Sounds good!</p>",
        "id": 1355627,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1648593000
    },
    {
        "content": "<p>Replacing the blue box with a <a href=\"/user_uploads/2/7a/JcY2g1hMa8cGFJ_0lkM5_O39/green-box.gif\">green box</a> for unread messages is pretty jarring, both when this temporarily occurs while Zulip loads with at least one new message, and when browsing a view that doesn’t mark messages read.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/7a/JcY2g1hMa8cGFJ_0lkM5_O39/green-box.gif\" title=\"green box\"><img src=\"/user_uploads/2/7a/JcY2g1hMa8cGFJ_0lkM5_O39/green-box.gif\"></a></div>",
        "id": 1424098,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1661323746
    },
    {
        "content": "<p>Hmm, yeah, that's kind of weird. I guess we already have this situation when looking at a search view that has a mix of read and unread messages, but \"mark as unread\" makes it more prominent.</p>",
        "id": 1424215,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661356081
    },
    {
        "content": "<p>The green box matches the green bar on the left, but I don't think it's particularly obvious what it means. It's possible we'd be OK not having any indication that messages aren't being marked as read until you get to the bottom and see the banner.</p>",
        "id": 1424299,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661364817
    },
    {
        "content": "<p>But CC  <span class=\"user-mention\" data-user-id=\"22433\">@Vlad Korobov</span> for thinking about if/how we should represent the \"messages are not being marked as read\" state in the new design</p>",
        "id": 1424300,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661364846
    },
    {
        "content": "<p>This is not being used to indicate “messages are not being marked as read”. It’s indicating “<em>this</em> message is unread”.</p>",
        "id": 1424405,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1661368901
    },
    {
        "content": "<p>I don’t see why we need that to be a different indicator than the one we already have to indicate that any other message is unread.</p>",
        "id": 1424407,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1661368937
    },
    {
        "content": "<p>Oh, I see. Yeah, OK, I agree with that.</p>",
        "id": 1424412,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661368991
    },
    {
        "content": "<p>It’s even more jarring when a <a href=\"/user_uploads/2/5b/sHa9JWNeIThShJ2Syy9VbqlF/date-divider.gif\">date divider</a> is involved.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/5b/sHa9JWNeIThShJ2Syy9VbqlF/date-divider.gif\" title=\"date divider\"><img src=\"/user_uploads/2/5b/sHa9JWNeIThShJ2Syy9VbqlF/date-divider.gif\"></a></div>",
        "id": 1424423,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1661369409
    },
    {
        "content": "<p>I filed <strong>Remove special coloring for message selection box on unread messages</strong> <a href=\"https://github.com/zulip/zulip/pull/22783\">#22783</a>.</p>",
        "id": 1424461,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661370657
    },
    {
        "content": "<p>This is not an issue in <code>main</code>. It’s part of <a href=\"https://github.com/zulip/zulip/pull/21477\">#21477</a>, which is currently deployed here as a <a href=\"#narrow/stream/415-chat.2Ezulip.2Eorg/topic/experiments/near/1423302\">chat.zulip.org experiment</a>.</p>",
        "id": 1424500,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1661371769
    },
    {
        "content": "<p>Yeah I was not convinced by that commit; we can just drop it from the pull request when we're next updating it.</p>",
        "id": 1424616,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661378903
    },
    {
        "content": "<p>Any other thoughts on \"mark as unread\"? One thing on my mind is that we haven't really discussed the choice of icon:</p>\n<p><a href=\"/user_uploads/2/23/Ltbr1M9xnqqrOLmDltMYRBKZ/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/23/Ltbr1M9xnqqrOLmDltMYRBKZ/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/23/Ltbr1M9xnqqrOLmDltMYRBKZ/image.png\"></a></div>",
        "id": 1424617,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661378940
    },
    {
        "content": "<p>I don't think an envelope is either intuitive or consistent with the icon choices we use elsewhere; usually envelope means private message right now.</p>",
        "id": 1424618,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661378974
    },
    {
        "content": "<p>The <code>m</code> shortcut key doesn’t seem to do anything.</p>",
        "id": 1424619,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1661379133
    },
    {
        "content": "<p>(Also why <code>m</code>? I’d expect the operative word to be <strong>u</strong>nread.)</p>",
        "id": 1424623,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1661379289
    },
    {
        "content": "<p>Ok, trying it on CZO, it seem that the shortcut is actually <code>SHIFT+U</code> in the current implementation, so that <code>(m)</code> is just incorrect.</p>",
        "id": 1424624,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661379475
    },
    {
        "content": "<p>The envelope matches Gmail (<a href=\"https://support.google.com/mail/answer/12516?hl=en&amp;co=GENIE.Platform%3DAndroid\">https://support.google.com/mail/answer/12516?hl=en&amp;co=GENIE.Platform%3DAndroid</a>), but I agree that we cannot use it both here and for PMs.</p>",
        "id": 1424625,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661379550
    },
    {
        "content": "<p>A chat bubble with an unread dot in the upper right seems to be common as a \"mark as unread\" icon:</p>\n<p><a href=\"/user_uploads/2/13/p5hHlNtylpSO5J3kr87ni4Xm/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/13/p5hHlNtylpSO5J3kr87ni4Xm/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/13/p5hHlNtylpSO5J3kr87ni4Xm/image.png\"></a></div>",
        "id": 1424631,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661379855
    },
    {
        "content": "<p><a href=\"/user_uploads/2/b1/MdO06gtg2FuzWDpBD9Ux473D/Screen-Shot-2022-08-24-at-3.25.08-PM.png\">Screen-Shot-2022-08-24-at-3.25.08-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/b1/MdO06gtg2FuzWDpBD9Ux473D/Screen-Shot-2022-08-24-at-3.25.08-PM.png\" title=\"Screen-Shot-2022-08-24-at-3.25.08-PM.png\"><img src=\"/user_uploads/2/b1/MdO06gtg2FuzWDpBD9Ux473D/Screen-Shot-2022-08-24-at-3.25.08-PM.png\"></a></div>",
        "id": 1424632,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661379919
    },
    {
        "content": "<p>Marking any message as unread seems to put me into a permanent “To preserve your reading state, this view does not mark messages as read” state. Although clicking “Mark as read” hides that banner, new messages that show up later remain unread and the banner comes back.</p>",
        "id": 1424636,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1661380044
    },
    {
        "content": "<p>Yeah, <span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> and I were chatting about that behavior yesterday... It's also how search views work, though it may come up less often in that context.</p>\n<p>Arguably, clicking \"Mark as read\" should remove the special \"not marking messages as read\" state.</p>",
        "id": 1424639,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661380374
    },
    {
        "content": "<p>Yeah, I wanted to see how folks feel about it -- having that behavior persist past clicking \"Mark as read\" seemed wrong to me.</p>",
        "id": 1424642,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661380541
    },
    {
        "content": "<p>It makes sense that it would persist when it’s a property of the view, but not when it’s a result of an action.</p>",
        "id": 1424643,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1661380590
    },
    {
        "content": "<p>The concern with \"mark as unread\" not putting your view into that state is that it's pretty likely you'll accidentally mark it as read again, at least if the bottom whitespace is in view (where scrolling will do that).</p>",
        "id": 1424645,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661380607
    },
    {
        "content": "<p>I'm confused by all that sorry.<br>\nIf we are starting to have ability to mark messages individually as read and unread the \"scroll to mark as read\" makes it not that great. So I guess  how scroll behaves if it still mark messages as read is a question.<br>\nI don't think that manual switch on a message should put it in a some special category to be excluded from the general rule of marking messages as read.</p>",
        "id": 1424858,
        "sender_full_name": "Vlad Korobov",
        "timestamp": 1661392395
    },
    {
        "content": "<p>Let me summarize my understanding of views that do not mark messages as read:</p>\n<h2>How they work</h2>\n<p>- In some views, messages don't get marked as read.<br>\n   - At the bottom of such a view, if there are any unread messages, the user sees a banner that allows them to mark all messages in the current view as read:<br>\n<a href=\"/user_uploads/2/b3/IA8Hwvgirx-G1Ye4xpZLhCik/Screen-Shot-2022-08-25-at-11.29.12-AM.png\">Screen-Shot-2022-08-25-at-11.29.12-AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/b3/IA8Hwvgirx-G1Ye4xpZLhCik/Screen-Shot-2022-08-25-at-11.29.12-AM.png\" title=\"Screen-Shot-2022-08-25-at-11.29.12-AM.png\"><img src=\"/user_uploads/2/b3/IA8Hwvgirx-G1Ye4xpZLhCik/Screen-Shot-2022-08-25-at-11.29.12-AM.png\"></a></div><p>- Clicking \"Mark as read\" does not change the nature of your view. So, if new messages come in, it still does not get marked as read, and the banner reappears.</p>\n<h2>Where we use them</h2>\n<ul>\n<li><strong>Search views</strong> that aren't equivalent to a stream or topic view.  Used because you may be seeing just a subset of messages in some thread, which makes it not a good way to catch up on the conversation (as opposed to finding some targeted information).</li>\n<li>Views where the user has just <strong>marked messages as unread</strong>, to avoid those messages immediately getting marked as read again.</li>\n<li><strong>\"Near\" message views</strong>. </li>\n</ul>\n<h2>UX questions</h2>\n<p>A few questions that are on my mind; there may be others.</p>\n<ol>\n<li>\n<p>As came up earlier in this thread, should clicking \"Mark as read\" take you out of the \"messages are not being marked as read\" state in some or all of the contexts above?</p>\n</li>\n<li>\n<p>Should there be any kind of visual indicator that messages are not currently being marked as read? Currently, it's not explicitly indicated until you get to the bottom and see the banner.</p>\n</li>\n<li>\n<p>Unlike the other two circumstances, it's not clear to me that \"near\" views not mark messages as read is the right approach. Chatting with <span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span> , the motivation is that otherwise you might accidentally mark higher messages as read without seeing them, by scrolling to the bottom of the message view, which marked all messages in your view as read. But Perhaps a better solution would be to modify that behavior, so that only messages you scrolled past get marked as read? This part also ties into the conversation in <a class=\"stream-topic\" data-stream-id=\"101\" href=\"/#narrow/stream/101-design/topic/navigate.20to.20search.20result\">#design &gt; navigate to search result</a> .</p>\n</li>\n</ol>",
        "id": 1425035,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661453908
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> <a href=\"#narrow/stream/101-design/topic/mark.20as.20unread/near/1424631\">said</a>:</p>\n<blockquote>\n<p>A chat bubble with an unread dot in the upper right seems to be common as a \"mark as unread\" icon:</p>\n<p><a href=\"/user_uploads/2/13/p5hHlNtylpSO5J3kr87ni4Xm/image.png\">image.png</a></p>\n</blockquote>\n<p>Thinking in that direction, our indication for unreads is an unread count pill. We could consider having the icon be an unread count pill. Theoretically it could show the actual number of messages that'd be marked unread, though that may be somewhat awkward it's more than 2 digits for visual space reasons.</p>",
        "id": 1425153,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661466764
    },
    {
        "content": "<p>Generated that in a super hacky way to make this screenshot:</p>\n<p><a href=\"/user_uploads/2/15/2XcmdDTdyjtZQPgyUl_BxEzo/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/15/2XcmdDTdyjtZQPgyUl_BxEzo/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/15/2XcmdDTdyjtZQPgyUl_BxEzo/image.png\"></a></div>",
        "id": 1425158,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661466896
    },
    {
        "content": "<p>Hmm, the color mismatch seems problematic, but if we were using grey symbols in that row it could be not crazy.</p>",
        "id": 1425159,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661466941
    },
    {
        "content": "<p>I suppose one could instead do an unread count pill in blue? Idunno.</p>",
        "id": 1425160,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661467101
    },
    {
        "content": "<p>Yeah, I would try a blue unread pill if we're going in that direction.</p>",
        "id": 1425163,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661467163
    },
    {
        "content": "<p>To summarize, I think we need to make the following set of changes before \"Mark as unread\" can be merged:</p>\n<ol>\n<li>Update the icon. Let's try just a blue unread pill that always shows a <code>1</code> (to avoid issues with large numbers not fitting).</li>\n<li>Correct the keyboard shortcut to <code>U</code>.</li>\n<li>Clicking \"Mark as read\" when the banner is only there because you marked messages as unread should put you in a regular view, where new incoming messages will be marked as read. Other views where we don't mark messages as read should remain as they are; we can keep thinking about those separately.</li>\n</ol>\n<p><span class=\"user-mention\" data-user-id=\"5140\">@Aman (amanagr)</span> would you be up for taking this on?</p>",
        "id": 1427851,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661882460
    },
    {
        "content": "<p>Also, I just noticed:</p>\n<ol start=\"4\">\n<li>Add \"Mark as unread from selected message\" to the <strong>Message actions</strong> section of the <code>?</code> menu. Maybe just below \"React to selected message with <span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span>\"?</li>\n<li>Make the same addition on <a href=\"https://zulip.com/help/keyboard-shortcuts#for-a-selected-message-outlined-in-blue\">https://zulip.com/help/keyboard-shortcuts#for-a-selected-message-outlined-in-blue</a>.</li>\n</ol>",
        "id": 1427861,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661882813
    },
    {
        "content": "<ol start=\"6\">\n<li>We can drop the commits other than <code>mark-unread: Provide basic functionality</code> from the \"mark as unread\" pull request; at least that's the only commit we're testing right now, and I think we removed the others because they didn't work.</li>\n</ol>",
        "id": 1427968,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661888606
    },
    {
        "content": "<p>Aman, feel free to do a new PR starting from that one commit to leave the existing work there if you'd prefer.</p>",
        "id": 1427971,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1661888643
    },
    {
        "content": "<p>Just caught up reading this, and excited to see it partially deployed and being worked on!</p>\n<p>Also interesting to see more discussion around 'not marking unread' narrows in light of my recent thoughts in <a class=\"stream-topic\" data-stream-id=\"2\" href=\"/#narrow/stream/2-general/topic/s.2FS.2Fz.20hotkeys\">#general &gt; s/S/z hotkeys</a> and related topics.</p>\n<p>I've not seen discussion across the topics on this exactly, but in particular it appears that the banner UI and hotkey <span class=\"user-mention silent\" data-user-id=\"58\">Steve Howell (showell)</span> introduced above as a way to get from the not-marking-unread narrow state to regular state would resolve problems czo users didn't like in the test deployment of <a class=\"stream-topic\" data-stream-id=\"101\" href=\"/#narrow/stream/101-design/topic/navigate.20to.20search.20result\">#design &gt; navigate to search result</a>. That is, if the action (and text) for the banner and hotkey was more along the lines of 'go to first unread in this narrow and start marking unread again', one could go from eg. mentions to a near view of a conversation, and use the key/banner to read any unreads there. Is the 'mark as read' in the banner above supposed to represent this action, or just the toggle from not-marking-unread to marking-unread view of the narrow?</p>",
        "id": 1428055,
        "sender_full_name": "Neil Pilgrim (neiljp)",
        "timestamp": 1661892916
    },
    {
        "content": "<p>The \"Mark as read\" banner is the same one we currently use in \"near\" message views and search views; it's only visible if you are already scrolled to the bottom of the view.</p>",
        "id": 1428056,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1661893594
    },
    {
        "content": "<p>What's the behavior of this feature when the user is looking at an interleaved view -- a whole stream, or All Messages, or search results, etc.?</p>\n<p>Does it act on the subsequent messages within the given message's conversation, or the subsequent messages in the current view/narrow, or do something else?</p>",
        "id": 1431146,
        "sender_full_name": "Greg Price",
        "timestamp": 1662508224
    },
    {
        "content": "<p>(I'm working on the mobile side of this feature: <a href=\"https://github.com/zulip/zulip-mobile/pull/5364\">#M5364</a>. We already have the mobile app handling when messages get marked unread through some other client, but the next step is for mobile to offer the UI to mark messages as unread.)</p>",
        "id": 1431147,
        "sender_full_name": "Greg Price",
        "timestamp": 1662508300
    },
    {
        "content": "<p>It works on all subsequent messages matching the view. I think that's the correct behavior for cases like \"Oops I accidentally marked this interleaved view as read, can I undo?\", and I think that's probably the only case I'd expect someone to intentionally use this feature in an interleaved view.</p>",
        "id": 1431148,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1662508307
    },
    {
        "content": "<p>Sounds sensible.</p>",
        "id": 1431149,
        "sender_full_name": "Greg Price",
        "timestamp": 1662508328
    },
    {
        "content": "<p>Do we offer the feature in views like search results where \"I accidentally marked this view as read\" can't happen?</p>",
        "id": 1431150,
        "sender_full_name": "Greg Price",
        "timestamp": 1662508351
    },
    {
        "content": "<p>Huh, playing around with it, I see it in a \"near\" view but not in a search view. Is that intentional?</p>\n<p>But someone familiar with the code would need to answer <span class=\"user-mention silent\" data-user-id=\"2187\">Greg Price</span> 's question. :)</p>",
        "id": 1431496,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1662574404
    },
    {
        "content": "<p><a href=\"/user_uploads/2/9c/DDL2mkbrlQ9-W4dKLjuRZVKz/image.png\">image.png</a> <br>\n<a href=\"/user_uploads/2/34/yRa-dwCtFFvii-yd8Y6qe341/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/9c/DDL2mkbrlQ9-W4dKLjuRZVKz/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/9c/DDL2mkbrlQ9-W4dKLjuRZVKz/image.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/34/yRa-dwCtFFvii-yd8Y6qe341/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/34/yRa-dwCtFFvii-yd8Y6qe341/image.png\"></a></div><p>Narrow windows:<br>\n<a href=\"/user_uploads/2/60/uzdqc7u06sfQruXA9TFs9BqW/image.png\">image.png</a> <br>\n<a href=\"/user_uploads/2/7a/2rlWAmR_BtmCnpyn1le20o99/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/60/uzdqc7u06sfQruXA9TFs9BqW/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/60/uzdqc7u06sfQruXA9TFs9BqW/image.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/7a/2rlWAmR_BtmCnpyn1le20o99/image.png\" title=\"image.png\"><img src=\"/user_uploads/2/7a/2rlWAmR_BtmCnpyn1le20o99/image.png\"></a></div>",
        "id": 1436958,
        "sender_full_name": "Aman (amanagr)",
        "timestamp": 1663366211
    },
    {
        "content": "<p>Do we want to display <code>U</code> or <code>Shift+u</code> as keyboard shortcut?</p>",
        "id": 1436960,
        "sender_full_name": "Aman (amanagr)",
        "timestamp": 1663366245
    },
    {
        "content": "<p>In this setting, it'd be just a capital <code>U</code>. We're migrating the UI towards hinting hotkeys with key icons that are always capital letters with explicit shift keys, but this context isn't one of them and wouldn't be straightforward to change.</p>",
        "id": 1437013,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1663368247
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"5140\">@Aman (amanagr)</span> I think we wanted to color the unread pills in the same blue as the other icons, rather than having the grey background?</p>",
        "id": 1437014,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1663368267
    },
    {
        "content": "<p>Yep, the color needs to match the rest of the options.</p>",
        "id": 1437015,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1663368287
    },
    {
        "content": "<blockquote>\n<p>but this context isn't one of them and wouldn't be straightforward to change.</p>\n</blockquote>\n<p>Sorry, what do you mean by that?</p>",
        "id": 1437017,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1663368386
    },
    {
        "content": "<p>I agree that for now we should stick with <code>U</code> for consistency.</p>",
        "id": 1437018,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1663368410
    },
    {
        "content": "<p>Oh, I just mean redesigning that popover to display keyboard shortcuts differently with <code>shift</code> <code>u</code> as an option would require widening the popover, which might look bad and up being nontrivial; so we shouldn't try to do that in isolation given we have plans to do a more full redesign of the component.</p>",
        "id": 1437061,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1663370856
    },
    {
        "content": "<p>Updated the PR(<a href=\"https://github.com/zulip/zulip/pull/21477\">#21477</a>)</p>\n<p>Some screenshots: <a href=\"/user_uploads/2/59/rw16nPRNtE2mk88QaTp3WY8K/Screenshot-2022-09-18-at-12.51.48-PM.png\">Screenshot-2022-09-18-at-12.51.48-PM.png</a> <a href=\"/user_uploads/2/8c/eBJ_0JrP_4Cg4AEKXbp8tXUK/Screenshot-2022-09-18-at-12.51.30-PM.png\">Screenshot-2022-09-18-at-12.51.30-PM.png</a> <a href=\"/user_uploads/2/2d/_7lgCVlJB_HIWA3Ia56wDF8R/Screenshot-2022-09-18-at-12.51.16-PM.png\">Screenshot-2022-09-18-at-12.51.16-PM.png</a> <a href=\"/user_uploads/2/dc/qCwoqxezOuzU-JMqFGYxAm5_/Screenshot-2022-09-18-at-12.50.58-PM.png\">Screenshot-2022-09-18-at-12.50.58-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/59/rw16nPRNtE2mk88QaTp3WY8K/Screenshot-2022-09-18-at-12.51.48-PM.png\" title=\"Screenshot-2022-09-18-at-12.51.48-PM.png\"><img src=\"/user_uploads/2/59/rw16nPRNtE2mk88QaTp3WY8K/Screenshot-2022-09-18-at-12.51.48-PM.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/8c/eBJ_0JrP_4Cg4AEKXbp8tXUK/Screenshot-2022-09-18-at-12.51.30-PM.png\" title=\"Screenshot-2022-09-18-at-12.51.30-PM.png\"><img src=\"/user_uploads/2/8c/eBJ_0JrP_4Cg4AEKXbp8tXUK/Screenshot-2022-09-18-at-12.51.30-PM.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/2d/_7lgCVlJB_HIWA3Ia56wDF8R/Screenshot-2022-09-18-at-12.51.16-PM.png\" title=\"Screenshot-2022-09-18-at-12.51.16-PM.png\"><img src=\"/user_uploads/2/2d/_7lgCVlJB_HIWA3Ia56wDF8R/Screenshot-2022-09-18-at-12.51.16-PM.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/dc/qCwoqxezOuzU-JMqFGYxAm5_/Screenshot-2022-09-18-at-12.50.58-PM.png\" title=\"Screenshot-2022-09-18-at-12.50.58-PM.png\"><img src=\"/user_uploads/2/dc/qCwoqxezOuzU-JMqFGYxAm5_/Screenshot-2022-09-18-at-12.50.58-PM.png\"></a></div>",
        "id": 1437424,
        "sender_full_name": "Aman (amanagr)",
        "timestamp": 1663486224
    },
    {
        "content": "<p>Addressed the 5 points <a href=\"#narrow/stream/101-design/topic/mark.20as.20unread/near/1427851\">here</a>, thanks Alya!</p>",
        "id": 1437425,
        "sender_full_name": "Aman (amanagr)",
        "timestamp": 1663486530
    },
    {
        "content": "<p>Nice, thanks <span class=\"user-mention silent\" data-user-id=\"5140\">Aman (amanagr)</span> !</p>\n<p>I retested the PR, and the only problem I see is the half-blue shadow on the <code>1</code> in the icon in light mode. (I'm seeing it in the PR itself, not just the above screenshot.)</p>",
        "id": 1437547,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1663562865
    },
    {
        "content": "<p>Ok, fixed, somehow it met the criteria for a bootstrap style and applied a <code>text-shadown</code> on it.</p>",
        "id": 1437643,
        "sender_full_name": "Aman (amanagr)",
        "timestamp": 1663584281
    },
    {
        "content": "<p>I just deployed the updated version of this from the pull request here.</p>",
        "id": 1438468,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1663720929
    },
    {
        "content": "<p>This has now been merged to <code>main</code>! There's still some documentation updates and the like to complete, but I'm really excited that we finally have this as part of the product. (There's also a subtle corner case where you're scrolled up where we can't offer the option right now, but we expect to remove that limitation in the next week or so).</p>",
        "id": 1440363,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1663975598
    },
    {
        "content": "<p>\"Mark as unread\" has been deployed to Zulip Cloud!</p>\n<p>Words of appreciation from the Rust community:</p>\n<p>@_<strong>tmandry|116883</strong> <a href=\"https://rust-lang.zulipchat.com/#narrow/stream/122653-zulip/topic/Mark.20as.20unread.20from.20here/near/302698718\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"19257\">Alya Abbott</span> I just want to express my excitement and gratitude for this feature to the team :) I've been wanting it for a long time!</p>\n</blockquote>",
        "id": 1445796,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1665094598
    },
    {
        "content": "<p>Went to the link while currently not signed in to the Rust org, and clicked on the message actions menu. Should mark as unread be there when signed out? Trying to use it prompts to sign up / login, but all the other actions in the menu that would require being logged in aren't shown.</p>",
        "id": 1446043,
        "sender_full_name": "Cyphase",
        "timestamp": 1665123755
    },
    {
        "content": "<p>Ah, good catch! It should not be shown to logged out users. <span class=\"user-mention\" data-user-id=\"5140\">@Aman (amanagr)</span> would you have a chance to fix this one?</p>",
        "id": 1446046,
        "sender_full_name": "Alya Abbott",
        "timestamp": 1665126999
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/zulip/zulip/pull/23165\">#23165</a></p>",
        "id": 1446060,
        "sender_full_name": "Aman (amanagr)",
        "timestamp": 1665131281
    },
    {
        "content": "<p>Merged, thanks for the quick fix!</p>",
        "id": 1446130,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1665161630
    }
]