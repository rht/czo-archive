[
    {
        "content": "<p>Hi,</p>\n<p>My instance is offline due to SSL renewal issues, I use lets encrypt. Any advice? Isnt this something that should be handled automatically?</p>",
        "id": 1592775,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686708842
    },
    {
        "content": "<p>Have you read <a href=\"https://zulip.readthedocs.io/en/latest/production/ssl-certificates.html#troubleshooting\">https://zulip.readthedocs.io/en/latest/production/ssl-certificates.html#troubleshooting</a> ?</p>",
        "id": 1592776,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1686709034
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"12178\">@Alex Vandiver</span> checking on now.</p>",
        "id": 1592792,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686711491
    },
    {
        "content": "<p>Well it stated what I just said above: Zulip configures automatic renewal for you. As a result, a Zulip server configured with Certbot does not require any ongoing work to maintain a current valid SSL certificate.</p>",
        "id": 1592793,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686711530
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>root@chat:/home/ubuntu#<span class=\"w\"> </span>/usr/bin/certbot<span class=\"w\"> </span>renew\nAnother<span class=\"w\"> </span>instance<span class=\"w\"> </span>of<span class=\"w\"> </span>Certbot<span class=\"w\"> </span>is<span class=\"w\"> </span>already<span class=\"w\"> </span>running.\n</code></pre></div>",
        "id": 1592794,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686711626
    },
    {
        "content": "<p><code>root     2122438  0.9  1.0  79932 41864 ?        Ss   02:59   0:00 /usr/bin/python3 /usr/bin/certbot -q renew</code></p>",
        "id": 1592796,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686711652
    },
    {
        "content": "<p>So kinda thats where the debug stops anyhow.</p>",
        "id": 1592797,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686711737
    },
    {
        "content": "<p>That wedged <code>certbot renew</code> is likely relevant to your failure.</p>",
        "id": 1592802,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1686711846
    },
    {
        "content": "<p>I'd suggest killing it and running <code>/usr/bin/certbot renew</code> again to see what happens.</p>",
        "id": 1592803,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1686711868
    },
    {
        "content": "<p>Will do, tried now an upgrade too, was thinking I was a bit behind. Will do this asap when the upgrade finishes</p>",
        "id": 1592805,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686711943
    },
    {
        "content": "<p>Ok, now we got more info, this is weird!</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>root@chat:/etc/letsencrypt/renewal#<span class=\"w\"> </span>sudo<span class=\"w\"> </span>certbot<span class=\"w\"> </span>delete<span class=\"w\"> </span>--cert-name<span class=\"w\"> </span>chat.uhl.site\nSaving<span class=\"w\"> </span>debug<span class=\"w\"> </span>log<span class=\"w\"> </span>to<span class=\"w\"> </span>/var/log/letsencrypt/letsencrypt.log\n\n-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-\nDeleted<span class=\"w\"> </span>all<span class=\"w\"> </span>files<span class=\"w\"> </span>relating<span class=\"w\"> </span>to<span class=\"w\"> </span>certificate<span class=\"w\"> </span>chat.uhl.site.\n-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-\nroot@chat:/etc/letsencrypt/renewal#<span class=\"w\"> </span>/usr/bin/certbot<span class=\"w\"> </span>renew\nSaving<span class=\"w\"> </span>debug<span class=\"w\"> </span>log<span class=\"w\"> </span>to<span class=\"w\"> </span>/var/log/letsencrypt/letsencrypt.log\n\n-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-\nProcessing<span class=\"w\"> </span>/etc/letsencrypt/renewal/chat.uhlhosting.ch.conf\n-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-\nCert<span class=\"w\"> </span>is<span class=\"w\"> </span>due<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>renewal,<span class=\"w\"> </span>auto-renewing...\nPlugins<span class=\"w\"> </span>selected:<span class=\"w\"> </span>Authenticator<span class=\"w\"> </span>webroot,<span class=\"w\"> </span>Installer<span class=\"w\"> </span>None\nRenewing<span class=\"w\"> </span>an<span class=\"w\"> </span>existing<span class=\"w\"> </span>certificate\nPerforming<span class=\"w\"> </span>the<span class=\"w\"> </span>following<span class=\"w\"> </span>challenges:\nhttp-01<span class=\"w\"> </span>challenge<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>chat.uhlhosting.ch\nUsing<span class=\"w\"> </span>the<span class=\"w\"> </span>webroot<span class=\"w\"> </span>path<span class=\"w\"> </span>/var/lib/zulip/certbot-webroot<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>all<span class=\"w\"> </span>unmatched<span class=\"w\"> </span>domains.\nWaiting<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>verification...\nChallenge<span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>domain<span class=\"w\"> </span>chat.uhlhosting.ch\nhttp-01<span class=\"w\"> </span>challenge<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>chat.uhlhosting.ch\nCleaning<span class=\"w\"> </span>up<span class=\"w\"> </span>challenges\nAttempting<span class=\"w\"> </span>to<span class=\"w\"> </span>renew<span class=\"w\"> </span>cert<span class=\"w\"> </span><span class=\"o\">(</span>chat.uhlhosting.ch<span class=\"o\">)</span><span class=\"w\"> </span>from<span class=\"w\"> </span>/etc/letsencrypt/renewal/chat.uhlhosting.ch.conf<span class=\"w\"> </span>produced<span class=\"w\"> </span>an<span class=\"w\"> </span>unexpected<span class=\"w\"> </span>error:<span class=\"w\"> </span>Some<span class=\"w\"> </span>challenges<span class=\"w\"> </span>have<span class=\"w\"> </span>failed..<span class=\"w\"> </span>Skipping.\nAll<span class=\"w\"> </span>renewal<span class=\"w\"> </span>attempts<span class=\"w\"> </span>failed.<span class=\"w\"> </span>The<span class=\"w\"> </span>following<span class=\"w\"> </span>certs<span class=\"w\"> </span>could<span class=\"w\"> </span>not<span class=\"w\"> </span>be<span class=\"w\"> </span>renewed:\n<span class=\"w\">  </span>/etc/letsencrypt/live/chat.uhlhosting.ch/fullchain.pem<span class=\"w\"> </span><span class=\"o\">(</span>failure<span class=\"o\">)</span>\n\n-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-\n\nAll<span class=\"w\"> </span>renewal<span class=\"w\"> </span>attempts<span class=\"w\"> </span>failed.<span class=\"w\"> </span>The<span class=\"w\"> </span>following<span class=\"w\"> </span>certs<span class=\"w\"> </span>could<span class=\"w\"> </span>not<span class=\"w\"> </span>be<span class=\"w\"> </span>renewed:\n<span class=\"w\">  </span>/etc/letsencrypt/live/chat.uhlhosting.ch/fullchain.pem<span class=\"w\"> </span><span class=\"o\">(</span>failure<span class=\"o\">)</span>\n-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-<span class=\"w\"> </span>-\n<span class=\"m\">1</span><span class=\"w\"> </span>renew<span class=\"w\"> </span>failure<span class=\"o\">(</span>s<span class=\"o\">)</span>,<span class=\"w\"> </span><span class=\"m\">0</span><span class=\"w\"> </span>parse<span class=\"w\"> </span>failure<span class=\"o\">(</span>s<span class=\"o\">)</span>\n\nIMPORTANT<span class=\"w\"> </span>NOTES:\n<span class=\"w\"> </span>-<span class=\"w\"> </span>The<span class=\"w\"> </span>following<span class=\"w\"> </span>errors<span class=\"w\"> </span>were<span class=\"w\"> </span>reported<span class=\"w\"> </span>by<span class=\"w\"> </span>the<span class=\"w\"> </span>server:\n\n<span class=\"w\">   </span>Domain:<span class=\"w\"> </span>chat.uhlhosting.ch\n<span class=\"w\">   </span>Type:<span class=\"w\">   </span>unauthorized\n<span class=\"w\">   </span>Detail:<span class=\"w\"> </span><span class=\"m\">92</span>.222.242.250:<span class=\"w\"> </span>Invalid<span class=\"w\"> </span>response<span class=\"w\"> </span>from\n<span class=\"w\">   </span>http://chat.uhlhosting.ch/.well-known/acme-challenge/xEMPouj6DOojGQD5uEnehBX-lBPPaRlZMXHg79M1tgg:\n<span class=\"w\">   </span><span class=\"m\">404</span>\n\n<span class=\"w\">   </span>To<span class=\"w\"> </span>fix<span class=\"w\"> </span>these<span class=\"w\"> </span>errors,<span class=\"w\"> </span>please<span class=\"w\"> </span>make<span class=\"w\"> </span>sure<span class=\"w\"> </span>that<span class=\"w\"> </span>your<span class=\"w\"> </span>domain<span class=\"w\"> </span>name<span class=\"w\"> </span>was\n<span class=\"w\">   </span>entered<span class=\"w\"> </span>correctly<span class=\"w\"> </span>and<span class=\"w\"> </span>the<span class=\"w\"> </span>DNS<span class=\"w\"> </span>A/AAAA<span class=\"w\"> </span>record<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>that<span class=\"w\"> </span>domain\n<span class=\"w\">   </span>contain<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span>the<span class=\"w\"> </span>right<span class=\"w\"> </span>IP<span class=\"w\"> </span>address.\nroot@chat:/etc/letsencrypt/renewal#\n</code></pre></div>",
        "id": 1592813,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712388
    },
    {
        "content": "<p>The A record is fine, cause it resolves to the IP.</p>",
        "id": 1592816,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712407
    },
    {
        "content": "<p>Have you changed <code>/etc/nginx/sites-available/zulip-enterprise</code> in any way?</p>",
        "id": 1592818,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1686712531
    },
    {
        "content": "<p>Going a bit deeper, I noticed this:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># Directory needed for certbot --webroot to work.</span>\nlocation<span class=\"w\"> </span>/.well-known/acme-challenge/<span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"nb\">alias</span><span class=\"w\"> </span>/var/lib/zulip/certbot-webroot/.well-known/acme-challenge/<span class=\"p\">;</span>\n<span class=\"o\">}</span>\ncertbot<span class=\"w\"> </span><span class=\"o\">(</span>END<span class=\"o\">)</span>\n</code></pre></div>",
        "id": 1592819,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712538
    },
    {
        "content": "<p>No I did not</p>",
        "id": 1592820,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712543
    },
    {
        "content": "<p>Only in past, there were some issues with the number of files, so I had to edit the nginx.conf at the suggestion of your colleagues</p>",
        "id": 1592822,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712572
    },
    {
        "content": "<p>To solve the HIGH RAM usage by NGinx</p>",
        "id": 1592823,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712579
    },
    {
        "content": "<p>Beside that nothing was altered, and I just run a complete upgrade now all worked well.</p>",
        "id": 1592824,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712600
    },
    {
        "content": "<p>The only issue I noticed, is that the alias mentioned in the above cerbot inside zulip-include in nginx, does not exist.</p>",
        "id": 1592825,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712623
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>root@chat:/etc/nginx/zulip-include#<span class=\"w\"> </span><span class=\"nb\">cd</span><span class=\"w\"> </span>/var/lib/zulip/certbot-webroot/.well-known/acme-challenge/\nbash:<span class=\"w\"> </span>cd:<span class=\"w\"> </span>/var/lib/zulip/certbot-webroot/.well-known/acme-challenge/:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory\nroot@chat:/etc/nginx/zulip-include#<span class=\"w\"> </span>ls\napi_headers<span class=\"w\">  </span>app.d<span class=\"w\">    </span>headers<span class=\"w\">  </span>proxy_longpolling<span class=\"w\">  </span>tornado-upstreams<span class=\"w\">  </span>uploads.types\napp<span class=\"w\">          </span>certbot<span class=\"w\">  </span>proxy<span class=\"w\">    </span>s3-cache<span class=\"w\">           </span>trusted-proto<span class=\"w\">      </span>upstreams\n</code></pre></div>",
        "id": 1592827,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712642
    },
    {
        "content": "<p><code>/var/lib/zulip/certbot-webroot</code> should exist, and <code>certbot</code> makes the files it needs under there as it does the challenge.</p>",
        "id": 1592829,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1686712673
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>root@chat:/var/lib/zulip/certbot-webroot#<span class=\"w\"> </span>ls<span class=\"w\"> </span>-latr\ntotal<span class=\"w\"> </span><span class=\"m\">8</span>\ndrwxrwx---<span class=\"w\"> </span><span class=\"m\">3</span><span class=\"w\"> </span>zulip<span class=\"w\"> </span>adm<span class=\"w\"> </span><span class=\"m\">4096</span><span class=\"w\"> </span>Jul<span class=\"w\">  </span><span class=\"m\">3</span><span class=\"w\">  </span><span class=\"m\">2021</span><span class=\"w\"> </span>..\ndrwxrwx---<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"w\"> </span>zulip<span class=\"w\"> </span>adm<span class=\"w\"> </span><span class=\"m\">4096</span><span class=\"w\"> </span>Jun<span class=\"w\"> </span><span class=\"m\">14</span><span class=\"w\"> </span><span class=\"m\">03</span>:12<span class=\"w\"> </span>.\nroot@chat:/var/lib/zulip/certbot-webroot#\n</code></pre></div>",
        "id": 1592830,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712686
    },
    {
        "content": "<p>Is there but empty</p>",
        "id": 1592831,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712691
    },
    {
        "content": "<p>That's normal.</p>",
        "id": 1592832,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1686712698
    },
    {
        "content": "<p>Well you got my complete reply to what certbot renew does</p>",
        "id": 1592835,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712751
    },
    {
        "content": "<p>Never had this issue before, no DNS changes made.</p>",
        "id": 1592836,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712762
    },
    {
        "content": "<p>SO its hard to me to say why is failing</p>",
        "id": 1592839,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712770
    },
    {
        "content": "<p>Nginx is up and working</p>",
        "id": 1592840,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712787
    },
    {
        "content": "<p>Inside the config:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>root@chat:/var/lib/zulip/certbot-webroot#<span class=\"w\"> </span>cat<span class=\"w\"> </span>/etc/letsencrypt/renewal/chat.uhlhosting.ch.conf\n<span class=\"c1\"># renew_before_expiry = 30 days</span>\n<span class=\"nv\">version</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">0</span>.40.0\n<span class=\"nv\">archive_dir</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>/etc/letsencrypt/archive/chat.uhlhosting.ch\n<span class=\"nv\">cert</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>/etc/letsencrypt/live/chat.uhlhosting.ch/cert.pem\n<span class=\"nv\">privkey</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>/etc/letsencrypt/live/chat.uhlhosting.ch/privkey.pem\n<span class=\"nv\">chain</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>/etc/letsencrypt/live/chat.uhlhosting.ch/chain.pem\n<span class=\"nv\">fullchain</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>/etc/letsencrypt/live/chat.uhlhosting.ch/fullchain.pem\n\n<span class=\"c1\"># Options used in the renewal process</span>\n<span class=\"o\">[</span>renewalparams<span class=\"o\">]</span>\n<span class=\"nv\">account</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>2effceb063450d93cbd98f797c4e3193\n<span class=\"nv\">authenticator</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>webroot\n<span class=\"nv\">webroot_path</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>/var/lib/zulip/certbot-webroot,\n<span class=\"nv\">server</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>https://acme-v02.api.letsencrypt.org/directory\n<span class=\"o\">[[</span>webroot_map<span class=\"o\">]]</span>\nchat.uhlhosting.ch<span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span>/var/lib/zulip/certbot-webroot\n</code></pre></div>",
        "id": 1592843,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712885
    },
    {
        "content": "<p>I wonder if this /etc/hosts is fine:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># Your system has configured 'manage_etc_hosts' as True.</span>\n<span class=\"c1\"># As a result, if you wish for changes to this file to persist</span>\n<span class=\"c1\"># then you will need to either</span>\n<span class=\"c1\"># a.) make changes to the master file in /etc/cloud/templates/hosts.debian.tmpl</span>\n<span class=\"c1\"># b.) change or remove the value of 'manage_etc_hosts' in</span>\n<span class=\"c1\">#     /etc/cloud/cloud.cfg or cloud-config from user-data</span>\n<span class=\"c1\">#</span>\n<span class=\"m\">127</span>.0.1.1<span class=\"w\"> </span>chat.uhlhosting.ch<span class=\"w\"> </span>chat\n<span class=\"m\">127</span>.0.0.1<span class=\"w\"> </span>localhost\n\n<span class=\"c1\"># The following lines are desirable for IPv6 capable hosts</span>\n::1<span class=\"w\"> </span>localhost<span class=\"w\"> </span>ip6-localhost<span class=\"w\"> </span>ip6-loopback\nff02::1<span class=\"w\"> </span>ip6-allnodes\nff02::2<span class=\"w\"> </span>ip6-allrouters\n</code></pre></div>",
        "id": 1592844,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712947
    },
    {
        "content": "<p>looks a bit shady to me, why it resolves locally only....</p>",
        "id": 1592845,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712958
    },
    {
        "content": "<p>Yet again, I havent touched that in the long runn</p>",
        "id": 1592846,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686712988
    },
    {
        "content": "<p>Thus, will result in solving the domain locally only, not sure if this is right config. </p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>root@chat:/var/lib/zulip/certbot-webroot#<span class=\"w\"> </span>host<span class=\"w\"> </span>chat.uhlhosting.ch\nchat.uhlhosting.ch<span class=\"w\"> </span>has<span class=\"w\"> </span>address<span class=\"w\"> </span><span class=\"m\">127</span>.0.1.1\n</code></pre></div>",
        "id": 1592847,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686713055
    },
    {
        "content": "<p>I note that <a href=\"http://chat.uhlhosting.ch\">http://chat.uhlhosting.ch</a> (not https) is serving the default nginx welcome page, rather than the expected redirect to https. This is probably related to your problem, since Let’s Encrypt’s HTTP-01 challenge runs over plain http.</p>",
        "id": 1592853,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1686714084
    },
    {
        "content": "<p>It’s not the cause of the problem, to be clear, but it might be a symptom of an nginx misconfiguration that causes the problem.</p>",
        "id": 1592859,
        "sender_full_name": "Anders Kaseorg",
        "timestamp": 1686714386
    },
    {
        "content": "<p>Not sure where to continue with this issue. Hence i did not altered the original configs in nginx.</p>",
        "id": 1592866,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1686715144
    },
    {
        "content": "<p>Any ideas how to solve this issue? Website is down since the certificate expired. And I could not find any issues with nginx is default config from the deployment.</p>",
        "id": 1595326,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687196572
    },
    {
        "content": "<p>Nothing discussed here helped me debug better or solve the issue</p>",
        "id": 1595327,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687196592
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> any ideas on this matter?</p>",
        "id": 1595329,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687196651
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"20576\">@Cosmic Sound</span>: In addition to our <a href=\"https://zulip.com/development-community/#getting-help\">general norm around @-mentioning core contributors</a> <span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span>  is <a href=\"#narrow/stream/65-checkins/topic/Alya/near/1595096\">freshly on parental leave</a>, so @'ing him is doubly not-helpful right now.</p>\n<p>Your <code>/etc/hosts</code> is not relevant, and looks fine.</p>\n<p>This line doesn't appear in my configuration:</p>\n<div class=\"codehilite\"><pre><span></span><code>[renewalparams]\nwebroot_path = /var/lib/zulip/certbot-webroot,\n</code></pre></div>\n<p>So it may be worth removing it and seeing if that fixes anything.  You should also try checking to see if you see the access in the error logs:</p>\n<div class=\"codehilite\"><pre><span></span><code>grep /.well-known/acme-challenge /var/log/nginx/access.log\n</code></pre></div>\n<p>If nothing shows up there after a <code>certbot renew</code>, then it's something with DNS, external firewall, or proxy in front of your host.  If you do see a log line there, then something is misconfigured with nginx or certbot.</p>",
        "id": 1595826,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1687283264
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"12178\">Alex Vandiver</span> <a href=\"#narrow/stream/31-production-help/topic/SSL.20not.20renewing.20automatically.3F/near/1595826\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"20576\">Cosmic Sound</span>: In addition to our <a href=\"https://zulip.com/development-community/#getting-help\">general norm around @-mentioning core contributors</a> <span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span>  is <a href=\"#narrow/stream/65-checkins/topic/Alya/near/1595096\">freshly on parental leave</a>, so @'ing him is doubly not-helpful right now.</p>\n<p>Your <code>/etc/hosts</code> is not relevant, and looks fine.</p>\n<p>This line doesn't appear in my configuration:</p>\n<div class=\"codehilite\"><pre><span></span><code>[renewalparams]\nwebroot_path = /var/lib/zulip/certbot-webroot,\n</code></pre></div>\n<p>So it may be worth removing it and seeing if that fixes anything.  You should also try checking to see if you see the access in the error logs:</p>\n<div class=\"codehilite\"><pre><span></span><code>grep /.well-known/acme-challenge /var/log/nginx/access.log\n</code></pre></div>\n<p>If nothing shows up there after a <code>certbot renew</code>, then it's something with DNS, external firewall, or proxy in front of your host.  If you do see a log line there, then something is misconfigured with nginx or certbot.</p>\n</blockquote>\n<p>I just for the first time in my life, got my issue igored by the staff here and nnot getting to a solution for more than a week now... Disaappoiting, Nothing of the statements here are correct. Nginx config is fine, ccertbot config is fine... The issue is some other stuff you maybe. tackeled in nginx like last. time when whole nginx crashed, do to too many files opened by the process, that caused the whole app to crash every 30 seconds. If one would see what are my support requests for, only such issues. Either are there DNS issues, since DNS is a simple entry for an A linked to the servers IP, that server runs for a few years like that, and no issues of  such kind. Now for almost 2 weeks completely offline. And again, NO help here!</p>",
        "id": 1596182,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687325518
    },
    {
        "content": "<p>I aam out of options, and when the admins that made this, do not have a better way to debug the issues... Dissapointing.</p>",
        "id": 1596183,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687325576
    },
    {
        "content": "<p>Is like someone so vital in solving issues or handling the team is missing, and everyone dissapeared who always in past would help any issues i had. again this is my first issue left to rot for weeks, without any proper help.</p>",
        "id": 1596184,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687325633
    },
    {
        "content": "<p>Tried removing the nginx completely, yet that made more issues, seems nginx is not redeployed as in past by Zulip...:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>System<span class=\"w\"> </span>check<span class=\"w\"> </span>identified<span class=\"w\"> </span>no<span class=\"w\"> </span>issues<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">18</span><span class=\"w\"> </span>silenced<span class=\"o\">)</span>.\n<span class=\"m\">2023</span>-06-21<span class=\"w\"> </span><span class=\"m\">05</span>:50:36,346<span class=\"w\"> </span>upgrade-zulip-stage-2:<span class=\"w\"> </span>Installing<span class=\"w\"> </span>hooks\nNotice:<span class=\"w\"> </span>Compiled<span class=\"w\"> </span>catalog<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>chat.uhlhosting.ch<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>environment<span class=\"w\"> </span>production<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">1</span>.93<span class=\"w\"> </span>seconds\nNotice:<span class=\"w\"> </span>Applied<span class=\"w\"> </span>catalog<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">0</span>.14<span class=\"w\"> </span>seconds\n<span class=\"m\">2023</span>-06-21<span class=\"w\"> </span><span class=\"m\">05</span>:50:47,639<span class=\"w\"> </span>upgrade-zulip-stage-2:<span class=\"w\"> </span>Applying<span class=\"w\"> </span>Puppet<span class=\"w\"> </span>changes...\nNotice:<span class=\"w\"> </span>Compiled<span class=\"w\"> </span>catalog<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>chat.uhlhosting.ch<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>environment<span class=\"w\"> </span>production<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">1</span>.90<span class=\"w\"> </span>seconds\nError:<span class=\"w\"> </span>Cannot<span class=\"w\"> </span>create<span class=\"w\"> </span>/etc/nginx/zulip-include<span class=\"p\">;</span><span class=\"w\"> </span>parent<span class=\"w\"> </span>directory<span class=\"w\"> </span>/etc/nginx<span class=\"w\"> </span>does<span class=\"w\"> </span>not<span class=\"w\"> </span>exist\nError:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>change<span class=\"w\"> </span>from<span class=\"w\"> </span><span class=\"s1\">'absent'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'directory'</span><span class=\"w\"> </span>failed:<span class=\"w\"> </span>Cannot<span class=\"w\"> </span>create<span class=\"w\"> </span>/etc/nginx/zulip-include<span class=\"p\">;</span><span class=\"w\"> </span>parent<span class=\"w\"> </span>directory<span class=\"w\"> </span>/etc/nginx<span class=\"w\"> </span>does<span class=\"w\"> </span>not<span class=\"w\"> </span>exist\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/api_headers<span class=\"o\">]</span>:<span class=\"w\"> </span>Dependency<span class=\"w\"> </span>File<span class=\"o\">[</span>/etc/nginx/zulip-include/<span class=\"o\">]</span><span class=\"w\"> </span>has<span class=\"w\"> </span>failures:<span class=\"w\"> </span><span class=\"nb\">true</span>\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/api_headers<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/certbot<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/headers<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/proxy<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/proxy_longpolling<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nError:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/dhparam.pem20230621-10002-1tp48ai.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/nginx.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">32</span><span class=\"o\">)</span>\nError:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/dhparam.pem20230621-10002-1tp48ai.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/nginx.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">32</span><span class=\"o\">)</span>\nWrapped<span class=\"w\"> </span>exception:\nNo<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/dhparam.pem20230621-10002-1tp48ai.lock\nError:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/dhparam.pem<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>change<span class=\"w\"> </span>from<span class=\"w\"> </span><span class=\"s1\">'absent'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>failed:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/dhparam.pem20230621-10002-1tp48ai.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/nginx.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">32</span><span class=\"o\">)</span>\nError:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/nginx.conf20230621-10002-k1m0ug.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/nginx.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">48</span><span class=\"o\">)</span>\nError:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/nginx.conf20230621-10002-k1m0ug.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/nginx.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">48</span><span class=\"o\">)</span>\nWrapped<span class=\"w\"> </span>exception:\nNo<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/nginx.conf20230621-10002-k1m0ug.lock\nError:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/nginx.conf<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>change<span class=\"w\"> </span>from<span class=\"w\"> </span><span class=\"s1\">'absent'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>failed:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/nginx.conf20230621-10002-k1m0ug.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/nginx.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">48</span><span class=\"o\">)</span>\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/trusted-proto<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nError:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/uwsgi_params20230621-10002-3ospmj.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/nginx.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">69</span><span class=\"o\">)</span>\nError:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/uwsgi_params20230621-10002-3ospmj.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/nginx.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">69</span><span class=\"o\">)</span>\nWrapped<span class=\"w\"> </span>exception:\nNo<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/uwsgi_params20230621-10002-3ospmj.lock\nError:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/uwsgi_params<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>change<span class=\"w\"> </span>from<span class=\"w\"> </span><span class=\"s1\">'absent'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>failed:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/uwsgi_params20230621-10002-3ospmj.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/nginx.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">69</span><span class=\"o\">)</span>\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Tornado_sharding/File<span class=\"o\">[</span>/etc/nginx/zulip-include/tornado-upstreams<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/app<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/uploads.types<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/app.d/<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/upstreams<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/app.d/uploads-internal.conf<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/uploads.route<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/app.d/thumbor.conf<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/s3-cache<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nError:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/sites-available/zulip-enterprise20230621-10002-qyayv3.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/profile/app_frontend.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">17</span><span class=\"o\">)</span>\nError:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/sites-available/zulip-enterprise20230621-10002-qyayv3.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/profile/app_frontend.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">17</span><span class=\"o\">)</span>\nWrapped<span class=\"w\"> </span>exception:\nNo<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/sites-available/zulip-enterprise20230621-10002-qyayv3.lock\nError:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Profile::App_frontend/File<span class=\"o\">[</span>/etc/nginx/sites-available/zulip-enterprise<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>change<span class=\"w\"> </span>from<span class=\"w\"> </span><span class=\"s1\">'absent'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>failed:<span class=\"w\"> </span>Could<span class=\"w\"> </span>not<span class=\"w\"> </span><span class=\"nb\">set</span><span class=\"w\"> </span><span class=\"s1\">'file'</span><span class=\"w\"> </span>on<span class=\"w\"> </span>ensure:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span>@<span class=\"w\"> </span>dir_s_mkdir<span class=\"w\"> </span>-<span class=\"w\"> </span>/etc/nginx/sites-available/zulip-enterprise20230621-10002-qyayv3.lock<span class=\"w\"> </span><span class=\"o\">(</span>file:<span class=\"w\"> </span>/home/zulip/deployments/2023-06-21-05-48-24/puppet/zulip/manifests/profile/app_frontend.pp,<span class=\"w\"> </span>line:<span class=\"w\"> </span><span class=\"m\">17</span><span class=\"o\">)</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Profile::App_frontend/File<span class=\"o\">[</span>/etc/nginx/sites-enabled/zulip-enterprise<span class=\"o\">]</span>:<span class=\"w\"> </span>Dependency<span class=\"w\"> </span>File<span class=\"o\">[</span>/etc/nginx/sites-available/zulip-enterprise<span class=\"o\">]</span><span class=\"w\"> </span>has<span class=\"w\"> </span>failures:<span class=\"w\"> </span><span class=\"nb\">true</span>\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Profile::App_frontend/File<span class=\"o\">[</span>/etc/nginx/sites-enabled/zulip-enterprise<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Profile::Redis/File<span class=\"o\">[</span>/run/redis<span class=\"o\">]</span>/mode:<span class=\"w\"> </span>mode<span class=\"w\"> </span>changed<span class=\"w\"> </span><span class=\"s1\">'2755'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'0755'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Profile::Memcached/File<span class=\"o\">[</span>/etc/memcached.conf<span class=\"o\">]</span>/content:<span class=\"w\"> </span>content<span class=\"w\"> </span>changed<span class=\"w\"> </span><span class=\"s1\">'{md5}30003b14bb9c8e994900510fb683b753'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'{md5}09ca19b84d2747c5d8e5a3c513e3a77e'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Profile::Memcached/Service<span class=\"o\">[</span>memcached<span class=\"o\">]</span>:<span class=\"w\"> </span>Triggered<span class=\"w\"> </span><span class=\"s1\">'refresh'</span><span class=\"w\"> </span>from<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span>event\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Localhost_camo/File<span class=\"o\">[</span>/etc/nginx/zulip-include/app.d/camo.conf<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/Service<span class=\"o\">[</span>nginx<span class=\"o\">]</span>:<span class=\"w\"> </span>Dependency<span class=\"w\"> </span>File<span class=\"o\">[</span>/etc/nginx/dhparam.pem<span class=\"o\">]</span><span class=\"w\"> </span>has<span class=\"w\"> </span>failures:<span class=\"w\"> </span><span class=\"nb\">true</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/Service<span class=\"o\">[</span>nginx<span class=\"o\">]</span>:<span class=\"w\"> </span>Dependency<span class=\"w\"> </span>File<span class=\"o\">[</span>/etc/nginx/nginx.conf<span class=\"o\">]</span><span class=\"w\"> </span>has<span class=\"w\"> </span>failures:<span class=\"w\"> </span><span class=\"nb\">true</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/Service<span class=\"o\">[</span>nginx<span class=\"o\">]</span>:<span class=\"w\"> </span>Dependency<span class=\"w\"> </span>File<span class=\"o\">[</span>/etc/nginx/uwsgi_params<span class=\"o\">]</span><span class=\"w\"> </span>has<span class=\"w\"> </span>failures:<span class=\"w\"> </span><span class=\"nb\">true</span>\nWarning:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/Service<span class=\"o\">[</span>nginx<span class=\"o\">]</span>:<span class=\"w\"> </span>Skipping<span class=\"w\"> </span>because<span class=\"w\"> </span>of<span class=\"w\"> </span>failed<span class=\"w\"> </span>dependencies\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Profile::Postgresql/File<span class=\"o\">[</span>/etc/postgresql/13/main/postgresql.conf<span class=\"o\">]</span>/content:<span class=\"w\"> </span>content<span class=\"w\"> </span>changed<span class=\"w\"> </span><span class=\"s1\">'{md5}44c58050f1d89ac4986471979d46c800'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'{md5}2d3b78c6261621637ea2032ead23243d'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Profile::Postgresql/Exec<span class=\"o\">[</span>pg_ctlcluster<span class=\"w\"> </span><span class=\"m\">13</span><span class=\"w\"> </span>main<span class=\"w\"> </span>restart<span class=\"o\">]</span>:<span class=\"w\"> </span>Triggered<span class=\"w\"> </span><span class=\"s1\">'refresh'</span><span class=\"w\"> </span>from<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span>event\nNotice:<span class=\"w\"> </span>Applied<span class=\"w\"> </span>catalog<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">3</span>.41<span class=\"w\"> </span>seconds\nTraceback<span class=\"w\"> </span><span class=\"o\">(</span>most<span class=\"w\"> </span>recent<span class=\"w\"> </span>call<span class=\"w\"> </span>last<span class=\"o\">)</span>:\n<span class=\"w\">  </span>File<span class=\"w\"> </span><span class=\"s2\">\"/home/zulip/deployments/2023-06-21-05-48-24/scripts/lib/upgrade-zulip-stage-2\"</span>,<span class=\"w\"> </span>line<span class=\"w\"> </span><span class=\"m\">541</span>,<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>&lt;module&gt;\n<span class=\"w\">    </span>subprocess.check_call<span class=\"o\">([</span><span class=\"s2\">\"./scripts/zulip-puppet-apply\"</span>,<span class=\"w\"> </span><span class=\"s2\">\"--force\"</span><span class=\"o\">])</span>\n<span class=\"w\">  </span>File<span class=\"w\"> </span><span class=\"s2\">\"/usr/lib/python3.8/subprocess.py\"</span>,<span class=\"w\"> </span>line<span class=\"w\"> </span><span class=\"m\">364</span>,<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>check_call\n<span class=\"w\">    </span>raise<span class=\"w\"> </span>CalledProcessError<span class=\"o\">(</span>retcode,<span class=\"w\"> </span>cmd<span class=\"o\">)</span>\nsubprocess.CalledProcessError:<span class=\"w\"> </span>Command<span class=\"w\"> </span><span class=\"s1\">'['</span>./scripts/zulip-puppet-apply<span class=\"s1\">', '</span>--force<span class=\"s1\">']'</span><span class=\"w\"> </span>returned<span class=\"w\"> </span>non-zero<span class=\"w\"> </span><span class=\"nb\">exit</span><span class=\"w\"> </span>status<span class=\"w\"> </span><span class=\"m\">2</span>.\n\nZulip<span class=\"w\"> </span>upgrade<span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"nb\">exit</span><span class=\"w\"> </span>code<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"o\">)</span>!\n\nThe<span class=\"w\"> </span>upgrade<span class=\"w\"> </span>process<span class=\"w\"> </span>is<span class=\"w\"> </span>designed<span class=\"w\"> </span>to<span class=\"w\"> </span>be<span class=\"w\"> </span>idempotent,<span class=\"w\"> </span>so<span class=\"w\"> </span>you<span class=\"w\"> </span>can<span class=\"w\"> </span>retry<span class=\"w\"> </span>after<span class=\"w\"> </span>resolving<span class=\"w\"> </span>whatever<span class=\"w\"> </span>issue<span class=\"w\"> </span>caused<span class=\"w\"> </span>the<span class=\"w\"> </span>failure<span class=\"w\"> </span><span class=\"o\">(</span>there<span class=\"w\"> </span>should<span class=\"w\"> </span>be<span class=\"w\"> </span>a<span class=\"w\"> </span>traceback<span class=\"w\"> </span>above<span class=\"o\">)</span>.<span class=\"w\"> </span>A<span class=\"w\"> </span>log<span class=\"w\"> </span>of<span class=\"w\"> </span>this<span class=\"w\"> </span>installation<span class=\"w\"> </span>is<span class=\"w\"> </span>available<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>/var/log/zulip/upgrade.log\nroot@chat:/etc#\n</code></pre></div>",
        "id": 1596188,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687326771
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>Notice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/certbot<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}09c7ebd534acf8682ae5b4dbc379a6fe'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/headers<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}b7521fb878c4e9562e7d6d68307da2dd'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/proxy<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}f90985bf8084ac0308ac20ddbcab6626'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/proxy_longpolling<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}e32de15d9e2f10be88c07f26a6228675'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/dhparam.pem<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}4328d5f118ce830b50784cc5a8a07ea9'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/nginx.conf<span class=\"o\">]</span>/content:<span class=\"w\"> </span>content<span class=\"w\"> </span>changed<span class=\"w\"> </span><span class=\"s1\">'{md5}d419ab8777e5d98481e17896e260dfe6'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'{md5}d6e491a203f9c32020126666117d0e64'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/zulip-include/trusted-proto<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}86222a85abead946dff1020d472421a6'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/uwsgi_params<span class=\"o\">]</span>/content:<span class=\"w\"> </span>content<span class=\"w\"> </span>changed<span class=\"w\"> </span><span class=\"s1\">'{md5}88ac833ee8ea60904a8b3063fde791de'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'{md5}da8fd9c526d7b6f88b4f5a86d48e87c3'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/nginx/sites-enabled/default<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>removed\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/var/log/nginx<span class=\"o\">]</span>/owner:<span class=\"w\"> </span>owner<span class=\"w\"> </span>changed<span class=\"w\"> </span><span class=\"s1\">'root'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'zulip'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/var/log/nginx<span class=\"o\">]</span>/mode:<span class=\"w\"> </span>mode<span class=\"w\"> </span>changed<span class=\"w\"> </span><span class=\"s1\">'0755'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'0750'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/File<span class=\"o\">[</span>/etc/logrotate.d/nginx<span class=\"o\">]</span>/content:<span class=\"w\"> </span>content<span class=\"w\"> </span>changed<span class=\"w\"> </span><span class=\"s1\">'{md5}b29112f9480a70fa7de2729ff39923e2'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'{md5}fc7659fda67d3ba105686f22051cbc28'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Tornado_sharding/File<span class=\"o\">[</span>/etc/nginx/zulip-include/tornado-upstreams<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}b815f5872e622f49041a53fdceac449c'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/app<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}9dcc0f252ca5e11284daef666b64120c'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/uploads.types<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}9454742e6db513bcfb4de4293b02ebab'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/app.d/<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>created\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/upstreams<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}b05f4545653cf611d62beed01db1cdd4'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/app.d/uploads-internal.conf<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}e4cd18fc7450bb6bf9c89df431c87666'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::App_frontend_base/File<span class=\"o\">[</span>/etc/nginx/zulip-include/s3-cache<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}b99eef3c23f23f4633118e49eedeb0d7'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Profile::App_frontend/File<span class=\"o\">[</span>/etc/nginx/sites-available/zulip-enterprise<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}1defc38fb8209121cd3a565185de3c80'</span>\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Profile::App_frontend/File<span class=\"o\">[</span>/etc/nginx/sites-enabled/zulip-enterprise<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>created\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Localhost_camo/File<span class=\"o\">[</span>/etc/nginx/zulip-include/app.d/camo.conf<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>defined<span class=\"w\"> </span>content<span class=\"w\"> </span>as<span class=\"w\"> </span><span class=\"s1\">'{md5}afa3ebd4aa0b4d5856418841c7c656ee'</span>\nError:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/Service<span class=\"o\">[</span>nginx<span class=\"o\">]</span>:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>to<span class=\"w\"> </span>call<span class=\"w\"> </span>refresh:<span class=\"w\"> </span>Systemd<span class=\"w\"> </span>restart<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>nginx<span class=\"w\"> </span>failed!\njournalctl<span class=\"w\"> </span>log<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>nginx:\n--<span class=\"w\"> </span>Logs<span class=\"w\"> </span>begin<span class=\"w\"> </span>at<span class=\"w\"> </span>Tue<span class=\"w\"> </span><span class=\"m\">2022</span>-12-13<span class=\"w\"> </span><span class=\"m\">19</span>:57:07<span class=\"w\"> </span>UTC,<span class=\"w\"> </span>end<span class=\"w\"> </span>at<span class=\"w\"> </span>Wed<span class=\"w\"> </span><span class=\"m\">2023</span>-06-21<span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>UTC.<span class=\"w\"> </span>--\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:41<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Stopping<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:41<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Succeeded.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:41<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Stopped<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">10568</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span><span class=\"o\">[</span>emerg<span class=\"o\">]</span><span class=\"w\"> </span>open<span class=\"o\">()</span><span class=\"w\"> </span><span class=\"s2\">\"/etc/nginx/nginx.conf\"</span><span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">2</span>:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"o\">)</span>\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">10568</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span>configuration<span class=\"w\"> </span>file<span class=\"w\"> </span>/etc/nginx/nginx.conf<span class=\"w\"> </span><span class=\"nb\">test</span><span class=\"w\"> </span>failed\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Control<span class=\"w\"> </span>process<span class=\"w\"> </span>exited,<span class=\"w\"> </span><span class=\"nv\">code</span><span class=\"o\">=</span>exited,<span class=\"w\"> </span><span class=\"nv\">status</span><span class=\"o\">=</span><span class=\"m\">1</span>/FAILURE\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>with<span class=\"w\"> </span>result<span class=\"w\"> </span><span class=\"s1\">'exit-code'</span>.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>to<span class=\"w\"> </span>start<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">10679</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span><span class=\"o\">[</span>emerg<span class=\"o\">]</span><span class=\"w\"> </span>open<span class=\"o\">()</span><span class=\"w\"> </span><span class=\"s2\">\"/etc/nginx/nginx.conf\"</span><span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">2</span>:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"o\">)</span>\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">10679</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span>configuration<span class=\"w\"> </span>file<span class=\"w\"> </span>/etc/nginx/nginx.conf<span class=\"w\"> </span><span class=\"nb\">test</span><span class=\"w\"> </span>failed\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Control<span class=\"w\"> </span>process<span class=\"w\"> </span>exited,<span class=\"w\"> </span><span class=\"nv\">code</span><span class=\"o\">=</span>exited,<span class=\"w\"> </span><span class=\"nv\">status</span><span class=\"o\">=</span><span class=\"m\">1</span>/FAILURE\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>with<span class=\"w\"> </span>result<span class=\"w\"> </span><span class=\"s1\">'exit-code'</span>.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>to<span class=\"w\"> </span>start<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:55:30<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:55:30<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Started<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Stopping<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Succeeded.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Stopped<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">13215</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span><span class=\"o\">[</span>emerg<span class=\"o\">]</span><span class=\"w\"> </span>cannot<span class=\"w\"> </span>load<span class=\"w\"> </span>certificate<span class=\"w\"> </span><span class=\"s2\">\"/etc/ssl/certs/zulip.combined-chain.crt\"</span>:<span class=\"w\"> </span>BIO_new_file<span class=\"o\">()</span><span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span>SSL:<span class=\"w\"> </span>error:02001002:system<span class=\"w\"> </span>library:fopen:No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory:fopen<span class=\"o\">(</span><span class=\"s1\">'/etc/ssl/certs/zulip.combined-chain.crt'</span>,<span class=\"s1\">'r'</span><span class=\"o\">)</span><span class=\"w\"> </span>error:2006D080:BIO<span class=\"w\"> </span>routines:BIO_new_file:no<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"o\">)</span>\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">13215</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span>configuration<span class=\"w\"> </span>file<span class=\"w\"> </span>/etc/nginx/nginx.conf<span class=\"w\"> </span><span class=\"nb\">test</span><span class=\"w\"> </span>failed\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Control<span class=\"w\"> </span>process<span class=\"w\"> </span>exited,<span class=\"w\"> </span><span class=\"nv\">code</span><span class=\"o\">=</span>exited,<span class=\"w\"> </span><span class=\"nv\">status</span><span class=\"o\">=</span><span class=\"m\">1</span>/FAILURE\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>with<span class=\"w\"> </span>result<span class=\"w\"> </span><span class=\"s1\">'exit-code'</span>.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>to<span class=\"w\"> </span>start<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\n\nError:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/Service<span class=\"o\">[</span>nginx<span class=\"o\">]</span>:<span class=\"w\"> </span>Systemd<span class=\"w\"> </span>restart<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>nginx<span class=\"w\"> </span>failed!\njournalctl<span class=\"w\"> </span>log<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>nginx:\n--<span class=\"w\"> </span>Logs<span class=\"w\"> </span>begin<span class=\"w\"> </span>at<span class=\"w\"> </span>Tue<span class=\"w\"> </span><span class=\"m\">2022</span>-12-13<span class=\"w\"> </span><span class=\"m\">19</span>:57:07<span class=\"w\"> </span>UTC,<span class=\"w\"> </span>end<span class=\"w\"> </span>at<span class=\"w\"> </span>Wed<span class=\"w\"> </span><span class=\"m\">2023</span>-06-21<span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>UTC.<span class=\"w\"> </span>--\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:41<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Stopping<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:41<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Succeeded.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:41<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Stopped<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">10568</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span><span class=\"o\">[</span>emerg<span class=\"o\">]</span><span class=\"w\"> </span>open<span class=\"o\">()</span><span class=\"w\"> </span><span class=\"s2\">\"/etc/nginx/nginx.conf\"</span><span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">2</span>:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"o\">)</span>\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">10568</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span>configuration<span class=\"w\"> </span>file<span class=\"w\"> </span>/etc/nginx/nginx.conf<span class=\"w\"> </span><span class=\"nb\">test</span><span class=\"w\"> </span>failed\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Control<span class=\"w\"> </span>process<span class=\"w\"> </span>exited,<span class=\"w\"> </span><span class=\"nv\">code</span><span class=\"o\">=</span>exited,<span class=\"w\"> </span><span class=\"nv\">status</span><span class=\"o\">=</span><span class=\"m\">1</span>/FAILURE\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>with<span class=\"w\"> </span>result<span class=\"w\"> </span><span class=\"s1\">'exit-code'</span>.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:53:48<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>to<span class=\"w\"> </span>start<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">10679</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span><span class=\"o\">[</span>emerg<span class=\"o\">]</span><span class=\"w\"> </span>open<span class=\"o\">()</span><span class=\"w\"> </span><span class=\"s2\">\"/etc/nginx/nginx.conf\"</span><span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">2</span>:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"o\">)</span>\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">10679</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span>configuration<span class=\"w\"> </span>file<span class=\"w\"> </span>/etc/nginx/nginx.conf<span class=\"w\"> </span><span class=\"nb\">test</span><span class=\"w\"> </span>failed\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Control<span class=\"w\"> </span>process<span class=\"w\"> </span>exited,<span class=\"w\"> </span><span class=\"nv\">code</span><span class=\"o\">=</span>exited,<span class=\"w\"> </span><span class=\"nv\">status</span><span class=\"o\">=</span><span class=\"m\">1</span>/FAILURE\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>with<span class=\"w\"> </span>result<span class=\"w\"> </span><span class=\"s1\">'exit-code'</span>.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:54:13<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>to<span class=\"w\"> </span>start<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:55:30<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:55:30<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Started<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Stopping<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Succeeded.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Stopped<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">13215</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span><span class=\"o\">[</span>emerg<span class=\"o\">]</span><span class=\"w\"> </span>cannot<span class=\"w\"> </span>load<span class=\"w\"> </span>certificate<span class=\"w\"> </span><span class=\"s2\">\"/etc/ssl/certs/zulip.combined-chain.crt\"</span>:<span class=\"w\"> </span>BIO_new_file<span class=\"o\">()</span><span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span>SSL:<span class=\"w\"> </span>error:02001002:system<span class=\"w\"> </span>library:fopen:No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory:fopen<span class=\"o\">(</span><span class=\"s1\">'/etc/ssl/certs/zulip.combined-chain.crt'</span>,<span class=\"s1\">'r'</span><span class=\"o\">)</span><span class=\"w\"> </span>error:2006D080:BIO<span class=\"w\"> </span>routines:BIO_new_file:no<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"o\">)</span>\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">13215</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span>configuration<span class=\"w\"> </span>file<span class=\"w\"> </span>/etc/nginx/nginx.conf<span class=\"w\"> </span><span class=\"nb\">test</span><span class=\"w\"> </span>failed\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Control<span class=\"w\"> </span>process<span class=\"w\"> </span>exited,<span class=\"w\"> </span><span class=\"nv\">code</span><span class=\"o\">=</span>exited,<span class=\"w\"> </span><span class=\"nv\">status</span><span class=\"o\">=</span><span class=\"m\">1</span>/FAILURE\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>with<span class=\"w\"> </span>result<span class=\"w\"> </span><span class=\"s1\">'exit-code'</span>.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">05</span>:57:21<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>to<span class=\"w\"> </span>start<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\n\nNotice:<span class=\"w\"> </span>Applied<span class=\"w\"> </span>catalog<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">0</span>.89<span class=\"w\"> </span>seconds\nTraceback<span class=\"w\"> </span><span class=\"o\">(</span>most<span class=\"w\"> </span>recent<span class=\"w\"> </span>call<span class=\"w\"> </span>last<span class=\"o\">)</span>:\n<span class=\"w\">  </span>File<span class=\"w\"> </span><span class=\"s2\">\"/home/zulip/deployments/2023-06-21-05-55-40/scripts/lib/upgrade-zulip-stage-2\"</span>,<span class=\"w\"> </span>line<span class=\"w\"> </span><span class=\"m\">541</span>,<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>&lt;module&gt;\n<span class=\"w\">    </span>subprocess.check_call<span class=\"o\">([</span><span class=\"s2\">\"./scripts/zulip-puppet-apply\"</span>,<span class=\"w\"> </span><span class=\"s2\">\"--force\"</span><span class=\"o\">])</span>\n<span class=\"w\">  </span>File<span class=\"w\"> </span><span class=\"s2\">\"/usr/lib/python3.8/subprocess.py\"</span>,<span class=\"w\"> </span>line<span class=\"w\"> </span><span class=\"m\">364</span>,<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>check_call\n<span class=\"w\">    </span>raise<span class=\"w\"> </span>CalledProcessError<span class=\"o\">(</span>retcode,<span class=\"w\"> </span>cmd<span class=\"o\">)</span>\nsubprocess.CalledProcessError:<span class=\"w\"> </span>Command<span class=\"w\"> </span><span class=\"s1\">'['</span>./scripts/zulip-puppet-apply<span class=\"s1\">', '</span>--force<span class=\"s1\">']'</span><span class=\"w\"> </span>returned<span class=\"w\"> </span>non-zero<span class=\"w\"> </span><span class=\"nb\">exit</span><span class=\"w\"> </span>status<span class=\"w\"> </span><span class=\"m\">2</span>.\n\nZulip<span class=\"w\"> </span>upgrade<span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"nb\">exit</span><span class=\"w\"> </span>code<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"o\">)</span>!\n\nroot@chat:~#\n</code></pre></div>",
        "id": 1596190,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687327231
    },
    {
        "content": "<p>I was certain zulip is fixing missing or broken nginx config on upgrade process, seems I was wrong, the whole thing is, we are completely down, and in production for over 2 weeks, for such a blatant topic like letsencrypt when it was all working for years now.</p>",
        "id": 1596191,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687327341
    },
    {
        "content": "<p>...</p>",
        "id": 1596192,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687327385
    },
    {
        "content": "<p>All I notice is that the nginx was broken before by the Zulip team, I do not see much more than a faulty push like always and maybe someone expect we the people will find it. Well clearly out of the box nginx is checking for some SSL locations that do not exists.</p>",
        "id": 1596194,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687327848
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>root@chat:/etc/nginx#<span class=\"w\"> </span>grep<span class=\"w\"> </span>-Rn<span class=\"w\"> </span>/etc/ssl/certs/zulip.combined-chain.crt\nsites-enabled/zulip-enterprise:22:#<span class=\"w\">    </span>ssl_certificate<span class=\"w\"> </span>/etc/ssl/certs/zulip.combined-chain.crt<span class=\"p\">;</span>\nsites-available/zulip-enterprise:22:#<span class=\"w\">    </span>ssl_certificate<span class=\"w\"> </span>/etc/ssl/certs/zulip.combined-chain.crt<span class=\"p\">;</span>\n</code></pre></div>\n<p>This SSL cannot exist when SSL is not working. It comes by default in the nginx conf.</p>",
        "id": 1596195,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687327900
    },
    {
        "content": "<p>Anyone who can help with the latest attempt to upgrade, I have removed the SSL location several times, no help:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>Done<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>5s\n+<span class=\"w\"> </span>./tools/setup/emoji/build_emoji\nbuild_emoji:<span class=\"w\"> </span>Using<span class=\"w\"> </span>cached<span class=\"w\"> </span>emojis<span class=\"w\"> </span>from<span class=\"w\"> </span>/srv/zulip-emoji-cache/33591d318e7eb2ad5e4b13233ecea965099e740b/emoji\n+<span class=\"w\"> </span>./tools/setup/generate_zulip_bots_static_files.py\n+<span class=\"w\"> </span>./tools/setup/build_pygments_data\n+<span class=\"w\"> </span>./tools/setup/build_timezone_values\n+<span class=\"w\"> </span>./tools/webpack<span class=\"w\"> </span>--quiet\n+<span class=\"w\"> </span>./manage.py<span class=\"w\"> </span>collectstatic<span class=\"w\"> </span>-v0<span class=\"w\"> </span>--noinput\n+<span class=\"w\"> </span>./manage.py<span class=\"w\"> </span>compilemessages<span class=\"w\"> </span>-v0<span class=\"w\"> </span><span class=\"s1\">'--ignore=*'</span>\nSystem<span class=\"w\"> </span>check<span class=\"w\"> </span>identified<span class=\"w\"> </span>no<span class=\"w\"> </span>issues<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"m\">18</span><span class=\"w\"> </span>silenced<span class=\"o\">)</span>.\n<span class=\"m\">2023</span>-06-21<span class=\"w\"> </span><span class=\"m\">06</span>:10:56,977<span class=\"w\"> </span>upgrade-zulip-stage-2:<span class=\"w\"> </span>Installing<span class=\"w\"> </span>hooks\nNotice:<span class=\"w\"> </span>Compiled<span class=\"w\"> </span>catalog<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>chat.uhlhosting.ch<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>environment<span class=\"w\"> </span>production<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">2</span>.08<span class=\"w\"> </span>seconds\nNotice:<span class=\"w\"> </span>Applied<span class=\"w\"> </span>catalog<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">0</span>.14<span class=\"w\"> </span>seconds\n<span class=\"m\">2023</span>-06-21<span class=\"w\"> </span><span class=\"m\">06</span>:11:08,047<span class=\"w\"> </span>upgrade-zulip-stage-2:<span class=\"w\"> </span>Applying<span class=\"w\"> </span>Puppet<span class=\"w\"> </span>changes...\nNotice:<span class=\"w\"> </span>Compiled<span class=\"w\"> </span>catalog<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>chat.uhlhosting.ch<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>environment<span class=\"w\"> </span>production<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">2</span>.06<span class=\"w\"> </span>seconds\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Profile::App_frontend/File<span class=\"o\">[</span>/etc/nginx/sites-available/zulip-enterprise<span class=\"o\">]</span>/content:<span class=\"w\"> </span>content<span class=\"w\"> </span>changed<span class=\"w\"> </span><span class=\"s1\">'{md5}63730958a238d4997fc0481e250e321a'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'{md5}1defc38fb8209121cd3a565185de3c80'</span>\nError:<span class=\"w\"> </span>Systemd<span class=\"w\"> </span>start<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>nginx<span class=\"w\"> </span>failed!\njournalctl<span class=\"w\"> </span>log<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>nginx:\n--<span class=\"w\"> </span>Logs<span class=\"w\"> </span>begin<span class=\"w\"> </span>at<span class=\"w\"> </span>Tue<span class=\"w\"> </span><span class=\"m\">2022</span>-12-13<span class=\"w\"> </span><span class=\"m\">19</span>:57:07<span class=\"w\"> </span>UTC,<span class=\"w\"> </span>end<span class=\"w\"> </span>at<span class=\"w\"> </span>Wed<span class=\"w\"> </span><span class=\"m\">2023</span>-06-21<span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>UTC.<span class=\"w\"> </span>--\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">16235</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span><span class=\"o\">[</span>emerg<span class=\"o\">]</span><span class=\"w\"> </span>cannot<span class=\"w\"> </span>load<span class=\"w\"> </span>certificate<span class=\"w\"> </span><span class=\"s2\">\"/etc/ssl/certs/zulip.combined-chain.crt\"</span>:<span class=\"w\"> </span>BIO_new_file<span class=\"o\">()</span><span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span>SSL:<span class=\"w\"> </span>error:02001002:system<span class=\"w\"> </span>library:fopen:No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory:fopen<span class=\"o\">(</span><span class=\"s1\">'/etc/ssl/certs/zulip.combined-chain.crt'</span>,<span class=\"s1\">'r'</span><span class=\"o\">)</span><span class=\"w\"> </span>error:2006D080:BIO<span class=\"w\"> </span>routines:BIO_new_file:no<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"o\">)</span>\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">16235</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span>configuration<span class=\"w\"> </span>file<span class=\"w\"> </span>/etc/nginx/nginx.conf<span class=\"w\"> </span><span class=\"nb\">test</span><span class=\"w\"> </span>failed\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Control<span class=\"w\"> </span>process<span class=\"w\"> </span>exited,<span class=\"w\"> </span><span class=\"nv\">code</span><span class=\"o\">=</span>exited,<span class=\"w\"> </span><span class=\"nv\">status</span><span class=\"o\">=</span><span class=\"m\">1</span>/FAILURE\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>with<span class=\"w\"> </span>result<span class=\"w\"> </span><span class=\"s1\">'exit-code'</span>.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>to<span class=\"w\"> </span>start<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">17652</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span><span class=\"o\">[</span>emerg<span class=\"o\">]</span><span class=\"w\"> </span>cannot<span class=\"w\"> </span>load<span class=\"w\"> </span>certificate<span class=\"w\"> </span><span class=\"s2\">\"/etc/ssl/certs/zulip.combined-chain.crt\"</span>:<span class=\"w\"> </span>BIO_new_file<span class=\"o\">()</span><span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span>SSL:<span class=\"w\"> </span>error:02001002:system<span class=\"w\"> </span>library:fopen:No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory:fopen<span class=\"o\">(</span><span class=\"s1\">'/etc/ssl/certs/zulip.combined-chain.crt'</span>,<span class=\"s1\">'r'</span><span class=\"o\">)</span><span class=\"w\"> </span>error:2006D080:BIO<span class=\"w\"> </span>routines:BIO_new_file:no<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"o\">)</span>\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">17652</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span>configuration<span class=\"w\"> </span>file<span class=\"w\"> </span>/etc/nginx/nginx.conf<span class=\"w\"> </span><span class=\"nb\">test</span><span class=\"w\"> </span>failed\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Control<span class=\"w\"> </span>process<span class=\"w\"> </span>exited,<span class=\"w\"> </span><span class=\"nv\">code</span><span class=\"o\">=</span>exited,<span class=\"w\"> </span><span class=\"nv\">status</span><span class=\"o\">=</span><span class=\"m\">1</span>/FAILURE\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>with<span class=\"w\"> </span>result<span class=\"w\"> </span><span class=\"s1\">'exit-code'</span>.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>to<span class=\"w\"> </span>start<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\n\nError:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/Service<span class=\"o\">[</span>nginx<span class=\"o\">]</span>/ensure:<span class=\"w\"> </span>change<span class=\"w\"> </span>from<span class=\"w\"> </span><span class=\"s1\">'stopped'</span><span class=\"w\"> </span>to<span class=\"w\"> </span><span class=\"s1\">'running'</span><span class=\"w\"> </span>failed:<span class=\"w\"> </span>Systemd<span class=\"w\"> </span>start<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>nginx<span class=\"w\"> </span>failed!\njournalctl<span class=\"w\"> </span>log<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>nginx:\n--<span class=\"w\"> </span>Logs<span class=\"w\"> </span>begin<span class=\"w\"> </span>at<span class=\"w\"> </span>Tue<span class=\"w\"> </span><span class=\"m\">2022</span>-12-13<span class=\"w\"> </span><span class=\"m\">19</span>:57:07<span class=\"w\"> </span>UTC,<span class=\"w\"> </span>end<span class=\"w\"> </span>at<span class=\"w\"> </span>Wed<span class=\"w\"> </span><span class=\"m\">2023</span>-06-21<span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>UTC.<span class=\"w\"> </span>--\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">16235</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span><span class=\"o\">[</span>emerg<span class=\"o\">]</span><span class=\"w\"> </span>cannot<span class=\"w\"> </span>load<span class=\"w\"> </span>certificate<span class=\"w\"> </span><span class=\"s2\">\"/etc/ssl/certs/zulip.combined-chain.crt\"</span>:<span class=\"w\"> </span>BIO_new_file<span class=\"o\">()</span><span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span>SSL:<span class=\"w\"> </span>error:02001002:system<span class=\"w\"> </span>library:fopen:No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory:fopen<span class=\"o\">(</span><span class=\"s1\">'/etc/ssl/certs/zulip.combined-chain.crt'</span>,<span class=\"s1\">'r'</span><span class=\"o\">)</span><span class=\"w\"> </span>error:2006D080:BIO<span class=\"w\"> </span>routines:BIO_new_file:no<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"o\">)</span>\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">16235</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span>configuration<span class=\"w\"> </span>file<span class=\"w\"> </span>/etc/nginx/nginx.conf<span class=\"w\"> </span><span class=\"nb\">test</span><span class=\"w\"> </span>failed\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Control<span class=\"w\"> </span>process<span class=\"w\"> </span>exited,<span class=\"w\"> </span><span class=\"nv\">code</span><span class=\"o\">=</span>exited,<span class=\"w\"> </span><span class=\"nv\">status</span><span class=\"o\">=</span><span class=\"m\">1</span>/FAILURE\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>with<span class=\"w\"> </span>result<span class=\"w\"> </span><span class=\"s1\">'exit-code'</span>.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:07:27<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>to<span class=\"w\"> </span>start<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Starting<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server...\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">17652</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span><span class=\"o\">[</span>emerg<span class=\"o\">]</span><span class=\"w\"> </span>cannot<span class=\"w\"> </span>load<span class=\"w\"> </span>certificate<span class=\"w\"> </span><span class=\"s2\">\"/etc/ssl/certs/zulip.combined-chain.crt\"</span>:<span class=\"w\"> </span>BIO_new_file<span class=\"o\">()</span><span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span>SSL:<span class=\"w\"> </span>error:02001002:system<span class=\"w\"> </span>library:fopen:No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory:fopen<span class=\"o\">(</span><span class=\"s1\">'/etc/ssl/certs/zulip.combined-chain.crt'</span>,<span class=\"s1\">'r'</span><span class=\"o\">)</span><span class=\"w\"> </span>error:2006D080:BIO<span class=\"w\"> </span>routines:BIO_new_file:no<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"o\">)</span>\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>nginx<span class=\"o\">[</span><span class=\"m\">17652</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx:<span class=\"w\"> </span>configuration<span class=\"w\"> </span>file<span class=\"w\"> </span>/etc/nginx/nginx.conf<span class=\"w\"> </span><span class=\"nb\">test</span><span class=\"w\"> </span>failed\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Control<span class=\"w\"> </span>process<span class=\"w\"> </span>exited,<span class=\"w\"> </span><span class=\"nv\">code</span><span class=\"o\">=</span>exited,<span class=\"w\"> </span><span class=\"nv\">status</span><span class=\"o\">=</span><span class=\"m\">1</span>/FAILURE\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>nginx.service:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>with<span class=\"w\"> </span>result<span class=\"w\"> </span><span class=\"s1\">'exit-code'</span>.\nJun<span class=\"w\"> </span><span class=\"m\">21</span><span class=\"w\"> </span><span class=\"m\">06</span>:11:19<span class=\"w\"> </span>chat<span class=\"w\"> </span>systemd<span class=\"o\">[</span><span class=\"m\">1</span><span class=\"o\">]</span>:<span class=\"w\"> </span>Failed<span class=\"w\"> </span>to<span class=\"w\"> </span>start<span class=\"w\"> </span>A<span class=\"w\"> </span>high<span class=\"w\"> </span>performance<span class=\"w\"> </span>web<span class=\"w\"> </span>server<span class=\"w\"> </span>and<span class=\"w\"> </span>a<span class=\"w\"> </span>reverse<span class=\"w\"> </span>proxy<span class=\"w\"> </span>server.\n\nNotice:<span class=\"w\"> </span>/Stage<span class=\"o\">[</span>main<span class=\"o\">]</span>/Zulip::Nginx/Service<span class=\"o\">[</span>nginx<span class=\"o\">]</span>:<span class=\"w\"> </span>Triggered<span class=\"w\"> </span><span class=\"s1\">'refresh'</span><span class=\"w\"> </span>from<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"w\"> </span>event\nNotice:<span class=\"w\"> </span>Applied<span class=\"w\"> </span>catalog<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">1</span>.12<span class=\"w\"> </span>seconds\nTraceback<span class=\"w\"> </span><span class=\"o\">(</span>most<span class=\"w\"> </span>recent<span class=\"w\"> </span>call<span class=\"w\"> </span>last<span class=\"o\">)</span>:\n<span class=\"w\">  </span>File<span class=\"w\"> </span><span class=\"s2\">\"/home/zulip/deployments/2023-06-21-06-09-35/scripts/lib/upgrade-zulip-stage-2\"</span>,<span class=\"w\"> </span>line<span class=\"w\"> </span><span class=\"m\">541</span>,<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>&lt;module&gt;\n<span class=\"w\">    </span>subprocess.check_call<span class=\"o\">([</span><span class=\"s2\">\"./scripts/zulip-puppet-apply\"</span>,<span class=\"w\"> </span><span class=\"s2\">\"--force\"</span><span class=\"o\">])</span>\n<span class=\"w\">  </span>File<span class=\"w\"> </span><span class=\"s2\">\"/usr/lib/python3.8/subprocess.py\"</span>,<span class=\"w\"> </span>line<span class=\"w\"> </span><span class=\"m\">364</span>,<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>check_call\n<span class=\"w\">    </span>raise<span class=\"w\"> </span>CalledProcessError<span class=\"o\">(</span>retcode,<span class=\"w\"> </span>cmd<span class=\"o\">)</span>\nsubprocess.CalledProcessError:<span class=\"w\"> </span>Command<span class=\"w\"> </span><span class=\"s1\">'['</span>./scripts/zulip-puppet-apply<span class=\"s1\">', '</span>--force<span class=\"s1\">']'</span><span class=\"w\"> </span>returned<span class=\"w\"> </span>non-zero<span class=\"w\"> </span><span class=\"nb\">exit</span><span class=\"w\"> </span>status<span class=\"w\"> </span><span class=\"m\">2</span>.\n\nZulip<span class=\"w\"> </span>upgrade<span class=\"w\"> </span>failed<span class=\"w\"> </span><span class=\"o\">(</span><span class=\"nb\">exit</span><span class=\"w\"> </span>code<span class=\"w\"> </span><span class=\"m\">1</span><span class=\"o\">)</span>!\n\nThe<span class=\"w\"> </span>upgrade<span class=\"w\"> </span>process<span class=\"w\"> </span>is<span class=\"w\"> </span>designed<span class=\"w\"> </span>to<span class=\"w\"> </span>be<span class=\"w\"> </span>idempotent,<span class=\"w\"> </span>so<span class=\"w\"> </span>you<span class=\"w\"> </span>can<span class=\"w\"> </span>retry<span class=\"w\"> </span>after<span class=\"w\"> </span>resolving<span class=\"w\"> </span>whatever<span class=\"w\"> </span>issue<span class=\"w\"> </span>caused<span class=\"w\"> </span>the<span class=\"w\"> </span>failure<span class=\"w\"> </span><span class=\"o\">(</span>there<span class=\"w\"> </span>should<span class=\"w\"> </span>be<span class=\"w\"> </span>a<span class=\"w\"> </span>traceback<span class=\"w\"> </span>above<span class=\"o\">)</span>.<span class=\"w\"> </span>A<span class=\"w\"> </span>log<span class=\"w\"> </span>of<span class=\"w\"> </span>this<span class=\"w\"> </span>installation<span class=\"w\"> </span>is<span class=\"w\"> </span>available<span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span>/var/log/zulip/upgrade.log\n</code></pre></div>",
        "id": 1596196,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687327962
    },
    {
        "content": "<p>OK, I had to move to a 3rd party SSL, anything but letsencrypt and it works, yet the SSL by letsencrypt wont work where the domains have SSL enforced on them like we do with main domains. Any app that will resolve aanything on http on a strict https site will be ignored. Thats why the whole issues caused, since in past when I made the migration from one SSL to letsencrypt, the existing ssl worked, so certbot was able to verify the address.</p>",
        "id": 1596200,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687329472
    },
    {
        "content": "<p>It can be closed. But would be nice to solve the certbot/nginx issues on HSTS only websites should be aother procedure.</p>",
        "id": 1596205,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687329508
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"20576\">@Cosmic Sound</span>: I'm sorry you had an outage, and I understand that can be very frustrating.  While we do our best to help, the <a class=\"stream\" data-stream-id=\"31\" href=\"/#narrow/stream/31-production-help\">#production help</a> stream in the community development chat is not a support contract -- we can't promise that we can fix your problem, and we are going to take time off to be spend time with our newborns (in <span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span>'s case) or be away for a 3-day weekend (in mine).  And while you may be disappointed, your baseline that you should be measuring against is <em>any volunteer-only support</em> -- and I feel that we generally do a much better job at providing completely free support for our completely free product than many others would.</p>\n<p>I also feel that it is a mischaracterization that \"nothing of the statements here are correct\" and we were \"NO help here.\"  I know you're frustrated, but berating us for the free help isn't encouraging us to help more.  I'd like to help you solve your problem, honestly.  It is made more difficult by your problems appearing to be relatively unique.</p>\n<p>Can you describe how you tried to \"remove nginx completely\"?  It looks like you did an <code>rm /etc/nginx -rf</code>.  While Zulip does know how to configure nginx from a fresh nginx install, it's not designed to recover from the whole configuration directory going missing -- it does assume that some things from the system <code>nginx</code> package (like <code>/etc/nginx</code> and <code>/etc/nginx/nginx.conf</code>) are in place already.</p>\n<blockquote>\n<p>SSL by letsencrypt wont work where the domains have SSL enforced on them like we do with main domains</p>\n</blockquote>\n<p>certbot does still work when HSTS is enabled for a domain -- as long as there isn't a proxy in front of Zulip which force-redirects all of HTTP -&gt; HTTPS, or something which blocks port 80.  Is that what you mean by \"have SSL enforced on them like we do with main domains\"?</p>\n<blockquote>\n<p>Any app that will resolve anything on http on a strict https site will be ignored. Thats why the whole issues caused, since in past when I made the migration from one SSL to letsencrypt, the existing ssl worked, so certbot was able to verify the address.</p>\n</blockquote>\n<p>I don't think I understand what you're saying here.  Can you try to explain again?</p>\n<p>Did you perform the test that I suggested, of looking in the access logs after doing a <code>certbot renew</code>?  Did that show an HTTPS access instead of an HTTP access?</p>",
        "id": 1596357,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1687357831
    },
    {
        "content": "<p>Certbot renew did not worked in an environment where used to work and we did not changed nginx.conf. After manually adding an ssl it works. Yet to debug certbot its a dead end. The only errors shown are the ones already sent here. The request its via http done yet in my understanding how HSTS works all sites are automatically redirected to https. Not that we have a special redirect in place. Most concerning is that still a bit weird as to why the same configs will work once and fail on second renewal. Since let's encrypt ssls are for 3 months in that period the process to renew degraded without any human manual changes in nginx or certbot side. Thats something that could had occured only by changes in the upgrade process while no other changes were registered on the machine prior to this failed renewal, from the last working certificate.</p>",
        "id": 1596535,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1687365076
    },
    {
        "content": "<blockquote>\n<p>Yet to debug certbot its a dead end.</p>\n</blockquote>\n<p>It seems to me that certbot, or its integration with nginx, is what failed for you -- so that's what I'm trying to debug.  I hear you that switching to a non-LetsEncrypt certificate resolved the issue for you, but my goal here is to (a) help you make your install more standardized, (b) make its certificate renewals automated, so you're less likely to have this issue in the future (c) understand if there's a general bug that we can fix to prevent others from having this trouble.</p>\n<blockquote>\n<p>The request its via http done yet in my understanding how HSTS works all sites are automatically redirected to https.</p>\n</blockquote>\n<p>That redirection is implemented at the client level.  The way the certbot renewal works is that it makes a file on disk, has its servers access that file over HTTP (<em>ignoring the HSTS headers</em> because that would defeat the point), and verify that the contents it gets via HTTP match the contents it wrote out to disk -- which validates that the server it wrote the file on does indeed map to that hostname.</p>\n<p>Here's a small demonstration that, even in the presence of HSTS headers, servers can very much still serve content over HTTP:</p>\n<div class=\"codehilite\"><pre><span></span><code>$ curl -v &#39;http://alexmv-prod.zulipdev.org/.well-known/acme-challenge/some-file&#39;\n*   Trying 192.241.204.97:80...\n* Connected to alexmv-prod.zulipdev.org (192.241.204.97) port 80 (#0)\n&gt; GET /.well-known/acme-challenge/some-file HTTP/1.1\n&gt; Host: alexmv-prod.zulipdev.org\n&gt; User-Agent: curl/7.88.1\n&gt; Accept: */*\n&gt;\n&lt; HTTP/1.1 200 OK\n&lt; Server: nginx/1.18.0 (Ubuntu)\n&lt; Date: Wed, 21 Jun 2023 16:41:46 GMT\n&lt; Content-Type: application/octet-stream\n&lt; Content-Length: 23\n&lt; Last-Modified: Wed, 21 Jun 2023 16:37:02 GMT\n&lt; Connection: keep-alive\n&lt; ETag: &quot;6493272e-17&quot;\n&lt; Strict-Transport-Security: max-age=15768000\n&lt; X-Frame-Options: DENY\n&lt; X-Content-Type-Options: nosniff\n&lt; Accept-Ranges: bytes\n&lt;\nhello there over http!\n</code></pre></div>\n<p>Note the <code>Strict-Transport-Security</code> header, which is the HSTS header.  And that content very much went in the clear over HTTP.</p>\n<blockquote>\n<p>Most concerning is that still a bit weird as to why the same configs will work once and fail on second renewal.</p>\n</blockquote>\n<p>I agree that's concerning, which is why I'm trying to help you show some debugging information that will help us track down what happened.</p>\n<p>So, again, when you ran <code>certbot renew</code>, did you see a request in <code>/var/log/nginx/access.log</code> to something under <code>/.well-known/acme-challenge/</code>?</p>",
        "id": 1596541,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1687365838
    },
    {
        "content": "<p>Ok guys</p>",
        "id": 1649740,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986225
    },
    {
        "content": "<p>Is nice that we have shared all this info here.</p>",
        "id": 1649741,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986234
    },
    {
        "content": "<p>The issue at hand is same.</p>",
        "id": 1649742,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986242
    },
    {
        "content": "<p>Never ever was I provided a solution</p>",
        "id": 1649743,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986251
    },
    {
        "content": "<p>Alto we run all default nginx setups provided by you</p>",
        "id": 1649744,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986265
    },
    {
        "content": "<p>We were not anymore successful able to use Lets encrypt.</p>",
        "id": 1649745,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986278
    },
    {
        "content": "<p>On all my other services, we have no issues to deploy lets encrypt.</p>",
        "id": 1649746,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986294
    },
    {
        "content": "<p>While even on this Zulip instance, it used to work, now it did not.</p>",
        "id": 1649747,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986305
    },
    {
        "content": "<p>Isn't there anything beside all this... testing without any relevancy.</p>",
        "id": 1649748,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986322
    },
    {
        "content": "<p>Would really appreciate a helping hand.</p>",
        "id": 1649749,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986343
    },
    {
        "content": "<p>Server works fine with manual SSL, yet those I have to keep renewing manually and ofc pay every year.</p>",
        "id": 1649750,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986373
    },
    {
        "content": "<p>All logs were already provided.</p>",
        "id": 1649752,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986575
    },
    {
        "content": "<p>Either this is a really communication issue, or not reading what I sent earlier... Not sure, yet all I know, just curious after 1 year since last attempt.</p>",
        "id": 1649753,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986609
    },
    {
        "content": "<p>How did evolved. seems to me nowhere.</p>",
        "id": 1649754,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986619
    },
    {
        "content": "<p>Ok</p>",
        "id": 1649755,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986707
    },
    {
        "content": "<p>I got my answer, what ever the issue was, was fixed, yet never mentioned here. All good for me.</p>",
        "id": 1649756,
        "sender_full_name": "Cosmic Sound",
        "timestamp": 1695986727
    }
]