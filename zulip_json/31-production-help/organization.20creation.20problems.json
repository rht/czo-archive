[
    {
        "content": "<p>I'm trying to finish setting up my instance of Zulip on my local server. </p>\n<p>I verified that the outgoing email configuration works and successfully received the email.</p>\n<p>When I go to the link generated by:</p>\n<div class=\"codehilite\"><pre><span></span>/home/zulip/deployments/current/manage.py generate_realm_creation_link\n</pre></div>\n\n\n<p>and enter my email address I get an error that says:</p>\n<div class=\"codehilite\"><pre><span></span>Well oops. This one&#39;s probably our fault. Sorry about that!\n\nIf you&#39;d like, you can drop us a line to let us know what happened.\n</pre></div>\n\n\n<p>The email link auto-fills an email to me reporting a 500 error.<br>\nAny ideas on what's gone wrong?</p>",
        "id": 254031,
        "sender_full_name": "Glen Thurston",
        "timestamp": 1500506306
    },
    {
        "content": "<p>Just figured out that I can create a realm using</p>\n<div class=\"codehilite\"><pre><span></span>/home/zulip/deployments/current/manage.py create_realm\n</pre></div>\n\n\n<p>I think everything is working now.</p>",
        "id": 254036,
        "sender_full_name": "Glen Thurston",
        "timestamp": 1500506639
    },
    {
        "content": "<p>Hmmm.  Glad you got unblocked, but it sounds like maybe our <code>generate_realm_creation_link</code> script may be broken?</p>",
        "id": 254038,
        "sender_full_name": "Steve Howell",
        "timestamp": 1500506869
    },
    {
        "content": "<p>Possibly. I had to generate an invite link to myself as well to create an account.  But it seems okay now.</p>",
        "id": 254039,
        "sender_full_name": "Glen Thurston",
        "timestamp": 1500506959
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"supermoosen@gmail.com\" data-user-id=\"2878\">@Glen Thurston</span> Are emails, more generally, working now? There is an open issue about a 500 error when SMTP fails (<a href=\"https://github.com/zulip/zulip/pull/3850\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/3850\">#3850</a>) but I'm not sure if it's relevant here. (I ran into it when my email configuration got corrupted.)</p>",
        "id": 254081,
        "sender_full_name": "Andrea  Longo",
        "timestamp": 1500513941
    },
    {
        "content": "<p>Yes, they are.  I can send test emails to myself, as well as send emails with invitations to join Zulip.  This seems to be a separate issue.</p>",
        "id": 254089,
        "sender_full_name": "Glen Thurston",
        "timestamp": 1500515519
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"supermoosen@gmail.com\" data-user-id=\"2878\">@Glen Thurston</span> if you were getting a 500 error, there should be logs in <code>/var/log/zulip/errors.log</code>.  Would you be up for taking a look at that and sending us the traceback?  The error was almost certainly something related to your email configuration.</p>",
        "id": 254460,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1500569917
    },
    {
        "content": "<p>Also <span class=\"user-mention\" data-user-email=\"rishig@zulipchat.com\" data-user-id=\"131\">@Rishi Gupta</span> I guess this is a data point for someone using <code>create_realm.py</code></p>",
        "id": 254461,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1500569930
    },
    {
        "content": "<p>Hmm</p>",
        "id": 254464,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1500570044
    },
    {
        "content": "<p>I'd argue the root problem here is whatever email or other configuration problem caused the 500 though</p>",
        "id": 254465,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1500570085
    },
    {
        "content": "<p>And the secondary problem is that we should make the error message for that case better.</p>",
        "id": 254467,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1500570122
    },
    {
        "content": "<p>It looks like maybe Google wasn't happy with the password it received.  I use two-factor authentication, and created a key specifically for Zulip to get around this. </p>\n<p>Here is the log:</p>\n<div class=\"codehilite\"><pre><span></span>2017-07-20 02:12:47,147 ERROR    Internal Server Error: /accounts/password/reset/\nTraceback (most recent call last):\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/core/handlers/exception.py&quot;, line 42, in inner\n    response = get_response(request)\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 249, in _legacy_get_response\n    response = self._get_response(request)\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 187, in _get_response\n    response = self.process_exception_by_middleware(e, request)\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 185, in _get_response\n    response = wrapped_callback(request, *callback_args, **callback_kwargs)\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/views.py&quot;, line 47, in inner\n    return func(*args, **kwargs)\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py&quot;, line 149, in _wrapped_view\n    response = view_func(request, *args, **kwargs)\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/views.py&quot;, line 205, in password_reset\n    form.save(**opts)\n  File &quot;./zerver/forms.py&quot;, line 228, in save\n    super(ZulipPasswordResetForm, self).save(*args, **kwargs)\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/forms.py&quot;, line 291, in save\n    user.email, html_email_template_name=html_email_template_name,\n File &quot;./zerver/forms.py&quot;, line 213, in send_mail\n    html_email_template_name=html_email_template_name\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/forms.py&quot;, line 247, in send_mail\n    email_message.send()\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/core/mail/message.py&quot;, line 342, in send\n    return self.get_connection(fail_silently).send_messages([self])\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/core/mail/backends/smtp.py&quot;, line 100, in send_messages\n    new_conn_created = self.open()\n  File &quot;/home/zulip/deployments/2017-07-19-17-35-32/zulip-venv/lib/python2.7/site-packages/django/core/mail/backends/smtp.py&quot;, line 67, in open\n    self.connection.login(self.username, self.password)\n  File &quot;/usr/lib/python2.7/smtplib.py&quot;, line 622, in login\n    raise SMTPAuthenticationError(code, resp)\nSMTPAuthenticationError: (535, &#39;5.7.8 Username and Password not accepted. Learn more at\\n5.7.8  https://support.google.com/mail/?p=BadCredentials g201sm629280itg.31 - gsmtp&#39;)\n</pre></div>",
        "id": 254703,
        "sender_full_name": "Glen Thurston",
        "timestamp": 1500577625
    },
    {
        "content": "<p>Ahh, OK, yeah, so this is the existing bug that we don't give you great feedback for how to debug for 500s this early in setup.</p>",
        "id": 254761,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1500582807
    },
    {
        "content": "<p>Aka <a href=\"https://github.com/zulip/zulip/pull/3577\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/3577\">#3577</a></p>",
        "id": 254762,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1500582816
    }
]