[
    {
        "content": "<p>I'm attempting to follow the instructions for importing a Slack, but am running into obstacles as things are not fully documented.</p>\n<p>I managed to finally get Zulip installed and now need to import the Slack data.  But there are some important missing pieces in the instructions at <a href=\"https://zulip.com/help/import-from-slack\">https://zulip.com/help/import-from-slack</a>, specifically:</p>\n<p>The commands we are said to run are:</p>\n<p>cd /home/zulip/deployments/current<br>\nsupervisorctl stop all  # Stop the Zulip server<br>\n./manage.py convert_slack_data slack_data.zip --token &lt;token&gt; --output converted_slack_data<br>\n./manage.py import '' converted_slack_data<br>\n./scripts/restart-server</p>\n<p>We are instructed to replace &lt;token&gt; with the Slack token, which is fine.  However there is no converted_slack_data directory, nor has a file named slack_data.zip been uploaded anywhere.  So no surprise, the script fails.</p>\n<p>I'm not a server admin, so while I can hack my way around SSH and the command line a bit when I must, figuring out what is expected of me from these incomplete instructions is frustrating and holding me up.  What do I need to do to complete this task and see our Slack imported?  Thanks.</p>",
        "id": 1086957,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608828979
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"18203\">@Jonathan van Clute</span> the <code>manage.py convert_slack_data</code> command writes its output to the path passed via the <code>--output</code> option.  So if working correctly, it will create that directory.</p>",
        "id": 1087310,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1608853081
    },
    {
        "content": "<p>The instructions are complete and we use them on a regular basis; can you post the output you're seeing?  Maybe you're getting an error for some other reason.</p>",
        "id": 1087311,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1608853125
    },
    {
        "content": "<p>It does not appear to be creating the directory.</p>\n<p>zulip@zulip-ubuntu-s-1vcpu-2gb-sfo2-01:~/deployments/current$ ./manage.py convert_slack_data slack_data.zip --token xoxb-<strong>**Slack Token </strong>** --output converted_slack_data<br>\nSlack data directory not found: 'slack_data.zip'<br>\nzulip@zulip-ubuntu-s-1vcpu-2gb-sfo2-01:~/deployments/current$ ./manage.py import '' converted_slack_data<br>\nDirectory not found: '/home/zulip/deployments/2020-12-24-16-48-03/converted_slack_data'</p>",
        "id": 1087313,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608858140
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"18203\">@Jonathan van Clute</span> you need to have the Slack archive ready with a name of slack_data.zip.</p>",
        "id": 1087319,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608861710
    },
    {
        "content": "<p>And how do I do that?  As I said, the instructions are incomplete and make no mention of this.</p>",
        "id": 1087320,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608861732
    },
    {
        "content": "<p>The tutorial you linked explicitly say this:</p>\n<blockquote>\n<p>Now, Export your Slack data. You will receive a zip file slack_data.zip.</p>\n</blockquote>",
        "id": 1087321,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608861786
    },
    {
        "content": "<p><a href=\"https://zulip.com/help/import-from-slack\">https://zulip.com/help/import-from-slack</a></p>",
        "id": 1087322,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608861795
    },
    {
        "content": "<p>And that is incorrect.  I received a file with a very long ugly filename.  I can rename it, but that still tells me nothing whatsoever about how I get it onto the server.  There is no mention of this unless I just completely and totally missed it.  If so please point me to it.</p>",
        "id": 1087323,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608861830
    },
    {
        "content": "<p>It probably used to be called \"slack_data.zip\" and Slack has changed the naming policy of the archive.</p>",
        "id": 1087324,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608861916
    },
    {
        "content": "<p>So, can you try to rename to slack_data.zip and rerun the script?</p>",
        "id": 1087325,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608861939
    },
    {
        "content": "<p>OK, trivial regardless as I can rename it.  But how do I put it on the server in the correct location?  I have no idea how to do that.</p>",
        "id": 1087326,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608861957
    },
    {
        "content": "<p>You can use scp.</p>",
        "id": 1087327,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608861979
    },
    {
        "content": "<p>See this tutorial: <a href=\"https://haydenjames.io/linux-securely-copy-files-using-scp/\">https://haydenjames.io/linux-securely-copy-files-using-scp/</a></p>",
        "id": 1087328,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608862003
    },
    {
        "content": "<p>I will have a look, thanks.  This is what I meant about the instructions being incomplete.  Nobody who doesn't already know about such things, could ever actually complete this process on their own.  Instructions like these should be complete, step-by-step, and leave no (or at least extremely little) room for error.</p>",
        "id": 1087329,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608862092
    },
    {
        "content": "<p>The instruction probably assumes that anyone who has successfully self-hosted Zulip knows how to do the <code>scp</code> thing.</p>",
        "id": 1087330,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608862379
    },
    {
        "content": "<p>That said, this error message seems wrong: <a href=\"https://github.com/zulip/zulip/blob/c685d368215bbc3d85d7c40f2c1e6fa95e53186a/zerver/management/commands/convert_slack_data.py#L49\">https://github.com/zulip/zulip/blob/c685d368215bbc3d85d7c40f2c1e6fa95e53186a/zerver/management/commands/convert_slack_data.py#L49</a>. It's not a directory.</p>",
        "id": 1087331,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608862395
    },
    {
        "content": "<p>Yeah, really bad assumption.  I had to get one of my partners involved to even figure out how to set up the domain so that the ssl certificate could install so that I could run the installation.</p>\n<p>So now I have a new problem.  It looks to me like the directory in question on the server, is attempting (and failing obviously) to be created dynamically as its name seems to have a timestamp in it - /home/zulip/deployments/2020-12-24-16-48-03/converted_slack_data</p>\n<p>Where do I put slack_data.zip on the server?</p>",
        "id": 1087332,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608862523
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/zulip/pull/16962\">#16962</a></p>",
        "id": 1087334,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608862554
    },
    {
        "content": "<blockquote>\n<p>Where do I put slack_data.zip on the server?</p>\n</blockquote>\n<p>You can either specify a full path to it, like /home/ubuntu/folder1/folder2/slack_data.zip or put it at where the manage.py is located.</p>",
        "id": 1087336,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608862631
    },
    {
        "content": "<p>Is that link supposed to mean something to me?</p>\n<p>I'm starting to wonder if I may have chosen poorly in recommending Zulip to my partners.  I'm pretty technical having grown up in Silicon Valley and been using computers since 1975, but I'm a user, not an administrator.  Nothing about any of this process has been obvious, intuitive, or easy.  I've installed countless scripts going back to Wordpress 1.2 when I didn't have any idea what PHP was or any forums to ask questions on, and that was less troublesome than this.  I don't want to burden us with an administrative nightmare going forward.</p>\n<p>Since there seems to be no actual tutorial for this, I'll just have to keep hacking at it and hope luck is on my side.  How fun.</p>",
        "id": 1087337,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608862872
    },
    {
        "content": "<p>No, the link is for Tim Abbott; I was fixing the weird error message.</p>",
        "id": 1087338,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608862924
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"18203\">@Jonathan van Clute</span> you can keep posting the new problems you encounter, then I can help, then we could update the documentation accordingly later.</p>",
        "id": 1087339,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608863011
    },
    {
        "content": "<p>Right now I'm just trying to figure out how to use scp to put the damn file on the server.  Seems to be issues with being root vs. being zulip, scp doesn't like using the zulip user and keeps demanding a password that I don't have.  Super frustrating way to be spending my evening.</p>",
        "id": 1087340,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608863184
    },
    {
        "content": "<p>Wait, how did you manage to access the server so far if you don't know the password?</p>",
        "id": 1087345,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608863237
    },
    {
        "content": "<p>I can access it just fine as root.  Zulip user has no password as far as I understand and from what I have read.</p>",
        "id": 1087346,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608863267
    },
    {
        "content": "<p>The credential you provide via <code>scp</code> is similar to <code>ssh</code>.</p>",
        "id": 1087347,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608863272
    },
    {
        "content": "<p>You can scp the file to the root home directory, and then <code>mv</code> from there to where the manage.py is located.</p>",
        "id": 1087348,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608863319
    },
    {
        "content": "<p>I can't even get the server to recognize a path to my machine.  I'm trying to follow what's on that link you sent, which is </p>\n<p>$ scp file.txt username@to_host:/remote/directory/</p>\n<p>But it has no idea that \"file.txt\" is a file on my local computer, and keeps trying to find that path on the server, which of course doesn't exist.</p>",
        "id": 1087350,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608863426
    },
    {
        "content": "<p>That's strange. The program should automatically detect the path that has the username@host prefix to be remote.</p>",
        "id": 1087351,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608863610
    },
    {
        "content": "<p>That's not the problem.  The problem is the path to my local file.  The server has no idea that's a path on my local machine, so it tries to find it on itself.</p>",
        "id": 1087352,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608863649
    },
    {
        "content": "<p>Where did you run the scp from?</p>",
        "id": 1087353,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608863671
    },
    {
        "content": "<p>You are supposed to run it from your laptop, where the slack_data.zip is located.</p>",
        "id": 1087356,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608863698
    },
    {
        "content": "<p>From the server.  I'm starting to think maybe that's not what is supposed to happen.  This is what I mean about incomplete instructions and assumptions.  Assume I know nothing more than how to launch a terminal.</p>",
        "id": 1087357,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608863704
    },
    {
        "content": "<p>OK that's what I was just concluding.  Will try that.</p>",
        "id": 1087358,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608863714
    },
    {
        "content": "<p>Allrighty... at least I have a new problem to tackle.  Output of import command:</p>\n<p>Converting Data ...<br>\n2020-12-25 02:37:47.419 INFO [] Not a Slack legacy token.<br>\n  This token might not have all the needed scopes. We need the following scopes:</p>\n<p>- emoji:read<br>\n  - users:read<br>\n  - users:<a href=\"http://read.email\">read.email</a><br>\n  - team:read<br>\nerror:  cannot open zipfile [ slack_data.zip ]<br>\n        Permission denied<br>\nunzip:  cannot find or open slack_data.zip, slack_data.zip.zip or slack_data.zip.ZIP.<br>\nTraceback (most recent call last):<br>\n  File \"./manage.py\", line 50, in &lt;module&gt;<br>\n    execute_from_command_line(sys.argv)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line<br>\n    utility.execute()<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute<br>\n    self.fetch_command(subcommand).run_from_argv(self.argv)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv<br>\n    self.execute(*args, **cmd_options)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute<br>\n    output = self.handle(*args, **options)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zerver/management/commands/convert_slack_data.py\", line 55, in handle<br>\n    do_convert_data(path, output_dir, token, threads=num_threads)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zerver/data_import/slack.py\", line 1068, in do_convert_data<br>\n    subprocess.check_call(['unzip', '-q', slack_zip_file, '-d', slack_data_dir])<br>\n  File \"/usr/lib/python3.6/subprocess.py\", line 311, in check_call<br>\n    raise CalledProcessError(retcode, cmd)<br>\nsubprocess.CalledProcessError: Command '['unzip', '-q', 'slack_data.zip', '-d', 'slack_data']' returned non-zero exit status 9.</p>",
        "id": 1087359,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608864179
    },
    {
        "content": "<p>That's good progress. That's because slack_data.zip can only be read by root.</p>",
        "id": 1087360,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608864323
    },
    {
        "content": "<p>You can do <code>chmod a+r slack_data.zip</code>.</p>",
        "id": 1087362,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608864355
    },
    {
        "content": "<p>Then try again.</p>",
        "id": 1087363,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608864361
    },
    {
        "content": "<p>But when I try to run as root I'm told to su to zulip instead.</p>\n<p>root@zulip-ubuntu-s-1vcpu-2gb-sfo2-01:/home/zulip/deployments/current# ./manage.py import '' converted_slack_data<br>\nmanage.py should not be run as root. Use <code>su zulip</code> to switch to the 'zulip'<br>\nuser before rerunning this, or use<br>\n  su zulip -c '/home/zulip/deployments/2020-12-24-16-48-03/manage.py ...'<br>\nto switch users and run this as a single command.</p>",
        "id": 1087364,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608864380
    },
    {
        "content": "<p>ok will try chmod</p>",
        "id": 1087365,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608864409
    },
    {
        "content": "<p>Yeah, just change the permission so that <code>zulip</code> can read the file.</p>",
        "id": 1087366,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608864420
    },
    {
        "content": "<p>Ok, progress, kinda...</p>\n<p>Processing dump: /home/zulip/deployments/2020-12-24-16-48-03/converted_slack_data ...<br>\n2020-12-25 02:47:18.981 INFO [] Importing realm dump /home/zulip/deployments/2020-12-24-16-48-03/converted_slack_data<br>\nTraceback (most recent call last):<br>\n  File \"./manage.py\", line 50, in &lt;module&gt;<br>\n    execute_from_command_line(sys.argv)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line<br>\n    utility.execute()<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute<br>\n    self.fetch_command(subcommand).run_from_argv(self.argv)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv<br>\n    self.execute(*args, **cmd_options)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute<br>\n    output = self.handle(*args, **options)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zerver/management/commands/import.py\", line 78, in handle<br>\n    realm = do_import_realm(path, subdomain, num_processes)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zerver/lib/import_realm.py\", line 792, in do_import_realm<br>\n    raise Exception(\"Missing realm.json file!\")<br>\nException: Missing realm.json file!</p>",
        "id": 1087367,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608864464
    },
    {
        "content": "<p>Does that mean <code>./manage.py convert_slack_data slack_data.zip --token &lt;token&gt; --output converted_slack_data</code> worked without error?</p>",
        "id": 1087368,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608864620
    },
    {
        "content": "<p>Ahhh whoops, I jumped a line.  Will try again.</p>",
        "id": 1087369,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608864670
    },
    {
        "content": "<p>Still no go.</p>\n<p>Converting Data ...<br>\n2020-12-25 02:51:24.461 INFO [] Not a Slack legacy token.<br>\n  This token might not have all the needed scopes. We need the following scopes:</p>\n<p>- emoji:read<br>\n  - users:read<br>\n  - users:<a href=\"http://read.email\">read.email</a><br>\n  - team:read<br>\nTraceback (most recent call last):<br>\n  File \"./manage.py\", line 50, in &lt;module&gt;<br>\n    execute_from_command_line(sys.argv)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py\", line 381, in execute_from_command_line<br>\n    utility.execute()<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/__init__.py\", line 375, in execute<br>\n    self.fetch_command(subcommand).run_from_argv(self.argv)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py\", line 323, in run_from_argv<br>\n    self.execute(*args, **cmd_options)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zulip-py3-venv/lib/python3.6/site-packages/django/core/management/base.py\", line 364, in execute<br>\n    output = self.handle(*args, **options)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zerver/management/commands/convert_slack_data.py\", line 55, in handle<br>\n    do_convert_data(path, output_dir, token, threads=num_threads)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zerver/data_import/slack.py\", line 1073, in do_convert_data<br>\n    fetch_shared_channel_users(user_list, slack_data_dir, token)<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zerver/data_import/slack.py\", line 979, in fetch_shared_channel_users<br>\n    public_channels = get_data_file(slack_data_dir + '/channels.json')<br>\n  File \"/home/zulip/deployments/2020-12-24-16-48-03/zerver/data_import/slack.py\", line 1123, in get_data_file<br>\n    with open(path) as fp:<br>\nFileNotFoundError: [Errno 2] No such file or directory: 'slack_data/channels.json'</p>",
        "id": 1087370,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608864699
    },
    {
        "content": "<p>Can you inspect whether the files in <code>slack_data/</code> directory look sensible?</p>",
        "id": 1087371,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608865160
    },
    {
        "content": "<p>No there is only one file and it's got the original filename of the zip file before I changed it.  Definitely something is screwy with the directory... I'm thinking I should probably delete and recreate it?</p>",
        "id": 1087372,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608865223
    },
    {
        "content": "<p>The error means <code>channels.json</code> doesn't exist, which is strange.</p>",
        "id": 1087373,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608865235
    },
    {
        "content": "<p>Wait, so what is inside <code>slack_data/</code> Is it slack_data.zip?</p>",
        "id": 1087374,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608865270
    },
    {
        "content": "<p>Maybe it is double-zipped?</p>",
        "id": 1087375,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608865277
    },
    {
        "content": "<p>Aha, the zip file is (of course) not the same as the resulting directory after unzipping.  I'll change the folder and re-zip.</p>",
        "id": 1087376,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608865319
    },
    {
        "content": "<p>Oh I think I see what's going on.  The folder is called slack_data, and it is zipped to slack_data.zip, so then it decompresses it's creating slack_data/ inside of slack_data.  I need to zip the raw files into slack_data.zip I bet.</p>",
        "id": 1087378,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608865509
    },
    {
        "content": "<p>Yeah something like that.</p>",
        "id": 1087379,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608865548
    },
    {
        "content": "<p>No nested folder</p>",
        "id": 1087380,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608865579
    },
    {
        "content": "<p>BINGO.  Getting somewhere at last!  <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 1087381,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608865609
    },
    {
        "content": "<p>Bit worried that this is still at the top of the output...</p>\n<p>Converting Data ...<br>\n2020-12-25 03:06:29.632 INFO [] Not a Slack legacy token.<br>\n  This token might not have all the needed scopes. We need the following scopes:</p>\n<p>- emoji:read<br>\n  - users:read<br>\n  - users:<a href=\"http://read.email\">read.email</a><br>\n  - team:read</p>",
        "id": 1087382,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608865640
    },
    {
        "content": "<p>The token you used doesn't have enough permission to access those content.</p>",
        "id": 1087383,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608865684
    },
    {
        "content": "<p>Hmmm well my partner sent it to me as he was the only one with the Slack access to do it.  He followed the instructions provided regarding obtaining the token, what should I tell him?</p>",
        "id": 1087384,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608865744
    },
    {
        "content": "<p>I think it is written in the documentation at <a href=\"https://zulip.com/help/import-from-slack\">https://zulip.com/help/import-from-slack</a>. It says</p>\n<blockquote>\n<p>Add OAuth scopes to your app. We need the following 'bot token scopes':<br>\nemoji:read<br>\nusers:read<br>\nusers:<a href=\"http://read.email\">read.email</a><br>\nteam:read</p>\n</blockquote>",
        "id": 1087385,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608865810
    },
    {
        "content": "<p>OK I will pass that along.  On a positive note, other than that message everything appears to have worked.  I'm resetting my password now and will see where I get from there.  Thank you!</p>",
        "id": 1087386,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608865938
    },
    {
        "content": "<p>How long does a password reset email usually take to arrive?  It's sending to my gmail account, nothing in spam.</p>",
        "id": 1087389,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608866085
    },
    {
        "content": "<p>30 minutes later and still no reset email.  I suspect it's not coming.  Is it maybe not being sent because the installation didn't do something fully correct?  How can I reset my password if the emails won't send?</p>",
        "id": 1087391,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608867821
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"18203\">@Jonathan van Clute</span> sorry, was away. Password reset email should take a minute the longest to arrive. You probably havent' set up the email correctly during installation.</p>",
        "id": 1087395,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608870119
    },
    {
        "content": "<p>You can change password with <code>./manage.py changepassword user@email.com</code>.</p>",
        "id": 1087397,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608870581
    },
    {
        "content": "<p>Hmmm... is there some step to set up the email during installation?  I simply followed the instructions as written and installation appeared to \"just work\".  It was the Slack import that gave me trouble.  I'll try the CLI option for changing password, thanks.</p>",
        "id": 1087745,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608931098
    },
    {
        "content": "<p>OK my partner will handle the email setup when we actually deploy production, so I'm not worried about that.</p>\n<p>Here's a new wrinkle.  I was able to change passwords from the CLI a couple of times for different users, no problem.  Now, it no longer works at all and I have no idea why.</p>\n<p>zulip@zulip-ubuntu-s-1vcpu-2gb-sfo2-01:~/deployments/current$ ./manage.py changepassword user@email<br>\nuser 'user@email' does not exist</p>\n<p>How come this doesn't work anymore?  I can't even change the passwords for the same users I previously changed without incident.</p>",
        "id": 1087833,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608952669
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"18203\">@Jonathan van Clute</span>  the user no longer exists, so quite possibly your partner had done a fresh reinstall and wiped out the realm?</p>",
        "id": 1087837,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608959444
    },
    {
        "content": "<p>Nope, he does not even have access.  In fact, his account is one of the ones I changed the password on already, so that I could log in as him in order to be admin.  I'm logged in at this very moment as one of the users it claims does not exist, and the other I can see plain as day in the user list.  I've tried 3 different users, all of which definitely exist, and I get the same error in all 3 cases (2 of them are the ones I had previously changed the password for).</p>",
        "id": 1087838,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608960529
    },
    {
        "content": "<p>Why did you change the passwords so often though?</p>",
        "id": 1087839,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608960651
    },
    {
        "content": "<p><code>manage.py changepassword</code> is Django-specific. Then maybe the only way forward is to make sure the emailing works.</p>",
        "id": 1087844,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608964361
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"10349\">@Mateusz Mandera</span> what do you think of the \"user x does not exist\" problem?</p>",
        "id": 1087877,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1608969603
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"2328\">@Rein Zustand</span> Due to being django-specific <code>changepassword</code> isn't very good at looking for UserProfiles (it looks at the .email field only) - e.g. it seems to break with email visibilitiy turned off. Pushed an adjusted version of this command to <a href=\"https://github.com/zulip/zulip/pull/16966\">https://github.com/zulip/zulip/pull/16966</a>.</p>\n<p><span class=\"user-mention\" data-user-id=\"18203\">@Jonathan van Clute</span> You might be able to grab its code to use it for changing the passwords.</p>",
        "id": 1088070,
        "sender_full_name": "Mateusz Mandera",
        "timestamp": 1608987669
    },
    {
        "content": "<p>I was only changing passwords so I could test out the Slack import before we committed to this fully and did it for real.  Since the email functionality wasn't working, I had no other way to get in.  Not something I would normally be doing with any frequency.</p>\n<p>As for grabbing code... that's above my pay grade I'm afraid.  If you can tell me exactly what command to issue in the CLI then no problem, but I'd most likely break something badly if I just started hacking away.</p>",
        "id": 1088135,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1608998312
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"10349\">@Mateusz Mandera</span> is there a way to intercept <code>changepassword</code> and then tell the user not to use it then exit 1?</p>",
        "id": 1088202,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609027590
    },
    {
        "content": "<p>So does that mean if the organization setting is such that email is visible, then <span class=\"user-mention\" data-user-id=\"18203\">@Jonathan van Clute</span> can be back to using <code>changepassword</code> once again?</p>",
        "id": 1088203,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609027663
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"2328\">Rein Zustand</span> <a href=\"#narrow/stream/31-production-help/topic/How.20to.20import.20Slack.3F/near/1088202\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"10349\">Mateusz Mandera</span> is there a way to intercept <code>changepassword</code> and then tell the user not to use it then exit 1?</p>\n</blockquote>\n<p>Based on <a href=\"https://docs.djangoproject.com/en/3.1/howto/custom-management-commands/#overriding-commands\">https://docs.djangoproject.com/en/3.1/howto/custom-management-commands/#overriding-commands</a> it seems that this would require us to put <code>zerver</code> on top of <code>INSTALLED_APPS</code> - and I'm not sure to what extent the current ordering is important and what else that change might end up affecting.</p>",
        "id": 1088385,
        "sender_full_name": "Mateusz Mandera",
        "timestamp": 1609098987
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"2328\">Rein Zustand</span> <a href=\"#narrow/stream/31-production-help/topic/How.20to.20import.20Slack.3F/near/1088203\">said</a>:</p>\n<blockquote>\n<p>So does that mean if the organization setting is such that email is visible, then <span class=\"user-mention silent\" data-user-id=\"18203\">Jonathan van Clute</span> can be back to using <code>changepassword</code> once again?</p>\n</blockquote>\n<p>That sounds likely indeed</p>",
        "id": 1088386,
        "sender_full_name": "Mateusz Mandera",
        "timestamp": 1609099021
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"18203\">@Jonathan van Clute</span> can you change back the settings to make user email visible again? This way you don't have to hack any code.</p>",
        "id": 1088419,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609113228
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"2328\">@Rein Zustand</span>  I'm afraid I don't know what that means.  I never made email \"invisible\".  It was just never configured when the Zulip was installed.</p>",
        "id": 1088420,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609113606
    },
    {
        "content": "<p><a href=\"https://zulip.com/help/restrict-visibility-of-email-addresses\">https://zulip.com/help/restrict-visibility-of-email-addresses</a></p>",
        "id": 1088421,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609113957
    },
    {
        "content": "<p>Oh email ADDRESSES... OK now I get it.  You just referred to \"user email\" so I assumed you were talking about email functionality (SMTP, etc.).  I have it set to only Admins can access them, so I guess the Zulip user isn't an admin and that's why it lost the ability to change passwords?  I'm already past needed to change a password again at this point but, good to know still.</p>",
        "id": 1088457,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609129705
    },
    {
        "content": "<p>We just discovered that our Slack plan apparently does not allow for exporting of DMs!  We had no idea.  This is a real drag as many of our members have had extensive private conversations with others.  I found some apps in the Slack marketplace for backing up DMs, for instance <a href=\"http://backupery.com\">backupery.com</a>, but is there a way to import from that?  Or to augment the slack_data import?</p>",
        "id": 1090791,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609461282
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"18203\">@Jonathan van Clute</span> can you provide anonymized sample content of the backup provided by <a href=\"http://backupery.com\">backupery.com</a>?</p>",
        "id": 1090793,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609463640
    },
    {
        "content": "<p>I actually haven't tried it yet at all, just found a link to it and mentioned it to my partners.  I'll have to see what they want to do first as I don't have access to what it would need to be able to test it myself.</p>",
        "id": 1090795,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609463932
    },
    {
        "content": "<p>There's a sample export here <a href=\"https://www.backupery.com/backupery-for-slack-export-structure/\">https://www.backupery.com/backupery-for-slack-export-structure/</a></p>",
        "id": 1090796,
        "sender_full_name": "Jonathan Rudenberg",
        "timestamp": 1609463995
    },
    {
        "content": "<p>Thanks.  <span class=\"user-mention\" data-user-id=\"2328\">@Rein Zustand</span> will that show you what you need to know?</p>",
        "id": 1090799,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609465344
    },
    {
        "content": "<p>Currently looking at it.</p>",
        "id": 1090800,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609465372
    },
    {
        "content": "<p>It appears that inside the sample zip, there is a directory called ReadyToImport. The content seems to be identical to standard Slack export.</p>",
        "id": 1090802,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609465750
    },
    {
        "content": "<p>Is <a href=\"http://backupery.com\">backupery.com</a> free as in beer?</p>",
        "id": 1090803,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609465768
    },
    {
        "content": "<p>Personally I don't know anything about it other than what is visible on its download page.</p>",
        "id": 1091079,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609523630
    },
    {
        "content": "<p>I did see the author post in Reddit that it has a 30 day free trial but that if that's not long enough for someone to get the data they need, that he would gladly extend it.</p>",
        "id": 1091094,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609525345
    },
    {
        "content": "<p>I'm trying Backupery now, seems it's extremely easy to use and if its export structure is such that Zulip could import it and keep all of our members' prior DMs in Zulip, that would be amazing.  I wonder how Zulip would handle threaded Slack DMs though.</p>",
        "id": 1091524,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609616221
    },
    {
        "content": "<p>The current Slack import tool doesn't support public/private threads.<br>\n^ <span class=\"user-mention\" data-user-id=\"52\">@Vishnu KS</span> is this correct? Need to be added in caveats?</p>",
        "id": 1091529,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609617278
    },
    {
        "content": "<p>Aha so Zulip currently cannot import Slack DMs even if they have been exported from Slack?</p>",
        "id": 1091534,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609618696
    },
    {
        "content": "<p>In case anyone else ever runs into this, I exported my entire Slack history from our old community (including all content of every channel) using backupery, and I'm now re-importing it into a private free Slack that I control, so I'll still have everything just as it was and always be able to go back and review it should I want to.  Very handy to know I can do this and it's free, so I don't really have to worry about importing my DMs into Zulip after all.</p>",
        "id": 1091569,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609627723
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"18203\">Jonathan van Clute</span> <a href=\"#narrow/stream/31-production-help/topic/How.20to.20import.20Slack.3F/near/1091534\">said</a>:</p>\n<blockquote>\n<p>Aha so Zulip currently cannot import Slack DMs even if they have been exported from Slack?</p>\n</blockquote>\n<p>No, no. Zulip can import DMs. I meant <em>threads</em>.</p>",
        "id": 1091576,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609634836
    },
    {
        "content": "<p>Ah ok, gotcha.  I have discovered that our Slack has been imported but of course has lost all the threaded conversations, which is supremely unfortunate but... such is life I guess.  This is why I also imported it into my own Slack so I could maintain a copy of it as it was.</p>",
        "id": 1091578,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609635074
    },
    {
        "content": "<p>There is an <a href=\"https://github.com/zulip/zulip/issues/9006\">open issue</a> for importing threads. A PR was also created but it didn't get merged.</p>",
        "id": 1092086,
        "sender_full_name": "Vishnu KS",
        "timestamp": 1609777085
    },
    {
        "content": "<blockquote>\n<p>^ @Vishnu KS is this correct? Need to be added in caveats?</p>\n</blockquote>\n<p>Yeah. We should add that. Will create a PR.</p>",
        "id": 1092088,
        "sender_full_name": "Vishnu KS",
        "timestamp": 1609777145
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"18203\">@Jonathan van Clute</span> &gt;  Slack has been imported but of course has lost all the threaded conversations, which is supremely unfortunate</p>\n<p>The messages are still there right? Only that they are not ordered properly?</p>",
        "id": 1092091,
        "sender_full_name": "Vishnu KS",
        "timestamp": 1609777249
    },
    {
        "content": "<p>Yes the messages appear to all be there, just lost any threading that had been used in Slack.  That was one of our biggest issues with Slack, that it didn't actually enforce threading, so conversations ended up splintered all over the place when some people used threading some of the time.</p>",
        "id": 1092264,
        "sender_full_name": "Jonathan van Clute",
        "timestamp": 1609785904
    },
    {
        "content": "<p>I can pick up <span class=\"user-mention silent\" data-user-id=\"3278\">Rhea Parekh</span> 's threading PR.</p>",
        "id": 1093254,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609899804
    },
    {
        "content": "<p>Thanks!</p>",
        "id": 1093310,
        "sender_full_name": "Vishnu KS",
        "timestamp": 1609911300
    },
    {
        "content": "<p>Made a PR on the caveats: <a href=\"https://github.com/zulip/zulip/pull/17018\">#17018</a>.</p>",
        "id": 1093341,
        "sender_full_name": "Rein Zustand",
        "timestamp": 1609915472
    }
]