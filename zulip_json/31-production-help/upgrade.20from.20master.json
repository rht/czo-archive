[
    {
        "content": "<p>Hi, just running an upgrade from master. the last upgrade I did was on 22nd January. <br>\nI run into multiple errors but it all led back to </p>\n<div class=\"codehilite\"><pre><span></span>deb https://packagecloud.io/zulip/server/debian/ stretch main\ndeb https://packages.groonga.org/debian/ stretch main\ndeb-src https://packages.groonga.org/debian/ stretch main\n</pre></div>\n\n\n<p>existing in both <code>/etc/apt/sources.list</code> and <code>/etc/apt/sources.list.d/zulip.list</code></p>\n<p>I commented out the former.</p>",
        "id": 709828,
        "sender_full_name": "Matthias",
        "timestamp": 1551391156
    },
    {
        "content": "<p>now I run  into a new problem.</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">Operations</span> <span class=\"n\">to</span> <span class=\"n\">perform</span><span class=\"p\">:</span>\n  <span class=\"n\">Apply</span> <span class=\"nb\">all</span> <span class=\"n\">migrations</span><span class=\"p\">:</span> <span class=\"n\">analytics</span><span class=\"p\">,</span> <span class=\"n\">auth</span><span class=\"p\">,</span> <span class=\"n\">confirmation</span><span class=\"p\">,</span> <span class=\"n\">contenttypes</span><span class=\"p\">,</span> <span class=\"n\">otp_static</span><span class=\"p\">,</span> <span class=\"n\">otp_totp</span><span class=\"p\">,</span> <span class=\"n\">sessions</span><span class=\"p\">,</span> <span class=\"n\">social_django</span><span class=\"p\">,</span> <span class=\"n\">two_factor</span><span class=\"p\">,</span> <span class=\"n\">zerver</span>\n<span class=\"n\">Running</span> <span class=\"n\">migrations</span><span class=\"p\">:</span>\n  <span class=\"n\">Applying</span> <span class=\"n\">zerver</span><span class=\"o\">.</span><span class=\"mo\">0206</span><span class=\"n\">_stream_rendered_description</span><span class=\"o\">...</span><span class=\"mi\">2019</span><span class=\"o\">-</span><span class=\"mo\">02</span><span class=\"o\">-</span><span class=\"mi\">28</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">58</span><span class=\"p\">:</span><span class=\"mf\">17.972</span> <span class=\"n\">ERR</span>  <span class=\"p\">[]</span> <span class=\"ne\">Exception</span> <span class=\"ow\">in</span> <span class=\"n\">Markdown</span> <span class=\"n\">parser</span><span class=\"p\">:</span> <span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/bugdown/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1012</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"n\">extracted_data</span> <span class=\"o\">=</span> <span class=\"n\">link_preview</span><span class=\"o\">.</span><span class=\"n\">link_embed_data_from_cache</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/cache.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">126</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">func_with_caching</span>\n    <span class=\"k\">raise</span> <span class=\"n\">NotFoundInCache</span><span class=\"p\">()</span>\n<span class=\"n\">zerver</span><span class=\"o\">.</span><span class=\"n\">lib</span><span class=\"o\">.</span><span class=\"n\">cache</span><span class=\"o\">.</span><span class=\"n\">NotFoundInCache</span>\n\n<span class=\"n\">During</span> <span class=\"n\">handling</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">above</span> <span class=\"n\">exception</span><span class=\"p\">,</span> <span class=\"n\">another</span> <span class=\"n\">exception</span> <span class=\"n\">occurred</span><span class=\"p\">:</span>\n\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/bugdown/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2213</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">do_convert</span>\n    <span class=\"n\">rendered_content</span> <span class=\"o\">=</span> <span class=\"n\">timeout</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"n\">_md_engine</span><span class=\"o\">.</span><span class=\"n\">convert</span><span class=\"p\">,</span> <span class=\"n\">content</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/timeout.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">88</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">timeout</span>\n    <span class=\"n\">six</span><span class=\"o\">.</span><span class=\"n\">reraise</span><span class=\"p\">(</span><span class=\"n\">thread</span><span class=\"o\">.</span><span class=\"n\">exc_info</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">thread</span><span class=\"o\">.</span><span class=\"n\">exc_info</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">thread</span><span class=\"o\">.</span><span class=\"n\">exc_info</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">])</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/six.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">693</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">reraise</span>\n    <span class=\"k\">raise</span> <span class=\"n\">value</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/timeout.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">48</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">func</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/markdown/core.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">272</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">convert</span>\n    <span class=\"n\">newRoot</span> <span class=\"o\">=</span> <span class=\"n\">treeprocessor</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">(</span><span class=\"n\">root</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/bugdown/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1014</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">markdown</span><span class=\"o\">.</span><span class=\"n\">zulip_message</span><span class=\"o\">.</span><span class=\"n\">links_for_preview</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">)</span>\n<span class=\"ne\">AttributeError</span><span class=\"p\">:</span> <span class=\"s1\">&#39;NoneType&#39;</span> <span class=\"nb\">object</span> <span class=\"n\">has</span> <span class=\"n\">no</span> <span class=\"n\">attribute</span> <span class=\"s1\">&#39;links_for_preview&#39;</span>\n<span class=\"n\">Input</span> <span class=\"p\">(</span><span class=\"n\">sanitized</span><span class=\"p\">)</span> <span class=\"n\">was</span><span class=\"p\">:</span> <span class=\"s1\">&#39;xxxxx xxxxxxxx xx xxxxxxxx xxx xxxxx xxxxxx xx xxx xxxxx: xxxx://xxx.xxxxxxxx.xx/xx/xxxx/xxxxxxx-xxxxxxxx/xxxxxxxxxxxxxxx/xx-xxxxx-xxxxxxx-xxx-xxxx/&#39;</span>\n <span class=\"p\">(</span><span class=\"n\">message</span> <span class=\"n\">unknown</span><span class=\"p\">)</span>\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/bugdown/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1012</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"n\">extracted_data</span> <span class=\"o\">=</span> <span class=\"n\">link_preview</span><span class=\"o\">.</span><span class=\"n\">link_embed_data_from_cache</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/cache.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">126</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">func_with_caching</span>\n    <span class=\"k\">raise</span> <span class=\"n\">NotFoundInCache</span><span class=\"p\">()</span>\n<span class=\"n\">zerver</span><span class=\"o\">.</span><span class=\"n\">lib</span><span class=\"o\">.</span><span class=\"n\">cache</span><span class=\"o\">.</span><span class=\"n\">NotFoundInCache</span>\n\n<span class=\"n\">During</span> <span class=\"n\">handling</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">above</span> <span class=\"n\">exception</span><span class=\"p\">,</span> <span class=\"n\">another</span> <span class=\"n\">exception</span> <span class=\"n\">occurred</span><span class=\"p\">:</span>\n\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/bugdown/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2213</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">do_convert</span>\n    <span class=\"n\">rendered_content</span> <span class=\"o\">=</span> <span class=\"n\">timeout</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"n\">_md_engine</span><span class=\"o\">.</span><span class=\"n\">convert</span><span class=\"p\">,</span> <span class=\"n\">content</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/timeout.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">88</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">timeout</span>\n    <span class=\"n\">six</span><span class=\"o\">.</span><span class=\"n\">reraise</span><span class=\"p\">(</span><span class=\"n\">thread</span><span class=\"o\">.</span><span class=\"n\">exc_info</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">thread</span><span class=\"o\">.</span><span class=\"n\">exc_info</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">thread</span><span class=\"o\">.</span><span class=\"n\">exc_info</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">])</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/six.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">693</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">reraise</span>\n    <span class=\"k\">raise</span> <span class=\"n\">value</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/timeout.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">48</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">func</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/markdown/core.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">272</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">convert</span>\n    <span class=\"n\">newRoot</span> <span class=\"o\">=</span> <span class=\"n\">treeprocessor</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">(</span><span class=\"n\">root</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/bugdown/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1014</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">markdown</span><span class=\"o\">.</span><span class=\"n\">zulip_message</span><span class=\"o\">.</span><span class=\"n\">links_for_preview</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">)</span>\n<span class=\"ne\">AttributeError</span><span class=\"p\">:</span> <span class=\"s1\">&#39;NoneType&#39;</span> <span class=\"nb\">object</span> <span class=\"n\">has</span> <span class=\"n\">no</span> <span class=\"n\">attribute</span> <span class=\"s1\">&#39;links_for_preview&#39;</span>\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/bugdown/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1012</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"n\">extracted_data</span> <span class=\"o\">=</span> <span class=\"n\">link_preview</span><span class=\"o\">.</span><span class=\"n\">link_embed_data_from_cache</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/cache.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">126</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">func_with_caching</span>\n    <span class=\"k\">raise</span> <span class=\"n\">NotFoundInCache</span><span class=\"p\">()</span>\n<span class=\"n\">zerver</span><span class=\"o\">.</span><span class=\"n\">lib</span><span class=\"o\">.</span><span class=\"n\">cache</span><span class=\"o\">.</span><span class=\"n\">NotFoundInCache</span>\n\n<span class=\"n\">During</span> <span class=\"n\">handling</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">above</span> <span class=\"n\">exception</span><span class=\"p\">,</span> <span class=\"n\">another</span> <span class=\"n\">exception</span> <span class=\"n\">occurred</span><span class=\"p\">:</span>\n\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/bugdown/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2213</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">do_convert</span>\n    <span class=\"n\">rendered_content</span> <span class=\"o\">=</span> <span class=\"n\">timeout</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"n\">_md_engine</span><span class=\"o\">.</span><span class=\"n\">convert</span><span class=\"p\">,</span> <span class=\"n\">content</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/timeout.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">88</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">timeout</span>\n    <span class=\"n\">six</span><span class=\"o\">.</span><span class=\"n\">reraise</span><span class=\"p\">(</span><span class=\"n\">thread</span><span class=\"o\">.</span><span class=\"n\">exc_info</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">thread</span><span class=\"o\">.</span><span class=\"n\">exc_info</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">thread</span><span class=\"o\">.</span><span class=\"n\">exc_info</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">])</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/six.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">693</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">reraise</span>\n    <span class=\"k\">raise</span> <span class=\"n\">value</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/timeout.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">48</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">func</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/markdown/core.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">272</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">convert</span>\n    <span class=\"n\">newRoot</span> <span class=\"o\">=</span> <span class=\"n\">treeprocessor</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">(</span><span class=\"n\">root</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/bugdown/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1014</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">markdown</span><span class=\"o\">.</span><span class=\"n\">zulip_message</span><span class=\"o\">.</span><span class=\"n\">links_for_preview</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">)</span>\n<span class=\"ne\">AttributeError</span><span class=\"p\">:</span> <span class=\"s1\">&#39;NoneType&#39;</span> <span class=\"nb\">object</span> <span class=\"n\">has</span> <span class=\"n\">no</span> <span class=\"n\">attribute</span> <span class=\"s1\">&#39;links_for_preview&#39;</span>\n\n<span class=\"n\">During</span> <span class=\"n\">handling</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">above</span> <span class=\"n\">exception</span><span class=\"p\">,</span> <span class=\"n\">another</span> <span class=\"n\">exception</span> <span class=\"n\">occurred</span><span class=\"p\">:</span>\n\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;./manage.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">46</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"n\">execute_from_command_line</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">364</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">execute_from_command_line</span>\n    <span class=\"n\">utility</span><span class=\"o\">.</span><span class=\"n\">execute</span><span class=\"p\">()</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">356</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">execute</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">fetch_command</span><span class=\"p\">(</span><span class=\"n\">subcommand</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">run_from_argv</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">283</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">run_from_argv</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">execute</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">cmd_options</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">330</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">execute</span>\n    <span class=\"n\">output</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">handle</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">options</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/commands/migrate.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">204</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">handle</span>\n    <span class=\"n\">fake_initial</span><span class=\"o\">=</span><span class=\"n\">fake_initial</span><span class=\"p\">,</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">115</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">migrate</span>\n    <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_migrate_all_forwards</span><span class=\"p\">(</span><span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"n\">plan</span><span class=\"p\">,</span> <span class=\"n\">full_plan</span><span class=\"p\">,</span> <span class=\"n\">fake</span><span class=\"o\">=</span><span class=\"n\">fake</span><span class=\"p\">,</span> <span class=\"n\">fake_initial</span><span class=\"o\">=</span><span class=\"n\">fake_initial</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">145</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_migrate_all_forwards</span>\n    <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">apply_migration</span><span class=\"p\">(</span><span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"n\">migration</span><span class=\"p\">,</span> <span class=\"n\">fake</span><span class=\"o\">=</span><span class=\"n\">fake</span><span class=\"p\">,</span> <span class=\"n\">fake_initial</span><span class=\"o\">=</span><span class=\"n\">fake_initial</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">244</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">apply_migration</span>\n    <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"n\">migration</span><span class=\"o\">.</span><span class=\"n\">apply</span><span class=\"p\">(</span><span class=\"n\">state</span><span class=\"p\">,</span> <span class=\"n\">schema_editor</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/migration.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">129</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"nb\">apply</span>\n    <span class=\"n\">operation</span><span class=\"o\">.</span><span class=\"n\">database_forwards</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">app_label</span><span class=\"p\">,</span> <span class=\"n\">schema_editor</span><span class=\"p\">,</span> <span class=\"n\">old_state</span><span class=\"p\">,</span> <span class=\"n\">project_state</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/operations/special.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">193</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">database_forwards</span>\n    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">code</span><span class=\"p\">(</span><span class=\"n\">from_state</span><span class=\"o\">.</span><span class=\"n\">apps</span><span class=\"p\">,</span> <span class=\"n\">schema_editor</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/migrations/0206_stream_rendered_description.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">render_all_stream_descriptions</span>\n    <span class=\"n\">stream</span><span class=\"o\">.</span><span class=\"n\">rendered_description</span> <span class=\"o\">=</span> <span class=\"n\">bugdown_convert</span><span class=\"p\">(</span><span class=\"n\">stream</span><span class=\"o\">.</span><span class=\"n\">description</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/bugdown/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2272</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">convert</span>\n    <span class=\"n\">mention_data</span><span class=\"p\">,</span> <span class=\"n\">email_gateway</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/zerver/lib/bugdown/__init__.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">2231</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">do_convert</span>\n    <span class=\"k\">raise</span> <span class=\"n\">BugdownRenderingException</span><span class=\"p\">()</span>\n<span class=\"n\">zerver</span><span class=\"o\">.</span><span class=\"n\">lib</span><span class=\"o\">.</span><span class=\"n\">exceptions</span><span class=\"o\">.</span><span class=\"n\">BugdownRenderingException</span>\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2019-02-28-21-55-06/scripts/lib/upgrade-zulip-stage-2&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">175</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"n\">subprocess</span><span class=\"o\">.</span><span class=\"n\">check_call</span><span class=\"p\">([</span><span class=\"s2\">&quot;./manage.py&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;migrate&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;--noinput&quot;</span><span class=\"p\">],</span> <span class=\"n\">preexec_fn</span><span class=\"o\">=</span><span class=\"n\">su_to_zulip</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/lib/python3.5/subprocess.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">271</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">check_call</span>\n    <span class=\"k\">raise</span> <span class=\"n\">CalledProcessError</span><span class=\"p\">(</span><span class=\"n\">retcode</span><span class=\"p\">,</span> <span class=\"n\">cmd</span><span class=\"p\">)</span>\n<span class=\"n\">subprocess</span><span class=\"o\">.</span><span class=\"n\">CalledProcessError</span><span class=\"p\">:</span> <span class=\"n\">Command</span> <span class=\"s1\">&#39;[&#39;</span><span class=\"o\">./</span><span class=\"n\">manage</span><span class=\"o\">.</span><span class=\"n\">py</span><span class=\"s1\">&#39;, &#39;</span><span class=\"n\">migrate</span><span class=\"s1\">&#39;, &#39;</span><span class=\"o\">--</span><span class=\"n\">noinput</span><span class=\"s1\">&#39;]&#39;</span> <span class=\"n\">returned</span> <span class=\"n\">non</span><span class=\"o\">-</span><span class=\"n\">zero</span> <span class=\"nb\">exit</span> <span class=\"n\">status</span> <span class=\"mi\">1</span>\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/current/scripts/lib/upgrade-zulip-from-git&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">70</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"n\">deploy_path</span><span class=\"p\">,</span> <span class=\"s2\">&quot;--from-git&quot;</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"n\">deploy_options</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/usr/lib/python3.5/subprocess.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">271</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">check_call</span>\n    <span class=\"k\">raise</span> <span class=\"n\">CalledProcessError</span><span class=\"p\">(</span><span class=\"n\">retcode</span><span class=\"p\">,</span> <span class=\"n\">cmd</span><span class=\"p\">)</span>\n<span class=\"n\">subprocess</span><span class=\"o\">.</span><span class=\"n\">CalledProcessError</span><span class=\"p\">:</span> <span class=\"n\">Command</span> <span class=\"s1\">&#39;[&#39;</span><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">zulip</span><span class=\"o\">/</span><span class=\"n\">deployments</span><span class=\"o\">/</span><span class=\"mi\">2019</span><span class=\"o\">-</span><span class=\"mo\">02</span><span class=\"o\">-</span><span class=\"mi\">28</span><span class=\"o\">-</span><span class=\"mi\">21</span><span class=\"o\">-</span><span class=\"mi\">55</span><span class=\"o\">-</span><span class=\"mo\">06</span><span class=\"o\">/</span><span class=\"n\">scripts</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">upgrade</span><span class=\"o\">-</span><span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">stage</span><span class=\"o\">-</span><span class=\"mi\">2</span><span class=\"s1\">&#39;, &#39;</span><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">zulip</span><span class=\"o\">/</span><span class=\"n\">deployments</span><span class=\"o\">/</span><span class=\"mi\">2019</span><span class=\"o\">-</span><span class=\"mo\">02</span><span class=\"o\">-</span><span class=\"mi\">28</span><span class=\"o\">-</span><span class=\"mi\">21</span><span class=\"o\">-</span><span class=\"mi\">55</span><span class=\"o\">-</span><span class=\"mo\">06</span><span class=\"s1\">&#39;, &#39;</span><span class=\"o\">--</span><span class=\"n\">from</span><span class=\"o\">-</span><span class=\"n\">git</span><span class=\"s1\">&#39;]&#39;</span> <span class=\"n\">returned</span> <span class=\"n\">non</span><span class=\"o\">-</span><span class=\"n\">zero</span> <span class=\"nb\">exit</span> <span class=\"n\">status</span> <span class=\"mi\">1</span>\n</pre></div>",
        "id": 709829,
        "sender_full_name": "Matthias",
        "timestamp": 1551391269
    },
    {
        "content": "<p>any idea what's going on?<br>\nMight be good to fix this before release 2.0 ;-)</p>",
        "id": 709830,
        "sender_full_name": "Matthias",
        "timestamp": 1551391383
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> If you can help that would be great. Currently Zulip server is dead</p>",
        "id": 709833,
        "sender_full_name": "Matthias",
        "timestamp": 1551391712
    },
    {
        "content": "<p>looks like something relating to the links preview feature?</p>",
        "id": 709834,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1551392051
    },
    {
        "content": "<p>is that something we can fix so that the upgrade goes through?</p>",
        "id": 709835,
        "sender_full_name": "Matthias",
        "timestamp": 1551392078
    },
    {
        "content": "<p>maybe try turning it off?</p>",
        "id": 709836,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1551392096
    },
    {
        "content": "<p>otherwise I see myself forced to restore the container from a backup but Id rather not</p>",
        "id": 709837,
        "sender_full_name": "Matthias",
        "timestamp": 1551392104
    },
    {
        "content": "<p>how do I do that?</p>",
        "id": 709838,
        "sender_full_name": "Matthias",
        "timestamp": 1551392116
    },
    {
        "content": "<p>(these are just guesses, feel free to ignore)</p>",
        "id": 709839,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1551392118
    },
    {
        "content": "<p>I think it's probably in settings.py. But it's off by default, so would only be turned on if you had turned it on int the past</p>",
        "id": 709840,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1551392139
    },
    {
        "content": "<p>ok, done. Will that already take apply when I rerun the update script?</p>",
        "id": 709842,
        "sender_full_name": "Matthias",
        "timestamp": 1551392265
    },
    {
        "content": "<p>good question. I am not sure. <br>\nNote that you can always rollback to a previous version, when upgrades fail: <br>\n<a href=\"https://zulip.readthedocs.io/en/stable/production/maintain-secure-upgrade.html#rolling-back-to-a-prior-version\" target=\"_blank\" title=\"https://zulip.readthedocs.io/en/stable/production/maintain-secure-upgrade.html#rolling-back-to-a-prior-version\">https://zulip.readthedocs.io/en/stable/production/maintain-secure-upgrade.html#rolling-back-to-a-prior-version</a></p>",
        "id": 709843,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1551392545
    },
    {
        "content": "<p>(though I'm not sure how that works with database migrations)</p>",
        "id": 709844,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1551392578
    },
    {
        "content": "<p>I tried that and it's not working</p>",
        "id": 709845,
        "sender_full_name": "Matthias",
        "timestamp": 1551392601
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"131\">@Rishi Gupta</span> I just tried rerunning the upgrade and now it went through. Your guess was spot on after all.</p>",
        "id": 709846,
        "sender_full_name": "Matthias",
        "timestamp": 1551392963
    },
    {
        "content": "<p>so maybe that's something to look into then when URL_PREVIEW is turned on that it might mess with the upgrade process</p>",
        "id": 709847,
        "sender_full_name": "Matthias",
        "timestamp": 1551392991
    },
    {
        "content": "<p>yeah, definitely. Thanks for the report!</p>",
        "id": 709848,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1551393022
    },
    {
        "content": "<p>I turned the setting on again and restarted Zulip and that seems to work as well.</p>",
        "id": 709849,
        "sender_full_name": "Matthias",
        "timestamp": 1551393158
    },
    {
        "content": "<p>What  I noticed though is that the organisation logo top left has defaulted back to the Zulip  logo although in the settings our orga logo is still set</p>",
        "id": 709850,
        "sender_full_name": "Matthias",
        "timestamp": 1551393196
    },
    {
        "content": "<p>after reuploading it was back (using night mode if that might be of any relevance)</p>",
        "id": 709851,
        "sender_full_name": "Matthias",
        "timestamp": 1551393290
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"131\">@Rishi Gupta</span> Thanks again for your help!</p>",
        "id": 709852,
        "sender_full_name": "Matthias",
        "timestamp": 1551393304
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"1646\">@Matthias</span> thanks for the reports!  Definitely the migration interaction with inline line previews I'll want to fix and know how to.</p>",
        "id": 709863,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1551394430
    },
    {
        "content": "<p>For this issue:</p>\n<blockquote>\n<p>Hi, just running an upgrade from master. the last upgrade I did was on 22nd January. <br>\nI run into multiple errors but it all led back to </p>\n<div class=\"codehilite\"><pre><span></span>deb https://packagecloud.io/zulip/server/debian/ stretch main\ndeb https://packages.groonga.org/debian/ stretch main\ndeb-src https://packages.groonga.org/debian/ stretch main\n</pre></div>\n\n\n<p>existing in both <code>/etc/apt/sources.list</code> and <code>/etc/apt/sources.list.d/zulip.list</code></p>\n<p>I commented out the former.</p>\n</blockquote>\n<p>I'm a bit puzzled; I'm not aware of our ever having a version that would have put those lines in <code>/etc/apt/sources.list</code> rather than in <code>zulip.list</code>.</p>",
        "id": 709865,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1551394574
    },
    {
        "content": "<blockquote>\n<p>What  I noticed though is that the organisation logo top left has defaulted back to the Zulip  logo although in the settings our orga logo is still set</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"1646\">@Matthias</span> can you provide more details on the exact sequence of events here?</p>",
        "id": 709867,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1551394643
    },
    {
        "content": "<p>logo: After the last upgrade on 22nd of January I uploaded the company logo and it worked fine. After the upgrade today I saw again the Zulip logo and when I checked the settings the menu was still showing the uploaded image for both themes (normal and night mode).<br>\nI didn't check for the logo before the upgrade though and can't remember whether it might have been missing before. <br>\nThat's all I can  tell.</p>",
        "id": 709875,
        "sender_full_name": "Matthias",
        "timestamp": 1551394921
    },
    {
        "content": "<p>Hmm, OK</p>",
        "id": 709877,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1551395224
    },
    {
        "content": "<p>The main logo-related thing we changed was adding support for a separate night-mode logo (for logos that need to be changed to look good on a dark background)</p>",
        "id": 709879,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1551395278
    },
    {
        "content": "<p>yes, that might be it. When I uploaded the night mode image (although the preview was already showing) the delete button appeared   below it and it wasn't there before.</p>",
        "id": 709880,
        "sender_full_name": "Matthias",
        "timestamp": 1551395379
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"1646\">@Matthias</span> I just fixed that upgrade issue in <a href=\"https://github.com/zulip/zulip/commit/de65a04ae08826e9a6b21c86d208706b77292da1\" target=\"_blank\" title=\"https://github.com/zulip/zulip/commit/de65a04ae08826e9a6b21c86d208706b77292da1\">de65a04ae08826e9a6b21c86d208706b77292da1</a>, thanks for the report!  <span class=\"user-mention\" data-user-id=\"9895\">@Hemanth V. Alluri</span> FYI, since this was an issue we didn't think of.  There is also probably some useful follow-up to do of making a <code>render_stream_description</code> function wrapping <code>bugdown_convert</code> so that we don't have to worry about updating 5 call points in future changes -- it'd be great if you can take the refactor.</p>",
        "id": 709910,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1551402232
    },
    {
        "content": "<blockquote>\n<p>There is also probably some useful follow-up to do of making a render_stream_description function wrapping bugdown_convert so that we don't have to worry about updating 5 call points in future changes</p>\n</blockquote>\n<p>Totally agree. I opened PR <a href=\"https://github.com/zulip/zulip/pull/11728\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/11728\">#11728</a> for this, and would like some feedback about a design decision I made.</p>",
        "id": 710096,
        "sender_full_name": "Hemanth V. Alluri",
        "timestamp": 1551440551
    },
    {
        "content": "<p>after this troublesome upgrade I have 3 redundant versions in the deployment folder. Is there a safe way to delete those that are not used?</p>",
        "id": 711453,
        "sender_full_name": "Matthias",
        "timestamp": 1551535750
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> ping</p>",
        "id": 711454,
        "sender_full_name": "Matthias",
        "timestamp": 1551535768
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"1646\">@Matthias</span> old ones get automatically garbage-collected during later upgrades</p>",
        "id": 711566,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1551546062
    },
    {
        "content": "<p><code>scripts/purge-old-deployments</code> is the manual tool for doing that, though by default it keeps them from the last week or so.</p>",
        "id": 711567,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1551546076
    },
    {
        "content": "<p>So there's no action required here unless you're nearly out of disk</p>",
        "id": 711568,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1551546089
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"1646\">@Matthias</span> I believe I fixed the logo issue in master today as well, thanks to another report that made me realize what the bug was.</p>",
        "id": 711978,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1551578863
    },
    {
        "content": "<p>We'll be doing a 2.0.1 release with that fix soon.</p>",
        "id": 711979,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1551578900
    },
    {
        "content": "<p>thanks, so next weekend I could run that purge script and get back some space. It's not so much disk space but the container backups (with compression) take a lot longer. Further 3 of those folders are basically failed upgrades, the content is identical.</p>",
        "id": 712405,
        "sender_full_name": "Matthias",
        "timestamp": 1551643754
    }
]