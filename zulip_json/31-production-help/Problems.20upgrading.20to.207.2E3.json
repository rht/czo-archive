[
    {
        "content": "<p>Hi, I'm currently attempting to upgrade our installation to version 7.3, and here are the results:</p>\n<p>root@im:~# /home/zulip/deployments/current/scripts/upgrade-zulip zulip-server-latest.tar.gz <br>\n2023-08-30 08:06:52,439 upgrade-zulip: Archiving the tarball under /home/zulip/archives<br>\n2023-08-30 08:06:52,607 upgrade-zulip: Unpacking the tarball<br>\n2023-08-30 08:06:54,759 upgrade-zulip-stage-2: Upgrading from 7.2 to 7.3, in /home/zulip/deployments/2023-08-30-10-06-52<br>\npostgresql-10-pgdg-pgroonga was already set on hold.<br>\npostgresql-13-pgdg-pgroonga was already set on hold.<br>\npostgresql-14-pgdg-pgroonga was already set on hold.<br>\npostgresql-15-pgdg-pgroonga was already set on hold.<br>\npostgresql-11-pgdg-pgroonga set on hold.<br>\npostgresql-12-pgdg-pgroonga set on hold.<br>\n2023-08-30 08:06:55,032 upgrade-zulip-stage-2: Upgrading system packages...<br>\nHit:1 <a href=\"http://asi-fs-d.contabo.net/ubuntu\">http://asi-fs-d.contabo.net/ubuntu</a> focal InRelease<br>\nHit:2 <a href=\"http://asi-fs-d.contabo.net/ubuntu\">http://asi-fs-d.contabo.net/ubuntu</a> focal-updates InRelease<br>\nHit:3 <a href=\"http://asi-fs-d.contabo.net/ubuntu\">http://asi-fs-d.contabo.net/ubuntu</a> focal-backports InRelease<br>\nHit:4 <a href=\"http://ppa.launchpad.net/groonga/ppa/ubuntu\">http://ppa.launchpad.net/groonga/ppa/ubuntu</a> focal InRelease<br>\nHit:5 <a href=\"http://archive.ubuntu.com/ubuntu\">http://archive.ubuntu.com/ubuntu</a> focal InRelease<br>\nHit:6 <a href=\"http://security.ubuntu.com/ubuntu\">http://security.ubuntu.com/ubuntu</a> focal-security InRelease<br>\nHit:7 <a href=\"http://apt.postgresql.org/pub/repos/apt\">http://apt.postgresql.org/pub/repos/apt</a> focal-pgdg InRelease<br>\nIgn:8 <a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable InRelease<br>\nGet:9 <a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable Release [16.0 kB]<br>\nGet:10 <a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable Release.gpg [819 B]<br>\nIgn:10 <a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable Release.gpg<br>\nHit:11 <a href=\"https://packages.groonga.org/ubuntu\">https://packages.groonga.org/ubuntu</a> focal InRelease<br>\nReading package lists...<br>\nW: Target Packages (main/binary-amd64/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Packages (main/binary-i386/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Packages (main/binary-all/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Translations (main/i18n/Translation-en) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target CNF (main/cnf/Commands-amd64) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target CNF (main/cnf/Commands-all) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: GPG error: <a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable Release: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY 2D223B918916F2A2<br>\nE: The repository '<a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable Release' is not signed.<br>\nW: Target Packages (main/binary-amd64/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Packages (main/binary-i386/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Packages (main/binary-all/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Translations (main/i18n/Translation-en) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target CNF (main/cnf/Commands-amd64) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target CNF (main/cnf/Commands-all) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nTraceback (most recent call last):<br>\n  File \"/home/zulip/deployments/2023-08-30-10-06-52/scripts/lib/upgrade-zulip-stage-2\", line 222, in &lt;module&gt;<br>\n    subprocess.check_call([\"apt-get\", \"update\"])<br>\n  File \"/usr/lib/python3.8/subprocess.py\", line 364, in check_call<br>\n    raise CalledProcessError(retcode, cmd)<br>\nsubprocess.CalledProcessError: Command '['apt-get', 'update']' returned non-zero exit status 100.</p>\n<p>Zulip upgrade failed (exit code 1)!</p>\n<p>The upgrade process is designed to be idempotent, so you can retry after resolving whatever issue caused the failure (there should be a traceback above). A log of this installation is available in /var/log/zulip/upgrade.log</p>\n<p>Just to clarify, our server is managed using Webmin and is regularly updated through it.</p>",
        "id": 1633320,
        "sender_full_name": "RentGes_Soft",
        "timestamp": 1693383287
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"27080\">RentGes_Soft</span> <a href=\"#narrow/stream/9-issues/topic/Problems.20upgrading.20to.207.2E3/near/1633320\">ha dicho</a>:</p>\n<blockquote>\n<p>Hi, I'm currently attempting to upgrade our installation to version 7.3, and here are the results:</p>\n<p>root@im:~# /home/zulip/deployments/current/scripts/upgrade-zulip zulip-server-latest.tar.gz <br>\n2023-08-30 08:06:52,439 upgrade-zulip: Archiving the tarball under /home/zulip/archives<br>\n2023-08-30 08:06:52,607 upgrade-zulip: Unpacking the tarball<br>\n2023-08-30 08:06:54,759 upgrade-zulip-stage-2: Upgrading from 7.2 to 7.3, in /home/zulip/deployments/2023-08-30-10-06-52<br>\npostgresql-10-pgdg-pgroonga was already set on hold.<br>\npostgresql-13-pgdg-pgroonga was already set on hold.<br>\npostgresql-14-pgdg-pgroonga was already set on hold.<br>\npostgresql-15-pgdg-pgroonga was already set on hold.<br>\npostgresql-11-pgdg-pgroonga set on hold.<br>\npostgresql-12-pgdg-pgroonga set on hold.<br>\n2023-08-30 08:06:55,032 upgrade-zulip-stage-2: Upgrading system packages...<br>\nHit:1 <a href=\"http://asi-fs-d.contabo.net/ubuntu\">http://asi-fs-d.contabo.net/ubuntu</a> focal InRelease<br>\nHit:2 <a href=\"http://asi-fs-d.contabo.net/ubuntu\">http://asi-fs-d.contabo.net/ubuntu</a> focal-updates InRelease<br>\nHit:3 <a href=\"http://asi-fs-d.contabo.net/ubuntu\">http://asi-fs-d.contabo.net/ubuntu</a> focal-backports InRelease<br>\nHit:4 <a href=\"http://ppa.launchpad.net/groonga/ppa/ubuntu\">http://ppa.launchpad.net/groonga/ppa/ubuntu</a> focal InRelease<br>\nHit:5 <a href=\"http://archive.ubuntu.com/ubuntu\">http://archive.ubuntu.com/ubuntu</a> focal InRelease<br>\nHit:6 <a href=\"http://security.ubuntu.com/ubuntu\">http://security.ubuntu.com/ubuntu</a> focal-security InRelease<br>\nHit:7 <a href=\"http://apt.postgresql.org/pub/repos/apt\">http://apt.postgresql.org/pub/repos/apt</a> focal-pgdg InRelease<br>\nIgn:8 <a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable InRelease<br>\nGet:9 <a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable Release [16.0 kB]<br>\nGet:10 <a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable Release.gpg [819 B]<br>\nIgn:10 <a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable Release.gpg<br>\nHit:11 <a href=\"https://packages.groonga.org/ubuntu\">https://packages.groonga.org/ubuntu</a> focal InRelease<br>\nReading package lists...<br>\nW: Target Packages (main/binary-amd64/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Packages (main/binary-i386/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Packages (main/binary-all/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Translations (main/i18n/Translation-en) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target CNF (main/cnf/Commands-amd64) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target CNF (main/cnf/Commands-all) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: GPG error: <a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable Release: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY 2D223B918916F2A2<br>\nE: The repository '<a href=\"https://download.webmin.com/download/newkey/repository\">https://download.webmin.com/download/newkey/repository</a> stable Release' is not signed.<br>\nW: Target Packages (main/binary-amd64/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Packages (main/binary-i386/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Packages (main/binary-all/Packages) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target Translations (main/i18n/Translation-en) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target CNF (main/cnf/Commands-amd64) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nW: Target CNF (main/cnf/Commands-all) is configured multiple times in /etc/apt/sources.list.d/pgdg.list:1 and /etc/apt/sources.list.d/zulip.list:1<br>\nTraceback (most recent call last):<br>\n  File \"/home/zulip/deployments/2023-08-30-10-06-52/scripts/lib/upgrade-zulip-stage-2\", line 222, in &lt;module&gt;<br>\n    subprocess.check_call([\"apt-get\", \"update\"])<br>\n  File \"/usr/lib/python3.8/subprocess.py\", line 364, in check_call<br>\n    raise CalledProcessError(retcode, cmd)<br>\nsubprocess.CalledProcessError: Command '['apt-get', 'update']' returned non-zero exit status 100.</p>\n<p>Zulip upgrade failed (exit code 1)!</p>\n<p>The upgrade process is designed to be idempotent, so you can retry after resolving whatever issue caused the failure (there should be a traceback above). A log of this installation is available in /var/log/zulip/upgrade.log</p>\n<p>Just to clarify, our server is managed using Webmin and is regularly updated through it.</p>\n</blockquote>\n<p>Auto-fixed! <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span> The issue was caused by the Webmin repository, specifically a GPG public key error. It was resolved by running a setup script based on the problem described in this repository (<a href=\"https://github.com/webmin/webmin/issues/1966#issuecomment-1653934423\">https://github.com/webmin/webmin/issues/1966#issuecomment-1653934423</a>). Now, the update process is functioning properly!</p>",
        "id": 1633322,
        "sender_full_name": "RentGes_Soft",
        "timestamp": 1693385694
    },
    {
        "content": "<p>This topic was moved here from <a class=\"stream-topic\" data-stream-id=\"9\" href=\"/#narrow/stream/9-issues/topic/Problems.20upgrading.20to.207.2E3\">#issues &gt; Problems upgrading to 7.3</a> by <span class=\"user-mention silent\" data-user-id=\"7\">Tim Abbott</span>.</p>",
        "id": 1634098,
        "sender_full_name": "Notification Bot",
        "timestamp": 1693522609
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"27080\">@RentGes_Soft</span> moved this to the documented stream for help with self-hosting.</p>",
        "id": 1634099,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1693522620
    },
    {
        "content": "<p>And yeah, looks like you correctly diagnosed the problem with the <code>webmin</code> repository unrelated to Zulip.</p>",
        "id": 1634100,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1693522651
    }
]