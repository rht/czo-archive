[
    {
        "content": "<p>Like deleting a user in zulip. I do not want to disable it, since I have problems with its user, I need to delete it. Any method?? <span class=\"user-mention\" data-user-email=\"tabbott@zulipchat.com\" data-user-id=\"7\">@Tim Abbott</span></p>",
        "id": 248400,
        "sender_full_name": "Manuel",
        "timestamp": 1499880794
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"bootfine@gmail.com\" data-user-id=\"2759\">@Manuel</span> I set a topic for your message so it gets sorted separately from other conversations.</p>",
        "id": 248403,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1499880843
    },
    {
        "content": "<p>You can deactivate a user in the Zulip admin UI.  In what way does that not solve your problem?</p>",
        "id": 248407,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1499880888
    },
    {
        "content": "<p>For some reason this user has problems connecting. I've disabled and enabled it, but apparently it's a problem with your account. I want to delete the account so I can login again without problems</p>",
        "id": 248424,
        "sender_full_name": "Manuel",
        "timestamp": 1499881260
    },
    {
        "content": "<p>For some reason this user has problems connecting. I've disabled and enabled it, but apparently it's a problem with your account. I want to delete the account so I can login again without problems</p>",
        "id": 248426,
        "sender_full_name": "Manuel",
        "timestamp": 1499881285
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"bootfine@gmail.com\" data-user-id=\"2759\">@Manuel</span> you can edit the topics of your messages after sending to the wrong place :)</p>",
        "id": 248427,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1499881323
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"tabbott@zulipchat.com\" data-user-id=\"7\">@Tim Abbott</span>  thank</p>",
        "id": 248429,
        "sender_full_name": "Manuel",
        "timestamp": 1499881371
    },
    {
        "content": "<p>I don't understand what you're saying.  Did you mean \"so the user can login without problems\"?  Or is this user account preventing other users from logging in?</p>",
        "id": 248431,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1499881377
    },
    {
        "content": "<p>I also have never heard of a \"problem with a Zulip account\" preventing login, and would be very surprised if deleting and recreating the account helped, so I suspect that there is something else going on here that's the root cause of the problem...</p>",
        "id": 248432,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1499881428
    },
    {
        "content": "<p>He drops the page. How can I see the error that happens to the user? Only he happens to others not.</p>",
        "id": 248437,
        "sender_full_name": "Manuel",
        "timestamp": 1499881950
    },
    {
        "content": "<p>Unfortunately Zulip does not have a user management console that allows deleting the account, emails, comments, etc.</p>",
        "id": 248438,
        "sender_full_name": "Manuel",
        "timestamp": 1499882221
    },
    {
        "content": "<p>Have you had the user send you a screenshot?  Have you asked how they are authenticating?</p>",
        "id": 248444,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499882549
    },
    {
        "content": "<p>This is error:</p>\n<p>msg \"El uso de la API excedió el límite\"<br>\nretry-after 5618.2348189354<br>\nresult  \"error\"</p>",
        "id": 248455,
        "sender_full_name": "Manuel",
        "timestamp": 1499882990
    },
    {
        "content": "<blockquote>\n<p>This is error:</p>\n<p>msg \"El uso de la API excedió el límite\"<br>\nretry-after 5618.2348189354<br>\nresult  \"error\"</p>\n</blockquote>",
        "id": 248459,
        "sender_full_name": "Manuel",
        "timestamp": 1499883091
    },
    {
        "content": "<blockquote>\n<blockquote>\n<p>This is error:</p>\n<p>msg \"El uso de la API excedió el límite\"<br>\nretry-after 5618.2348189354<br>\nresult  \"error\"</p>\n</blockquote>\n</blockquote>\n<p><a href=\"/user_uploads/2/1b/rnW0DPiMQdH0pZX-tbxc0BXf/Error_Login_usuario.pdf\" target=\"_blank\" title=\"Error_Login_usuario.pdf\">Error_Login_usuario.pdf</a></p>",
        "id": 248461,
        "sender_full_name": "Manuel",
        "timestamp": 1499883149
    },
    {
        "content": "<p>Are they trying to use the API?   We rate-limit how often a user connects to the server, so that you can prevent denial-of-service attacks.</p>",
        "id": 248462,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499883155
    },
    {
        "content": "<blockquote>\n<p>Are they trying to use the API?   We rate-limit how often a user connects to the server, so that you can prevent denial-of-service attacks.</p>\n</blockquote>\n<p>No, the error appeared, which I do know is that it takes several connection attempts</p>",
        "id": 248465,
        "sender_full_name": "Manuel",
        "timestamp": 1499883231
    },
    {
        "content": "<p>Are you able to sit next to the user while they try to log in, or are they remote?</p>",
        "id": 248475,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499883398
    },
    {
        "content": "<p>And how can I help the user to connect?, I thought deleting the account could start again</p>",
        "id": 248477,
        "sender_full_name": "Manuel",
        "timestamp": 1499883439
    },
    {
        "content": "<p>The user gave me their credentials, and I'm testing myself on my computer, and it happens exactly the same to me.</p>",
        "id": 248480,
        "sender_full_name": "Manuel",
        "timestamp": 1499883495
    },
    {
        "content": "<p>If you can sit next to the user, you can have them open up the browser console to get insight into what's happening.</p>",
        "id": 248482,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499883506
    },
    {
        "content": "<p>Look, perform the following test:<br>\nFrom mozilla and chrome I try to connect to the credential of the affected user, and I get the error mentioned. I tried with another test credential and I did not have any problems of entrance, nor I had problems of entrance with the credential of administrator.</p>",
        "id": 248495,
        "sender_full_name": "Manuel",
        "timestamp": 1499883901
    },
    {
        "content": "<p>It's possible that this user's credentials are triggering some obscure bug with out rate limiting code.</p>\n<p>I think it's far more likely that there's some runaway script somewhere that's hitting your server with the user's credentials.</p>\n<p>A good troubleshooting step, if it's practical for you, is to restart the server.</p>",
        "id": 248501,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499884120
    },
    {
        "content": "<p>There's a management command related to rate limiting that I'm looking at now.</p>",
        "id": 248502,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499884290
    },
    {
        "content": "<p>You might want to try <code>./manage.py rate_limit --email &lt;email&gt; unblock</code>.</p>",
        "id": 248503,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499884361
    },
    {
        "content": "<p>Do you share the editing path to get to the file?</p>",
        "id": 248511,
        "sender_full_name": "Manuel",
        "timestamp": 1499885651
    },
    {
        "content": "<p>Run it from your \"root\" directory.  Have you used Django-based management commands before?</p>",
        "id": 248514,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499885713
    },
    {
        "content": "<blockquote>\n<p>Run it from your \"root\" directory.  Have you used Django-based management commands before?</p>\n</blockquote>\n<p>No, but I learn fast xD</p>",
        "id": 248521,
        "sender_full_name": "Manuel",
        "timestamp": 1499885809
    },
    {
        "content": "<blockquote>\n<p>It's possible that this user's credentials are triggering some obscure bug with out rate limiting code.</p>\n<p>I think it's far more likely that there's some runaway script somewhere that's hitting your server with the user's credentials.</p>\n<p>A good troubleshooting step, if it's practical for you, is to restart the server.</p>\n</blockquote>\n<p><em>Restart the server, and follow the same user with the same problem</em></p>",
        "id": 248545,
        "sender_full_name": "Manuel",
        "timestamp": 1499886466
    },
    {
        "content": "<p>Thanks for trying to restart the server.</p>",
        "id": 248546,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499886528
    },
    {
        "content": "<p>Django management commands are a Django concept where Zulip basically does very normal Django things.  You can run <code>./manage.py help</code> from the root of your installation to see all the management commands that are supported.</p>",
        "id": 248549,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499886645
    },
    {
        "content": "<p>But what I do not understand is that there is no zulip method of eliminating users to correct these problems, do you know one?</p>",
        "id": 248590,
        "sender_full_name": "Manuel",
        "timestamp": 1499888967
    },
    {
        "content": "<p>We don't have an admin-friendly way to delete users, because in 99.999% of cases, it's sufficient to deactivate the user.   The thing that is new and unique about your situation is that it seems you have a user whose email has been black-listed in our redis rate limiting system.  I proposed one way to fix that, which is to run the management command.  If that doesn't work, we probably need to figure out a way to clear redis by hand.  Deleting the user from the postgres database won't help if the problem is in redis.</p>\n<p>Sorry we're not more helpful here.  If this problem had come up with other admins, we would have solutions ready for you.  But this is the first time we're hearing of it.</p>",
        "id": 248599,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499889589
    },
    {
        "content": "<p>I understand and appreciate the support for everything else, can you explain a little more about how to apply the indicated command?</p>",
        "id": 248600,
        "sender_full_name": "Manuel",
        "timestamp": 1499889757
    },
    {
        "content": "<p>You should be able  to log on to your production box and find the \"root\" directory for zulip. Let me see if I can find what that is.  (It's <code>/srv/zulip</code> on dev.)</p>",
        "id": 248611,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499890186
    },
    {
        "content": "<p>And then run <code>./manage.py help</code>.</p>",
        "id": 248612,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499890199
    },
    {
        "content": "<p><a href=\"http://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html?highlight=management%20commands#management-commands\" target=\"_blank\" title=\"http://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html?highlight=management%20commands#management-commands\">http://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html?highlight=management%20commands#management-commands</a></p>",
        "id": 248614,
        "sender_full_name": "Steve Howell",
        "timestamp": 1499890269
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"bootfine@gmail.com\" data-user-id=\"2759\">@Manuel</span> the reason we don't allow deleting users from the database is that deleting a user from the database will basically break the experience for other users.  E.g. if that user had sent a message, the database has to delete that message as well, since there's no longer a user object to refer to as the sender.  So in a tool like Zulip where you can see things other users did in the past, usually \"delete\" actually means \"deactivate\".</p>",
        "id": 248665,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1499891760
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"tabbott@zulipchat.com\" data-user-id=\"7\">@Tim Abbott</span> , <span class=\"user-mention\" data-user-email=\"showell@zulipchat.com\" data-user-id=\"58\">@Steve Howell</span> <br>\nI already understood the problem. The topic goes through the NTP update. When done on the server, despite restarting ZULIP services, the accounts are blocked. A cleanup of all the messages that the users made to solve it. I leave this debug to investigate.</p>",
        "id": 251878,
        "sender_full_name": "Manuel",
        "timestamp": 1500307446
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"bootfine@gmail.com\" data-user-id=\"2759\">@Manuel</span> can you explain what you mean by \"NTP update\" a bit more?</p>",
        "id": 251952,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1500316925
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"tabbott@zulipchat.com\" data-user-id=\"7\">@Tim Abbott</span>  hello!<br>\nNetwork Time Protocol. Network Time Protocol (NTP) is an Internet protocol for synchronizing the clocks of computer systems through packet routing in networks with variable latency. What I saw happened, is that linux had the wrong time and date, when I update the time the messages of the users with the old time could not be logged, so I had to wait for 48 hours after your last message to That the service was restored. It's all I found</p>",
        "id": 253775,
        "sender_full_name": "Manuel",
        "timestamp": 1500490187
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"showell@zulipchat.com\" data-user-id=\"58\">@Steve Howell</span> <br>\nI just came across a situation that needs user deletion... a user successfully registered but cannot log in. Email password reset messages never get sent out to this specific user. When I test the email set up as per the install docs, and also by sending myself a password reset, everything works.</p>\n<p>For some mysterious reason, Zulip just doesn't want to work with this user's (legal) address. Since I could not delete the user and recreate his account using the same email address, I had to give him a different address to re-register in Zulip. His old deactivated account is hanging around like a bad smell, I'd really like to just delete it and start again with this user.</p>\n<p>Very weird, I looked at the logs but can't find anything amiss.</p>",
        "id": 256142,
        "sender_full_name": "Edmund Lian",
        "timestamp": 1500881957
    },
    {
        "content": "<p>Just curious, is there anything unusual about the user's email, such as capital letters or unusual punctuation?</p>\n<p>It's a bit dangerous to fully delete a user's account, since other users have references to the old user's messages.  When you say the the deactivated account is \"hanging around like a bad smell,\" are there user-facing things still showing up, or are you referring more to the admin screens and that kind of clutter?</p>",
        "id": 256214,
        "sender_full_name": "Steve Howell",
        "timestamp": 1500896059
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"elian-zulip@645ad.net\" data-user-id=\"2530\">@Edmund Lian</span> how are you sending outgoing email?  It sounds a lot like your emails are being spam-filtered by that user's email provider.</p>",
        "id": 256296,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1500914936
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"tabbott@zulipchat.com\" data-user-id=\"7\">@Tim Abbott</span> Outgoing and incoming email are being handled locally by our own server. During my testing, I was actually looking at my mail logs in real-time to see if this was happening. I saw contact from Zulip when I used my address, but not when I used this user's address. Does Zulip keep a log of email activity too? If so what is its name? I should look at this log too.</p>",
        "id": 256553,
        "sender_full_name": "Edmund Lian",
        "timestamp": 1500937558
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"showell@zulipchat.com\" data-user-id=\"58\">@Steve Howell</span> Nothing unusual about the email address... it is of the form \"<a href=\"mailto:firstname_lastname@domain.com\" title=\"mailto:firstname_lastname@domain.com\">firstname_lastname@domain.com</a>\". Sorry for the colloquialism, but by hanging around, I mean that I can see it as admin, but also that the user can no longer use his regular email address to log in, etc.</p>",
        "id": 256554,
        "sender_full_name": "Edmund Lian",
        "timestamp": 1500937725
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"elian-zulip@645ad.net\" data-user-id=\"2530\">@Edmund Lian</span> I don't think we have such a central log but it's probably a good idea (CC <span class=\"user-mention\" data-user-email=\"rishig@zulipchat.com\" data-user-id=\"131\">@Rishi Gupta</span>, can you open an issue?).  There are individual logs for certain types of emails; I guess this is a confirmation email?  I don't think we have a log for that specifically.</p>",
        "id": 256555,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1500937754
    },
    {
        "content": "<p>This is a bit mysterious.  Can you lay out more precisely what the state of the user's account is and what operation you're trying to do?  E.g. is it that the user has an account with email X, which you deactivated using the admin UI, and now they're trying to sign up again with email X?  Or something else?</p>",
        "id": 256556,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1500937847
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-email=\"tabbott@zulipchat.com\" data-user-id=\"7\">@Tim Abbott</span> Oh, too bad about the log. I will experiment a bit more  to see if it is the mail system, when I get back to the office in a few days.</p>",
        "id": 256558,
        "sender_full_name": "Edmund Lian",
        "timestamp": 1500937921
    },
    {
        "content": "<p>Cool.  I think it's definitely worth adding such a log for this sort of debugging.</p>",
        "id": 256565,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1500938138
    },
    {
        "content": "<p>It is indeed mysterious, so looking at the email server more is a good ideal.</p>\n<p>What happened is that the user registered with <a href=\"mailto:first_last@domain.com\" title=\"mailto:first_last@domain.com\">first_last@domain.com</a>. His selected password was of the form \"word1-word2-word3#\". At the time, I did see his registration. Because he didn't use the right fullname during registration, I manually corrected it to a Chinese name.</p>\n<p>A few days later, he reported not being able to log in, and not receiving password reset email messages. This is when I began testing. I:</p>\n<p>1. Tested SMTP operation by sending a test message using ./manage.py. (success)<br>\n2. Tested password recovery on my own account (success, I received the message and saw it in the logs)<br>\n3. Tested SMTP email using ./manage.py with the user's email address (failure, no logs either)<br>\n4. Tested password recovery with the user's email address (failure).</p>\n<p>I do have a spam filter (rspamd) in front of Postfix, but it does (or should) not kick in for email from our own networks and domain. I'll still go and look at this possibility in a few days though...</p>",
        "id": 256570,
        "sender_full_name": "Edmund Lian",
        "timestamp": 1500938557
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/zulip/zulip/pull/5900\" target=\"_blank\" title=\"https://github.com/zulip/zulip/pull/5900\">#5900</a> for adding logs for outgoing email.</p>",
        "id": 256593,
        "sender_full_name": "Rishi Gupta",
        "timestamp": 1500939830
    }
]