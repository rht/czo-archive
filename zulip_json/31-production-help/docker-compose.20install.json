[
    {
        "content": "<p>I am just running the docker-compose install. Looks scary, as if tons of things are being installed on my server and not in a container.</p>",
        "id": 639629,
        "sender_full_name": "Chris",
        "timestamp": 1535481838
    },
    {
        "content": "<p>After \"Status: Downloaded newer image for ubuntu:xenial-20171114\" it goes crazy ;-)</p>",
        "id": 639631,
        "sender_full_name": "Chris",
        "timestamp": 1535481874
    },
    {
        "content": "<p>Is it installting the entire ubuntu server on my computer ?</p>",
        "id": 639633,
        "sender_full_name": "Chris",
        "timestamp": 1535481955
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"8324\">@Chris</span> in any case, using Docker involves downloading an entire Ubuntu server.  But I think if you didn't run the <code>docker pull</code> command, then it will build a new docker image for Zulip from source, which involves installing a lot of dependencies on top of a base ubuntu server container.</p>",
        "id": 639641,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535482682
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span>  Yeah, Didn't do pull. Did do directly 'docker-compose up -d'. <br>\nDidn't work anyways... Well, debugging tomorrow I guess since tonight it's getting late ;-)</p>",
        "id": 639720,
        "sender_full_name": "Chris",
        "timestamp": 1535485426
    },
    {
        "content": "<p>Cool, keep us updated!</p>",
        "id": 639721,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535485589
    },
    {
        "content": "<p>hmm. THis does not work very smooth. Can't let go though ;-)</p>",
        "id": 639764,
        "sender_full_name": "Chris",
        "timestamp": 1535487861
    },
    {
        "content": "<p>Complains about standard parts in the docker-compose.yml file like:</p>\n<blockquote>\n<p>ck@server:/opt/docker-compose/docker-zulip$ docker-compose pull<br>\nERROR: The Compose file './docker-compose.yml' is invalid because:<br>\nservices.zulip.environment contains {\"DB_HOST\": \"database\"}, which is an invalid type, it should be a string</p>\n</blockquote>",
        "id": 639765,
        "sender_full_name": "Chris",
        "timestamp": 1535487930
    },
    {
        "content": "<p>I will try and fix it.... ;-)</p>",
        "id": 639769,
        "sender_full_name": "Chris",
        "timestamp": 1535488567
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"8324\">@Chris</span> try doing <code>docker pull</code> instead?  I'm wondering if the problem is <code>docker-compose pull</code> being weird.</p>",
        "id": 639776,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535489297
    },
    {
        "content": "<p>I guess <code>docker-compose pull</code> works great for me...</p>",
        "id": 639777,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535489316
    },
    {
        "content": "<p>What version of <code>docker-compose</code> do you have?</p>",
        "id": 639778,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535489334
    },
    {
        "content": "<p>I starting from scratch and did a docker-compose pull</p>",
        "id": 639779,
        "sender_full_name": "Chris",
        "timestamp": 1535489347
    },
    {
        "content": "<p>I think it's something with the Emailauth:</p>\n<blockquote>\n<p>File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/auth.py\", line 1021, in &gt; get_auth_handler<br>\n    'Check your credentials' % (len(names), str(names)))<br>\nboto.exception.NoAuthHandlerFound: No handler was ready to authenticate. 1 handlers were checked. ['HmacAuthV1Handler'] Check your &gt; credentials<br>\n  Applying zerver.0060_move_avatars_to_be_uid_based...Zulip first start database initi failed in \"initialize-database\" exit code 1. &gt; Exiting.</p>\n</blockquote>",
        "id": 639781,
        "sender_full_name": "Chris",
        "timestamp": 1535489435
    },
    {
        "content": "<p>docker-compose version 1.22.0, build f46880fe</p>",
        "id": 639782,
        "sender_full_name": "Chris",
        "timestamp": 1535489456
    },
    {
        "content": "<p>OK; I'm using 1.8.0; I wonder if that's related to the difference.</p>",
        "id": 639784,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535489488
    },
    {
        "content": "<p>I could post the error log here so we can have a quick look together.<br>\nHard to say if it's the version of docker-compose. Might well be. Might be that there is another problem.</p>\n<p>E.g. I guess without working Email Authentication Zulip can;t start up.</p>",
        "id": 639785,
        "sender_full_name": "Chris",
        "timestamp": 1535489610
    },
    {
        "content": "<p>It's possible that Docker have changed the formatting rules for <code>docker-compose.yml</code> in a recent release...</p>",
        "id": 639786,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535489613
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"77\">@Alexander Trost</span> do you have any theories for what could be causing the error above?</p>",
        "id": 639788,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535489686
    },
    {
        "content": "<p>should I post my yaml file here?</p>",
        "id": 639789,
        "sender_full_name": "Chris",
        "timestamp": 1535489729
    },
    {
        "content": "<p>Just let me know what makes most sense. Maybe posting it in a private message makes more sense.</p>",
        "id": 639790,
        "sender_full_name": "Chris",
        "timestamp": 1535489753
    },
    {
        "content": "<p>Well, the sort of thing I'd try is removing the quotes around \"database\" in that part of the config, and see if the error changes.</p>",
        "id": 639791,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535489824
    },
    {
        "content": "<p>If so, that'd likely confirm the issue is that your docker-compose is assuming a different file format or something.</p>",
        "id": 639792,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535489839
    },
    {
        "content": "<p>Ah sorry: this error I solved already:<br>\nComplains about standard parts in the docker-compose.yml file like:</p>\n<blockquote>\n<p>ck@server:/opt/docker-compose/docker-zulip$ docker-compose pull<br>\nERROR: The Compose file './docker-compose.yml' is invalid because:<br>\nservices.zulip.environment contains {\"DB_HOST\": \"database\"}, which is an invalid type, it should be a string</p>\n</blockquote>",
        "id": 639793,
        "sender_full_name": "Chris",
        "timestamp": 1535489892
    },
    {
        "content": "<p>this came up during docker-compose pull.</p>\n<p>I needed to indent the environment tags 1 space further and the error message went away.</p>\n<p>I had a similar problem with another docker image that I am running.</p>",
        "id": 639794,
        "sender_full_name": "Chris",
        "timestamp": 1535489959
    },
    {
        "content": "<p>The second error message from above is the outcome of the log of the zulip container.</p>",
        "id": 639796,
        "sender_full_name": "Chris",
        "timestamp": 1535490013
    },
    {
        "content": "<p>my siutation is after <br>\n      docker-compose up -d:</p>\n<p>I am checking for the status of the containers:</p>\n<div class=\"codehilite\"><pre><span></span> docker-compose ps\n</pre></div>\n\n\n<blockquote>\n<div class=\"codehilite\"><pre><span></span>     Name                        Command               State    Ports\n</pre></div>\n\n\n<hr>\n<p>docker-zulip_database_1    <a href=\"http://docker-entrypoint.sh\" target=\"_blank\" title=\"http://docker-entrypoint.sh\">docker-entrypoint.sh</a> postgres    Exit 0        <br>\ndocker-zulip_memcached_1   /sbin/entrypoint.sh /usr/b ...   Exit 0        <br>\ndocker-zulip_rabbitmq_1    <a href=\"http://docker-entrypoint.sh\" target=\"_blank\" title=\"http://docker-entrypoint.sh\">docker-entrypoint.sh</a> rabbi ...   Exit 0        <br>\ndocker-zulip_redis_1       /sbin/entrypoint.sh              Exit 0        <br>\ndocker-zulip_zulip_1       /sbin/entrypoint.sh app:run      Exit 1</p>\n</blockquote>",
        "id": 639797,
        "sender_full_name": "Chris",
        "timestamp": 1535490105
    },
    {
        "content": "<p>I then checked the log of zulip_zulip_1</p>\n<p>I will post it now, but feel free to delete it again, if it's considered spamming.</p>",
        "id": 639799,
        "sender_full_name": "Chris",
        "timestamp": 1535490267
    },
    {
        "content": "<p>ck@server:/opt/docker-compose/docker-zulip$ docker logs docker-zulip_zulip_1</p>\n<blockquote>\n<p>=== Begin Initial Configuration Phase ===<br>\nPreparing and linking the uploads folder ...<br>\nPrepared and linked the uploads directory.<br>\nExecuting nginx configuration ...<br>\nNginx configuration succeeded.<br>\nGenerating self-signed certificates ...<br>\n+ KEYFILE=/etc/ssl/private/zulip.key<br>\n+ CERTFILE=/etc/ssl/certs/zulip.combined-chain.crt<br>\n+ '[' -n '' ']'<br>\n+ '[' -z '' ']'<br>\n+ '[' -e /etc/ssl/private/zulip.key ']'<br>\n+ '[' -e /etc/ssl/certs/zulip.combined-chain.crt ']'<br>\n+ rm -f /etc/ssl/private/zulip.key /etc/ssl/certs/zulip.combined-chain.crt<br>\n++ mktemp<br>\n[...]<br>\nSetting key \"REMOTE_POSTGRES_HOST\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"REMOTE_POSTGRES_SSLMODE\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nDatabase configuration succeeded.<br>\nSetting Zulip secrets ...<br>\nGenerating Zulip secrets ...<br>\nGenerated Camo config file /etc/default/camo<br>\nGenerated new secrets in /etc/zulip/zulip-secrets.conf.<br>\nSecrets generation succeeded.<br>\nZulip secrets configuration succeeded.<br>\nActivating authentication backends ...<br>\nSetting key \"AUTHENTICATION_BACKENDS\", type \"array\" in file \"/etc/zulip/settings.py\".<br>\nAdding authentication backend \"EmailAuthBackend\".<br>\nAuthentication backend activation succeeded.<br>\nExecuting Zulip configuration ...<br>\nSetting key \"EXTERNAL_HOST\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"EMAIL_HOST\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"ALLOWED_HOSTS\", type \"array\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"ZULIP_ADMINISTRATOR\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"USE_X_FORWARDED_HOST\", type \"bool\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"REDIS_HOST\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"RABBITMQ_HOST\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"EMAIL_HOST_USER\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"MEMCACHED_LOCATION\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"EMAIL_USE_SSL\", type \"bool\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"EMAIL_USE_TLS\", type \"bool\" in file \"/etc/zulip/settings.py\".<br>\nSetting key \"EMAIL_PORT\", type \"integer\" in file \"/etc/zulip/settings.py\".<br>\nZulip configuration succeeded.<br>\nAuto backup enabled.<br>\n=== End Initial Configuration Phase ===<br>\n=== Begin Bootstrap Phase ===<br>\nWaiting for database server to allow connections ...<br>\nExecuting Zulip first start init ...<br>\n+++ readlink -f /home/zulip/deployments/current/scripts/setup/initialize-database<br>\n++ dirname /home/zulip/deployments/2018-08-27-20-28-29/scripts/setup/initialize-database<br>\n+ THIS_DIR=/home/zulip/deployments/2018-08-27-20-28-29/scripts/setup<br>\n+ cd /home/zulip/deployments/2018-08-27-20-28-29/scripts/setup/../..<br>\n+ ./manage.py checkconfig<br>\n+ ./manage.py migrate --noinput<br>\nOperations to perform:<br>\n  Apply all migrations: analytics, auth, confirmation, contenttypes, otp_static, otp_totp, sessions, sites, social_django, two_factor, &gt; zerver<br>\nRunning migrations:<br>\n  Applying contenttypes.0001_initial... OK<br>\n  Applying auth.0001_initial... OK<br>\n  Applying zerver.0001_initial... OK<br>\n  Applying zerver.0029_realm_subdomain... OK<br>\n  Applying zerver.0030_realm_org_type... OK<br>\n  Applying zerver.0031_remove_system_avatar_source... OK<br>\n[....]<br>\n  Applying zerver.0056_userprofile_emoji_alt_code... OK<br>\n  Applying zerver.0057_realmauditlog... OK<br>\n  Applying zerver.0058_realm_email_changes_disabled... OK<br>\n  Applying zerver.0059_userprofile_quota... OK<br>\n2018-08-28 20:37:37.618 ERR  [boto] Caught exception reading instance data<br>\nTraceback (most recent call last):<br>\n  File \"/usr/lib/python3.5/urllib/request.py\", line 1254, in do_open<br>\n    h.request(req.get_method(), req.selector, req.data, headers)<br>\n  File \"/usr/lib/python3.5/http/client.py\", line 1106, in request<br>\n    self._send_request(method, url, body, headers)<br>\n  File \"/usr/lib/python3.5/http/client.py\", line 1151, in _send_request<br>\n    self.endheaders(body)<br>\n  File \"/usr/lib/python3.5/http/client.py\", line 1102, in endheaders<br>\n    self._send_output(message_body)<br>\n  File \"/usr/lib/python3.5/http/client.py\", line 934, in _send_output<br>\n    self.send(msg)<br>\n  File \"/usr/lib/python3.5/http/client.py\", line 877, in send<br>\n    self.connect()<br>\n  File \"/usr/lib/python3.5/http/client.py\", line 849, in connect<br>\n    (self.host,self.port), self.timeout, self.source_address)<br>\n  File \"/usr/lib/python3.5/socket.py\", line 711, in create_connection<br>\n    raise err<br>\n  File \"/usr/lib/python3.5/socket.py\", line 702, in create_connection<br>\n    sock.connect(sa)<br>\nsocket.timeout: timed out</p>\n<p>During handling of the above exception, another exception occurred:</p>\n<p>Traceback (most recent call last):<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/utils.py\", line 217, in retry_url<br>\n    r = opener.open(req, timeout=timeout)<br>\n  File \"/usr/lib/python3.5/urllib/request.py\", line 466, in open<br>\n    response = self._open(req, data)<br>\n  File \"/usr/lib/python3.5/urllib/request.py\", line 484, in _open<br>\n    '_open', req)<br>\n  File \"/usr/lib/python3.5/urllib/request.py\", line 444, in _call_chain<br>\n    result = func(*args)<br>\n  File \"/usr/lib/python3.5/urllib/request.py\", line 1282, in http_open<br>\n    return self.do_open(http.client.HTTPConnection, req)<br>\n  File \"/usr/lib/python3.5/urllib/request.py\", line 1256, in do_open<br>\n    raise URLError(err)<br>\nurllib.error.URLError: &lt;urlopen error timed out&gt;<br>\n2018-08-28 20:37:37.907 ERR  [boto] Unable to read instance data, giving up<br>\nTraceback (most recent call last):<br>\n  File \"./manage.py\", line 36, in &lt;module&gt;<br>\n    execute_from_command_line(sys.argv)<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py\", &gt; line 364, in execute_from_command_line<br>\n    utility.execute()<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py\", &gt; line 356, in execute<br>\n    self.fetch_command(subcommand).run_from_argv(self.argv)<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py\", line &gt; 283, in run_from_argv<br>\n    self.execute(*args, **cmd_options)<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py\", line &gt; 330, in execute<br>\n    output = self.handle(*args, **options)<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/commands/migrate.&gt; py\", line 204, in handle<br>\n    fake_initial=fake_initial,<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py\", line &gt; 115, in migrate<br>\n    state = self._migrate_all_forwards(state, plan, full_plan, fake=fake, fake_initial=fake_initial)<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py\", line &gt; 145, in _migrate_all_forwards<br>\n    state = self.apply_migration(state, migration, fake=fake, fake_initial=fake_initial)<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py\", line &gt; 244, in apply_migration<br>\n    state = migration.apply(state, schema_editor)<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/migration.py\", &gt; line 129, in apply<br>\n    operation.database_forwards(self.app_label, schema_editor, old_state, project_state)<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/operations/special.&gt; py\", line 193, in database_forwards<br>\n    self.code(from_state.apps, schema_editor)<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zerver/migrations/0060_move_avatars_to_be_uid_based.py\", line 56, in &gt; move_avatars_to_be_uid_based<br>\n    conn = S3Connection(settings.S3_KEY, settings.S3_SECRET_KEY)<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/connection.py\", line 194, in &gt; __init__<br>\n    validate_certs=validate_certs, profile_name=profile_name)<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/connection.py\", line 569, in &gt; __init__<br>\n    host, config, self.provider, self._required_auth_capability())<br>\n  File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/auth.py\", line 1021, in &gt; get_auth_handler<br>\n    'Check your credentials' % (len(names), str(names)))<br>\nboto.exception.NoAuthHandlerFound: No handler was ready to authenticate. 1 handlers were checked. ['HmacAuthV1Handler'] Check your &gt; credentials<br>\n  Applying zerver.0060_move_avatars_to_be_uid_based...Zulip first start database initi failed in \"initialize-database\" exit code 1. Exiting.</p>\n</blockquote>",
        "id": 639800,
        "sender_full_name": "Chris",
        "timestamp": 1535490415
    },
    {
        "content": "<p>So something with the database.</p>",
        "id": 639801,
        "sender_full_name": "Chris",
        "timestamp": 1535490439
    },
    {
        "content": "<p>The docker-compose.yml file looks like this:</p>\n<blockquote>\n<p>version: '2'<br>\nservices:<br>\n  database:<br>\n    image: 'zulip/zulip-postgresql'<br>\n    environment:<br>\n      POSTGRES_DB: zulip<br>\n      POSTGRES_USER: zulip<br>\n      POSTGRES_PASSWORD: zulip<br>\n    volumes:<br>\n      - '/opt/docker/zulip/postgresql/data:/var/lib/postgresql/data:rw'<br>\n  memcached:<br>\n    image: '<a href=\"http://quay.io/sameersbn/memcached:latest\" target=\"_blank\" title=\"http://quay.io/sameersbn/memcached:latest\">quay.io/sameersbn/memcached:latest</a>'<br>\n    restart: always<br>\n  rabbitmq:<br>\n    image: 'rabbitmq:3.7.7'<br>\n    hostname: zulip-rabbit<br>\n    restart: always<br>\n    environment:<br>\n        RABBITMQ_DEFAULT_USER: 'zulip'<br>\n        RABBITMQ_DEFAULT_PASS: 'zulip'<br>\n    volumes:<br>\n      - '/opt/docker/zulip/rabbitmq:/var/lib/rabbitmq:rw'<br>\n  redis:<br>\n    image: '<a href=\"http://quay.io/sameersbn/redis:latest\" target=\"_blank\" title=\"http://quay.io/sameersbn/redis:latest\">quay.io/sameersbn/redis:latest</a>'<br>\n    volumes:<br>\n      - '/opt/docker/zulip/redis:/var/lib/redis:rw'<br>\n  zulip:<br>\n    image: 'zulip/docker-zulip:1.9.0-rc1-2'<br>\n    build:<br>\n      context: .<br>\n      args:<br>\n        # Change these if you want to build zulip from a different repo/branch<br>\n        ZULIP_GIT_URL: <a href=\"https://github.com/zulip/zulip.git\" target=\"_blank\" title=\"https://github.com/zulip/zulip.git\">https://github.com/zulip/zulip.git</a><br>\n        ZULIP_GIT_REF: 1.9.0-rc1<br>\n        # Set this up if you plan to use your own CA certificate bundle for building<br>\n        # CUSTOM_CA_CERTIFICATES:<br>\n    ports:<br>\n      - '3300:80'<br>\n      - '3343:443'<br>\n    environment:<br>\n        DB_HOST: 'database'<br>\n        DB_HOST_PORT: '5432'<br>\n        DB_USER: 'zulip'<br>\n        SSL_CERTIFICATE_GENERATION: 'self-signed'<br>\n        SETTING_MEMCACHED_LOCATION: 'memcached:11211'<br>\n        SETTING_RABBITMQ_HOST: 'rabbitmq'<br>\n        SETTING_REDIS_HOST: 'redis'<br>\n        SECRETS_email_password: 'dddd'<br>\n        SECRETS_rabbitmq_password: 'zulip'<br>\n        SECRETS_postgres_password: 'zulip'<br>\n        SECRETS_secret_key: 'REPLACE_WITH_SECURE_SECRET_KEY'<br>\n        SETTING_EXTERNAL_HOST: '<a href=\"http://zulip.example.com\" target=\"_blank\" title=\"http://zulip.example.com\">zulip.example.com</a>'<br>\n        SETTING_ALLOWED_HOSTS: \"['<a href=\"http://zulip.example.com\" target=\"_blank\" title=\"http://zulip.example.com\">zulip.example.com</a>', '127.0.0.1']\"<br>\n        SETTING_USE_X_FORWARDED_HOST: 'True'<br>\n        SETTING_ZULIP_ADMINISTRATOR: '<a href=\"mailto:admin@example.com\" title=\"mailto:admin@example.com\">admin@example.com</a>'<br>\n        SETTING_EMAIL_HOST: '<a href=\"http://office.example.com\" target=\"_blank\" title=\"http://office.example.com\">office.example.com</a>'  # e.g. <a href=\"http://smtp.example.com\" target=\"_blank\" title=\"http://smtp.example.com\">smtp.example.com</a><br>\n        SETTING_EMAIL_HOST_USER: '<a href=\"mailto:admin@example.com\" title=\"mailto:admin@example.com\">admin@example.com</a>'<br>\n        SETTING_EMAIL_PORT: '587'<br>\n      # It seems that the email server needs to use ssl or tls and can't be used without it<br>\n        SETTING_EMAIL_USE_SSL: 'False'<br>\n        SETTING_EMAIL_USE_TLS: 'True'<br>\n        ZULIP_AUTH_BACKENDS: 'EmailAuthBackend'<br>\n      # Uncomment this when configuring the mobile push notifications service<br>\n      # SETTING_PUSH_NOTIFICATION_BOUNCER_URL: '<a href=\"https://push.zulipchat.com\" target=\"_blank\" title=\"https://push.zulipchat.com\">https://push.zulipchat.com</a>'<br>\n    volumes:<br>\n      - '/opt/docker/zulip/zulip:/data:rw'&gt;</p>\n</blockquote>",
        "id": 639802,
        "sender_full_name": "Chris",
        "timestamp": 1535490509
    },
    {
        "content": "<p>It sorta looks like <code>settings.LOCAL_UPLOADS_DIR</code> is somehow missing its default value.</p>",
        "id": 639803,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535490578
    },
    {
        "content": "<p>(That should be being set by default with no action on your part)</p>",
        "id": 639804,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535490603
    },
    {
        "content": "<p>Can you do <code>docker-compose exec zulip bash</code> and then look at <code>/etc/zulip/settings.py</code> and see what it has for <code>LOCAL_UPLOADS_DIR</code>?</p>",
        "id": 639805,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535490725
    },
    {
        "content": "<p>(AFK for a bit)</p>",
        "id": 639806,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535490793
    },
    {
        "content": "<p>can't do <code>docker-compose exec zulip bash</code> cause the container does not start up.</p>",
        "id": 639807,
        "sender_full_name": "Chris",
        "timestamp": 1535490909
    },
    {
        "content": "<p>I will go off for tonight (CET). Will keep looking tomorrow. Thanks already for your help!</p>\n<p>What a shame this doe not just run through. But there is always something, isn't it ;-)</p>",
        "id": 639808,
        "sender_full_name": "Chris",
        "timestamp": 1535490984
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"8324\">@Chris</span> You can do <code>docker cp CONTAINER_NAME:FILE_PATH .</code> to copy the file out of the container (even if it is stopped)</p>",
        "id": 639853,
        "sender_full_name": "Alexander Trost",
        "timestamp": 1535529614
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"8324\">@Chris</span> Is that a fresh install?<br>\n<span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> The problem seems to be that the rabbitmq takes too long to start so a check like for the database would be needed</p>",
        "id": 639854,
        "sender_full_name": "Alexander Trost",
        "timestamp": 1535530597
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> What is the full name of the <code>EmailAuthBackend</code> in the AUTHENTICATION_BACKENDS list?</p>",
        "id": 639855,
        "sender_full_name": "Alexander Trost",
        "timestamp": 1535530802
    },
    {
        "content": "<p>Should it still be like this in the <code>settings.py</code> or just <code>EmailAuthBackend</code>?</p>\n<div class=\"codehilite\"><pre><span></span>AUTHENTICATION_BACKENDS = (&#39;zproject.backends.EmailAuthBackend&#39;,)\n</pre></div>",
        "id": 639856,
        "sender_full_name": "Alexander Trost",
        "timestamp": 1535530812
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"77\">@Alexander Trost</span> Thanks for the 'docker cp' tip. I managed to get the setting.py file from the zulip container.</p>\n<blockquote>\n<p>REMOTE_POSTGRES_HOST = 'database'<br>\nREMOTE_POSTGRES_SSLMODE = 'prefer'<br>\nAUTHENTICATION_BACKENDS = ('zproject.backends.EmailAuthBackend',)<br>\nEXTERNAL_HOST = '<a href=\"http://zulip.example.com\" target=\"_blank\" title=\"http://zulip.example.com\">zulip.example.com</a>'<br>\nEMAIL_HOST = '<a href=\"http://office.example.com\" target=\"_blank\" title=\"http://office.example.com\">office.example.com</a>'<br>\nALLOWED_HOSTS = ['<a href=\"http://zulip.example.com\" target=\"_blank\" title=\"http://zulip.example.com\">zulip.example.com</a>', '127.0.0.1']<br>\nZULIP_ADMINISTRATOR = '<a href=\"mailto:admin@example.com\" title=\"mailto:admin@example.com\">admin@example.com</a>'<br>\nUSE_X_FORWARDED_HOST = True<br>\nREDIS_HOST = 'redis'<br>\nRABBITMQ_HOST = 'rabbitmq'<br>\nEMAIL_HOST_USER = '<a href=\"mailto:admin@example.com\" title=\"mailto:admin@example.com\">admin@example.com</a>'<br>\nMEMCACHED_LOCATION = 'memcached:11211'<br>\nEMAIL_USE_SSL = False<br>\nEMAIL_USE_TLS = True<br>\nEMAIL_PORT = 587</p>\n</blockquote>",
        "id": 639857,
        "sender_full_name": "Chris",
        "timestamp": 1535531245
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> It does not seem to have the Setting <code>LOCAL_UPLOADS_DIR</code></p>",
        "id": 639858,
        "sender_full_name": "Chris",
        "timestamp": 1535531315
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"77\">@Alexander Trost</span> <span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> Just let me know if you need anything else. Please just know that I am travelling tomorrow so might not come back before Friday.</p>",
        "id": 639937,
        "sender_full_name": "Chris",
        "timestamp": 1535552057
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"77\">@Alexander Trost</span> </p>\n<blockquote>\n<p><span class=\"user-mention\" data-user-id=\"8324\">@Chris</span> Is that a fresh install?</p>\n</blockquote>\n<p>Yes, it was a fresh docker install.<br>\nBut there were other docker instances running on the same machine. Is there something else I could do? Really would like to keep trying to get this running in Docker <span class=\"emoji emoji-1f642\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 640076,
        "sender_full_name": "Chris",
        "timestamp": 1535572503
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"77\">@Alexander Trost</span> does the Docker image generate its <code>/etc/zulip/settings.py</code> by first copying <code>prod_settings_template.py</code> and then adding things, or does it do something else?</p>",
        "id": 640082,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535577688
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span>  No it used the one that was created during build. So this commit \"broke\" it as there is no <code>prod_settings_template.py</code> copying in the <code>entrypoint.sh</code>, see <a href=\"https://github.com/zulip/docker-zulip/commit/62bf74190be763535b21d2032c2dd279bd31da38\" target=\"_blank\" title=\"https://github.com/zulip/docker-zulip/commit/62bf74190be763535b21d2032c2dd279bd31da38\">https://github.com/zulip/docker-zulip/commit/62bf74190be763535b21d2032c2dd279bd31da38</a></p>",
        "id": 640162,
        "sender_full_name": "Alexander Trost",
        "timestamp": 1535626856
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> Fix would be to add a <code>cp /home/zulip/.../prod_settings_template.py /etc/zulip/settings.py</code> as I'm understanding from you now, right?</p>",
        "id": 640163,
        "sender_full_name": "Alexander Trost",
        "timestamp": 1535626940
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"77\">@Alexander Trost</span> yes, that should be correct; can you try testing that?</p>",
        "id": 640359,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535689293
    },
    {
        "content": "<p><code>AUTH_LDAP_USER_SEARCH</code> seems to be initialized with <code>LDAPSearch</code> which is not imported in <code>settings.py</code>. Maybe this is related to this issue?</p>",
        "id": 640433,
        "sender_full_name": "Peter Nagy",
        "timestamp": 1535712828
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"9021\">@Peter Nagy</span> I think that's possibly right; since <code>prod_settings_template.py</code> is where that gets imported...</p>",
        "id": 640524,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535737967
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> Yes, I should be able to do that during the weekend.</p>",
        "id": 640616,
        "sender_full_name": "Alexander Trost",
        "timestamp": 1535750375
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"77\">@Alexander Trost</span> I merged an attempt at doing that which seems to work; probably worth your verifying though</p>",
        "id": 640618,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535750441
    },
    {
        "content": "<p>Just let me know if / when I can help by reinstalling the docker image</p>",
        "id": 640702,
        "sender_full_name": "Chris",
        "timestamp": 1535804210
    },
    {
        "content": "<p>Now's a great time to test</p>",
        "id": 640789,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1535857523
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> <span class=\"user-mention\" data-user-id=\"77\">@Alexander Trost</span> It was not successful yet.<br>\nI tried docker-compose pull and docker-compose up again with the following output:</p>\n<p>ck@server:/opt/docker-compose/docker-zulip$ docker-compose up<br>\nStarting docker-zulip_zulip_1     ... done<br>\nStarting docker-zulip_rabbitmq_1  ... done<br>\nStarting docker-zulip_memcached_1 ... done<br>\nStarting docker-zulip_database_1  ... done<br>\nStarting docker-zulip_redis_1     ... done<br>\nAttaching to docker-zulip_rabbitmq_1, docker-zulip_zulip_1, docker-zulip_memcached_1, docker-zulip_database_1, docker-zulip_redis_1<br>\nzulip_1      | === Begin Initial Configuration Phase ===<br>\nzulip_1      | Preparing and linking the uploads folder ...<br>\nzulip_1      | Prepared and linked the uploads directory.<br>\nzulip_1      | Executing nginx configuration ...<br>\nzulip_1      | Nginx configuration succeeded.<br>\nzulip_1      | Certificates configuration succeeded.<br>\nzulip_1      | Setting database configuration ...<br>\nzulip_1      | Setting key \"REMOTE_POSTGRES_HOST\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"REMOTE_POSTGRES_SSLMODE\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Database configuration succeeded.<br>\nzulip_1      | Setting Zulip secrets ...<br>\nzulip_1      | Secrets already generated/existing.<br>\nredis_1      | Starting redis-server...<br>\nredis_1      | 1:C 03 Sep 09:34:24.294 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo<br>\nredis_1      | 1:C 03 Sep 09:34:24.294 # Redis version=4.0.9, bits=64, commit=00000000, modified=0, pid=1, just started<br>\nredis_1      | 1:C 03 Sep 09:34:24.294 # Configuration loaded<br>\nredis_1      |                 _._                                                  <br>\nredis_1      |            _.-<code>__ ''-._                                             \nredis_1      |       _.-</code>    <code>.  </code>_.  ''-._           Redis 4.0.9 (00000000/0) 64 bit<br>\nredis_1      |   .-<code> .-```.  ```\\/    _.,_ ''-._                                   \nredis_1      |  (    '      ,       .-`  | `,    )     Running in standalone mode\nredis_1      |  |`-._`-...-` __...-.</code>-._|'<code> _.-'|     Port: 6379\nredis_1      |  |    </code>-._   <code>._    /     _.-'    |     PID: 1\nredis_1      |   </code>-._    <code>-._  </code>-./  _.-'    _.-'                                   <br>\nredis_1      |  |<code>-._</code>-._    <code>-.__.-'    _.-'_.-'|                                  \nredis_1      |  |    </code>-._<code>-._        _.-'_.-'    |           http://redis.io        \nredis_1      |   </code>-._    <code>-._</code>-.__.-'_.-'    _.-'                                   <br>\nredis_1      |  |<code>-._</code>-._    <code>-.__.-'    _.-'_.-'|                                  \nredis_1      |  |    </code>-._<code>-._        _.-'_.-'    |                                  \nredis_1      |   </code>-._    <code>-._</code>-.__.-'_.-'    _.-'                                   <br>\nredis_1      |       <code>-._    </code>-.__.-'    _.-'                                       <br>\nredis_1      |           <code>-._        _.-'                                           \nredis_1      |               </code>-.__.-'                                               <br>\nredis_1      | <br>\nredis_1      | 1:M 03 Sep 09:34:24.303 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.<br>\nredis_1      | 1:M 03 Sep 09:34:24.303 # Server initialized<br>\nredis_1      | 1:M 03 Sep 09:34:24.303 # WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.<br>\nredis_1      | 1:M 03 Sep 09:34:24.303 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.<br>\nredis_1      | 1:M 03 Sep 09:34:24.336 * DB loaded from disk: 0.032 seconds<br>\nredis_1      | 1:M 03 Sep 09:34:24.336 * Ready to accept connections<br>\nredis_1      | 1:M 03 Sep 09:34:24.336 * The server is now ready to accept connections at /var/run/redis/redis-server.sock<br>\nzulip_1      | Zulip secrets configuration succeeded.<br>\nzulip_1      | Activating authentication backends ...<br>\nzulip_1      | Setting key \"AUTHENTICATION_BACKENDS\", type \"array\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Adding authentication backend \"EmailAuthBackend\".<br>\nzulip_1      | Authentication backend activation succeeded.<br>\nzulip_1      | Executing Zulip configuration ...<br>\nzulip_1      | Setting key \"EXTERNAL_HOST\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"EMAIL_HOST\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"ALLOWED_HOSTS\", type \"array\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"ZULIP_ADMINISTRATOR\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"USE_X_FORWARDED_HOST\", type \"bool\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"REDIS_HOST\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"RABBITMQ_HOST\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"EMAIL_HOST_USER\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"MEMCACHED_LOCATION\", type \"string\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"EMAIL_USE_SSL\", type \"bool\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"EMAIL_USE_TLS\", type \"bool\" in file \"/etc/zulip/settings.py\".<br>\nzulip_1      | Setting key \"EMAIL_PORT\", type \"integer\" in file \"/etc/zulip/settings.py\".<br>\ndatabase_1   | 2018-09-03 09:34:25.319 UTC [1] LOG:  listening on IPv4 address \"0.0.0.0\", port 5432<br>\ndatabase_1   | 2018-09-03 09:34:25.319 UTC [1] LOG:  listening on IPv6 address \"::\", port 5432<br>\ndatabase_1   | 2018-09-03 09:34:25.507 UTC [1] LOG:  listening on Unix socket \"/var/run/postgresql/.s.PGSQL.5432\"<br>\nrabbitmq_1   | 2018-09-03 09:34:25.594 [info] &lt;0.33.0&gt; Application lager started on node 'rabbit@zulip-rabbit'<br>\ndatabase_1   | 2018-09-03 09:34:26.132 UTC [25] LOG:  database system was shut down at 2018-09-03 09:07:10 UTC<br>\ndatabase_1   | 2018-09-03 09:34:26.493 UTC [1] LOG:  database system is ready to accept connections<br>\nrabbitmq_1   | 2018-09-03 09:34:27.865 [info] &lt;0.33.0&gt; Application mnesia started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.865 [info] &lt;0.33.0&gt; Application crypto started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.865 [info] &lt;0.33.0&gt; Application recon started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.865 [info] &lt;0.33.0&gt; Application jsx started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.866 [info] &lt;0.33.0&gt; Application os_mon started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.866 [info] &lt;0.33.0&gt; Application xmerl started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.867 [info] &lt;0.33.0&gt; Application inets started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.867 [info] &lt;0.33.0&gt; Application asn1 started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.867 [info] &lt;0.33.0&gt; Application public_key started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.868 [info] &lt;0.33.0&gt; Application ssl started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.868 [info] &lt;0.33.0&gt; Application ranch started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.868 [info] &lt;0.33.0&gt; Application ranch_proxy_protocol started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.868 [info] &lt;0.33.0&gt; Application rabbit_common started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:27.868 [info] &lt;0.230.0&gt; <br>\nrabbitmq_1   |  Starting RabbitMQ 3.7.7 on Erlang 20.3.8.3<br>\nrabbitmq_1   |  Copyright (C) 2007-2018 Pivotal Software, Inc.<br>\nrabbitmq_1   |  Licensed under the MPL.  See <a href=\"http://www.rabbitmq.com/\" target=\"_blank\" title=\"http://www.rabbitmq.com/\">http://www.rabbitmq.com/</a><br>\nrabbitmq_1   | <br>\nrabbitmq_1   |   ##  ##<br>\nrabbitmq_1   |   ##  ##      RabbitMQ 3.7.7. Copyright (C) 2007-2018 Pivotal Software, Inc.<br>\nrabbitmq_1   |   ##########  Licensed under the MPL.  See <a href=\"http://www.rabbitmq.com/\" target=\"_blank\" title=\"http://www.rabbitmq.com/\">http://www.rabbitmq.com/</a><br>\nrabbitmq_1   |   ######  ##<br>\nrabbitmq_1   |   ##########  Logs: &lt;stdout&gt;<br>\nrabbitmq_1   | <br>\nrabbitmq_1   |               Starting broker...<br>\nrabbitmq_1   | 2018-09-03 09:34:27.869 [info] &lt;0.230.0&gt; <br>\nrabbitmq_1   |  node           : rabbit@zulip-rabbit<br>\nrabbitmq_1   |  home dir       : /var/lib/rabbitmq<br>\nrabbitmq_1   |  config file(s) : /etc/rabbitmq/rabbitmq.conf<br>\nrabbitmq_1   |  cookie hash    : X4cGfaItX6dhi+addW4ndg==<br>\nrabbitmq_1   |  log(s)         : &lt;stdout&gt;<br>\nrabbitmq_1   |  database dir   : /var/lib/rabbitmq/mnesia/rabbit@zulip-rabbit<br>\nrabbitmq_1   | 2018-09-03 09:34:27.884 [info] &lt;0.263.0&gt; Memory high watermark set to 6380 MiB (6690642329 bytes) of 15951 MiB (16726605824 bytes) total<br>\nrabbitmq_1   | 2018-09-03 09:34:27.886 [info] &lt;0.265.0&gt; Enabling free disk space monitoring<br>\nrabbitmq_1   | 2018-09-03 09:34:27.886 [info] &lt;0.265.0&gt; Disk free limit set to 50MB<br>\nrabbitmq_1   | 2018-09-03 09:34:27.888 [info] &lt;0.267.0&gt; Limiting to approx 1048476 file handles (943626 sockets)<br>\nrabbitmq_1   | 2018-09-03 09:34:27.888 [info] &lt;0.268.0&gt; FHC read buffering:  OFF<br>\nrabbitmq_1   | 2018-09-03 09:34:27.888 [info] &lt;0.268.0&gt; FHC write buffering: ON<br>\nrabbitmq_1   | 2018-09-03 09:34:27.889 [info] &lt;0.230.0&gt; Waiting for Mnesia tables for 30000 ms, 9 retries left<br>\nrabbitmq_1   | 2018-09-03 09:34:28.177 [info] &lt;0.230.0&gt; Waiting for Mnesia tables for 30000 ms, 9 retries left<br>\nrabbitmq_1   | 2018-09-03 09:34:28.177 [info] &lt;0.230.0&gt; Peer discovery backend rabbit_peer_discovery_classic_config does not support registration, skipping registration.<br>\nrabbitmq_1   | 2018-09-03 09:34:28.178 [info] &lt;0.230.0&gt; Priority queues enabled, real BQ is rabbit_variable_queue<br>\nrabbitmq_1   | 2018-09-03 09:34:28.271 [info] &lt;0.294.0&gt; Starting rabbit_node_monitor<br>\nrabbitmq_1   |</p>",
        "id": 640963,
        "sender_full_name": "Chris",
        "timestamp": 1535967345
    },
    {
        "content": "<p>rabbitmq_1   | 2018-09-03 09:34:28.178 [info] &lt;0.230.0&gt; Priority queues enabled, real BQ is rabbit_variable_queue<br>\nrabbitmq_1   | 2018-09-03 09:34:28.271 [info] &lt;0.294.0&gt; Starting rabbit_node_monitor<br>\nrabbitmq_1   | 2018-09-03 09:34:28.292 [info] &lt;0.322.0&gt; Making sure data directory '/var/lib/rabbitmq/mnesia/rabbit@zulip-rabbit/msg_stores/vhosts/628WB79CIFDYO9LJI6DKMI09L' for vhost '/' exists<br>\nrabbitmq_1   | 2018-09-03 09:34:28.395 [info] &lt;0.322.0&gt; Starting message stores for vhost '/'<br>\nrabbitmq_1   | 2018-09-03 09:34:28.396 [info] &lt;0.326.0&gt; Message store \"628WB79CIFDYO9LJI6DKMI09L/msg_store_transient\": using rabbit_msg_store_ets_index to provide index<br>\nrabbitmq_1   | 2018-09-03 09:34:28.398 [info] &lt;0.322.0&gt; Started message store of type transient for vhost '/'<br>\nrabbitmq_1   | 2018-09-03 09:34:28.398 [info] &lt;0.329.0&gt; Message store \"628WB79CIFDYO9LJI6DKMI09L/msg_store_persistent\": using rabbit_msg_store_ets_index to provide index<br>\nrabbitmq_1   | 2018-09-03 09:34:28.401 [info] &lt;0.322.0&gt; Started message store of type persistent for vhost '/'<br>\nrabbitmq_1   | 2018-09-03 09:34:28.455 [info] &lt;0.369.0&gt; started TCP Listener on [::]:5672<br>\nrabbitmq_1   | 2018-09-03 09:34:28.456 [info] &lt;0.230.0&gt; Setting up a table for connection tracking on this node: 'tracked_connection_on_node_rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:28.456 [info] &lt;0.230.0&gt; Setting up a table for per-vhost connection counting on this node: 'tracked_connection_per_vhost_on_node_rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:28.457 [info] &lt;0.33.0&gt; Application rabbit started on node 'rabbit@zulip-rabbit'<br>\nrabbitmq_1   | 2018-09-03 09:34:28.593 [info] &lt;0.5.0&gt; Server startup complete; 0 plugins started.<br>\nrabbitmq_1   |  completed with 0 plugins.<br>\nzulip_1      | Zulip configuration succeeded.<br>\nzulip_1      | Auto backup enabled.<br>\nzulip_1      | === End Initial Configuration Phase ===<br>\nzulip_1      | === Begin Bootstrap Phase ===<br>\nzulip_1      | Waiting for database server to allow connections ...<br>\nzulip_1      | Executing Zulip first start init ...<br>\nzulip_1      | +++ readlink -f /home/zulip/deployments/current/scripts/setup/initialize-database<br>\nzulip_1      | ++ dirname /home/zulip/deployments/2018-08-27-20-28-29/scripts/setup/initialize-database<br>\nzulip_1      | + THIS_DIR=/home/zulip/deployments/2018-08-27-20-28-29/scripts/setup<br>\nzulip_1      | + cd /home/zulip/deployments/2018-08-27-20-28-29/scripts/setup/../..<br>\nzulip_1      | + ./manage.py checkconfig<br>\nzulip_1      | + ./manage.py migrate --noinput<br>\nzulip_1      | Operations to perform:<br>\nzulip_1      |   Apply all migrations: analytics, auth, confirmation, contenttypes, otp_static, otp_totp, sessions, sites, social_django, two_factor, zerver<br>\nzulip_1      | Running migrations:<br>\nrabbitmq_1   | 2018-09-03 09:34:39.467 [info] &lt;0.375.0&gt; accepting AMQP connection &lt;0.375.0&gt; (172.28.0.3:46832 -&gt; 172.28.0.2:5672)<br>\nrabbitmq_1   | 2018-09-03 09:34:39.470 [info] &lt;0.375.0&gt; connection &lt;0.375.0&gt; (172.28.0.3:46832 -&gt; 172.28.0.2:5672): user 'zulip' authenticated and granted access to vhost '/'<br>\nzulip_1      |   Applying zerver.0060_move_avatars_to_be_uid_based...2018-09-03 09:34:39.301 ERR  [boto] Caught exception reading instance data<br>\nzulip_1      | Traceback (most recent call last):<br>\nzulip_1      |   File \"/usr/lib/python3.5/urllib/request.py\", line 1254, in do_open<br>\nzulip_1      |     h.request(req.get_method(), req.selector, req.data, headers)<br>\nzulip_1      |   File \"/usr/lib/python3.5/http/client.py\", line 1106, in request<br>\nzulip_1      |     self._send_request(method, url, body, headers)<br>\nzulip_1      |   File \"/usr/lib/python3.5/http/client.py\", line 1151, in _send_request<br>\nzulip_1      |     self.endheaders(body)<br>\nzulip_1      |   File \"/usr/lib/python3.5/http/client.py\", line 1102, in endheaders<br>\nzulip_1      |     self._send_output(message_body)<br>\nzulip_1      |   File \"/usr/lib/python3.5/http/client.py\", line 934, in _send_output<br>\nzulip_1      |     self.send(msg)<br>\nzulip_1      |   File \"/usr/lib/python3.5/http/client.py\", line 877, in send<br>\nzulip_1      |     self.connect()<br>\nzulip_1      |   File \"/usr/lib/python3.5/http/client.py\", line 849, in connect<br>\nzulip_1      |     (self.host,self.port), self.timeout, self.source_address)<br>\nzulip_1      |   File \"/usr/lib/python3.5/socket.py\", line 711, in create_connection<br>\nzulip_1      |     raise err<br>\nzulip_1      |   File \"/usr/lib/python3.5/socket.py\", line 702, in create_connection<br>\nzulip_1      |     sock.connect(sa)<br>\nzulip_1      | socket.timeout: timed out<br>\nzulip_1      | <br>\nzulip_1      | During handling of the above exception, another exception occurred:<br>\nzulip_1      | <br>\nzulip_1      | Traceback (most recent call last):<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/utils.py\", line 217, in retry_url<br>\nzulip_1      |     r = opener.open(req, timeout=timeout)<br>\nzulip_1      |   File \"/usr/lib/python3.5/urllib/request.py\", line 466, in open<br>\nzulip_1      |     response = self._open(req, data)<br>\nzulip_1      |   File \"/usr/lib/python3.5/urllib/request.py\", line 484, in _open<br>\nzulip_1      |     '_open', req)<br>\nzulip_1      |   File \"/usr/lib/python3.5/urllib/request.py\", line 444, in _call_chain<br>\nzulip_1      |     result = func(*args)<br>\nzulip_1      |   File \"/usr/lib/python3.5/urllib/request.py\", line 1282, in http_open<br>\nzulip_1      |     return self.do_open(http.client.HTTPConnection, req)<br>\nzulip_1      |   File \"/usr/lib/python3.5/urllib/request.py\", line 1256, in do_open<br>\nzulip_1      |     raise URLError(err)<br>\nzulip_1      | urllib.error.URLError: &lt;urlopen error timed out&gt;<br>\nzulip_1      | 2018-09-03 09:34:39.485 ERR  [boto] Unable to read instance data, giving up<br>\nzulip_1      | Traceback (most recent call last):<br>\nzulip_1      |   File \"./manage.py\", line 36, in &lt;module&gt;<br>\nzulip_1      |     execute_from_command_line(sys.argv)<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py\", line 364, in execute_from_command_line<br>\nzulip_1      |     utility.execute()<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py\", line 356, in execute<br>\nzulip_1      |     self.fetch_command(subcommand).run_from_argv(self.argv)<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py\", line 283, in run_from_argv<br>\nzulip_1      |     self.execute(*args, **cmd_options)<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py\", line 330, in execute<br>\nzulip_1      |     output = self.handle(*args, **options)<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/commands/migrate.py\", line 204, in handle<br>\nzulip_1      |     fake_initial=fake_initial,<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py\", line 115, in migrate<br>\nzulip_1      |     state = self._migrate_all_forwards(state, plan, full_plan, fake=fake, fake_initial=fake_initial)<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py\", line 145, in _migrate_all_forwards<br>\nzulip_1      |     state = self.apply_migration(state, migration, fake=fake, fake_initial=fake_initial)<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py\", line 244, in apply_migration<br>\nzulip_1      |     state = migration.apply(state, schema_editor)<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/migration.py\", line 129, in apply<br>\nzulip_1      |     operation.database_forwards(self.app_label, schema_editor, old_state, project_state)<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/operations/special.py\", line 193, in database_forwards<br>\nzulip_1      |     self.code(from_state.apps, schema_editor)<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zerver/migrations/0060_move_avatars_to_be_uid_based.py\", line 56, in move_avatars_to_be_uid_based<br>\nzulip_1      |     conn = S3Connection(settings.S3_KEY, settings.S3_SECRET_KEY)<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/connection.py\", line 194, in __init__<br>\nzulip_1      |     validate_certs=validate_certs, profile_name=profile_name)<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/connection.py\", line 569, in __init__<br>\nzulip_1      |     host, config, self.provider, self._required_auth_capability())<br>\nzulip_1      |   File \"/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/auth.py\", line 1021, in get_auth_handler<br>\nzulip_1      |     'Check your credentials' % (len(names), str(names)))<br>\nzulip_1      | boto.exception.NoAuthHandlerFound: No handler was ready to authenticate. 1 handlers were checked. ['HmacAuthV1Handler'] Check your credentials<br>\nrabbitmq_1   | 2018-09-03 09:34:39.736 [warning] &lt;0.375.0&gt; closing AMQP connection &lt;0.375.0&gt; (172.28.0.3:46832 -&gt; 172.28.0.2:5672, vhost: '/', user: 'zulip'):<br>\nrabbitmq_1   | client unexpectedly closed TCP connection<br>\nzulip_1      | Zulip first start database initi failed in \"initialize-database\" exit code 1. Exiting.<br>\ndocker-zulip_zulip_1 exited with code 1</p>",
        "id": 640964,
        "sender_full_name": "Chris",
        "timestamp": 1535967412
    },
    {
        "content": "<p>So looks like still an issue with the database.</p>",
        "id": 640965,
        "sender_full_name": "Chris",
        "timestamp": 1535967469
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"3028\">@chris</span> did you rebase to the latest version of <code>docker-zulip</code> first?</p>",
        "id": 641176,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1536079747
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> <span class=\"user-mention\" data-user-id=\"77\">@Alexander Trost</span> I got a slot for testing again. The install of the Zulip Docker image seems to have worked. I have problem with my Nginx Reverse proxy and will need to fix that to a proper configuration. Will let you know once done successfully.</p>",
        "id": 642347,
        "sender_full_name": "Chris",
        "timestamp": 1536568460
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> <span class=\"user-mention\" data-user-id=\"77\">@Alexander Trost</span> The Zulip Docker image works. I think there is an error in the documentation for the docker image running behind a reverse proxy (Nginx):</p>\n<p><a href=\"https://github.com/zulip/docker-zulip/wiki/Proxying-via-nginx-on-host-machine\" target=\"_blank\" title=\"https://github.com/zulip/docker-zulip/wiki/Proxying-via-nginx-on-host-machine\">https://github.com/zulip/docker-zulip/wiki/Proxying-via-nginx-on-host-machine</a></p>\n<p>In my opinion the proxy_pass must go to port 80 and not port 443. The \"double SSL proxy\" does not work in my opinion.<br>\nTherefore the nginx configuration file should be:  </p>\n<div class=\"codehilite\"><pre><span></span>    location / {\n          proxy_pass  http://127.0.0.1:8088;    # Port that docker-zulip is listening on\n   }\n</pre></div>\n\n\n<p>instead of  </p>\n<div class=\"codehilite\"><pre><span></span>    location / {\n            proxy_pass  https://127.0.0.1:8089;    # Port that docker-zulip is listening on\n  }\n</pre></div>\n\n\n<p>What do you think? Please advise in case my proposal should be insecure.</p>\n<p>Edit: At least the proxy_pass to port 80 makes it work on my system.</p>",
        "id": 642349,
        "sender_full_name": "Chris",
        "timestamp": 1536570485
    },
    {
        "content": "<p>-</p>",
        "id": 642354,
        "sender_full_name": "Chris",
        "timestamp": 1536571827
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"2915\">@chris</span> hmm, I don't think proxying to port 80 should be required there.</p>",
        "id": 642774,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1536705518
    },
    {
        "content": "<p>Dear all, I was, too, trying to get a docker instance up and running, and was following the steps given in <a href=\"https://github.com/zulip/docker-zulip\" target=\"_blank\" title=\"https://github.com/zulip/docker-zulip\">https://github.com/zulip/docker-zulip</a> 1:1.</p>\n<p>After configuring and giving the server a <code>docker-compose up -d</code>, the server, indeed, does \"print a bunch of output\" (as written in the instructions on how to set this up), only it does so for 5+ minutes and eventually finishes this way:</p>\n<div class=\"codehilite\"><pre><span></span>writing to /home/zulip/zulip/var/6d74d8a6-9e1a-45ec-9921-1dbdcddf43b4/provision_version\n\nZulip development environment setup succeeded!\n\nWARNING: This shell does not have the Zulip Python 3 virtualenv activated.\nZulip commands will fail until you activate the virtualenv.\n\nTo update the shell, run:\n    source /srv/zulip-py3-venv/bin/activate\nor just close this shell and start a new one (with Vagrant, `vagrant ssh`).\n</pre></div>\n\n\n<p>I'm not sure what \"This shell\" he is talking about; my server (host) does not have a /srv/zulipy-py3-venv/bin/... directory, and the Zulip container is not actually running at this point, so I can't get into its own shell. When looking from another shell on the host, I can see that the docker-zulip is not running:</p>\n<div class=\"codehilite\"><pre><span></span>ilyas@v16384:~$ sudo docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\n</pre></div>\n\n\n<p>And, uh, despite having given him the <code>-d</code> option, it does not return to shell, just hangs.</p>\n<p>Just like <span class=\"user-mention\" data-user-id=\"14112\">@Raju Devidas</span> , I'm trying to get this working for the third day in a row (meanwhile, I gave up on trying it via Plesk the GUI way).</p>\n<p>Is there anyone out there with ideas about this? What am I missing? I have no clue at this point anymore. <span aria-label=\"hurt\" class=\"emoji emoji-1f915\" role=\"img\" title=\"hurt\">:hurt:</span></p>",
        "id": 811599,
        "sender_full_name": "Amrish Ilyas",
        "timestamp": 1579901219
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"14507\">@Amrish Ilyas</span> can you provide more output?  Those lines are part of the setup process for a Zulip development environment, which might appear as part of building your own image.</p>",
        "id": 811610,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1579902148
    },
    {
        "content": "<p>Are you not using <code>docker-compose pull</code> to use the prebuilt images?</p>",
        "id": 811611,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1579902160
    },
    {
        "content": "<p>Yes I did <code>docker-compose pull</code>, exactly as in <a href=\"https://github.com/zulip/docker-zulip\" target=\"_blank\" title=\"https://github.com/zulip/docker-zulip\">https://github.com/zulip/docker-zulip</a>. And then <code>docker-compose up -d</code>. It was not my intention to set up a <strong>development environment</strong>, btw.</p>\n<p>I let it run and it went on, like 30 or so minutes later. It is still spitting out stuff. Shall report back soon.</p>",
        "id": 811619,
        "sender_full_name": "Amrish Ilyas",
        "timestamp": 1579902509
    },
    {
        "content": "<p>OK, if you can upload a file containing the log output from running it, that'd be helpful.</p>",
        "id": 811621,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1579902561
    },
    {
        "content": "<p>A <code>docker-compose build</code> will certainly spend a while building the image if you have slow Internet.</p>",
        "id": 811623,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1579902596
    },
    {
        "content": "<p>And <code>docker-compose up</code> will generally build an image if one hasn't been pulled.</p>",
        "id": 811624,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1579902609
    },
    {
        "content": "<p>Alright, it went on and finished by now. (I can't connect to the Zulip server, but that's another story I will be following up later.)</p>\n<p>Here's the terminal output (where, I hope, you can see I followed the instructions): <a href=\"https://pastebin.com/dPemGasn\" target=\"_blank\" title=\"https://pastebin.com/dPemGasn\">https://pastebin.com/dPemGasn</a> (beware, it's the whole stuff!)</p>\n<p>From here:</p>\n<div class=\"codehilite\"><pre><span></span>ilyas@v16384:~/docker-zulip$ sudo docker-compose pull\n[sudo] Passwort fr ilyas:\nWARNING: The GVqF variable is not set. Defaulting to a blank string.\nPulling database  ... done\nPulling memcached ... done\nPulling rabbitmq  ... done\nPulling redis     ... done\n</pre></div>\n\n\n<p>...it seems it didn't pull the docker-zulip image itself, so next thing it said it is going to build it:</p>\n<div class=\"codehilite\"><pre><span></span>ilyas@v16384:~/docker-zulip$ sudo docker-compose up -d\nWARNING: The GVqF variable is not set. Defaulting to a blank string.\n**Building zulip**\n</pre></div>",
        "id": 811692,
        "sender_full_name": "Amrish Ilyas",
        "timestamp": 1579905128
    },
    {
        "content": "<p>PS, something seems to be missing, no?:</p>\n<div class=\"codehilite\"><pre><span></span>ilyas@v16384:~/docker-zulip$ sudo docker ps\nCONTAINER ID        IMAGE                       COMMAND                  CREATED             STATUS              PORTS                                                        NAMES\ndf2f56ee703e        memcached:alpine            <span class=\"s2\">&quot;docker-entrypoint.s&quot;</span>   <span class=\"m\">34</span> minutes ago      Up <span class=\"m\">34</span> minutes       <span class=\"m\">11211</span>/tcp                                                    docker-zulip_memcached_1\na37a7067273e        zulip/zulip-postgresql:10   <span class=\"s2\">&quot;docker-entrypoint.s&quot;</span>   <span class=\"m\">34</span> minutes ago      Up <span class=\"m\">34</span> minutes       <span class=\"m\">5432</span>/tcp                                                     docker-zulip_database_1\na001dbe4e2f1        redis:alpine                <span class=\"s2\">&quot;docker-entrypoint.s&quot;</span>   <span class=\"m\">34</span> minutes ago      Up <span class=\"m\">34</span> minutes       <span class=\"m\">6379</span>/tcp                                                     docker-zulip_redis_1\n034fc0de4706        rabbitmq:3.7.7              <span class=\"s2\">&quot;docker-entrypoint.s&quot;</span>   <span class=\"m\">34</span> minutes ago      Up <span class=\"m\">34</span> minutes       <span class=\"m\">4369</span>/tcp, <span class=\"m\">5671</span>-5672/tcp, <span class=\"m\">25672</span>/tcp         docker-zulip_rabbitmq_1\n</pre></div>",
        "id": 811693,
        "sender_full_name": "Amrish Ilyas",
        "timestamp": 1579905614
    },
    {
        "content": "<p>I'm guessing the issue is whatever caused this to be displayed:<br>\n<code>WARNING: The GVqF variable is not set. Defaulting to a blank string.</code></p>",
        "id": 811721,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1579914614
    },
    {
        "content": "<p>That could be an issue with your changes to the docker-compose.yml?</p>",
        "id": 811722,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1579914663
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"14507\">@Amrish Ilyas</span> for me, <code>docker-compose pull</code> doesn't display that warning and does download a <code>zulip</code> container image as well as the others.</p>",
        "id": 811723,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1579914677
    },
    {
        "content": "<p>Correct output from the <code>docker-compose pull</code> command should look like this:</p>\n<div class=\"codehilite\"><pre><span></span>tabbott@coset:~/docker-zulip$ docker-compose pull\nPulling redis (redis:alpine)...\nalpine: Pulling from library/redis\nDigest: sha256:cb9783b1c39bb34f8d6572406139ab325c4fac0b28aaa25d5350495637bb2f76\nStatus: Image is up to date for redis:alpine\nPulling zulip (zulip/docker-zulip:2.1.2-0)...\n2.1.2-0: Pulling from zulip/docker-zulip\nDigest: sha256:4f86a2c12b02cd36621a1461628bd3fdaa72d416c1cbef7085c28486245d2f17\nStatus: Image is up to date for zulip/docker-zulip:2.1.2-0\nPulling memcached (memcached:alpine)...\nalpine: Pulling from library/memcached\nDigest: sha256:a5937f7b44e7482c6119fe53e8b6ed62241e222f5ef92407a9085ca16742b396\nStatus: Image is up to date for memcached:alpine\nPulling rabbitmq (rabbitmq:3.7.7)...\n3.7.7: Pulling from library/rabbitmq\nDigest: sha256:a8094b952b9fe778f4e70efaca98494e167088ef3272944a28b89caf6e098790\nStatus: Image is up to date for rabbitmq:3.7.7\nPulling database (zulip/zulip-postgresql:10)...\n10: Pulling from zulip/zulip-postgresql\nDigest: sha256:7541f451aa8e6f7b91cb860a4dee33105e3da28693d0e06431c30792939c1d6e\nStatus: Image is up to date for zulip/zulip-postgresql:10\n</pre></div>\n\n\n<p>(Well, if you run it twice)</p>",
        "id": 811725,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1579914735
    },
    {
        "content": "<blockquote>\n<p>That could be an issue with your changes to the docker-compose.yml?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span>  Oh, I only set all the passwords, external host, email stuff and ports. Can you identify a problem here? -&gt; <a href=\"https://pastebin.com/P0jRFVnj\" target=\"_blank\" title=\"https://pastebin.com/P0jRFVnj\">https://pastebin.com/P0jRFVnj</a> (erased the email settings for obvious reasons). I did look up how to set the containers exposed ports right (container:host or host:container), but maybe I got it the wrong way. Wouldn't think that's the reason for this, though. :/</p>\n<p>Couldn't find anything about a GVqF variable anywhere. It's a standard Ubuntu 18.04 LTS vhost I'm trying to get this set up (w/ enough RAM, really). Docker-compose is version 1.25.0, build 0a186604. Docker itself is version 19.03.5, build 633a0ea838.</p>\n<p>Just as a side note, I did set up a Zulip server on real hardware for my organization, and it's phantastic. Love it very much, you are doing a great job!!</p>",
        "id": 811781,
        "sender_full_name": "Amrish Ilyas",
        "timestamp": 1579939726
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"14507\">@Amrish Ilyas</span> OK, I think I see what the problem is.  The <code>GVqF</code> variable is I think coming from the fact that your redis password in that file has some special characters in it that aren't being escaped properly when going through Docker's environment variable system <span aria-label=\"frown\" class=\"emoji emoji-1f641\" role=\"img\" title=\"frown\">:frown:</span>.  Let me open an issue for this bug.  <span class=\"user-mention\" data-user-id=\"699\">@Anders Kaseorg</span> FYI.</p>",
        "id": 811928,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1580019518
    },
    {
        "content": "<p><a href=\"https://github.com/zulip/docker-zulip/issues/238\" target=\"_blank\" title=\"https://github.com/zulip/docker-zulip/issues/238\">https://github.com/zulip/docker-zulip/issues/238</a></p>",
        "id": 811929,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1580019752
    },
    {
        "content": "<p>Thank you Tim. I wouldn't have looked for a \"GVqF variable\" in my own strings...</p>\n<p>For this to get finally going, I changed all the passwords to letters and numbers only (after removing all containers and images for a fresh start). The error does not come up anymore, but for some odd reason, the Zulip docker image was still not getting pulled... <span aria-label=\"dizzy\" class=\"emoji emoji-1f635\" role=\"img\" title=\"dizzy\">:dizzy:</span></p>\n<p>I had to remove / outcomment the following lines from <code>docker-compose.yml</code>to finally have it pulled along with the other images:</p>\n<div class=\"codehilite\"><pre><span></span>    <span class=\"nt\">build</span><span class=\"p\">:</span>\n      <span class=\"nt\">context</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">.</span>\n      <span class=\"nt\">args</span><span class=\"p\">:</span>\n        <span class=\"c1\"># Change these if you want to build zulip from a different repo/branch</span>\n        <span class=\"nt\">ZULIP_GIT_URL</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">https://github.com/zulip/zulip.git</span>\n        <span class=\"nt\">ZULIP_GIT_REF</span><span class=\"p\">:</span> <span class=\"l l-Scalar l-Scalar-Plain\">2.1.2</span>\n</pre></div>",
        "id": 812113,
        "sender_full_name": "Amrish Ilyas",
        "timestamp": 1580058294
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"14507\">@Amrish Ilyas</span> what version of <code>docker-compose</code> are you using?</p>",
        "id": 812123,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1580082749
    },
    {
        "content": "<p>It may be that Docker changed its defaults for whether to prefer building over using a pulled image, and that's the source of the discrepancy.</p>",
        "id": 812124,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1580082767
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> It's <code>docker-compose version 1.25.0, build 0a186604</code>.</p>\n<p>Under \"New Features\" for this version, <a href=\"https://docs.docker.com/release-notes/docker-compose/\" target=\"_blank\" title=\"https://docs.docker.com/release-notes/docker-compose/\">they write</a>: \"Pulling only of images that cannot be built\". Maybe that's it.</p>",
        "id": 812272,
        "sender_full_name": "Amrish Ilyas",
        "timestamp": 1580109787
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"14507\">@Amrish Ilyas</span> I see, it does sound like that new feature makes it impossible to provide configuration for building an email without editing <code>docker-compose.yml</code> while also allowing pulling.</p>",
        "id": 812571,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1580167492
    }
]