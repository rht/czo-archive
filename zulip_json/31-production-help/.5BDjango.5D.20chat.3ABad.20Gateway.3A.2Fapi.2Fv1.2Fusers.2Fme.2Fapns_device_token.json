[
    {
        "content": "<p>from day to day, i'm getting more and more errors from different users like this (via email to the admin). </p>\n<p>does somebody know what this means or what is causing this ?</p>\n<div class=\"codehilite\"><pre><span></span><code>Logger django.request, from module django.utils.log line 230:\nError generated by &lt;**username**&gt; &lt;**user email**&gt; (Member) on &lt;**servername**&gt; deployment\n\nNo stack trace available\n\nDeployed code:\n- git: None\n- ZULIP_VERSION: 4.3\n\n\nRequest info:\n- path: /api/v1/users/me/apns_device_token\n- POST: {&#39;token&#39;: [&#39;&lt;**token string**&gt;&#39;], &#39;appid&#39;: [&#39;org.zulip.Zulip&#39;]}\n- REMOTE_ADDR: &quot;&lt;**IP**&gt;&quot;\n- QUERY_STRING: &quot;&quot;\n- SERVER_NAME: &quot;&quot;\n</code></pre></div>",
        "id": 1246328,
        "sender_full_name": "RolandK",
        "timestamp": 1628712697
    },
    {
        "content": "<p>This topic was moved here from <a class=\"stream-topic\" data-stream-id=\"9\" href=\"/#narrow/stream/9-issues/topic/.5BDjango.5D.20chat.3ABad.20Gateway.3A.2Fapi.2Fv1.2Fusers.2Fme.2Fapns_device_token\">#issues &gt; [Django] chat:Bad Gateway:/api/v1/users/me/apns_device_token</a> by <span class=\"user-mention silent\" data-user-id=\"12178\">Alex Vandiver</span></p>",
        "id": 1246475,
        "sender_full_name": "Notification Bot",
        "timestamp": 1628788133
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"11088\">@RolandK</span>: I'm assuming the string you set as the topic was the subject of the email?</p>\n<p>This looks like a failure to register new mobile devices.  Mobile notifications go through Zulip Cloud, so the \"Bad Gateway\" could conceivably be coming from the Zulip Cloud servers; we did have a short outage of push notifications on the 4th.</p>\n<p>Are you still seeing those errors come in, with recent timestamps?  If so, can you tell me (via PMs, if you prefer) the IP address of your server?</p>",
        "id": 1246486,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1628789956
    },
    {
        "content": "<p>oh yes, i was not aware that this is about push notifications. i send you the ip via pn</p>",
        "id": 1246697,
        "sender_full_name": "RolandK",
        "timestamp": 1628854529
    },
    {
        "content": "<p>I don't see any hits to Zulip Cloud's mobile push gateway (or anything else) from the IP you told me.</p>\n<p>Did your server register for mobile push notifications, using <a href=\"https://zulip.readthedocs.io/en/latest/production/mobile-push-notifications.html\">https://zulip.readthedocs.io/en/latest/production/mobile-push-notifications.html</a> ?</p>",
        "id": 1247400,
        "sender_full_name": "Alex Vandiver",
        "timestamp": 1629174961
    },
    {
        "content": "<p>hello, thanks for helping and looking into it. </p>\n<p>apparently there has been some problem with our firewall configuration and outgoing connection to the internet from our zulip server was blocked completely (policy:drop) and nobody complained that push notifications didnt work (and i didn't notice either), as many often disable those (me included). at least, from time to time.</p>\n<p>anyway, if the server cannot send push notifications to <a href=\"http://push.zulipchat.com\">push.zulipchat.com</a>, a more precise error message would be very helpful and would have pointed us to the real problem very quickly.</p>",
        "id": 1247493,
        "sender_full_name": "RolandK",
        "timestamp": 1629193870
    },
    {
        "content": "<p>should i open an RFE on github for this (if it doesn't exist) ?</p>",
        "id": 1247494,
        "sender_full_name": "RolandK",
        "timestamp": 1629193890
    },
    {
        "content": "<p>i did not notice the problem, because the django error emails we got, were mostly regarding the same two persons but we have 50+ users on that server and i don't believe, that these are the only ones who have push notifications active. so the question is, why we admins did not get spammed with \"bad gateway\" error-mails</p>",
        "id": 1247498,
        "sender_full_name": "RolandK",
        "timestamp": 1629194439
    },
    {
        "content": "<p>ok, in server.log apparently there IS a notification, so the question is why zulip server rarely sends email regarding an obscure django error for some few affected persons when push notification server was not reachable at all.</p>\n<div class=\"codehilite\"><pre><span></span><code>root@chat:/var/log/zulip# cat server.log |grep ConnectionError |tail\n2021-08-17 00:14:59.285 WARN [] ConnectionError while trying to connect to push notification bouncer\n2021-08-17 01:06:19.380 WARN [] ConnectionError while trying to connect to push notification bouncer\n2021-08-17 02:05:03.906 WARN [] ConnectionError while trying to connect to push notification bouncer\n2021-08-17 03:05:38.147 WARN [] ConnectionError while trying to connect to push notification bouncer\n2021-08-17 04:05:05.230 WARN [] ConnectionError while trying to connect to push notification bouncer\n2021-08-17 05:05:13.697 WARN [] ConnectionError while trying to connect to push notification bouncer\n2021-08-17 06:05:21.932 WARN [] ConnectionError while trying to connect to push notification bouncer\n2021-08-17 07:05:10.122 WARN [] ConnectionError while trying to connect to push notification bouncer\n2021-08-17 08:05:04.193 WARN [] ConnectionError while trying to connect to push notification bouncer\n2021-08-17 09:05:04.114 WARN [] ConnectionError while trying to connect to push notification bouncer\n</code></pre></div>",
        "id": 1247501,
        "sender_full_name": "RolandK",
        "timestamp": 1629194807
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 1247502,
        "sender_full_name": "RolandK",
        "timestamp": 1629195093
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"11088\">@RolandK</span> yeah I think you should open an issue for adjusting the error reporting situation here; this should probably have sent emails.</p>",
        "id": 1247548,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1629209547
    },
    {
        "content": "<p>(Though we do need to be careful to distinguish totally broken from transient issues, since transient 1-2 minutes Internet connection interruptions happen all the time and one probably doesn't want emails about that)</p>",
        "id": 1247549,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1629209582
    },
    {
        "content": "<p>thanks. i will open a github issue</p>",
        "id": 1247708,
        "sender_full_name": "RolandK",
        "timestamp": 1629232873
    },
    {
        "content": "<p>fyi:  <a href=\"https://github.com/zulip/zulip/issues/19596\">https://github.com/zulip/zulip/issues/19596</a></p>",
        "id": 1248150,
        "sender_full_name": "RolandK",
        "timestamp": 1629381709
    },
    {
        "content": "<p>Great, tagged it as a priority.</p>",
        "id": 1248394,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1629468028
    }
]