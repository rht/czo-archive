[
    {
        "content": "<p>Hi, zulip is showing this error -&gt; <code>zulip-thumbor: ERROR (spawn error)</code> while restarting.</p>",
        "id": 678016,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546463922
    },
    {
        "content": "<p>Here, some trace while restarting the server.</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"mi\">2019</span><span class=\"o\">-</span><span class=\"mo\">01</span><span class=\"o\">-</span><span class=\"mo\">02</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">10</span><span class=\"p\">:</span><span class=\"mi\">56</span><span class=\"p\">,</span><span class=\"mi\">441</span> <span class=\"n\">restart</span><span class=\"o\">-</span><span class=\"n\">server</span><span class=\"p\">:</span> <span class=\"n\">Stopping</span> <span class=\"n\">server</span> <span class=\"n\">core</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">django</span><span class=\"p\">:</span> <span class=\"n\">stopped</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">senders</span><span class=\"p\">:</span><span class=\"n\">zulip_events_message_sender</span><span class=\"o\">-</span><span class=\"mi\">0</span><span class=\"p\">:</span> <span class=\"n\">stopped</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">senders</span><span class=\"p\">:</span><span class=\"n\">zulip_events_message_sender</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">:</span> <span class=\"n\">stopped</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">senders</span><span class=\"p\">:</span><span class=\"n\">zulip_events_message_sender</span><span class=\"o\">-</span><span class=\"mi\">2</span><span class=\"p\">:</span> <span class=\"n\">stopped</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">senders</span><span class=\"p\">:</span><span class=\"n\">zulip_events_message_sender</span><span class=\"o\">-</span><span class=\"mi\">3</span><span class=\"p\">:</span> <span class=\"n\">stopped</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">thumbor</span><span class=\"p\">:</span> <span class=\"n\">ERROR</span> <span class=\"p\">(</span><span class=\"ow\">not</span> <span class=\"n\">running</span><span class=\"p\">)</span>\n<span class=\"mi\">2019</span><span class=\"o\">-</span><span class=\"mo\">01</span><span class=\"o\">-</span><span class=\"mo\">02</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">10</span><span class=\"p\">:</span><span class=\"mi\">59</span><span class=\"p\">,</span><span class=\"mi\">115</span> <span class=\"n\">restart</span><span class=\"o\">-</span><span class=\"n\">server</span><span class=\"p\">:</span> <span class=\"n\">Starting</span> <span class=\"n\">server</span> <span class=\"n\">core</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">django</span><span class=\"p\">:</span> <span class=\"n\">started</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">senders</span><span class=\"p\">:</span><span class=\"n\">zulip_events_message_sender</span><span class=\"o\">-</span><span class=\"mi\">0</span><span class=\"p\">:</span> <span class=\"n\">started</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">senders</span><span class=\"p\">:</span><span class=\"n\">zulip_events_message_sender</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">:</span> <span class=\"n\">started</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">senders</span><span class=\"p\">:</span><span class=\"n\">zulip_events_message_sender</span><span class=\"o\">-</span><span class=\"mi\">2</span><span class=\"p\">:</span> <span class=\"n\">started</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">senders</span><span class=\"p\">:</span><span class=\"n\">zulip_events_message_sender</span><span class=\"o\">-</span><span class=\"mi\">3</span><span class=\"p\">:</span> <span class=\"n\">started</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">thumbor</span><span class=\"p\">:</span> <span class=\"n\">ERROR</span> <span class=\"p\">(</span><span class=\"n\">spawn</span> <span class=\"n\">error</span><span class=\"p\">)</span>\n<span class=\"mi\">2019</span><span class=\"o\">-</span><span class=\"mo\">01</span><span class=\"o\">-</span><span class=\"mo\">02</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">11</span><span class=\"p\">:</span><span class=\"mo\">02</span><span class=\"p\">,</span><span class=\"mi\">940</span> <span class=\"n\">restart</span><span class=\"o\">-</span><span class=\"n\">server</span><span class=\"p\">:</span> <span class=\"n\">Starting</span> <span class=\"n\">workers</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">workers</span><span class=\"p\">:</span><span class=\"n\">zulip_events_feedback_messages</span><span class=\"p\">:</span> <span class=\"n\">started</span>\n<span class=\"n\">zulip</span><span class=\"o\">-</span><span class=\"n\">workers</span><span class=\"p\">:</span><span class=\"n\">zulip_events_slow_queries</span><span class=\"p\">:</span> <span class=\"n\">started</span>\n</pre></div>",
        "id": 678021,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546464086
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"10831\">@Mani Sankar Nambaru</span> what's in <code>/var/log/zulip/thumbor.log</code>?</p>",
        "id": 678022,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546464233
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/current/zulip-thumbor-venv/bin/thumbor&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n    <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">exit</span><span class=\"p\">(</span><span class=\"n\">main</span><span class=\"p\">())</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/srv/zulip-venv-cache/890ced270adac8406802ba25797517e3250e67d8/zulip-thumbor-venv/local/lib/python2.7/site-packages/thumbor/server.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">136</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">main</span>\n    <span class=\"n\">config</span> <span class=\"o\">=</span> <span class=\"n\">get_config</span><span class=\"p\">(</span><span class=\"n\">server_parameters</span><span class=\"o\">.</span><span class=\"n\">config_path</span><span class=\"p\">,</span> <span class=\"n\">server_parameters</span><span class=\"o\">.</span><span class=\"n\">use_environment</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/srv/zulip-venv-cache/890ced270adac8406802ba25797517e3250e67d8/zulip-thumbor-venv/local/lib/python2.7/site-packages/thumbor/server.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">53</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">get_config</span>\n    <span class=\"k\">return</span> <span class=\"n\">Config</span><span class=\"o\">.</span><span class=\"n\">load</span><span class=\"p\">(</span><span class=\"n\">config_path</span><span class=\"p\">,</span> <span class=\"n\">conf_name</span><span class=\"o\">=</span><span class=\"s1\">&#39;thumbor.conf&#39;</span><span class=\"p\">,</span> <span class=\"n\">lookup_paths</span><span class=\"o\">=</span><span class=\"n\">lookup_paths</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/srv/zulip-venv-cache/890ced270adac8406802ba25797517e3250e67d8/zulip-thumbor-venv/local/lib/python2.7/site-packages/derpconf/config.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">75</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">load</span>\n    <span class=\"k\">return</span> <span class=\"bp\">cls</span><span class=\"o\">.</span><span class=\"n\">__load_from_path</span><span class=\"p\">(</span><span class=\"n\">conf</span><span class=\"p\">,</span> <span class=\"n\">path</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/srv/zulip-venv-cache/890ced270adac8406802ba25797517e3250e67d8/zulip-thumbor-venv/local/lib/python2.7/site-packages/derpconf/config.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">95</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">__load_from_path</span>\n    <span class=\"n\">six</span><span class=\"o\">.</span><span class=\"n\">exec_</span><span class=\"p\">(</span><span class=\"n\">code</span><span class=\"p\">,</span> <span class=\"n\">module</span><span class=\"o\">.</span><span class=\"vm\">__dict__</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/srv/zulip-venv-cache/890ced270adac8406802ba25797517e3250e67d8/zulip-thumbor-venv/local/lib/python2.7/site-packages/six.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">709</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">exec_</span>\n    <span class=\"k\">exec</span><span class=\"p\">(</span><span class=\"s2\">&quot;&quot;&quot;exec _code_ in _globs_, _locs_&quot;&quot;&quot;</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;&lt;string&gt;&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;&lt;string&gt;&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">660</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n<span class=\"ne\">ImportError</span><span class=\"p\">:</span> <span class=\"n\">cannot</span> <span class=\"kn\">import</span> <span class=\"nn\">name</span> <span class=\"nn\">S3_REGION</span>\n</pre></div>",
        "id": 678023,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546464301
    },
    {
        "content": "<p>Interesting.</p>",
        "id": 678027,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546464597
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"10831\">@Mani Sankar Nambaru</span> did you by any chance upgrade this server from an older version of Zulip?</p>",
        "id": 678028,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546464618
    },
    {
        "content": "<p>I think you just need to add <code>S3_REGION = ''</code> in <code>/etc/zulip/settings.py</code>  to fix this.</p>",
        "id": 678029,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546464636
    },
    {
        "content": "<p>Okay I will try. I have added that in boto.cfg though.</p>",
        "id": 678030,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546464673
    },
    {
        "content": "<p>Yeah, that's not relevant to this specific issue.</p>",
        "id": 678031,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546464688
    },
    {
        "content": "<blockquote>\n<p><span class=\"user-mention\" data-user-id=\"10831\">@Mani Sankar Nambaru</span> did you by any chance upgrade this server from an older version of Zulip?</p>\n</blockquote>\n<p>Yes, from 1.8.1 to the latest version.</p>",
        "id": 678032,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546464695
    },
    {
        "content": "<p>(There's a bug in the code, which I'll fix,; my suggestion above is a workaround)</p>",
        "id": 678033,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546464700
    },
    {
        "content": "<blockquote>\n<p>(There's a bug in the code, which I'll fix,; my suggestion above is a workaround)</p>\n</blockquote>\n<p>Great!</p>",
        "id": 678034,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546464715
    },
    {
        "content": "<p>I will add and let you know. Thanks!</p>",
        "id": 678035,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546464732
    },
    {
        "content": "<p>Should be fixed for future users in <a href=\"https://github.com/zulip/zulip/commit/2e533f32c2e476a6ce1a53271f7801373ecccb2e\" target=\"_blank\" title=\"https://github.com/zulip/zulip/commit/2e533f32c2e476a6ce1a53271f7801373ecccb2e\">2e533f32c2e476a6ce1a53271f7801373ecccb2e</a></p>",
        "id": 678038,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546464842
    },
    {
        "content": "<p>I'm also getting mails from the server, maybe impotError was causing this:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">185</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_get_response</span>\n    <span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"n\">wrapped_callback</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">callback_args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">callback_kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/django/views/decorators/csrf.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">58</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">wrapped_view</span>\n    <span class=\"k\">return</span> <span class=\"n\">view_func</span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;./zerver/lib/rest.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">131</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">rest_dispatch</span>\n    <span class=\"k\">return</span> <span class=\"n\">target_function</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/django/utils/decorators.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">149</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_wrapped_view</span>\n    <span class=\"n\">response</span> <span class=\"o\">=</span> <span class=\"n\">view_func</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;./zerver/decorator.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">669</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_wrapped_view_func</span>\n    <span class=\"k\">return</span> <span class=\"n\">authenticate_log_and_execute_json</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"n\">view_func</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;./zerver/decorator.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">651</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">authenticate_log_and_execute_json</span>\n    <span class=\"k\">return</span> <span class=\"n\">rate_limit</span><span class=\"p\">()(</span><span class=\"n\">view_func</span><span class=\"p\">)(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"n\">user_profile</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;./zerver/decorator.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">804</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">wrapped_func</span>\n    <span class=\"k\">return</span> <span class=\"n\">func</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">args</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;./zerver/views/upload.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">103</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">upload_file_backend</span>\n    <span class=\"n\">uri</span> <span class=\"o\">=</span> <span class=\"n\">upload_message_image_from_request</span><span class=\"p\">(</span><span class=\"n\">request</span><span class=\"p\">,</span> <span class=\"n\">user_file</span><span class=\"p\">,</span> <span class=\"n\">user_profile</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;./zerver/lib/upload.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">669</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">upload_message_image_from_request</span>\n    <span class=\"n\">content_type</span><span class=\"p\">,</span> <span class=\"n\">user_file</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">(),</span> <span class=\"n\">user_profile</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;./zerver/lib/upload.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">645</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">upload_message_file</span>\n    <span class=\"n\">target_realm</span><span class=\"o\">=</span><span class=\"n\">target_realm</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;./zerver/lib/upload.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">313</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">upload_message_file</span>\n    <span class=\"n\">file_data</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;./zerver/lib/upload.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">231</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">upload_image_to_s3</span>\n    <span class=\"n\">key</span><span class=\"o\">.</span><span class=\"n\">set_contents_from_string</span><span class=\"p\">(</span><span class=\"n\">contents</span><span class=\"p\">,</span> <span class=\"n\">headers</span><span class=\"o\">=</span><span class=\"n\">headers</span><span class=\"p\">)</span>  <span class=\"c1\"># type: ignore # https://github.com/python/typeshed/issues/1552</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/key.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1442</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">set_contents_from_string</span>\n    <span class=\"n\">encrypt_key</span><span class=\"o\">=</span><span class=\"n\">encrypt_key</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/key.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1309</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">set_contents_from_file</span>\n    <span class=\"n\">chunked_transfer</span><span class=\"o\">=</span><span class=\"n\">chunked_transfer</span><span class=\"p\">,</span> <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"n\">size</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/key.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">762</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">send_file</span>\n    <span class=\"n\">chunked_transfer</span><span class=\"o\">=</span><span class=\"n\">chunked_transfer</span><span class=\"p\">,</span> <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"n\">size</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/key.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">963</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_send_file_internal</span>\n    <span class=\"n\">query_args</span><span class=\"o\">=</span><span class=\"n\">query_args</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/connection.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">671</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">make_request</span>\n    <span class=\"n\">retry_handler</span><span class=\"o\">=</span><span class=\"n\">retry_handler</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/connection.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">1071</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">make_request</span>\n    <span class=\"n\">retry_handler</span><span class=\"o\">=</span><span class=\"n\">retry_handler</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/connection.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">927</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">_mexe</span>\n    <span class=\"n\">request</span><span class=\"o\">.</span><span class=\"n\">authorize</span><span class=\"p\">(</span><span class=\"n\">connection</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/connection.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">377</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">authorize</span>\n    <span class=\"n\">connection</span><span class=\"o\">.</span><span class=\"n\">_auth_handler</span><span class=\"o\">.</span><span class=\"n\">add_auth</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/auth.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">755</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">add_auth</span>\n    <span class=\"o\">**</span><span class=\"n\">kwargs</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/auth.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">574</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">add_auth</span>\n    <span class=\"n\">string_to_sign</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">string_to_sign</span><span class=\"p\">(</span><span class=\"n\">req</span><span class=\"p\">,</span> <span class=\"n\">canonical_request</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/auth.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">514</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">string_to_sign</span>\n    <span class=\"n\">sts</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">credential_scope</span><span class=\"p\">(</span><span class=\"n\">http_request</span><span class=\"p\">))</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/auth.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">496</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">credential_scope</span>\n    <span class=\"n\">region_name</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">determine_region_name</span><span class=\"p\">(</span><span class=\"n\">http_request</span><span class=\"o\">.</span><span class=\"n\">host</span><span class=\"p\">)</span>\n  <span class=\"n\">File</span> <span class=\"s2\">&quot;/home/zulip/deployments/2018-12-31-18-39-43/zulip-py3-venv/lib/python3.5/site-packages/boto/auth.py&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span> <span class=\"mi\">690</span><span class=\"p\">,</span> <span class=\"ow\">in</span> <span class=\"n\">determine_region_name</span>\n    <span class=\"k\">return</span> <span class=\"n\">region_name</span>\n<span class=\"ne\">UnboundLocalError</span><span class=\"p\">:</span> <span class=\"n\">local</span> <span class=\"n\">variable</span> <span class=\"s1\">&#39;region_name&#39;</span> <span class=\"n\">referenced</span> <span class=\"n\">before</span> <span class=\"n\">assignment</span>\n\n\n<span class=\"n\">Deployed</span> <span class=\"n\">code</span><span class=\"p\">:</span>\n<span class=\"o\">-</span> <span class=\"n\">ZULIP_VERSION</span><span class=\"p\">:</span> <span class=\"mf\">1.9</span><span class=\"o\">.</span><span class=\"mi\">1</span>\n<span class=\"o\">-</span> <span class=\"n\">version</span><span class=\"p\">:</span> <span class=\"mf\">1.9</span><span class=\"o\">.</span><span class=\"mi\">1</span>\n</pre></div>",
        "id": 678041,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546464874
    },
    {
        "content": "<p>that could be related to your <code>boto.cfg</code> file.</p>",
        "id": 678042,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546464934
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span>[s3]\nuse-sigv4 = True\nhost = ec2.ap-south-1.amazonaws.com\n</pre></div>",
        "id": 678044,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546465019
    },
    {
        "content": "<p>It's not an exception I've seen before; kinda sound like a bug in boto itself?</p>",
        "id": 678045,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546465021
    },
    {
        "content": "<p>And that's at <code>/etc/zulip/boto.cfg</code>?</p>",
        "id": 678046,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546465035
    },
    {
        "content": "<blockquote>\n<p>And that's at <code>/etc/zulip/boto.cfg</code>?</p>\n</blockquote>\n<p>Yes</p>",
        "id": 678047,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546465048
    },
    {
        "content": "<p><a href=\"https://github.com/boto/boto/issues/3377\" target=\"_blank\" title=\"https://github.com/boto/boto/issues/3377\">https://github.com/boto/boto/issues/3377</a></p>",
        "id": 678048,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546465073
    },
    {
        "content": "<p><a href=\"https://github.com/boto/boto/issues/3377\" target=\"_blank\" title=\"https://github.com/boto/boto/issues/3377\">https://github.com/boto/boto/issues/3377</a></p>",
        "id": 678049,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546465078
    },
    {
        "content": "<p>Change the <code>ec2.</code> to <code>s3.</code>.</p>",
        "id": 678050,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546465128
    },
    {
        "content": "<p>I bet that's your problem.</p>",
        "id": 678051,
        "sender_full_name": "Tim Abbott",
        "timestamp": 1546465133
    },
    {
        "content": "<p>Wow, You are correct.</p>",
        "id": 678053,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546465156
    },
    {
        "content": "<p>Thank you very much <span class=\"user-mention\" data-user-id=\"7\">@Tim Abbott</span> it worked like a charm. I have made a mistake while copy and pasting the described region from aws ec2.</p>",
        "id": 678056,
        "sender_full_name": "Mani Sankar",
        "timestamp": 1546465530
    }
]