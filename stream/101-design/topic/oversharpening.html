<html>
<head><meta charset="utf-8"><title>oversharpening · design · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/101-design/index.html">design</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html">oversharpening</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="653881"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/653881" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#653881">(Oct 19 2018 at 16:17)</a>:</h4>
<p>I didn't mention this when I noticed it first, thinking it is too obvious to not get addressed, but I maybe not...</p>



<a name="653882"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/653882" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#653882">(Oct 19 2018 at 16:19)</a>:</h4>
<p>We are oversharpening the thumbnails significantly.</p>



<a name="653883"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/653883" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#653883">(Oct 19 2018 at 16:19)</a>:</h4>
<p>Pinging <span class="user-mention" data-user-id="1113">@Aditya Bansal</span> about i.</p>



<a name="653884"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/653884" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#653884">(Oct 19 2018 at 16:20)</a>:</h4>
<p>Looking at the settings in the docs:<br>
<a href="https://github.com/thumbor/thumbor/wiki/Sharpen" target="_blank" title="https://github.com/thumbor/thumbor/wiki/Sharpen">https://github.com/thumbor/thumbor/wiki/Sharpen</a></p>



<a name="653885"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/653885" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#653885">(Oct 19 2018 at 16:22)</a>:</h4>
<p>The use of sharpen in our case should be mostly to undo the softening the resize causes.<br>
I suggest we:</p>
<ul>
<li>set <code>luminance_only</code> to <code>true</code> (sharpens and does not distort colors)</li>
<li>decrease  <code>sharpen_amount</code> to something in the 1-1.5 range</li>
<li>decrease <code>sharpen_radius</code> to 0.5-0.6</li>
</ul>



<a name="653935"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/653935" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#653935">(Oct 19 2018 at 19:44)</a>:</h4>
<p>OK, happy to just switch those.  Right now we're only using the thumbnailing on this server precisely so we can find issues like this, so happy to iterate.  I'm a little sad I couldn't find recommended settings on the thumbor website for what to use for these and thus we're having to try a few things ourselves.</p>



<a name="653947"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/653947" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#653947">(Oct 19 2018 at 20:13)</a>:</h4>
<p>I have a lot of experience sharpening in Photoshop, which has similar values and names, possibly similar algorithm for sharpening too.</p>



<a name="653948"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/653948" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#653948">(Oct 19 2018 at 20:14)</a>:</h4>
<p>I guess that made it more obvious to me what the issue is.</p>



<a name="653949"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/653949" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#653949">(Oct 19 2018 at 20:18)</a>:</h4>
<p>haha yeah, I don't think I would have ever figured it out.</p>



<a name="654104"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/654104" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aditya Bansal <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#654104">(Oct 20 2018 at 19:37)</a>:</h4>
<p>hey sorry for the delay in reply <span class="user-mention" data-user-id="284">@Boris Yankov</span> <br>
so basically my process for choosing the values was hit and trial. I did try reading docs but as Tim mentioned apart from ranges mentioned over there we have to just choose these values ourselves. So what I did was pick up an image and try out different values locally. I just chose those values which seemed to make the image look a bit more clear (that is the edges inside the image seemed to have became more visible even when it was a thumbnail). I guess this is what sharpening itself means! <br>
I used the below image when I was figuring the values. Seemed to have made boundaries of the figure in the image more evident so I chose those values.<br>
<a href="/user_uploads/2/f/DNAkVnq5CZVVGPWDF1S77Sy7/_MG_0452.JPG" target="_blank" title="_MG_0452.JPG">_MG_0452.JPG</a> </p>
<div class="message_inline_image"><a href="/user_uploads/2/f/DNAkVnq5CZVVGPWDF1S77Sy7/_MG_0452.JPG" target="_blank" title="_MG_0452.JPG"><img data-src-fullsize="/thumbnail?url=user_uploads%2F2%2Ff%2FDNAkVnq5CZVVGPWDF1S77Sy7%2F_MG_0452.JPG&amp;size=full" src="/thumbnail?url=user_uploads%2F2%2Ff%2FDNAkVnq5CZVVGPWDF1S77Sy7%2F_MG_0452.JPG&amp;size=thumbnail"></a></div><p>If you would like I can deploy some values on nightly as well and see which one looks good (when you are online) :)</p>
<p>Also you can try out different values in your own dev environment if you would like. I can pin point the exact line where you can just change the settings and server would hot reload and you can see changes in the image rendered. (Change line 52 in <code>/zulip/zerver/lib/thumbnail.py</code>. Line says <code>filters=['no_upscale()', 'sharpen(2.2,0.8,false)'],</code>)</p>



<a name="654145"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/654145" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#654145">(Oct 20 2018 at 23:57)</a>:</h4>
<p><span class="user-mention" data-user-id="1113">@Aditya Bansal</span> yeah, I suspect there has to be some trial-and-error process in the end.<br>
Sharpening generally works by finding edges in the image (sometimes the threshold of the difference in luminescence is also configurable) and then applying a 'halo' like effect - a dark one on the darker side of the edge and lighter on the lighter. When done very subtly it almost 'magically' enhances the details, but can definitely be overdone ;)</p>



<a name="654146"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/654146" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#654146">(Oct 20 2018 at 23:57)</a>:</h4>
<p>Will hit you on PM <span class="emoji emoji-1f642" title="slight smile">:slight_smile:</span></p>



<a name="654148"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/654148" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#654148">(Oct 21 2018 at 00:00)</a>:</h4>
<p>Oh, it is also worth noting that different types of images can 'sustain' different amounts of sharpening. For example, photographs usually can take up more of it, before looking weird. A very out of focus photo or one with motion blur can take even more.</p>



<a name="654149"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/654149" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#654149">(Oct 21 2018 at 00:01)</a>:</h4>
<p>But a screenshot, being sharp by default (something that we would see often) can't take much before showing the artifacts. We should probably apply enough only to 'undo' the softening of the resize, not more.</p>



<a name="654307"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/654307" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aditya Bansal <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#654307">(Oct 22 2018 at 00:57)</a>:</h4>
<p>Just an update on this <br>
Boris and I coordinated and figured a suitable value after experimenting on nightly. Value is currently deployed on nightly if someone wanna take a look. I have a commit ready but will push it to a PR later on. (Github seems to be suffering from some issues causing inconsistencies in there branch tracking)</p>



<a name="654439"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/654439" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aditya Bansal <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#654439">(Oct 22 2018 at 17:00)</a>:</h4>
<p>PR <a href="https://github.com/zulip/zulip/pull/10704" target="_blank" title="https://github.com/zulip/zulip/pull/10704">#10704</a> <br>
<span class="user-mention" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-id="284">@Boris Yankov</span></p>



<a name="654448"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/oversharpening/near/654448" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Yankov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/oversharpening.html#654448">(Oct 22 2018 at 17:04)</a>:</h4>
<p>I confirm we tested these values on several images and they work exactly as expeced - they undo the softening that is added by the resizing, but do not add any significant artifacts (that larger values do)</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>