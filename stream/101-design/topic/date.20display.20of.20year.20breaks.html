<html>
<head><meta charset="utf-8"><title>date display of year breaks · design · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/101-design/index.html">design</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html">date display of year breaks</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1599342"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1599342" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1599342">(Jun 27 2023 at 11:51)</a>:</h4>
<p>In this screenshot there is a four year break between messages that is not super clear:</p>
<p><a href="/user_uploads/2/1d/MPllFMpFPQ6w2Q7WoaVQVcau/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/1d/MPllFMpFPQ6w2Q7WoaVQVcau/image.png" title="image.png"><img src="/user_uploads/2/1d/MPllFMpFPQ6w2Q7WoaVQVcau/image.png"></a></div>



<a name="1599343"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1599343" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1599343">(Jun 27 2023 at 11:52)</a>:</h4>
<p>The message sent by Tim on May 31 was sent this year (2023).</p>



<a name="1599344"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1599344" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1599344">(Jun 27 2023 at 11:52)</a>:</h4>
<p>See <a class="stream-topic" data-stream-id="3" href="/#narrow/stream/3-backend/topic/test-backend.20performance">#backend &gt; test-backend performance</a></p>



<a name="1599656"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1599656" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1599656">(Jun 27 2023 at 18:45)</a>:</h4>
<p>Hmm, yeah, that is a potential flaw in our current algorithm for how to display dates -- we display the date this year without a year, and that would probably feel fine for a date like "Yesterday", but I can certainly imagine someone misinterpreting that "May 31" as "May 31, 2019".</p>



<a name="1599657"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1599657" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1599657">(Jun 27 2023 at 18:46)</a>:</h4>
<p>Let me move this thread to <a class="stream" data-stream-id="101" href="/#narrow/stream/101-design">#design</a>; I think that's probably a good place to discuss it. At a technical level, we certainly could make our logic always show the year if different from that of the previous date displayed, so that this would become "May 31, 2023", but another recipient bar for the next day would still say "June 1".</p>



<a name="1599660"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1599660" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1599660">(Jun 27 2023 at 18:47)</a>:</h4>
<p>This topic was moved here from <a class="stream-topic" data-stream-id="9" href="/#narrow/stream/9-issues/topic/year.20breaks">#issues &gt; year breaks</a> by <span class="user-mention silent" data-user-id="7">Tim Abbott</span>.</p>



<a name="1637367"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1637367" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1637367">(Sep 08 2023 at 23:08)</a>:</h4>
<p>I filed <strong>Show new year in date divider</strong> <a href="https://github.com/zulip/zulip/pull/26673">#26673</a> for this. Do folks agree that we only need the year in date divider lines, not in message header bars?</p>



<a name="1637420"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1637420" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1637420">(Sep 09 2023 at 00:04)</a>:</h4>
<p>I think if we have a set of messages that's similar to the ones in the example above, but the newer messages happen to have their own message header bar instead of a date divider, it'd still be important to show the year for the same reason it's important in the date divider.</p>
<p>That situation probably isn't quite as common, because if you have an interleaved view (so that it's possible to have multiple message header bars) then it's likely to be a higher-traffic view without such long gaps, and so if there's a year boundary then it's probably more like December to January and the reader won't be confused. But in principle it totally can happen.</p>
<p>Perhaps one of the more likely ways is if there's a stream that goes unused for a year or two and then someone starts a new discussion there — then the stream narrow would fall into exactly this situation.</p>



<a name="1637858"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1637858" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1637858">(Sep 11 2023 at 00:33)</a>:</h4>
<p>Yeah, I feel pretty pretty strongly that we should show the year whenever we're displaying a date that is in a different year than the current one, at least if there's also content in the current year on the screen.</p>
<p>The clutter cost is pretty minimal -- except on January 3, almost all the dates that one looks at are in the current year. And it's very upsetting when you see "June 27" somewhere and start reasoning about the story there before discovering that actually it's "June 27, 2021".</p>
<p>To be clear, we already show the year in message header bars -- the logic is that we show the year whenever it does not match the current year -- so I think there's nothing to change in <a href="https://github.com/zulip/zulip/pull/26673">#26673</a> to achieve the desired behavior for that element.</p>



<a name="1638320"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1638320" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1638320">(Sep 11 2023 at 19:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="7">Tim Abbott</span> <a href="#narrow/stream/101-design/topic/date.20display.20of.20year.20breaks/near/1637858">said</a>:</p>
<blockquote>
<p>Yeah, I feel pretty pretty strongly that we should show the year whenever we're displaying a date that is in a different year than the current one, at least if there's also content in the current year on the screen.</p>
</blockquote>
<p>AFAIK we already do that. But this thread is about something more subtle — it's that we should show the year in certain circumstances when it is the current year, too.</p>



<a name="1640083"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1640083" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1640083">(Sep 14 2023 at 00:33)</a>:</h4>
<p>Seems reasonable to me; I updated the issue accordingly.</p>



<a name="1640104"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1640104" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1640104">(Sep 14 2023 at 01:16)</a>:</h4>
<p>Reading the current issue description:</p>
<blockquote>
<p>Show the year in date dividers if it's different from the year of the previous date displayed.<br>
Show the year in message header bars if it's different from the year of the previous date displayed.</p>
</blockquote>
<p>I think the message header bars already do this, so this would just be a change to the date dividers? Or am I missing something?</p>



<a name="1642401"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1642401" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1642401">(Sep 18 2023 at 19:07)</a>:</h4>
<p>The change is in both places to show the <em>current</em> year if it's different from the previous message.</p>



<a name="1642420"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1642420" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1642420">(Sep 18 2023 at 19:24)</a>:</h4>
<p>I see, whereas currently we display that mainly on the "previous year" side. I think that's probably pretty low-cost to do -- and I think would be a nice improvement. Sorry for the confusion -- I would have found this discussion a lot easier to follow with examples/test cases as the format.</p>
<p>Code-wise that part probably involves tweaking this interface to pass a <code>same_year(message_container, prev_message_container)</code> sort of thing down to <code>render_date</code>.</p>
<div class="codehilite"><pre><span></span><code>function update_group_date(group, message_container, prev) {
    const time = new Date(message_container.msg.timestamp * 1000);
    const today = new Date();

    // Show the date in the recipient bar if the previous message was from a different day.
    group.date_unchanged = same_day(message_container, prev);
    group.group_date_html = timerender.render_date(time, today)[0].outerHTML;
}
</code></pre></div>



<a name="1642427"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1642427" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1642427">(Sep 18 2023 at 19:27)</a>:</h4>
<p>Here are some concrete examples for today:</p>
<div class="codehilite"><pre><span></span><code>prev: Dec 31, 2021
cur: Jan 1, 2022
</code></pre></div>
<div class="codehilite"><pre><span></span><code>prev: Dec 31, 2021
cur: Jan 1                           # current year, 2023
</code></pre></div>
<div class="codehilite"><pre><span></span><code>prev: Jun 13, 2021
cur: Jul 14                        # current year, 2023
</code></pre></div>
<p>And the latter two test cases would be changed to show the 2023 just because they are coming immediately after a year change.</p>



<a name="1642428"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/date%20display%20of%20year%20breaks/near/1642428" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/date.20display.20of.20year.20breaks.html#1642428">(Sep 18 2023 at 19:28)</a>:</h4>
<p>I think it's mainly the <code>Jul 14</code> case that is confusing with the current UI and would be good to change -- because even if a user could figure out that Zulip always shows the year when it's different from the current, some other apps don't, and so a user might not feel safe in assuming that the <code>Jul 14</code> is not the same year as the previous message, even if they think about it.</p>
<p>(And of course it's also very possible for someone to just be passively confused without thinking about it)</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>