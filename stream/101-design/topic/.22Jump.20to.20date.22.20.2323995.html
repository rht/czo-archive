<html>
<head><meta charset="utf-8"><title>&quot;Jump to date&quot; #23995 · design · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/101-design/index.html">design</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html">&quot;Jump to date&quot; #23995</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1496700"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496700" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Barış <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496700">(Jan 25 2023 at 18:21)</a>:</h4>
<p>Hi, I am developing a navigate in time feature in <a href="https://github.com/zulip/zulip/issues/23995">this issue</a>. Is this date chooser(flatpickr)/ layout design ok?<br>
<a href="/user_uploads/2/7/iroTOM0SnG1lx5csvpa0Z7fO/Screenshot-from-2023-01-25-21-18-27.png">Screenshot-from-2023-01-25-21-18-27.png</a> <br>
<a href="/user_uploads/2/f4/W1Cdke-ig9Wf8r_vBS4u-0WS/Screenshot-from-2023-01-25-21-25-12.png">Screenshot-from-2023-01-25-21-25-12.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/7/iroTOM0SnG1lx5csvpa0Z7fO/Screenshot-from-2023-01-25-21-18-27.png" title="Screenshot-from-2023-01-25-21-18-27.png"><img src="/user_uploads/2/7/iroTOM0SnG1lx5csvpa0Z7fO/Screenshot-from-2023-01-25-21-18-27.png"></a></div><div class="message_inline_image"><a href="/user_uploads/2/f4/W1Cdke-ig9Wf8r_vBS4u-0WS/Screenshot-from-2023-01-25-21-25-12.png" title="Screenshot-from-2023-01-25-21-25-12.png"><img src="/user_uploads/2/f4/W1Cdke-ig9Wf8r_vBS4u-0WS/Screenshot-from-2023-01-25-21-25-12.png"></a></div>



<a name="1496755"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496755" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496755">(Jan 25 2023 at 19:37)</a>:</h4>
<p>This topic was moved here from <a class="stream-topic" data-stream-id="6" href="/#narrow/stream/6-frontend/topic/for.20.2323995">#frontend &gt; for #23995</a> by <span class="user-mention silent" data-user-id="19257">Alya Abbott</span>.</p>



<a name="1496757"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496757" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496757">(Jan 25 2023 at 19:40)</a>:</h4>
<p>Having the date/time picker be the same as for the <code>&lt;time</code> widget seems fine to me as a starting point, but I think we want a heading and probably some intro text to clarify to the user what's going on. (I'm happy to draft up the specific wording when the time comes; you can use whatever text you like for mockups.)</p>



<a name="1496758"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496758" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Barış <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496758">(Jan 25 2023 at 19:41)</a>:</h4>
<p>Ok . Where should I post my backend questions? To <a href="#narrow/stream/137-feedback/topic/time.20machine.20for.20All.20messages">url</a> provided in issue?<br>
Ok, I posted there.</p>



<a name="1496793"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496793" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniil Fadeev <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496793">(Jan 25 2023 at 20:36)</a>:</h4>
<p>Great work! I got some thoughs on this date picker. <br>
In my opinion, we don't need a confirm button and time selectors here. When we want to "jump to a date," the time is excessive. There are not usually many messages at a specific date. The confirm button is redundant because we can confirm the chosen date by clicking on it.</p>
<p><span class="user-mention" data-user-id="25694">@Barış</span> , I was wondering if it's possible to easily customize the styles of the date picker? I think the current design could use some improvement and we should discuss this with <span class="user-mention" data-user-id="22433">@Vlad Korobov</span> .</p>



<a name="1496801"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496801" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496801">(Jan 25 2023 at 20:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="25694">Barış</span> <a href="#narrow/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995/near/1496758">said</a>:</p>
<blockquote>
<p>Ok . Where should I post my backend questions? To <a href="#narrow/stream/137-feedback/topic/time.20machine.20for.20All.20messages">url</a> provided in issue?<br>
Ok, I posted there.</p>
</blockquote>
<p>If the question is purely technical, <a class="stream" data-stream-id="3" href="/#narrow/stream/3-backend">#backend</a> would be most appropriate. I moved your question there.</p>



<a name="1496805"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496805" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496805">(Jan 25 2023 at 20:42)</a>:</h4>
<blockquote>
<p>When we want to "jump to a date," the time is excessive. </p>
</blockquote>
<p>Do other folks have thoughts on whether to include the time?</p>



<a name="1496807"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496807" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496807">(Jan 25 2023 at 20:43)</a>:</h4>
<blockquote>
<p>The confirm button is redundant because we can confirm the chosen date by clicking on it.</p>
</blockquote>
<p>Mmm, I'd be inclined to leave a confirmation button, but relabel it (e.g., "Jump to date").</p>



<a name="1496808"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496808" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496808">(Jan 25 2023 at 20:44)</a>:</h4>
<blockquote>
<p>@Barış , I was wondering if it's possible to easily customize the styles of the date picker? I think the current design could use some improvement and we should discuss this with @Vlad Korobov .</p>
</blockquote>
<p>Yes, the design for the picker could definitely be improved, but I don't think it's a blocker for this work, and I believe <span class="user-mention silent" data-user-id="22433">Vlad Korobov</span> has other priorities at the moment.</p>



<a name="1496810"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496810" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496810">(Jan 25 2023 at 20:45)</a>:</h4>
<p>(Though if for some technical reason it would be very difficult to modify the visual design in the future with this library, that would be good to know.)</p>



<a name="1496947"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496947" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496947">(Jan 25 2023 at 22:35)</a>:</h4>
<p>Yeah, we should definitely just use the existing date picker module -- we'll want to replace it at some point, but that's readily an independent project, since we're already using it.</p>



<a name="1496949"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1496949" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1496949">(Jan 25 2023 at 22:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="19257">Alya Abbott</span> <a href="#narrow/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995/near/1496805">said</a>:</p>
<blockquote>
<blockquote>
<p>When we want to "jump to a date," the time is excessive. </p>
</blockquote>
<p>Do other folks have thoughts on whether to include the time?</p>
</blockquote>
<p>I think probably the time is not excessive -- if you know that there were like 1000 messages in this topic today, which is certainly possible with a particularly spirited discussion about a major outage or something, you might want to be able to go to the conversation around 2PM. And it's simple to include that option by just not hiding the UI.</p>



<a name="1497106"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1497106" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vlad Korobov <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1497106">(Jan 26 2023 at 04:16)</a>:</h4>
<p>1000 messages is easily scrollable and the case is very rare. I would suggest to remove time. I would also suggest to remove confirm button. In future it would be great to show histogram behind every date about number of messages until then is there a way to disable empty days?</p>



<a name="1497264"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1497264" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1497264">(Jan 26 2023 at 16:43)</a>:</h4>
<p>Yeah, I think including the time makes people think they <em>need</em> to enter it.  I think it'd look simpler and less cluttered to leave it off.</p>
<p>I'd ideally remove the "confirm" button and make clicking on the dates themselves do the jumping, to save a click, but that might be difficult with the current widget.</p>



<a name="1497304"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1497304" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Barış <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1497304">(Jan 26 2023 at 17:43)</a>:</h4>
<p><a href="/user_uploads/2/3f/Eiyi0ltlWHNGvbl4wbc2yM3g/Screencast-from-26-01-2023-203720.webm">Screencast-from-26-01-2023-203720.webm</a> I am using flatpckr.show_flatpickr method to show date and time. As your suggestions, I tried to disable time. After I click a random date, it closes. Why is it like that? My code:</p>
<div class="codehilite"><pre><span></span><code> function on_message_timestamp_selection(test){
        data.narrow = &quot;[{\&quot;negated\&quot;:false,\&quot;operator\&quot;:\&quot;stream\&quot;,\&quot;operand\&quot;:27},{\&quot;negated\&quot;:false,\&quot;operator\&quot;:\&quot;topic\&quot;,\&quot;operand\&quot;:\&quot;blue MOBILE has been linking slowly\&quot;}]&quot;
        data.num_after =50
        data.num_before = 50
        data.anchor = &quot;3088&quot;
        data.date = test
        debugger;
        channel.get({
            data,
            url: &quot;/json/messages&quot;,
            success(data) {
                debugger;
               console.log(data);
            },
        })
    }

    // DATE PICK

    $(&quot;body&quot;).on(&quot;click&quot;, &quot;.message_header .recipient_row_date&quot;, (e) =&gt; {
        e.stopPropagation();
        flatpickr.show_flatpickr(
            e.target,
            on_message_timestamp_selection,
            new Date(),
            {
                position: &quot;below&quot;,  // works..
            },
        );
    });

    // MESSAGE ROW DATE PICK

    $(&quot;body&quot;).on(&quot;click&quot;, &quot;.message_row .date_row&quot;, (e) =&gt; {
        e.stopPropagation();
        flatpickr.show_flatpickr(
            e.target,
            on_message_timestamp_selection,
            new Date(),
            {
                position: &quot;auto center&quot;,
                enableTime: false, // doesn&#39;t work
            },
        );
    });
</code></pre></div>



<a name="1497561"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1497561" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniil Fadeev <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1497561">(Jan 26 2023 at 21:11)</a>:</h4>
<blockquote>
<p>After I click a random date, it closes.</p>
</blockquote>
<p><span class="user-mention" data-user-id="25694">@Barış</span> , It seems to me that this is exactly the behavior that is expected. I relied on the <a href="https://flatpickr.js.org/examples/#:~:text=a%20given%20config.-,Basic,-%23">basic example</a> from the documentation in the flatpickr library.<br>
If you want to change the behavior you should look at the <code>closeOnSelect</code>option <a href="https://github.com/flatpickr/flatpickr/blob/master/src/types/options.ts#L19">here</a>. But like I mentioned before, I think that's the desired behavior.</p>



<a name="1497572"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1497572" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1497572">(Jan 26 2023 at 21:21)</a>:</h4>
<p>Well, sounds like folks are interested in trying it without a "confirm" button in any case, so we can test that out on CZO and see how it feels.</p>



<a name="1498844"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1498844" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Barış <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1498844">(Jan 29 2023 at 18:33)</a>:</h4>
<p><span class="user-mention" data-user-id="25585">@Daniil Fadeev</span> there is a mismatch between cont method parameter and argument count. process_result in message_fetch.js calls <a href="https://github.com/zulip/zulip/blob/main/static/js/message_fetch.js#L74">opts.cont()</a> with data and opts. But in <a href="https://github.com/zulip/zulip/blob/main/static/js/narrow.js#L535">narrow.js</a> , it wont handle these 2  arguments. Should I add them? I need to add data (opts can be ignored for my case) because I need to override final_select_id with the id in data (returned from server, contains messages) <a href="/user_uploads/2/48/XZlkODM_RMouiw58KOGeBUEN/Screenshot-from-2023-01-29-21-29-01.png">Screenshot-from-2023-01-29-21-29-01.png</a><br>
Edit : You can test on my <a href="https://github.com/lapaz17/zulip/tree/23995">branch</a> if you wnat.</p>
<div class="message_inline_image"><a href="/user_uploads/2/48/XZlkODM_RMouiw58KOGeBUEN/Screenshot-from-2023-01-29-21-29-01.png" title="Screenshot-from-2023-01-29-21-29-01.png"><img src="/user_uploads/2/48/XZlkODM_RMouiw58KOGeBUEN/Screenshot-from-2023-01-29-21-29-01.png"></a></div>



<a name="1498914"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1498914" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Barış <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1498914">(Jan 30 2023 at 04:11)</a>:</h4>
<p><span class="user-mention" data-user-id="25585">@Daniil Fadeev</span>  one more thing. Final version of my code is (not pushed yet): </p>
<div class="codehilite"><pre><span></span><code> message_fetch.load_messages_for_narrow({
            anchor,
            cont(data, options) {
///////////// ADDED PART
                if(anchor == &quot;date&quot;){
                    select_immediately = false;
                    id_info.final_select_id = data.messages[30].id; // instead of 30 return exact id from server to jump.
                }
//////////////////
                if (!select_immediately) {
                    update_selection({
                        id_info,
                        select_offset: then_select_offset,
                        msg_list: message_lists.current,
                    });
                }
                msg_list.network_time = new Date();
                maybe_report_narrow_time(msg_list);
            },
            msg_list,
            anchor_date,
        });
</code></pre></div>
<p>select_immediately is defined as const. It won't let me  to change it to false. So I deleted const declaration. Is there a better way to do this?</p>



<a name="1499317"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1499317" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniil Fadeev <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1499317">(Jan 30 2023 at 19:39)</a>:</h4>
<p>Hi, <span class="user-mention" data-user-id="25694">@Barış</span> . It is very difficult to immediately understand the problems you describe without examining the context. It seems to me that at this point you can do whatever you think is right and do a pool request so we can look at it in more detail.</p>
<p>If you do have questions, I suggest you write it in this form:<br>
What problem do you want to solve?<br>
How are you solving it?<br>
What problems arise in solving it?</p>
<p>It seems to me that in this format it will be easier to deal with the problem and help you solve it.</p>



<a name="1499319"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1499319" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1499319">(Jan 30 2023 at 19:42)</a>:</h4>
<p>I recommend checking out <a href="https://zulip.readthedocs.io/en/latest/contributing/asking-great-questions.html">https://zulip.readthedocs.io/en/latest/contributing/asking-great-questions.html</a>.</p>



<a name="1499350"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1499350" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniil Fadeev <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1499350">(Jan 30 2023 at 20:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="19257">Alya Abbott</span> <a href="#narrow/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995/near/1499319">сказал/а</a>:</p>
<blockquote>
<p>I recommend checking out <a href="https://zulip.readthedocs.io/en/latest/contributing/asking-great-questions.html">https://zulip.readthedocs.io/en/latest/contributing/asking-great-questions.html</a>.</p>
</blockquote>
<p>Thanks! This is the best please to start!</p>



<a name="1499589"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1499589" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Barış <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1499589">(Jan 31 2023 at 05:55)</a>:</h4>
<p><span class="user-mention" data-user-id="25585">@Daniil Fadeev</span>  looks like it's hard to comprehend activate function in narrow.js , is there any detailed discussion about it on this community?<br>
Some discussions like <a href="#narrow/stream/49-development-help/topic/near.20.20narrow.20and.20msg.20anchoring">this</a>, provides some guidance but why is not it documented on code itself<br>
 ;(</p>



<a name="1501023"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1501023" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Barış <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1501023">(Feb 01 2023 at 23:59)</a>:</h4>
<p><span class="user-mention" data-user-id="25585">@Daniil Fadeev</span>  <span class="user-mention" data-user-id="7">@Tim Abbott</span>   I have a hypothetical question. Let's say num_before and num_after are set to 50. Last message in the y stream is sent at x date . At 'x' there were 120 messages being sent back and forth. If  user selects x + 2 as a date, where should the pointer jump?<br>
a. beginning of x date (Num_before set to 120 even though was 50 at json request )<br>
b. 50 th message from the last message<br>
c . ???</p>



<a name="1501034"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1501034" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1501034">(Feb 02 2023 at 00:09)</a>:</h4>
<p><span class="user-mention" data-user-id="25694">@Barış</span> Are you asking what happens if a user picks a date that's after the last message that was sent in the relevant narrow? From a user perspective, they should end up at the end of the narrow.</p>



<a name="1501036"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1501036" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Barış <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1501036">(Feb 02 2023 at 00:13)</a>:</h4>
<p>Oh, my bad :(</p>



<a name="1501764"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1501764" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1501764">(Feb 03 2023 at 01:39)</a>:</h4>
<p>Yeah, the user almost certainly wants the messages closest to that day, if there were none on the day itself.</p>
<p>I think there is a question here as to what time within the day we use for computing the anchor. From an API perspective, probably we want the client to send a full datetime, and the server to just use that, but from a UI perspective, do we want to use noon, 9AM, 5PM, the current time of day, or something else as the default?</p>



<a name="1502244"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1502244" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1502244">(Feb 03 2023 at 22:11)</a>:</h4>
<p>Midnight at the start of the day?</p>



<a name="1502265"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1502265" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1502265">(Feb 03 2023 at 22:24)</a>:</h4>
<p>Start of the day in the user's timezone seems reasonable to me.</p>



<a name="1502413"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1502413" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1502413">(Feb 04 2023 at 01:18)</a>:</h4>
<p>So that would be that we send a timestamp to the server that is midnight starting that day in the current browser's timezone, and we make the semantics be that it finds the first message on or AFTER that timestamp you requested, if any, and otherwise the last mesasge?</p>
<p>I think that'd be pretty nice in that you'd land with the selected message box around the very first message for that day in the current view.</p>



<a name="1503071"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1503071" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Barış <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1503071">(Feb 05 2023 at 20:07)</a>:</h4>
<p>Hi everyone, I have a bakcend question. Even though I set the return type to any (as recommended <a href="https://stackoverflow.com/questions/43910979/mypy-error-incompatible-types-in-assignment">here</a>), it still complains about inner_msg_id_col. Why?<br>
Edit: I know, any is not recommended. So I will change return type, but to  understand mypy better, I had to ask this problem. <a href="/user_uploads/2/dd/-D_9iAz2xJtENaKj-y4rbRgy/Screenshot-from-2023-02-05-23-27-47.png">Screenshot-from-2023-02-05-23-27-47.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/dd/-D_9iAz2xJtENaKj-y4rbRgy/Screenshot-from-2023-02-05-23-27-47.png" title="Screenshot-from-2023-02-05-23-27-47.png"><img src="/user_uploads/2/dd/-D_9iAz2xJtENaKj-y4rbRgy/Screenshot-from-2023-02-05-23-27-47.png"></a></div>



<a name="1503165"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1503165" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1503165">(Feb 06 2023 at 00:40)</a>:</h4>
<p><span class="user-mention" data-user-id="25694">@Barış</span> the issue is that you're using the same variable with incompatible types -- one is an integer column, the other a DateTime column.</p>



<a name="1504432"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1504432" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Barış <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1504432">(Feb 07 2023 at 19:12)</a>:</h4>
<p>Hi everyone I faced a problem in  backend tests. Basically, in message_fetch.py I modified like </p>
<div class="codehilite"><pre><span></span><code>has_request_variables
def get_messages_backend(
    ...
    anchor_date: Optional[str] = REQ(&quot;anchor_date&quot;, default=None),
    ...
) -&gt; HttpResponse:
</code></pre></div>
<p>and in test_classes.py I modified:</p>
<div class="codehilite"><pre><span></span><code>def get_messages_response(
        ...
        anchor_date: Optional[str] = None,
    ) -&gt; Dict[str, List[Dict[str, Any]]]:
        post_params = {
           ...
            &quot;anchor_date&quot;: anchor_date,
         ...
        }
        result = self.client_get(&quot;/json/messages&quot;, dict(post_params))
        data = result.json()
        return data
</code></pre></div>
<p>It throws</p>
<div class="codehilite"><pre><span></span><code>File &quot;/srv/zulip-py3-venv/lib/python3.10/site-packages/django/utils/http.py&quot;, line 61, in urlencode
    raise TypeError(
TypeError: Cannot encode None for key &#39;anchor_date&#39; in a query string. Did you mean to pass an empty string or omit the value?
</code></pre></div>
<p>Should I remove optional keyword of anchor_date in get_messages_backend?  Or Should I create a new method like get_messages_response but instead of wrapping the params inside dict, manually append them (?anchor=1494639&amp;num_before=0&amp;num_after=1000&amp;client_gravatar=true&amp;anchor_date=)?  &lt;-empty anchor_date at the end.</p>



<a name="1504445"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1504445" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1504445">(Feb 07 2023 at 19:15)</a>:</h4>
<p><span class="user-mention" data-user-id="25694">@Barış</span> I think you just want <code>get_messages_response</code> to only send an <code>anchor_date</code> parameter if is not <code>None</code> -- that's what the exception is complaining about.</p>



<a name="1504793"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%22Jump%20to%20date%22%20%2323995/near/1504793" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Barış <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.22Jump.20to.20date.22.20.2323995.html#1504793">(Feb 08 2023 at 06:56)</a>:</h4>
<p>Ok, then I am going to use if else there, as you suggested</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>