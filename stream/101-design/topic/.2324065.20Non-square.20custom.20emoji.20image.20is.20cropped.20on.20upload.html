<html>
<head><meta charset="utf-8"><title>#24065 Non-square custom emoji image is cropped on upload · design · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/101-design/index.html">design</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html">#24065 Non-square custom emoji image is cropped on upload</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1495761"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1495761" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Glebs Ivanovskis <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1495761">(Jan 24 2023 at 08:24)</a>:</h4>
<p><span class="user-mention" data-user-id="19257">@Alya Abbott</span>, I am available for discussion. I will post the link to this topic in GutHub issue in a minute.</p>



<a name="1495986"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1495986" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1495986">(Jan 24 2023 at 17:11)</a>:</h4>
<p>Thanks! ,When a user uploads a non-square image to use as a custom emoji, that image gets cropped. However, as <span class="user-mention silent" data-user-id="25821">Glebs Ivanovskis</span> brought up in <a href="https://github.com/zulip/zulip/pull/24065">#24065</a>, sometimes users would strongly prefer to use the whole image (with some white space around it).</p>
<p>I was thinking the ideal solution would be to give users a cropping widget where they could select which part of the image to use. Is there a library that would let us do that without too much work?</p>



<a name="1495987"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1495987" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1495987">(Jan 24 2023 at 17:13)</a>:</h4>
<p>(It would be a nice feature for the other image upload widgets as well.)</p>



<a name="1496034"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1496034" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Palash Baderia <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1496034">(Jan 24 2023 at 18:25)</a>:</h4>
<p>I propose using the <strong>Croppie.js</strong> library to create a cropping widget in the Zulip application. Not only does it have basic cropping functionality, but it also allows for zooming in and cropping specific areas with precision. Additionally, it is compatible with jQuery and has thorough documentation, making it easy to implement and utilize. Using this library will greatly enhance the user's ability to crop images within the Zulip application.</p>
<p><strong>Github :</strong> <a href="https://github.com/Foliotek/Croppie">https://github.com/Foliotek/Croppie</a><br>
<strong>Demo:</strong> <a href="http://foliotek.github.io/Croppie/">http://foliotek.github.io/Croppie/</a></p>



<a name="1496512"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1496512" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Glebs Ivanovskis <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1496512">(Jan 25 2023 at 08:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="19257">Alya Abbott</span> <a href="#narrow/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload/near/1495986">said</a>:</p>
<blockquote>
<p>I was thinking the ideal solution would be to give users a cropping widget where they could select which part of the image to use.</p>
</blockquote>
<p>Cropping widget sounds great, but please don't forget about API users.</p>



<a name="1496655"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1496655" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1496655">(Jan 25 2023 at 17:28)</a>:</h4>
<p>Hmm, OK. By the way, anyone can edit the images to be square (e.g. by adding a background) before they upload, so you can still get the results you want even if Zulip doesn't have a feature for it.</p>



<a name="1497161"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1497161" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Glebs Ivanovskis <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1497161">(Jan 26 2023 at 08:05)</a>:</h4>
<p>Yes, this is what I will have to do if you reject the issue. :)<br>
In my use case I have almost 400 custom emojis to upload (they are pictures of road signs for traffic-rule-related discussions), this is why I am using API in the first place. Probably many of them are square enough, but there are still probably too many to fix manually. I have no previous experience of scripted image editing, so I decided to file an issue. Mainly because I'm lazy and having this feature in Zulip would save me some effort. And secondly, I believe that current behavior is wrong. Cropping image is "lossy" operation and losing user's data silently is not perfect. <a href="https://github.com/zulip/zulip/pull/6023#issuecomment-320275129">Adding white background has even been implemented</a>, but for unknown reasons was not merged.</p>



<a name="1502403"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1502403" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1502403">(Feb 04 2023 at 01:10)</a>:</h4>
<p>I think extending with a white background is problematic with the light/dark themes, but we could extend with a transparent background.</p>



<a name="1502404"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1502404" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1502404">(Feb 04 2023 at 01:11)</a>:</h4>
<p>But I'm not sure how often that would feel like it did the right thing for the user.</p>



<a name="1504862"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1504862" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Glebs Ivanovskis <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1504862">(Feb 08 2023 at 09:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="7">Tim Abbott</span> <a href="#narrow/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload/near/1502403">said</a>:</p>
<blockquote>
<p>we could extend with a transparent background.</p>
</blockquote>
<p>This would work for me.</p>



<a name="1504865"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1504865" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Glebs Ivanovskis <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1504865">(Feb 08 2023 at 09:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="7">Tim Abbott</span> <a href="#narrow/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload/near/1502404">said</a>:</p>
<blockquote>
<p>But I'm not sure how often that would feel like it did the right thing for the user.</p>
</blockquote>
<p>Would it possible to add a way for API user to select between cropping/adding background/returning an error for non-square images? This will shift the blame, because Zulip will be just doing what user says.</p>



<a name="1505436"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1505436" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1505436">(Feb 08 2023 at 20:19)</a>:</h4>
<p>I filed <strong>Allow custom cropping of profile pictures, organization logos, custom emoji at upload time</strong> <a href="https://github.com/zulip/zulip/pull/24324">#24324</a> for the custom cropping idea, in replacement of the original issue. I think if we are going to work on this problem, we should implement the solution we actually want, rather than something that only gets us half-way there.</p>



<a name="1509504"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1509504" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hardik Dharmani <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1509504">(Feb 18 2023 at 07:34)</a>:</h4>
<p>Hi! <span class="user-mention" data-user-id="19257">@Alya Abbott</span> <span class="user-mention" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-id="5140">@Aman (amanagr)</span> <br>
I have tried to solve a part of <a href="https://github.com/zulip/zulip/issues/24324">#24324</a> ( video attached).<br>
I have used cropperjs module to achieve the cropping feature that works exactly as described in <a href="https://github.com/zulip/zulip/issues/24324">#24324</a>.<br>
if you like this solution and approve of the approach then I would love to complete the issue.  <a href="/user_uploads/2/19/I2w3s_FXjPkx9vuiE-UUST28/Untitled.mp4">Untitled.mp4</a></p>



<a name="1509517"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1509517" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1509517">(Feb 18 2023 at 08:04)</a>:</h4>
<p>I suspect we want to use <a href="https://uppy.io/docs/image-editor/"><code>@uppy/image-editor</code></a> since we’re already using Uppy.</p>



<a name="1509520"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1509520" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hardik Dharmani <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1509520">(Feb 18 2023 at 08:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="699">Anders Kaseorg</span> <a href="#narrow/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload/near/1509517">said</a>:</p>
<blockquote>
<p>I suspect we want to use <a href="https://uppy.io/docs/image-editor/"><code>@uppy/image-editor</code></a> since we’re already using Uppy.</p>
</blockquote>
<p>uppy is using cropperjs(which I have used) to achieve editor feature as mentioned in <a href="https://uppy.io/docs/image-editor/">@uppy/image-editor </a> so I can easily change from cropperjs to uppy as you suggested.</p>



<a name="1509521"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1509521" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hardik Dharmani <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1509521">(Feb 18 2023 at 08:12)</a>:</h4>
<p>apart from it do you have any other suggestion/improvement in my approach/design?</p>



<a name="1509853"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1509853" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hardik Dharmani <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1509853">(Feb 19 2023 at 09:21)</a>:</h4>
<p><span class="user-mention" data-user-id="699">@Anders Kaseorg</span> I have changed my solution with uppy as you suggested.<br>
Here is the updated version: <a href="/user_uploads/2/e/qkgnHGRAVPaJgD9Gfka9pxNG/uppy-image-crop.mp4">uppy-image-crop.mp4</a> <br>
any suggestion/improvements on this new version with uppy?</p>



<a name="1509855"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1509855" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hardik Dharmani <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1509855">(Feb 19 2023 at 09:23)</a>:</h4>
<p><span class="user-mention" data-user-id="699">@Anders Kaseorg</span> thanks to your suggestions now the editor has more options like rotate, zoom, flip etc. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="1509856"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1509856" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hardik Dharmani <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1509856">(Feb 19 2023 at 09:24)</a>:</h4>
<p><span class="user-mention" data-user-id="19257">@Alya Abbott</span> <span class="user-mention" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-id="5140">@Aman (amanagr)</span> <span class="user-mention" data-user-id="699">@Anders Kaseorg</span> <br>
if you approve this I can create a PR for <a href="https://github.com/zulip/zulip/issues/24324">#24324</a>.</p>



<a name="1510499"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/%2324065%20Non-square%20custom%20emoji%20image%20is%20cropped%20on%20upload/near/1510499" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hardik Dharmani <a href="https://rht.github.io/czo-archive/stream/101-design/topic/.2324065.20Non-square.20custom.20emoji.20image.20is.20cropped.20on.20upload.html#1510499">(Feb 21 2023 at 11:35)</a>:</h4>
<p>please review this <a href="https://github.com/zulip/zulip/pull/24426">PR</a>.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>