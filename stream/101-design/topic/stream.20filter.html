<html>
<head><meta charset="utf-8"><title>stream filter · design · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/101-design/index.html">design</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html">stream filter</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="858285"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858285" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858285">(Apr 20 2020 at 16:32)</a>:</h4>
<p>I see there are some new changes in the view all stream panel. It's nice to have a filter to sort the streams. Although, can we manage the spacing here a bit? Looks a tad bit strange to me personally.<br>
<a href="/user_uploads/2/cd/csN7gfD1ahFhUo-JMlo6eSSa/image.png" title="image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/cd/csN7gfD1ahFhUo-JMlo6eSSa/image.png" title="image.png"><img src="/user_uploads/2/cd/csN7gfD1ahFhUo-JMlo6eSSa/image.png"></a></div>



<a name="858286"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858286" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858286">(Apr 20 2020 at 16:32)</a>:</h4>
<p>Or maybe float it to either left or right?</p>



<a name="858287"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858287" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858287">(Apr 20 2020 at 16:34)</a>:</h4>
<p>I'm also happy about this change!  The person that contributed is busy with non-Zulip stuff for the short term, so we'll need somebody else to run with the next iteration.  I agree that we could tweak the position/spacing of those buttons for starters.  We also eventually want to support reverse sorts, which shouldn't be terribly difficult to implement.</p>



<a name="858288"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858288" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858288">(Apr 20 2020 at 16:36)</a>:</h4>
<p>Can I pick this up for the time being if the original contributor is alright with it? At least the visual changes since they seem necessary right now.</p>



<a name="858292"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858292" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Siddharth <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858292">(Apr 20 2020 at 16:38)</a>:</h4>
<p>Also, there is a white divider b/w <code>Filter stream</code> input and stream list...it doesn't look good and make any sense there</p>



<a name="858310"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858310" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858310">(Apr 20 2020 at 16:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="13307">Vaibhav Raj Singh</span> <a href="#narrow/stream/101-design/topic/stream.20filter/near/858288" title="#narrow/stream/101-design/topic/stream.20filter/near/858288">said</a>:</p>
<blockquote>
<p>Can I pick this up for the time being if the original contributor is alright with it? At least the visual changes since they seem necessary right now.</p>
</blockquote>
<p>Yep!</p>



<a name="858311"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858311" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858311">(Apr 20 2020 at 16:48)</a>:</h4>
<p>Yeah, I think that white divider is probably a row too low?</p>



<a name="858313"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858313" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858313">(Apr 20 2020 at 16:49)</a>:</h4>
<p>Oh, not, it seems like it's in the right place, just in a color that's probably inherited from the day theme.</p>



<a name="858314"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858314" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858314">(Apr 20 2020 at 16:49)</a>:</h4>
<p>The commit <a href="https://github.com/zulip/zulip/commit/ac7ec426b0482deb61b93558e0f33539b79bb972" title="https://github.com/zulip/zulip/commit/ac7ec426b0482deb61b93558e0f33539b79bb972">https://github.com/zulip/zulip/commit/ac7ec426b0482deb61b93558e0f33539b79bb972</a> was contributed by <span class="user-mention silent" data-user-id="14879">Roland Crosby</span> , and we've already reached out, so you're good, <span class="user-mention" data-user-id="13307">@Vaibhav Raj Singh</span></p>



<a name="858538"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858538" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858538">(Apr 20 2020 at 19:23)</a>:</h4>
<p><a href="/user_uploads/2/9d/Sr4-kY8XNRg0YO27s4jgj7wG/Screenshot-from-2020-04-21-00-35-35.png" title="Screenshot-from-2020-04-21-00-35-35.png">Screenshot-from-2020-04-21-00-35-35.png</a> <br>
Just a simple right align will be alright?</p>
<div class="message_inline_image"><a href="/user_uploads/2/9d/Sr4-kY8XNRg0YO27s4jgj7wG/Screenshot-from-2020-04-21-00-35-35.png" title="Screenshot-from-2020-04-21-00-35-35.png"><img src="/user_uploads/2/9d/Sr4-kY8XNRg0YO27s4jgj7wG/Screenshot-from-2020-04-21-00-35-35.png"></a></div>



<a name="858542"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858542" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858542">(Apr 20 2020 at 19:27)</a>:</h4>
<p>That seems reasonable to me.  I'd make sure to test it out on a wide screen just to get the feel for it.</p>



<a name="858550"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858550" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858550">(Apr 20 2020 at 19:34)</a>:</h4>
<p>Also that divider. Should I change its color for dark mode?</p>



<a name="858556"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858556" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Siddharth <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858556">(Apr 20 2020 at 19:36)</a>:</h4>
<p>can the create stream <code>+</code> button have the same outline and color box as its neighbours <br>
right now hovering on it dull the color</p>



<a name="858562"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858562" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858562">(Apr 20 2020 at 19:42)</a>:</h4>
<p><span class="user-mention" data-user-id="11296">@Siddharth</span>  You mean something of this sort?<br>
<a href="user_uploads/2/1d/GCoyvbAEH2Ns_nZz8d6HiwDG/sample-button.png" title="user_uploads/2/1d/GCoyvbAEH2Ns_nZz8d6HiwDG/sample-button.png">sample-button.png</a></p>
<div class="message_inline_image"><a href="user_uploads/2/1d/GCoyvbAEH2Ns_nZz8d6HiwDG/sample-button.png" title="sample-button.png"><img src="user_uploads/2/1d/GCoyvbAEH2Ns_nZz8d6HiwDG/sample-button.png"></a></div>



<a name="858564"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858564" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Siddharth <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858564">(Apr 20 2020 at 19:43)</a>:</h4>
<p>yeah exactly<br>
it fits with the design of other buttons</p>



<a name="858663"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858663" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858663">(Apr 20 2020 at 21:39)</a>:</h4>
<p><span class="user-mention" data-user-id="58">@Steve Howell</span> I made <a href="https://github.com/zulip/zulip/pull/14670" title="https://github.com/zulip/zulip/pull/14670">#14670</a> for this. Added a small conditional since the CSS for this is limited to just this small div. However, the tests are failing due to loss in code coverage. Should I add a test for such a minor change?</p>



<a name="858687"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858687" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858687">(Apr 20 2020 at 22:02)</a>:</h4>
<p>We should add the test coverage there, although the need for tests here is making me wonder about this code (which is one of the functions of having tests).</p>



<a name="858689"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858689" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858689">(Apr 20 2020 at 22:04)</a>:</h4>
<p>It seems like the switcher class should generally generate very vanilla HTML, and the <code>align</code> option feels like it's kind of overly specific.</p>



<a name="858691"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858691" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858691">(Apr 20 2020 at 22:07)</a>:</h4>
<p>Maybe we just allow every toggle component (so far, we only four) to pass in something like <code>opts.html_class</code>?  And then that class can be styled however we want in CSS?  Or we could just put it inside a container that gets aligned--that's another option.</p>



<a name="858692"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858692" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858692">(Apr 20 2020 at 22:08)</a>:</h4>
<p><span class="user-mention" data-user-id="13307">@Vaibhav Raj Singh</span> I assume these are the lines missing coverage?</p>
<div class="codehilite"><pre><span></span><code>        <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">align</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// add a check inside passed arguments in case some extra</span>
            <span class="c1">// classes need to be added for correct alignment or other purposes</span>
            <span class="nx">_component</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;align-tab&quot;</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div>



<a name="858727"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858727" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858727">(Apr 20 2020 at 22:38)</a>:</h4>
<p>Yeah, I like the idea of supporting a generic HTML class here.</p>



<a name="858740"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858740" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858740">(Apr 20 2020 at 22:49)</a>:</h4>
<p>Let's go with <code>opts.html_class</code> then, and I think it's fine if it's optional, since we haven't needed it for the other togglers.  We should keep 100% coverage here--I think it should be mostly straightforward to test this in a nice way, and <span class="user-mention" data-user-id="1406">@Rohitt Vashishtha</span> and I are good resources on the node tests.</p>



<a name="858745"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858745" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858745">(Apr 20 2020 at 22:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="58">Steve Howell</span> <a href="#narrow/stream/101-design/topic/stream.20filter/near/858692" title="#narrow/stream/101-design/topic/stream.20filter/near/858692">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="13307">Vaibhav Raj Singh</span> I assume these are the lines missing coverage?</p>
</blockquote>
<p>Yea these are the ones. Re: <code>opts.html_class</code> any extra classes to be added can be then added through this, right? I'll make the changes then.</p>



<a name="858776"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858776" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858776">(Apr 20 2020 at 23:04)</a>:</h4>
<p>I can't see any reason why you'd ever need more than one class, the way that we generally organize our CSS.</p>



<a name="858777"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858777" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858777">(Apr 20 2020 at 23:05)</a>:</h4>
<p>Like, here, I'd call the class something like <code>stream_sorter_toggle</code>, and then just have the CSS use that class to specify the alignment stuff.</p>



<a name="858800"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858800" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858800">(Apr 20 2020 at 23:53)</a>:</h4>
<p>Updated the PR for <code>html_class</code>( <a href="https://github.com/zulip/zulip/pull/14670" title="https://github.com/zulip/zulip/pull/14670">#14670</a>). Will work on adding required tests now.</p>



<a name="858808"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858808" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858808">(Apr 20 2020 at 23:58)</a>:</h4>
<p>For the tests, should I begin with adding another case in here? -</p>
<div class="codehilite"><pre><span></span><code> <span class="k">switch</span> <span class="p">(</span><span class="nx">sel</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s2">&quot;&lt;div class=&#39;tab-switcher&#39;&gt;&lt;/div&gt;&quot;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">switcher</span><span class="p">;</span>
        <span class="k">case</span> <span class="s2">&quot;&lt;div class=&#39;ind-tab&#39; data-tab-key=&#39;keyboard-shortcuts&#39; data-tab-id=&#39;0&#39; tabindex=&#39;0&#39;&gt;translated: Keyboard shortcuts&lt;/div&gt;&quot;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">make_tab</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="k">case</span> <span class="s2">&quot;&lt;div class=&#39;ind-tab&#39; data-tab-key=&#39;message-formatting&#39; data-tab-id=&#39;1&#39; tabindex=&#39;0&#39;&gt;translated: Message formatting&lt;/div&gt;&quot;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">make_tab</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">case</span> <span class="s2">&quot;&lt;div class=&#39;ind-tab&#39; data-tab-key=&#39;search-operators&#39; data-tab-id=&#39;2&#39; tabindex=&#39;0&#39;&gt;translated: Search operators&lt;/div&gt;&quot;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">make_tab</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">throw</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;unknown selector: &#39;</span> <span class="o">+</span> <span class="nx">sel</span><span class="p">);</span>
</code></pre></div>



<a name="858868"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858868" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858868">(Apr 21 2020 at 00:30)</a>:</h4>
<p>Yeah, I think you can just modify the first <code>case</code> there as well as the call to <code>components.toggle</code> in that test.</p>



<a name="858871"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858871" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858871">(Apr 21 2020 at 00:36)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> I wonder if we should just make this code build its HTML with a template.  Here's the original commit for the toggle component: <a href="https://github.com/zulip/zulip/commit/75db0367333261704f4615b7bee8fcc03979996c" title="https://github.com/zulip/zulip/commit/75db0367333261704f4615b7bee8fcc03979996c">75db0367333261704f4615b7bee8fcc03979996c</a></p>



<a name="858872"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858872" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858872">(Apr 21 2020 at 00:37)</a>:</h4>
<p>I'm generally a fan of using templates rather than HTML generated with JS for everything.</p>



<a name="858873"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858873" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858873">(Apr 21 2020 at 00:37)</a>:</h4>
<p>The code has not evolved a ton since the original commit:</p>
<div class="codehilite"><pre><span></span><code> 14     const component = (function render_component(opts) {
 15         const _component = $(&quot;&lt;div class=&#39;tab-switcher&#39;&gt;&lt;/div&gt;&quot;);
 16         opts.values.forEach(function (value, i) {
 17             // create a tab with a tab-id so they don&#39;t have to be referenced
 18             // by text value which can be inconsistent.
 19             const tab = $(&quot;&lt;div class=&#39;ind-tab&#39; data-tab-key=&#39;&quot; + value.key + &quot;&#39; data-tab-id=&#39;&quot; + i + &quot;&#39; tabindex=&#39;0&#39;&gt;&quot; + value.la    bel + &quot;&lt;/div&gt;&quot;);
 20
 21             // add proper classes for styling in CSS.
 22             if (i === 0) {
 23                 // this should be default selected unless otherwise specified.
 24                 tab.addClass(&quot;first selected&quot;);
 25             } else if (i === opts.values.length - 1) {
 26                 tab.addClass(&quot;last&quot;);
 27             } else {
 28                 tab.addClass(&quot;middle&quot;);
 29             }
 30             _component.append(tab);
 31         });
 32         return _component;
 33     }(opts));
</code></pre></div>



<a name="858874"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858874" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858874">(Apr 21 2020 at 00:37)</a>:</h4>
<p>So yeah, I'd be in favor of doing that here.</p>



<a name="858875"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858875" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858875">(Apr 21 2020 at 00:41)</a>:</h4>
<p>If this were actually using the power of JS in some meaningful way, that would be nice, but it's really not doing anything special here.</p>



<a name="858876"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858876" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rohitt Vashishtha <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858876">(Apr 21 2020 at 00:43)</a>:</h4>
<p><span class="user-mention" data-user-id="58">@Steve Howell</span> if you are working on it now, I'd be happy to help review/test this.</p>
<p>Otherwise I could take a quick stab at this (and related testing) in a few hours.</p>



<a name="858877"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858877" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858877">(Apr 21 2020 at 00:43)</a>:</h4>
<p>I'm not really working on it.</p>



<a name="858878"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858878" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858878">(Apr 21 2020 at 00:45)</a>:</h4>
<p>I don't think it's urgent to convert this to a template, was just kinda wondering.</p>



<a name="858879"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/858879" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#858879">(Apr 21 2020 at 00:48)</a>:</h4>
<p>Somewhat related--it would be nice to get keyboard support (i.e. tabs and arrows) working for these widgets:</p>
<p><a href="/user_uploads/2/20/LMlVgXmr_FHSX-eXl9r9yOTl/image.png" title="image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/20/LMlVgXmr_FHSX-eXl9r9yOTl/image.png" title="image.png"><img src="/user_uploads/2/20/LMlVgXmr_FHSX-eXl9r9yOTl/image.png"></a></div>



<a name="859482"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859482" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859482">(Apr 21 2020 at 19:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="58">Steve Howell</span> <a href="#narrow/stream/101-design/topic/stream.20filter/near/858868" title="#narrow/stream/101-design/topic/stream.20filter/near/858868">said</a>:</p>
<blockquote>
<p>Yeah, I think you can just modify the first <code>case</code> there as well as the call to <code>components.toggle</code> in that test.</p>
</blockquote>
<p><span class="user-mention" data-user-id="58">@Steve Howell</span>  Should I add those tests or are we taking the templates approach for it?</p>



<a name="859507"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859507" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859507">(Apr 21 2020 at 20:18)</a>:</h4>
<p><span class="user-mention" data-user-id="13307">@Vaibhav Raj Singh</span> Just modify the tests for now.  Hopefully the tests are just like a three-line change.</p>



<a name="859664"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859664" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859664">(Apr 21 2020 at 21:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="13307">Vaibhav Raj Singh</span> <a href="#narrow/stream/101-design/topic/stream.20filter/near/858808" title="#narrow/stream/101-design/topic/stream.20filter/near/858808">said</a>:</p>
<blockquote>
<p>For the tests, should I begin with adding another case in here? -</p>
<div class="codehilite"><pre><span></span><code> <span class="k">switch</span> <span class="p">(</span><span class="nx">sel</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s2">&quot;&lt;div class=&#39;tab-switcher&#39;&gt;&lt;/div&gt;&quot;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">switcher</span><span class="p">;</span>
        <span class="k">case</span> <span class="s2">&quot;&lt;div class=&#39;ind-tab&#39; data-tab-key=&#39;keyboard-shortcuts&#39; data-tab-id=&#39;0&#39; tabindex=&#39;0&#39;&gt;translated: Keyboard shortcuts&lt;/div&gt;&quot;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">make_tab</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="k">case</span> <span class="s2">&quot;&lt;div class=&#39;ind-tab&#39; data-tab-key=&#39;message-formatting&#39; data-tab-id=&#39;1&#39; tabindex=&#39;0&#39;&gt;translated: Message formatting&lt;/div&gt;&quot;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">make_tab</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">case</span> <span class="s2">&quot;&lt;div class=&#39;ind-tab&#39; data-tab-key=&#39;search-operators&#39; data-tab-id=&#39;2&#39; tabindex=&#39;0&#39;&gt;translated: Search operators&lt;/div&gt;&quot;</span><span class="o">:</span>
            <span class="k">return</span> <span class="nx">make_tab</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">throw</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;unknown selector: &#39;</span> <span class="o">+</span> <span class="nx">sel</span><span class="p">);</span>
</code></pre></div>


</blockquote>
<p>The tests here (and in most parts of file) are meant entirely for the <code>keyboard-shortcuts</code>, <code>message-formatting</code> and <code>search-operators</code>. All of these don't have the criteria for additional class through <code>html_class</code>. How should I test the presence of  the additional <code>html_class</code>?</p>



<a name="859666"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859666" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859666">(Apr 21 2020 at 21:48)</a>:</h4>
<p>I have to add coverage for this specific line:</p>
<div class="codehilite"><pre><span></span><code>_component.addClass(opts.html_class);
</code></pre></div>



<a name="859668"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859668" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859668">(Apr 21 2020 at 21:57)</a>:</h4>
<p>It’s fine to just add a class in the test.</p>



<a name="859669"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859669" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859669">(Apr 21 2020 at 21:58)</a>:</h4>
<p>The test is just to make sure the component works in a generic sense.</p>



<a name="859695"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859695" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859695">(Apr 21 2020 at 22:19)</a>:</h4>
<p>I'm getting a strange error:</p>
<div class="codehilite"><pre><span></span><code>TypeError: _component.addClass is not a function
</code></pre></div>


<p><code>_component </code>is defined as an element just before this <code>const _component = $("&lt;div class='tab-switcher'&gt;&lt;/div&gt;");</code>.  It's a function and is working since the class is being added as seen in frontend.</p>



<a name="859697"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859697" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859697">(Apr 21 2020 at 22:20)</a>:</h4>
<p>I think you need to add an <code>addClass</code> to the <code>switcher</code> stub.</p>



<a name="859701"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859701" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859701">(Apr 21 2020 at 22:24)</a>:</h4>
<p>Here's the "real" code:</p>
<div class="codehilite"><pre><span></span><code>        const _component = $(&quot;&lt;div class=&#39;tab-switcher&#39;&gt;&lt;/div&gt;&quot;);
        if (opts.html_class) {
            // add a check inside passed arguments in case some extra
            // classes need to be added for correct alignment or other purposes
            _component.addClass(opts.html_class);
        }
</code></pre></div>



<a name="859702"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859702" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859702">(Apr 21 2020 at 22:24)</a>:</h4>
<p>And when you run the tests, note what <code>_component</code> becomes due to the <code>$</code> stub here:</p>
<div class="codehilite"><pre><span></span><code><span class="mi">104</span>     <span class="nx">set_global</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">sel</span><span class="p">)</span> <span class="p">{</span>
<span class="p">[...]</span>
<span class="mi">110</span>         <span class="k">switch</span> <span class="p">(</span><span class="nx">sel</span><span class="p">)</span> <span class="p">{</span>
<span class="mi">111</span>         <span class="k">case</span> <span class="s2">&quot;&lt;div class=&#39;tab-switcher&#39;&gt;&lt;/div&gt;&quot;</span><span class="o">:</span>
<span class="mi">112</span>             <span class="k">return</span> <span class="nx">switcher</span><span class="p">;</span>
</code></pre></div>



<a name="859703"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859703" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859703">(Apr 21 2020 at 22:26)</a>:</h4>
<p>So you want something like this inside the code that builds <code>switcher</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">self</span><span class="p">.</span><span class="nx">addClass</span> <span class="o">=</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">class_added</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="s1">&#39;some_class&#39;</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>



<a name="859705"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859705" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859705">(Apr 21 2020 at 22:27)</a>:</h4>
<p>And after you build the widget, make sure the class was actually added with <code>assert(class_added)</code>.</p>



<a name="859706"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859706" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859706">(Apr 21 2020 at 22:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="58">Steve Howell</span> <a href="#narrow/stream/101-design/topic/stream.20filter/near/859702" title="#narrow/stream/101-design/topic/stream.20filter/near/859702">said</a>:</p>
<blockquote>
<p>And when you run the tests, note what <code>_component</code> becomes due to the <code>$</code> stub here:</p>
</blockquote>
<p>I didn't realise this point. Will add <code>.addClass</code> to switcher .</p>



<a name="859707"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859707" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859707">(Apr 21 2020 at 22:35)</a>:</h4>
<p>How about </p>
<div class="codehilite"><pre><span></span><code>self.addClass = function (c) {
            self.class += &#39; &#39; + c;
        }
</code></pre></div>


<p>Since the class is being added explicitly here, would an extra check be still required? (Ran the tests and code coverage is recovered now)</p>



<a name="859708"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859708" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859708">(Apr 21 2020 at 22:39)</a>:</h4>
<p>We want to verify that the class is actually added properly; otherwise, it's kind of a weak test.</p>



<a name="859709"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859709" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859709">(Apr 21 2020 at 22:39)</a>:</h4>
<p>For example, if the test still passes if you remove <code>self.class += ' ' + c</code>, then that line of code is kind of pointless, right?</p>



<a name="859711"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859711" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859711">(Apr 21 2020 at 22:40)</a>:</h4>
<p>I do think my original proposal was clumsy, though.</p>



<a name="859712"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859712" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859712">(Apr 21 2020 at 22:40)</a>:</h4>
<p>Consider modelling that with <code>classList</code> instead of <code>class</code>.</p>



<a name="859713"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859713" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859713">(Apr 21 2020 at 22:41)</a>:</h4>
<p>Maybe...</p>
<div class="codehilite"><pre><span></span><code><span class="nx">self</span><span class="p">.</span><span class="nx">addClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">self</span><span class="p">.</span><span class="nx">added_class</span><span class="o">=</span> <span class="nx">c</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// build widget with class=&#39;whatever&#39;</span>

<span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">switcher</span><span class="p">.</span><span class="nx">added_class</span><span class="p">,</span> <span class="s1">&#39;whatever&#39;</span><span class="p">);</span>
</code></pre></div>



<a name="859714"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859714" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859714">(Apr 21 2020 at 22:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="699">Anders Kaseorg</span> <a href="#narrow/stream/101-design/topic/stream.20filter/near/859712" title="#narrow/stream/101-design/topic/stream.20filter/near/859712">said</a>:</p>
<blockquote>
<p>Consider modelling that with <code>classList</code> instead of <code>class</code>.</p>
</blockquote>
<p>yeah, <code>self.classList.push(class)</code></p>



<a name="859718"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859718" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859718">(Apr 21 2020 at 22:45)</a>:</h4>
<p><code>self.classList.push(c)</code> gives this error:</p>
<div class="codehilite"><pre><span></span><code>TypeError: Cannot read property &#39;push&#39; of undefined
</code></pre></div>



<a name="859720"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859720" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859720">(Apr 21 2020 at 22:46)</a>:</h4>
<p>I guess it should be <code>classList.add</code> instead of push.</p>



<a name="859722"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859722" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859722">(Apr 21 2020 at 22:49)</a>:</h4>
<p>Yeah it acts more like a <code>Set</code> than an <code>Array</code>. But right now the mocked version doesn’t exist at all.</p>



<a name="859723"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859723" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859723">(Apr 21 2020 at 22:49)</a>:</h4>
<p><code>self.classList</code> seems to be undefined inside the stub.</p>



<a name="859724"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859724" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859724">(Apr 21 2020 at 22:52)</a>:</h4>
<p>There’s maybe a larger conversation to be had about whether we should be using real jQuery and JSDOM for more of these mocking tasks (but we don’t need to have it now).</p>



<a name="859725"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859725" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859725">(Apr 21 2020 at 22:53)</a>:</h4>
<p>I think you just need to say <code>self.classList = []</code> in the stub.</p>



<a name="859726"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859726" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859726">(Apr 21 2020 at 22:54)</a>:</h4>
<p><code>new Set()</code>.</p>



<a name="859735"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859735" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859735">(Apr 21 2020 at 23:02)</a>:</h4>
<p>Updated <a href="https://github.com/zulip/zulip/pull/14670" title="https://github.com/zulip/zulip/pull/14670">#14670</a> . Thanks for the help!</p>



<a name="859753"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859753" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859753">(Apr 21 2020 at 23:13)</a>:</h4>
<p><span class="user-mention" data-user-id="13307">@Vaibhav Raj Singh</span> I don't think this is quite the idea:</p>
<div class="codehilite"><pre><span></span><code>        self.addClass = function (c) {
            self.classList = new Set();
            self.classList.add(c);
            self.addedClass = c;
        }
</code></pre></div>



<a name="859754"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859754" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859754">(Apr 21 2020 at 23:14)</a>:</h4>
<p>The idea behind using a <code>Set</code> is to validate that the set of classes that your code adds matches the set of classes that you expect.</p>



<a name="859756"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859756" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859756">(Apr 21 2020 at 23:14)</a>:</h4>
<p>So you'd want to initialize the set outside of <code>addClass</code>, and probably call it <code>classSet</code> or <code>classes</code>.</p>



<a name="859761"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859761" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859761">(Apr 21 2020 at 23:19)</a>:</h4>
<p><code>classList</code> is a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/classList" title="https://developer.mozilla.org/en-US/docs/Web/API/Element/classList">real thing</a>.</p>



<a name="859762"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859762" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859762">(Apr 21 2020 at 23:20)</a>:</h4>
<p>As in I need to just  initialize <code>self.classList = new Set()</code> in the stub, outside <code>self.addClass</code>?</p>



<a name="859774"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859774" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859774">(Apr 21 2020 at 23:31)</a>:</h4>
<p>yep</p>



<a name="859794"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859794" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859794">(Apr 21 2020 at 23:57)</a>:</h4>
<p><a href="https://github.com/zulip/zulip/pull/14670" title="https://github.com/zulip/zulip/pull/14670">#14670</a> is ready for a review.</p>



<a name="859820"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859820" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859820">(Apr 22 2020 at 00:14)</a>:</h4>
<p>If we're gonna have <code>classList</code>, we should assert that it's being populated correctly, and then we won't need <code>addedClass</code>.</p>
<div class="codehilite"><pre><span></span><code>        <span class="nx">self</span><span class="p">.</span><span class="nx">addClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">addedClass</span> <span class="o">=</span> <span class="nx">c</span><span class="p">;</span>
        <span class="p">};</span>
</code></pre></div>



<a name="859821"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859821" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859821">(Apr 22 2020 at 00:15)</a>:</h4>
<p>It might help to step back and think about the big picture.</p>



<a name="859823"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859823" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859823">(Apr 22 2020 at 00:15)</a>:</h4>
<p>You've added code to the widget such that when it creates the main component, it will add a class to the list of classes for that component, via jQuery.</p>



<a name="859829"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859829" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859829">(Apr 22 2020 at 00:16)</a>:</h4>
<p>So you want the test to basically assert that <code>switcher.classList</code> really is equal to a set containing the element <code>'stream_sorter_toggle'</code>.</p>



<a name="859831"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859831" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859831">(Apr 22 2020 at 00:17)</a>:</h4>
<p>And then you can kind of work back from that assertion to figure out the stubbing.</p>



<a name="859867"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/stream%20filter/near/859867" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Raj Singh <a href="https://rht.github.io/czo-archive/stream/101-design/topic/stream.20filter.html#859867">(Apr 22 2020 at 01:00)</a>:</h4>
<p>Will remember this nice approach <span aria-label="raised hands" class="emoji emoji-1f64c" role="img" title="raised hands">:raised_hands:</span></p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>