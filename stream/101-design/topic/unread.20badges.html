<html>
<head><meta charset="utf-8"><title>unread badges · design · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/101-design/index.html">design</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html">unread badges</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="670895"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/670895" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#670895">(Dec 12 2018 at 11:01)</a>:</h4>
<p>There is something wrong  with unread counts.<br>
It seems that clicking some parts of the interface will clean up all unread messages notifications, making users missing them.<br>
Some things I found that trigger the issue is going to All messages and scroll, or Private messages and scroll.<br>
So, say user has multiple unread messages under Private messages, but the PM is collapsed. User opens the PM to see the unread messages, scroll or clicks and all the unread badges are gone.</p>



<a name="670897"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/670897" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex-CL <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#670897">(Dec 12 2018 at 11:57)</a>:</h4>
<p>clicking a Stream makes the Count disappear.  It would be better if it stayed, and showed which topic actually had unread messages.</p>



<a name="670900"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/670900" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#670900">(Dec 12 2018 at 12:06)</a>:</h4>
<p>Problem here is that it cleans all unread badges, not only the ones that were clicked.</p>



<a name="670901"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/670901" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex-CL <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#670901">(Dec 12 2018 at 12:08)</a>:</h4>
<p>What are the steps to reproduce this?</p>



<a name="670902"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/670902" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#670902">(Dec 12 2018 at 12:14)</a>:</h4>
<p>I'm trying to figure it out.<br>
But I guess that if I click "Private Messages", all badges below it will get cleaned.</p>



<a name="670903"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/670903" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#670903">(Dec 12 2018 at 12:15)</a>:</h4>
<p>Say two users PM me and Private Messages is collapsed.<br>
I have to open it to see who PM me, and if I click the badges get cleaned.</p>



<a name="670912"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/670912" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#670912">(Dec 12 2018 at 12:26)</a>:</h4>
<p>also seems to me that if I have more than one user that PM me, when I click the first user the other badges are removed as well, even when I did not read their messages</p>



<a name="670913"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/670913" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#670913">(Dec 12 2018 at 12:28)</a>:</h4>
<p>to sum up</p>
<ul>
<li>expanding "Private Messages" should not mark all messages as read.</li>
<li>reading a Private Message from one user should not mark other users messages as read</li>
</ul>



<a name="671028"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/671028" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#671028">(Dec 12 2018 at 17:32)</a>:</h4>
<p>I think there's some confusion about how this works.  <a href="https://zulip.readthedocs.io/en/latest/subsystems/pointer.html#unread-count-logic" target="_blank" title="https://zulip.readthedocs.io/en/latest/subsystems/pointer.html#unread-count-logic">https://zulip.readthedocs.io/en/latest/subsystems/pointer.html#unread-count-logic</a> explains the precise algorithm -- we'll only mark everything in the stream as read when you visit if there's only a few messages in the stream and you can see the bottom.</p>



<a name="671050"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/671050" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#671050">(Dec 12 2018 at 18:15)</a>:</h4>
<p>Some thoughts:</p>
<ul>
<li>The fact that we mark messages as read when you click into an interleaved view is bad UX, and is something on our priority list to change. It turns out to be a somewhat complex change technically, which is why it hasn't happened yet. </li>
<li>The algorithm is essentially: we mark 1 message as read if there are a lot of messages, and all messages as read if you can see all the messages on your screen. </li>
<li>One workaround is to use the <code>n</code> keyboard shortcut to navigate (and <code>p</code> for private messages), since that takes you topic by topic</li>
</ul>



<a name="671051"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/671051" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#671051">(Dec 12 2018 at 18:16)</a>:</h4>
<ul>
<li>You can tell which messages are being marked as read by looking at the left edge of the message (this is pretty helpful for figuring out what our "mark as read" algorithm is doing)</li>
</ul>



<a name="671056"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/671056" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#671056">(Dec 12 2018 at 18:22)</a>:</h4>
<p>as a workaround, couldn't you add a flag to "search" when clicking "All messages" or "Private Messages" that would say "search this, but don't mark as read". <br>
Something like <em>is:private markasread:false</em></p>



<a name="677514"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/677514" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Neil Pilgrim (neiljp) <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#677514">(Dec 31 2018 at 19:54)</a>:</h4>
<p><span class="user-mention" data-user-id="131">@Rishi Gupta</span> Is this in the frontend or backend?</p>



<a name="677568"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/677568" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#677568">(Jan 01 2019 at 13:39)</a>:</h4>
<p>I think you mean this?</p>
<blockquote>
<p>The fact that we mark messages as read when you click into an interleaved view is bad UX, and is something on our priority list to change. </p>
</blockquote>
<p>I think the current plan involves both a backend and frontend change. The main backend change is to add a "fake" message at the top of stream narrows, so that there's a default place for the blue box to go in a totally-unread stream narrow.</p>
<p>Though Tim is probably the right person to ask for details, since now that I write this it seems like the initial hello message would fit that bill :). So potentially it's a frontend-only change, which is to restyle the initial hello message and automatically mark it as read.</p>



<a name="677681"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/677681" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#677681">(Jan 02 2019 at 05:16)</a>:</h4>
<p><span class="user-mention" data-user-id="131">@Rishi Gupta</span> the initial "hello" message doesn't suffice, because e.g. topic narrows might have 0 messages.</p>



<a name="677765"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/677765" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#677765">(Jan 02 2019 at 13:06)</a>:</h4>
<p>hm. ok, maybe we should talk about this more at some point.</p>



<a name="677822"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/677822" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#677822">(Jan 02 2019 at 17:08)</a>:</h4>
<p>So, the design I had in mind is changing the <code>selected_message</code> logic to support selecting the top-of-feed Z block (eventually to become a notification) (with effectively message ID -1, which is the guard value we use for no selected message anyway if I'm remembering correctly), and to change our logic for navigation to allow walking onto that message object in the case that the message feed is caught up on top.</p>



<a name="677827"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/677827" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Neil Pilgrim (neiljp) <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#677827">(Jan 02 2019 at 17:27)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> So this would mean there is always a 'valid' place to put a stream/PM/search cursor, from the UI code perspective? So the backend wouldn't need to change for this?</p>



<a name="677847"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/677847" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#677847">(Jan 02 2019 at 18:00)</a>:</h4>
<p>Exactly.</p>



<a name="677848"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/677848" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#677848">(Jan 02 2019 at 18:00)</a>:</h4>
<p>Well, the backend would change to replace <code>use_first_unread</code> with <code>use_last_read</code>, or something, but that's relatively minoir.</p>



<a name="720423"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/720423" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#720423">(Mar 17 2019 at 22:51)</a>:</h4>
<p>This is something I keep hearing from my users, and that also makes me stress.<br>
Every time I see a unread badge &gt; 1 I know I will have a hard time following up on all messages, because it is hard to get all context from the "Private Message" root node.<br>
And then I no longer have the unread badge to show me what users PM me.</p>



<a name="720431"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/720431" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#720431">(Mar 18 2019 at 01:43)</a>:</h4>
<p><span class="user-mention" data-user-id="10530">@Ricardo Duarte</span> completely agree, and something we're currently working on. A workaround in the meantime is to use the keyboard shortcut <code>p</code>, which does the right thing</p>



<a name="720432"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/unread%20badges/near/720432" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/101-design/topic/unread.20badges.html#720432">(Mar 18 2019 at 01:44)</a>:</h4>
<p>(and <code>n</code>, for the corresponding problem on streams)</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>