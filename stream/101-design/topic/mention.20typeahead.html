<html>
<head><meta charset="utf-8"><title>mention typeahead · design · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/101-design/index.html">design</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html">mention typeahead</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1234295"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234295" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234295">(Jul 19 2021 at 18:03)</a>:</h4>
<p>So, a few weeks ago, in <a href="https://github.com/zulip/zulip/commit/11c37bca8f8b9ee4942567903b45ac7b908f9c4c">11c37bca8f8b9ee4942567903b45ac7b908f9c4c</a>, we changed things to have the mention typeahead open without typing any characters.  A quirk of that implementation is that if you haven't typed any characters, the wildcard mentions appear at the top:</p>
<p><a href="/user_uploads/2/58/Do5RvdWmltkNzxnRwyFhW4NA/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/2/58/Do5RvdWmltkNzxnRwyFhW4NA/image.png" title="image.png"><img src="/user_uploads/2/58/Do5RvdWmltkNzxnRwyFhW4NA/image.png"></a></div><p><span class="user-mention" data-user-id="17026">@Akshat (akshatdalton)</span> <span class="user-mention" data-user-id="1406">@Rohitt Vashishtha</span> FYI as folks who may have ideas here.</p>



<a name="1234297"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234297" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234297">(Jul 19 2021 at 18:04)</a>:</h4>
<p>I feel like we definitely want the actual people who've participated in a conversation to be the top options, so that <code>@+Enter</code> is reasonably likely to mention the last other person to post in the current topic.</p>



<a name="1234300"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234300" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234300">(Jul 19 2021 at 18:05)</a>:</h4>
<p>I think probably the right answer is to just adjust the general sort order to make wildcard mentions sorted similarly to user groups, which clearly aren't appearing on top just because they exist?</p>



<a name="1234454"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234454" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234454">(Jul 19 2021 at 19:09)</a>:</h4>
<p>Yeah, I agree that we don't want the wildcard mentions at the top. What does "similarly to user groups" imply? What's the best way to learn about our sort algorithm?</p>



<a name="1234456"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234456" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234456">(Jul 19 2021 at 19:09)</a>:</h4>
<p>As a side point, if anyone wants to redo the icon for wildcard mentions, I feel like it could be prettier. :)</p>



<a name="1234459"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234459" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234459">(Jul 19 2021 at 19:10)</a>:</h4>
<p>The sorting algorithm is complicated, but basically it prefers users who have participated in the topic, stream, and organization (or in PMs with you) over other users, but also prefers exact and prefix matches, and I don't recall how those are ordered with respect to each other.</p>



<a name="1234461"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234461" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234461">(Jul 19 2021 at 19:11)</a>:</h4>
<p>But my theory here is that we seem to be doing something reasonable for user groups, so we should just make the wildcard mentions sort however user groups do.</p>



<a name="1234470"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234470" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234470">(Jul 19 2021 at 19:21)</a>:</h4>
<p>Wildcard mentions appear on top. The reason can be found <a href="https://github.com/zulip/zulip/blob/b23fd2f1f3dedbc2591e94531b065c0fe57847a8/static/js/typeahead_helper.js#L173-L217">here</a> which says:</p>
<div class="codehilite"><pre><span></span><code>give preference to &quot;all&quot;, &quot;everyone&quot; or &quot;stream&quot;
We use is_broadcast for a quick check.  It will
true for all/everyone/stream and undefined (falsy)
for actual people.
</code></pre></div>
<p>The reason why user groups don't usually appear on top (in large streams) is because in our final list object we first concatenate active users in that stream/topic and then we concatenate user groups. User groups are usually not concatenated because of <a href="https://github.com/zulip/zulip/blob/b23fd2f1f3dedbc2591e94531b065c0fe57847a8/static/js/typeahead_helper.js#L316-L330">this logic</a> - we stop concatenation as soon as we reach the <code>max_num_items</code> limit, so probably this is the reason why user groups don't appear on top when we type <code>@</code>.</p>



<a name="1234477"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234477" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Neil Pilgrim (neiljp) <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234477">(Jul 19 2021 at 19:28)</a>:</h4>
<p>I don't recall if there was a web app conclusion on this since I think the behavior was different at the time, but ZT treats <code>@</code> -&gt; users+groups (in that order), <code>@*</code> -&gt; groups only, <code>@**</code> -&gt; users only - even though the middle case could also cover users. That enables finding groups other than through very specific name matches.</p>



<a name="1234479"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234479" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234479">(Jul 19 2021 at 19:29)</a>:</h4>
<p>Moreover, in the stream messages, we give the <a href="https://github.com/zulip/zulip/blob/b23fd2f1f3dedbc2591e94531b065c0fe57847a8/static/js/typeahead_helper.js#L216">last preference</a> to the recent senders.</p>



<a name="1234619"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234619" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234619">(Jul 19 2021 at 23:25)</a>:</h4>
<p>Yeah, I think if you have <code>@*</code> only, we could reasonably make that complete user groups.</p>



<a name="1234622"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234622" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234622">(Jul 19 2021 at 23:26)</a>:</h4>
<p>I suspect the motivation for having those at the top is to advertise that wildcard mentions exist, but I feel like that's probably not particularly important to advertise in that way.</p>



<a name="1234842"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234842" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rohitt Vashishtha <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234842">(Jul 20 2021 at 07:09)</a>:</h4>
<p>I feel having the wildcard mentions exposed is more useful but just pressing <code>@+enter</code> should still mention the last participant.</p>
<p>This gives a couple of options:</p>
<ol>
<li>
<p>Highlight the 4th option (first person) in the typeahead by default. Since we have a very bold highlight color, it's hard to miss which option is selected. On typing any more characters, the default behavior of keeping the cursor at top would happen. I'm not sure how intuitive it would be, but it sounds like people could get confused with this behavior too.</p>
</li>
<li>
<p>Put 5 people at the top, then put wildcard mentions and then put the rest of the people. This could make the sort order a bit funny, but it would solve the issue of the highlight jumping around when typing more characters.</p>
</li>
<li>
<p>We could argue that <code>@all, @everyone and @stream</code> are rarely used. If we just put the WIP <code>@here</code> mention as the top choice (and maybe even hide the other wildcards), then <code>@+enter</code> would do something reasonable too.</p>
</li>
</ol>



<a name="1234844"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234844" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rohitt Vashishtha <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234844">(Jul 20 2021 at 07:10)</a>:</h4>
<p>After writing this, I like the 3rd idea more. It has a good balance of exposing wildcard mentions but not accidentally mentioning a lot of people.</p>



<a name="1234845"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1234845" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rohitt Vashishtha <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1234845">(Jul 20 2021 at 07:18)</a>:</h4>
<blockquote>
<p>I feel like we definitely want the actual people who've participated in a conversation to be the top options</p>
</blockquote>
<p>I'm sure you don't want to mention yourself that much though. This might be another small bug in the sort/filter order that got exposed by this change.</p>
<p><a href="/user_uploads/2/62/IUg74Wuxh-S4GMv3QNYq0mE2/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/62/IUg74Wuxh-S4GMv3QNYq0mE2/image.png" title="image.png"><img src="/user_uploads/2/62/IUg74Wuxh-S4GMv3QNYq0mE2/image.png"></a></div>



<a name="1235242"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1235242" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1235242">(Jul 21 2021 at 01:07)</a>:</h4>
<p>One consideration here is that we don't want to encourage people to be using things like <code>@all</code> all the time. If they're always there in the list, that makes it look like those are things you should consider using frequently.</p>



<a name="1235243"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1235243" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1235243">(Jul 21 2021 at 01:09)</a>:</h4>
<p>When I type an empty <code>@</code> in replying to this thread, I get the following list:<br>
<a href="/user_uploads/2/27/MX1s8-nlCQMuPefn2IOoXidE/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/2/27/MX1s8-nlCQMuPefn2IOoXidE/image.png" title="image.png"><img src="/user_uploads/2/27/MX1s8-nlCQMuPefn2IOoXidE/image.png"></a></div><p>That includes me (the bug Rohitt just mentioned). Another surprise there is that it includes two people who haven't talked in this thread, even while it leaves out several people who have.</p>



<a name="1235458"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1235458" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rohitt Vashishtha <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1235458">(Jul 21 2021 at 07:14)</a>:</h4>
<p>Right, Akshat isn't mentioned in your list but it is in mine. I would consider that a bug. I'll look into the sorting code later today.</p>



<a name="1236012"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1236012" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1236012">(Jul 21 2021 at 22:19)</a>:</h4>
<p><span class="user-mention" data-user-id="1406">@Rohitt Vashishtha</span> awesome!</p>



<a name="1236030"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1236030" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1236030">(Jul 21 2021 at 22:42)</a>:</h4>
<p>So if I'm reading the code right, the priority is:</p>
<ol>
<li>prefer is_broadcast (<code>@all, @everyone, @stream</code>) over individuals</li>
<li>prefer stream subscribers over people not subscribed</li>
<li>prefer people you've PMed with over people you haven't PMed with</li>
<li>prefer people who have sent messages to the topic; if both people have sent messages to the topic, prefer whoever did so more recently</li>
<li>prefer people who have sent messages to the stream; if both people have sent messages to the sream, prefer whoever did so more recently</li>
</ol>
<p>Can someone clarify how groups are treated?</p>



<a name="1236035"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1236035" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1236035">(Jul 21 2021 at 22:48)</a>:</h4>
<p>From the discussion above, it sounds like we think this is not the right order of importance. Perhaps it should be something like: </p>
<p>subscribers &gt;non-subscribers; sent to topic &gt; haven't sent; PMed &gt; haven't PMed; sent to stream &gt; haven't sent to stream</p>
<p>Which group should broadcasts go after? Probably no higher than after subsribers who've sent to the topic.</p>



<a name="1236037"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1236037" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1236037">(Jul 21 2021 at 22:49)</a>:</h4>
<p>Plus we need a special case for the sender.</p>



<a name="1236752"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1236752" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1236752">(Jul 22 2021 at 21:46)</a>:</h4>
<p>That sounds correct.  I think the right order is for the non-wildcard mentions is probably 2 (which will have a lot of ties), 4 , 5 (actual participation in the topic and then stream I think is really strong signal for who you might want to mention), 3, 1.  </p>
<p>I'm not totally sure about how wildcard mentions should relate to the rest, but I'm moving towards the opinion that we'd be better off making them a thing you have to type a prefix of to see.  They're a very small fraction of all mentions and I think it's pretty discoverable in other ways that they exist, in part because if anyone ever uses one in a stream, every user in that stream gets an email/mobile push about it, and it's a standard feature of this class of product.</p>



<a name="1236845"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1236845" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1236845">(Jul 22 2021 at 22:30)</a>:</h4>
<p>That reorders "PMed" with "sent to stream" in what I suggested. Seems reasonable to me.</p>



<a name="1236943"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1236943" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1236943">(Jul 22 2021 at 23:43)</a>:</h4>
<p><span class="user-mention" data-user-id="17026">@Akshat (akshatdalton)</span> do you want to take this issue, since you've been doing a bunch of other typeahead work this week?</p>



<a name="1240740"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1240740" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1240740">(Jul 29 2021 at 18:46)</a>:</h4>
<p>I just want a confirmation that we prefer the following priority order, right? :</p>
<ol>
<li>subscribers &gt; non-subscribers</li>
<li>sent to topic &gt; haven't sent</li>
<li>sent to stream &gt; haven't sent to stream</li>
<li>PMed &gt; haven't PMed.</li>
</ol>
<p>And then we want wildcard mentions.</p>



<a name="1240741"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1240741" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1240741">(Jul 29 2021 at 18:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="2406">Neil Pilgrim (neiljp)</span> <a href="#narrow/stream/101-design/topic/mention.20typeahead/near/1234477">said</a>:</p>
<blockquote>
<p>I don't recall if there was a web app conclusion on this since I think the behavior was different at the time, but ZT treats <code>@</code> -&gt; users+groups (in that order), <code>@*</code> -&gt; groups only, <code>@**</code> -&gt; users only - even though the middle case could also cover users. That enables finding groups other than through very specific name matches.</p>
</blockquote>
<p>And also we want to follow the same logic as that of Zulip-Terminal, right?</p>



<a name="1240742"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1240742" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Neil Pilgrim (neiljp) <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1240742">(Jul 29 2021 at 18:48)</a>:</h4>
<p>(I think there was earlier discussion of that with <span class="user-mention" data-user-id="1406">@Rohitt Vashishtha</span>?)</p>



<a name="1240761"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1240761" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1240761">(Jul 29 2021 at 19:06)</a>:</h4>
<p>1-4 look good to me.</p>
<p>Perhaps wildcard shouldn't go at the <em>very</em> bottom? I'd be inclined to at least put them above the bottom bucket, i.e. non-subscribers who haven't sent to stream or topic and haven't PMed.</p>



<a name="1240785"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1240785" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rohitt Vashishtha <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1240785">(Jul 29 2021 at 19:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="2406">Neil Pilgrim (neiljp)</span> <a href="#narrow/stream/101-design/topic/mention.20typeahead/near/1240742">said</a>:</p>
<blockquote>
<p>(I think there was earlier discussion of that with <span class="user-mention silent" data-user-id="1406">Rohitt Vashishtha</span>?)</p>
</blockquote>
<p>Yep, and we agreed that it was the right plan to deal with <code>@*</code> and <code>@**</code> separately but we didn't get agreement from others IG.</p>



<a name="1240788"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1240788" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rohitt Vashishtha <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1240788">(Jul 29 2021 at 19:31)</a>:</h4>
<p>I think we can reduce wildcards we show. Like I said a few messages up, @all and @everyone and even @stream are not that commonly used.</p>
<p>When we add @here or @topic, having it visible more prominently might be helpful.</p>



<a name="1242409"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1242409" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1242409">(Aug 02 2021 at 20:58)</a>:</h4>
<p><span class="user-mention" data-user-id="1406">@Rohitt Vashishtha</span> <span class="user-mention" data-user-id="10457">@Sumanth Rao</span> what do you think about changing the wildcard mentions to use the aliases system we use for the programming languages typeahead, where we show at most one?  That would make it much nicer to have them sorted relatively high in the list.</p>



<a name="1242496"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1242496" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sumanth Rao <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1242496">(Aug 03 2021 at 00:54)</a>:</h4>
<p>Using the alias system would help us show at most one, which is great. For the programming language aliases, we associated something like a priority for the aliases to sort them based on popularity. For the wildcards, they could be shown only when a prefix matches like <code>@he</code> -&gt; <code>@here</code>while prioritizing it higher than users starting with that prefix.</p>



<a name="1242571"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1242571" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rohitt Vashishtha <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1242571">(Aug 03 2021 at 03:42)</a>:</h4>
<p>I like the idea, but it would still take a hit in terms of visibility. If someone doesn't know about wildcard mentions already, they'd be less likely to find all of them.</p>



<a name="1250001"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1250001" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Aptekar-Cassels <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1250001">(Aug 26 2021 at 21:19)</a>:</h4>
<p>is there a consensus on what we're doing here, or who's going to be implementing this?</p>



<a name="1251016"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251016" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251016">(Aug 31 2021 at 18:13)</a>:</h4>
<p>It sounds like there's agreement on only showing at most one wildcard mention in the typeahead, which is relevant before the user has typed the first letter. We should make a call on which one we prefer.</p>



<a name="1251017"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251017" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251017">(Aug 31 2021 at 18:14)</a>:</h4>
<p>.</p>



<a name="1251019"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251019" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251019">(Aug 31 2021 at 18:14)</a>:</h4>
<p>/poll Which wildcard mention should be shown in typeahead for <code>@</code>?</p>



<a name="1251020"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251020" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251020">(Aug 31 2021 at 18:15)</a>:</h4>
<p>(Oops, typo-ed the first option!)</p>



<a name="1251021"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251021" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251021">(Aug 31 2021 at 18:17)</a>:</h4>
<p>And then given that change, we should re-decide where in the sorting we want to put the wildcard mentions. Should they go at the very top or lower than that?</p>



<a name="1251022"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251022" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251022">(Aug 31 2021 at 18:18)</a>:</h4>
<p>FWIW, Slack and Discord do put them first.</p>



<a name="1251031"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251031" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251031">(Aug 31 2021 at 18:34)</a>:</h4>
<p>Is there a difference in behavior between @-all, @-everyone, and @-stream? Or are they different names for the same thing?</p>
<p>It looks like only one of them is documented:<br>
<a href="https://zulip.com/help/mention-a-user-or-group">https://zulip.com/help/mention-a-user-or-group</a></p>



<a name="1251032"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251032" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251032">(Aug 31 2021 at 18:35)</a>:</h4>
<p>My view on having them in the list when you haven't typed anything is:</p>
<p><span class="user-mention silent" data-user-id="2187">Greg Price</span> <a href="#narrow/stream/101-design/topic/mention.20typeahead/near/1235242">said</a>:</p>
<blockquote>
<p>One consideration here is that we don't want to encourage people to be using things like <code>@all</code> all the time. If they're always there in the list, that makes it look like those are things you should consider using frequently.</p>
</blockquote>



<a name="1251063"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251063" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251063">(Aug 31 2021 at 19:16)</a>:</h4>
<p>I was assuming from the parenthetical description ("(Notify stream)") that they are all the same thing, but I could be mistaken.</p>
<p>Slack and Discord also have <code>@here</code>, which only notifies users who are online.</p>



<a name="1251064"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251064" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251064">(Aug 31 2021 at 19:17)</a>:</h4>
<p>Yeah, @-here can be a very handy feature sometimes and would be neat to add.</p>



<a name="1251454"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251454" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251454">(Sep 01 2021 at 10:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="17945">Wesley Aptekar-Cassels</span> <a href="#narrow/stream/101-design/topic/mention.20typeahead/near/1250001">said</a>:</p>
<blockquote>
<p>is there a consensus on what we're doing here, or who's going to be implementing this?</p>
</blockquote>
<p>I opened <a href="https://github.com/zulip/zulip/pull/19554">#19554</a> implementing new changes. Any feedback will be appreciated!</p>



<a name="1251455"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251455" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251455">(Sep 01 2021 at 10:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="2187">Greg Price</span> <a href="#narrow/stream/101-design/topic/mention.20typeahead/near/1251064">said</a>:</p>
<blockquote>
<p>Yeah, @-here can be a very handy feature sometimes and would be neat to add.</p>
</blockquote>
<p>I was working on this feature <a href="https://github.com/zulip/zulip/pull/16964">#16964</a>, in December.</p>



<a name="1251669"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251669" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251669">(Sep 01 2021 at 22:23)</a>:</h4>
<p><span class="user-mention" data-user-id="17026">@Akshat</span> I think doing an update to that <code>@here</code> PR would be valuable, while you're thinking about this code path.</p>



<a name="1251670"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1251670" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1251670">(Sep 01 2021 at 22:23)</a>:</h4>
<p>It looks like CI didn't run on <a href="https://github.com/zulip/zulip/pull/19554">#19554</a>; I just attempted to trigger a rerun on it.</p>



<a name="1342341"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1342341" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1342341">(Mar 10 2022 at 18:59)</a>:</h4>
<p>What's the status of <a href="https://github.com/zulip/zulip/pull/19554">#19554</a>? Could we get it merged? <span class="user-mention" data-user-id="17026">@Akshat</span> <span class="user-mention" data-user-id="7">@Tim Abbott</span></p>



<a name="1342352"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1342352" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1342352">(Mar 10 2022 at 19:06)</a>:</h4>
<p>I have sometime for the next 15 days; I will update my PR, address the comments.<br>
But if someone wants to work on that issue they should feel free to use my code contribution.</p>



<a name="1342359"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1342359" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1342359">(Mar 10 2022 at 19:11)</a>:</h4>
<p>I was recently reminded of this in the context of discussing the typeahead/search algorithms for mobile. If you're up for working on it, that would be great!</p>



<a name="1342362"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1342362" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1342362">(Mar 10 2022 at 19:15)</a>:</h4>
<p>We also noticed that the suggestions are sorted differently for @-mentions (with no message recipient specified) vs. the addressee of a PM typeahead. Could someone explain what the differences between those algorithms are? The situations seem very similar.</p>



<a name="1428493"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1428493" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1428493">(Aug 31 2022 at 07:36)</a>:</h4>
<p>I was just reminded of this discussion; I guess <a href="https://github.com/zulip/zulip/pull/19554">#19554</a> is still open. I actually can't quite tell from the PR description what exactly it does. <span class="user-mention" data-user-id="17026">@Akshat</span> if you're potentially interested in continuing work on this, I wonder if you could add some screenshots and/or additional explanation of the changes?</p>



<a name="1429796"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1429796" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1429796">(Sep 02 2022 at 20:30)</a>:</h4>
<p>I vaguely remember that change; I'm pretty sure that change was useful and would be excited to see <span class="user-mention" data-user-id="17026">@Akshat</span> revive it and also document it with explanation/reminders of the context.</p>



<a name="1429821"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1429821" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1429821">(Sep 02 2022 at 21:14)</a>:</h4>
<p>We figured out that we need to work on two subjects: <a href="https://github.com/zulip/zulip/pull/19554">#19554</a> and <a href="https://github.com/zulip/zulip/pull/16964">#16964</a>.</p>
<ul>
<li><a href="https://github.com/zulip/zulip/pull/19554">#19554</a> is about changing the sorting algorithm of typeahead mentions having the priority order mentioned <a href="#narrow/stream/101-design/topic/mention.20typeahead/near/1240740">here</a>.</li>
<li><a href="https://github.com/zulip/zulip/pull/16964">#16964</a> is about implementing the new feature: <code>@here</code>.</li>
</ul>
<p>I'll take up the first task and then move to the second one.</p>



<a name="1430037"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1430037" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1430037">(Sep 03 2022 at 11:23)</a>:</h4>
<p>I'm noticing something weird behavior while debugging:<br>
I'm noticing a change in the order of values while concatenating the arrays.<br>
It will be hard for me to explain what's going on so</p>
<ul>
<li>you can try the changes from: <a href="https://github.com/akshatdalton/zulip/commit/e07f8f7479062301c5d2220cda898bfae0393a0e">https://github.com/akshatdalton/zulip/commit/e07f8f7479062301c5d2220cda898bfae0393a0e</a> and type <code>@</code> in the message box.</li>
<li>console logs:</li>
</ul>
<div class="codehilite"><pre><span></span><code>res1 =
0: {email: &#39;user14@zulipdev.com&#39;, user_id: 14, avatar_version: 1, is_admin: false, is_owner: false, …}
1: {email: &#39;default-bot@zulip.com&#39;, user_id: 16, avatar_version: 1, is_admin: false, is_owner: false, …}
2: {email: &#39;user9@zulipdev.com&#39;, user_id: 9, avatar_version: 1, is_admin: true, is_owner: true, …}
3: {email: &#39;user12@zulipdev.com&#39;, user_id: 12, avatar_version: 1, is_admin: false, is_owner: false, …}
4: {email: &#39;user6@zulipdev.com&#39;, user_id: 6, avatar_version: 1, is_admin: false, is_owner: false, …}
5: {email: &#39;user11@zulipdev.com&#39;, user_id: 11, avatar_version: 1, is_admin: true, is_owner: false, …}
</code></pre></div>
<div class="codehilite"><pre><span></span><code>res2 =
0: {special_item_text: &#39;all (Notify stream)&#39;, email: &#39;all&#39;, pm_recipient_count: Infinity, full_name: &#39;all&#39;, is_broadcast: true, …}
1: {special_item_text: &#39;everyone (Notify stream)&#39;, email: &#39;everyone&#39;, pm_recipient_count: Infinity, full_name: &#39;everyone&#39;, is_broadcast: true, …}
2: {special_item_text: &#39;stream (Notify stream)&#39;, email: &#39;stream&#39;, pm_recipient_count: Infinity, full_name: &#39;stream&#39;, is_broadcast: true, …}
3: {email: &#39;user12@zulipdev.com&#39;, user_id: 12, avatar_version: 1, is_admin: false, is_owner: false, …}
4: {email: &#39;user7@zulipdev.com&#39;, user_id: 7, avatar_version: 1, is_admin: false, is_owner: false, …}
5: {email: &#39;user13@zulipdev.com&#39;, user_id: 13, avatar_version: 1, is_admin: false, is_owner: false, …}
</code></pre></div>
<div class="codehilite"><pre><span></span><code>res3 =
0: {email: &#39;user14@zulipdev.com&#39;, user_id: 14, avatar_version: 1, is_admin: false, is_owner: false, …}
1: {email: &#39;default-bot@zulip.com&#39;, user_id: 16, avatar_version: 1, is_admin: false, is_owner: false, …}
2: {email: &#39;user9@zulipdev.com&#39;, user_id: 9, avatar_version: 1, is_admin: true, is_owner: true, …}
3: {email: &#39;user12@zulipdev.com&#39;, user_id: 12, avatar_version: 1, is_admin: false, is_owner: false, …}
4: {email: &#39;user6@zulipdev.com&#39;, user_id: 6, avatar_version: 1, is_admin: false, is_owner: false, …}
5: {email: &#39;user11@zulipdev.com&#39;, user_id: 11, avatar_version: 1, is_admin: true, is_owner: false, …}
</code></pre></div>



<a name="1573912"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1573912" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joseph Ho <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1573912">(May 22 2023 at 05:18)</a>:</h4>
<p>In <a href="https://github.com/zulip/zulip/pull/25613">#25613</a>, we plan on limiting the wildcard mentions to at most 1 suggestion for the typeahead. But I find that in the current typeahead there are a couple things that's a bit jarring. </p>
<p>When we open the mention typeahead, we see that all the wildcard mentions are at the top and when we type it'll work just fine too. But let's say we attempt a fuzzy search with "stream" and just enter "t". Here we will start to notice that <span class="user-mention silent" data-user-id="7">Tim Abbott</span> is at the top with the stream mention in the middle of the pack. I personally find this messy as I kind of expect the wildcard mentions to always be at the top. </p>
<p>This is my opinion on this but would love to hear other's opinions on this as well.</p>



<a name="1573917"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1573917" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joseph Ho <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1573917">(May 22 2023 at 05:38)</a>:</h4>
<p>We should also consider if fuzzy search should be considered a "match" or not when dealing with wildcard mentions.</p>



<a name="1574157"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1574157" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1574157">(May 22 2023 at 17:45)</a>:</h4>
<p><span class="user-mention" data-user-id="24937">@Joseph Ho</span> Can you show this with a little screencast?</p>



<a name="1574226"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1574226" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1574226">(May 22 2023 at 18:56)</a>:</h4>
<p>I would not expect "stream" to be at the top for "t" -- typing "t" would be a very odd way for a user to attempt to create an <code>@stream</code> mention.</p>



<a name="1574233"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1574233" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1574233">(May 22 2023 at 19:00)</a>:</h4>
<p>The current behavior is that "stream" matches in the middle of the word in the same way as other mentions, so, e.g., for <code>@tr</code> in this stream, you get <code>@stream</code>, followed by <code>Sahil Ba*tr*a</code>, and then other users. That seems OK to me, but I don't feel super strongly about this detail.</p>



<a name="1608522"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1608522" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1608522">(Jul 12 2023 at 18:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="19257">Alya Abbott</span> I checked <a href="https://github.com/zulip/zulip/pull/25613">#25613</a>; don't we want to go with the priority order we discussed <a href="#narrow/stream/101-design/topic/mention.20typeahead/near/1240740">here</a>?</p>



<a name="1608523"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1608523" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1608523">(Jul 12 2023 at 18:40)</a>:</h4>
<p>I was considering reviving my old PR: <a href="https://github.com/zulip/zulip/pull/19554">#19554</a> (Update typeahead priority order logic for recipients).</p>



<a name="1609105"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1609105" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1609105">(Jul 13 2023 at 15:35)</a>:</h4>
<p><span class="user-mention" data-user-id="17026">@Akshat</span> I thought <a href="https://github.com/zulip/zulip/pull/25613">#25613</a> was just about not showing all the duplicates -- I'm pretty sure we have a <code>aliases</code> feature in some other typeaheads for this exact problem.</p>



<a name="1612606"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1612606" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1612606">(Jul 19 2023 at 19:21)</a>:</h4>
<blockquote>
<p>I'm pretty sure we have a aliases feature in some other typeaheads for this exact problem.</p>
</blockquote>
<p>I don't get it.</p>
<p>I believe my old PR: <a href="https://github.com/zulip/zulip/pull/19554">#19554</a> implements the priority order where it does not show the wildcard duplicates.</p>



<a name="1613454"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1613454" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1613454">(Jul 20 2023 at 23:25)</a>:</h4>
<p><span class="user-mention" data-user-id="17026">@Akshat</span> can you spell out a bit more what you're proposing and why? Your plan is probably right but it'd really help if you wrote out the context to remind everyone.</p>



<a name="1615785"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1615785" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1615785">(Jul 25 2023 at 17:56)</a>:</h4>
<p>Sure! Here's what we decided to do to update the priority order of recipients in the typeahead:</p>
<p>For stream messages, the order of priority is as follows:</p>
<ol>
<li>Subscribers over non-subscribers.</li>
<li>Users who have sent messages to the current topic over those who haven't sent to the current topic.</li>
<li>Users who have sent messages to the stream over those who haven't sent to the stream.</li>
<li>Users have PMed with over users haven't PMed with.</li>
</ol>
<p>For PM conversations, the order of priority is as follows:</p>
<ol>
<li>Users who have PMed with each other over those who haven't.</li>
<li>Recipients with higher counts.</li>
<li>Normal users over bots.</li>
<li>Users with shorter names over those with longer names.</li>
</ol>



<a name="1615787"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1615787" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1615787">(Jul 25 2023 at 18:00)</a>:</h4>
<p>In this logic update, we also handle the wildcards where we don't show wildcards at the top anymore instead if the search text matches parts of the wildcard then only we put it higher in the priority order.</p>



<a name="1615788"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1615788" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1615788">(Jul 25 2023 at 18:03)</a>:</h4>
<p>But this doesn't mean we keep the wildcards at the bottom but the new priority order to sort wildcards in the typeahead is - Wildcards are given preference over:</p>
<ul>
<li>non-subscribers</li>
<li>users who have not participated in topics </li>
<li>and the users with whom the current user hasn't PMed.</li>
</ul>



<a name="1615792"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1615792" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1615792">(Jul 25 2023 at 18:06)</a>:</h4>
<p>Because of this logic, I believe we do not need to specifically address: <a href="https://github.com/zulip/zulip/pull/25613">#25613</a> but it will be resolved in <a href="https://github.com/zulip/zulip/pull/19554">#19554</a>.</p>



<a name="1617925"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1617925" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Akshat <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1617925">(Jul 30 2023 at 19:25)</a>:</h4>
<p>I've updated my PR (<a href="https://github.com/zulip/zulip/pull/19554">#19554</a>) along with feedback given by <span class="user-mention silent" data-user-id="7">Tim Abbott</span>; it would be great if people can try out the changes and give feedback on the same.</p>



<a name="1620061"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1620061" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dinesh Ch <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1620061">(Aug 05 2023 at 08:31)</a>:</h4>
<p>It might be helpful to deploy this to czo (<a class="stream-topic" data-stream-id="415" href="/#narrow/stream/415-chat.2Ezulip.2Eorg/topic/experiments">#chat.zulip.org &gt; experiments</a> )</p>



<a name="1645873"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1645873" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1645873">(Sep 23 2023 at 00:27)</a>:</h4>
<p>I just filed <a href="https://github.com/zulip/zulip/pull/26838">#26838</a> to help make sure we don't lose track of this project and <span class="user-mention" data-user-id="17026">@Akshat</span> 's PR (<a href="https://github.com/zulip/zulip/pull/19554">#19554</a>).</p>



<a name="1645874"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1645874" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1645874">(Sep 23 2023 at 00:27)</a>:</h4>
<p>I agree that it would be good to try it out on CZO.</p>



<a name="1645877"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1645877" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1645877">(Sep 23 2023 at 00:28)</a>:</h4>
<p>I'm currently feeling uncertain about demoting wildcard mentions, because we're about to add an <code>@topic</code> feature, and putting it at the top of the typeahead is great for discoverability.</p>



<a name="1645878"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/mention%20typeahead/near/1645878" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/mention.20typeahead.html#1645878">(Sep 23 2023 at 00:30)</a>:</h4>
<p>I guess we can treat it differently from the others... In general, <code>@all</code> or <code>@everyone</code> are probably familiar to users of other chat apps, but <code>@topic</code> would be very hard to guess.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>