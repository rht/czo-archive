<html>
<head><meta charset="utf-8"><title>report message feature (#20047) · design · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/101-design/index.html">design</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html">report message feature (#20047)</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1362574"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1362574" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Sah <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1362574">(Apr 08 2022 at 12:47)</a>:</h4>
<p>opening a CZO for <a href="https://github.com/zulip/zulip/issues/20047">https://github.com/zulip/zulip/issues/20047</a></p>
<p><span class="user-mention" data-user-id="19257">@Alya Abbott</span>  <span class="user-mention" data-user-id="7">@Tim Abbott</span> etc - it's been 6+ months... still high priority?  you guys interested if I prototype this? FWIW, I've worked on user generated content (UGC) products for decades, including "at scale" (Google) and I've also been a mod on reddit for a 2M user sub. This seems like a good next zulip project for me, now that I'm familiar with the frontend etc.</p>
<p><span class="user-mention" data-user-id="19257">@Alya Abbott</span> the posted design makes sense to me. With your permission of course, I might suggest the wording change slightly from "flag message" to "report message" since that's actually what the user is doing ;-)  Regardless, tooltip &amp; online help will be super important for users &amp; moderators.</p>
<p>all - given that Zulip's gone many years without this feature, my sense is that we can defer "secondary issues" and "issues of scale" including abuse of the report-message button, brigading, flooding the abuse queue, etc.</p>



<a name="1362691"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1362691" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1362691">(Apr 08 2022 at 16:52)</a>:</h4>
<p><span class="user-mention" data-user-id="21154">@Adam S</span> We're pretty liberal with the high-priority label, so it doesn't necessarily indicate plans to do something immediately. Definitely still excited about this feature. :) If you want to pick it up, that sounds great!</p>



<a name="1362692"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1362692" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1362692">(Apr 08 2022 at 16:53)</a>:</h4>
<p>Sure, "Report message" makes sense to me for the label.</p>



<a name="1362695"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1362695" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1362695">(Apr 08 2022 at 16:57)</a>:</h4>
<blockquote>
<p>all - given that Zulip's gone many years without this feature, my sense is that we can defer "secondary issues" and "issues of scale" including abuse of the report-message button, brigading, flooding the abuse queue, etc.</p>
</blockquote>
<p>That makes sense to me; admins can kick off any users who are abusing the reporting mechanism.</p>



<a name="1363961"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1363961" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Sah <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1363961">(Apr 10 2022 at 13:54)</a>:</h4>
<p>I'm on it. PR coming.</p>



<a name="1382488"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1382488" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Sah <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1382488">(May 19 2022 at 22:25)</a>:</h4>
<p>PR <a href="https://github.com/zulip/zulip/pull/21821">#21821</a> ready for eng review incl unittests, etc - I recommend playing with it and seeing how it feels. Thx to design feedback from <span class="user-mention" data-user-id="19257">@Alya Abbott</span>.</p>
<p>There's one corner case we should discuss: what happens if the "report message" stream is deleted/disabled/etc ?  I don't want to add complexity, but IMHO it's bad to have this feature silently fail.  Thoughts?</p>
<p>cc <span class="user-mention" data-user-id="12178">@Alex Vandiver</span> <span class="user-mention" data-user-id="699">@Anders Kaseorg</span> <span class="user-mention" data-user-id="7">@Tim Abbott</span> (substantial feature requested by the Rust community)</p>



<a name="1382504"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1382504" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Evy <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1382504">(May 20 2022 at 00:35)</a>:</h4>
<p>Thank you for working on this!!</p>



<a name="1382546"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1382546" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1382546">(May 20 2022 at 03:07)</a>:</h4>
<p>And good thinking about that corner case.</p>
<p>There are two angles on that -- one is to notify someone when it happens, and the other is to try to prevent getting into that exceptional case.  I see you currently have a <code>logging.error("...")</code> when it happens -- which in most installs will email the server admins.  Which is a pretty reasonable first pass, in that in most self-hosted installs those folks are likely the folks who would be able to fix it.</p>
<p>The problem is that in things like Zulip Cloud, the server admins (e.g. someone like me) can't do anything about the configuration of the streams in that one realm.  So we'd prefer to notify the realm admins, instead -- e.g. via <code>send_email_to_admins</code>.</p>
<p>But even better would be to prevent being in that case, by hooking into when we archive streams to show a client-side popup confirming that this will disable the feature.  That also provides a way to handle the similar issues from if one archives the new-user or new-stream notifications, which users might also archive without understanding the implications.</p>
<p>And tangentially, the "report message" option still shows up even if the feature is disabled (both if it was explicitly unset, as well as if the stream is archived).  We should remove it from the UI in those cases.</p>



<a name="1382631"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1382631" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Sah <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1382631">(May 20 2022 at 09:26)</a>:</h4>
<p>thx! the client-side confirmation has a problem in the corner-corner case where the UserProfile archiving the stream isn't an admin and therefore shouldn't be permitted to disable this feature!</p>
<p>But hooking-into the archive-stream function is smart, and leads to the simple solution of just erroring if someone tries to archive the report-messages stream: "Error: cannot delete &lt;stream&gt; because it is being used to receive reporting messages. Please first disable this feature in the admin settings."</p>
<p>If nobody screams, I'll try that next and post a screencap.</p>



<a name="1382637"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1382637" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sahil Batra <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1382637">(May 20 2022 at 11:08)</a>:</h4>
<p>We allow only admins and owners to archive streams, so that should not be a problem.</p>



<a name="1382961"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1382961" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1382961">(May 20 2022 at 23:25)</a>:</h4>
<p>Ah, I think when Adam and I messaged about this on the issue, I think we may have been talking about different situations.</p>
<p>You can disable the stream via the "Disable" button for the message setting, similar to New stream/user notifications:</p>
<p><a href="/user_uploads/2/e8/x-IisWjG9jBaYUYSp6aTWUP4/Screen-Shot-2022-05-20-at-4.19.42-PM.png">Screen-Shot-2022-05-20-at-4.19.42-PM.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/2/e8/x-IisWjG9jBaYUYSp6aTWUP4/Screen-Shot-2022-05-20-at-4.19.42-PM.png" title="Screen-Shot-2022-05-20-at-4.19.42-PM.png"><img src="/user_uploads/2/e8/x-IisWjG9jBaYUYSp6aTWUP4/Screen-Shot-2022-05-20-at-4.19.42-PM.png"></a></div><p>In that situation it should be clear to the admin that they are turning off the feature, and I still think all we need to do is to remove the option from the three-dot menu for users, as Alex suggested above as well.</p>



<a name="1382962"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1382962" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1382962">(May 20 2022 at 23:28)</a>:</h4>
<blockquote>
<p>But even better would be to prevent being in that case, by hooking into when we archive streams to show a client-side popup confirming that this will disable the feature. That also provides a way to handle the similar issues from if one archives the new-user or new-stream notifications, which users might also archive without understanding the implications.</p>
</blockquote>
<p>I agree with that proposal. I think it should be a warning as <span class="user-mention silent" data-user-id="12178">Alex Vandiver</span> suggested, not an error -- you can still archive the stream and turn off the feature in one step. It should work the same for new user and new stream announcements.</p>
<p>It would be totally fine for this warning to be a follow-up issue/PR. It's a rare situation, and it's not a blocker for the report message feature.</p>



<a name="1383514"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1383514" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Sah <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1383514">(May 23 2022 at 10:28)</a>:</h4>
<p>For simplicity, I coded this as an error, with a descriptive warning. This is an obscure case and imho doesn't deserve optimization. :-)<br>
<a href="/user_uploads/2/e9/f3R4LEpeI3Qey6a1alOhAl99/chrome-capture-2022-4-22.gif">chrome-capture-2022-4-22.gif</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/e9/f3R4LEpeI3Qey6a1alOhAl99/chrome-capture-2022-4-22.gif" title="chrome-capture-2022-4-22.gif"><img src="/user_uploads/2/e9/f3R4LEpeI3Qey6a1alOhAl99/chrome-capture-2022-4-22.gif"></a></div><p><a href="https://github.com/zulip/zulip/pull/21821">#21821</a> ready for review.</p>



<a name="1383591"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1383591" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1383591">(May 23 2022 at 19:58)</a>:</h4>
<p>I filed <a href="https://github.com/zulip/zulip/pull/22110">#22110</a> for the archive stream warning; we can just add some text to the existing confirmation dialog.</p>



<a name="1383602"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1383602" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1383602">(May 23 2022 at 20:22)</a>:</h4>
<p>I guess ideally we'd also warn when changing the stream for reporting messages to no longer be private, as that turns off the feature as well.</p>



<a name="1383608"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1383608" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alya Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1383608">(May 23 2022 at 20:26)</a>:</h4>
<p>Playing with the PR, it looks like the reporting option still needs to be removed from the three-dot message menu when the org setting is disabled.</p>



<a name="1383621"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1383621" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Sah <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1383621">(May 23 2022 at 20:52)</a>:</h4>
<p><span class="user-mention" data-user-id="19257">@Alya Abbott</span>  ok, I'll fix both cases (error-on-public and triple-dot disable) as well as the UI bug you mentioned in the PR (<a href="https://github.com/zulip/zulip/pull/21821#issuecomment-1135105229">https://github.com/zulip/zulip/pull/21821#issuecomment-1135105229</a>)</p>



<a name="1385181"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1385181" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1385181">(May 26 2022 at 23:14)</a>:</h4>
<p>I agree not offering the report option if the destination stream is disabled is probably the best plan. To be explicit, <span class="user-mention" data-user-id="21154">@Adam S</span> have you implemented that detail yet? I can do a detailed review of this PR but it'd be nice to know whether the UX matches what we intend when doing so.</p>



<a name="1385278"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1385278" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Sah <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1385278">(May 27 2022 at 00:18)</a>:</h4>
<p>I have not implemented this yet - yes I agree, let's hold off code review<br>
until the next round of changes is ready. Lol, I have plenty of other PRs<br>
ready for review!</p>



<a name="1387915"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1387915" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1387915">(Jun 03 2022 at 00:58)</a>:</h4>
<p>I ended up doing a review anyway -- most of my comments are on naming/convention details independent of these UI details, so I think my time was well spent. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="1391842"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1391842" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Sah <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1391842">(Jun 12 2022 at 16:36)</a>:</h4>
<p>I'm working through the code review... ran into a question about the formatting: <a href="https://github.com/zulip/zulip/pull/21821#discussion_r887412747">https://github.com/zulip/zulip/pull/21821#discussion_r887412747</a><br>
<span class="user-mention" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-id="19257">@Alya Abbott</span> (and others?) WDYT?</p>
<p>Pick the format you want, and I'll code it up.</p>



<a name="1391843"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1391843" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1391843">(Jun 12 2022 at 16:47)</a>:</h4>
<p>I think I'd recommend just structuring it so there is a single string template with substitutions so it's easy to finalize the string in a later pass.</p>



<a name="1391844"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1391844" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1391844">(Jun 12 2022 at 16:48)</a>:</h4>
<p>Since we often like to do that while doing the final documentation.</p>



<a name="1404583"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/101-design/topic/report%20message%20feature%20%28%2320047%29/near/1404583" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Sah <a href="https://rht.github.io/czo-archive/stream/101-design/topic/report.20message.20feature.20.28.2320047.29.html#1404583">(Jul 14 2022 at 03:17)</a>:</h4>
<p>prep commits are in (thx <span class="user-mention" data-user-id="7">@Tim Abbott</span> ) and merged, ready for review: <a href="https://github.com/zulip/zulip/pull/21821">https://github.com/zulip/zulip/pull/21821</a></p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>