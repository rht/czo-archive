<html>
<head><meta charset="utf-8"><title>docker-compose install · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html">docker-compose install</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="639629"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639629" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639629">(Aug 28 2018 at 18:43)</a>:</h4>
<p>I am just running the docker-compose install. Looks scary, as if tons of things are being installed on my server and not in a container.</p>



<a name="639631"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639631" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639631">(Aug 28 2018 at 18:44)</a>:</h4>
<p>After "Status: Downloaded newer image for ubuntu:xenial-20171114" it goes crazy ;-)</p>



<a name="639633"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639633" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639633">(Aug 28 2018 at 18:45)</a>:</h4>
<p>Is it installting the entire ubuntu server on my computer ?</p>



<a name="639641"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639641" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639641">(Aug 28 2018 at 18:58)</a>:</h4>
<p><span class="user-mention" data-user-id="8324">@Chris</span> in any case, using Docker involves downloading an entire Ubuntu server.  But I think if you didn't run the <code>docker pull</code> command, then it will build a new docker image for Zulip from source, which involves installing a lot of dependencies on top of a base ubuntu server container.</p>



<a name="639720"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639720" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639720">(Aug 28 2018 at 19:43)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span>  Yeah, Didn't do pull. Did do directly 'docker-compose up -d'. <br>
Didn't work anyways... Well, debugging tomorrow I guess since tonight it's getting late ;-)</p>



<a name="639721"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639721" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639721">(Aug 28 2018 at 19:46)</a>:</h4>
<p>Cool, keep us updated!</p>



<a name="639764"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639764" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639764">(Aug 28 2018 at 20:24)</a>:</h4>
<p>hmm. THis does not work very smooth. Can't let go though ;-)</p>



<a name="639765"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639765" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639765">(Aug 28 2018 at 20:25)</a>:</h4>
<p>Complains about standard parts in the docker-compose.yml file like:</p>
<blockquote>
<p>ck@server:/opt/docker-compose/docker-zulip$ docker-compose pull<br>
ERROR: The Compose file './docker-compose.yml' is invalid because:<br>
services.zulip.environment contains {"DB_HOST": "database"}, which is an invalid type, it should be a string</p>
</blockquote>



<a name="639769"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639769" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639769">(Aug 28 2018 at 20:36)</a>:</h4>
<p>I will try and fix it.... ;-)</p>



<a name="639776"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639776" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639776">(Aug 28 2018 at 20:48)</a>:</h4>
<p><span class="user-mention" data-user-id="8324">@Chris</span> try doing <code>docker pull</code> instead?  I'm wondering if the problem is <code>docker-compose pull</code> being weird.</p>



<a name="639777"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639777" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639777">(Aug 28 2018 at 20:48)</a>:</h4>
<p>I guess <code>docker-compose pull</code> works great for me...</p>



<a name="639778"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639778" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639778">(Aug 28 2018 at 20:48)</a>:</h4>
<p>What version of <code>docker-compose</code> do you have?</p>



<a name="639779"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639779" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639779">(Aug 28 2018 at 20:49)</a>:</h4>
<p>I starting from scratch and did a docker-compose pull</p>



<a name="639781"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639781" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639781">(Aug 28 2018 at 20:50)</a>:</h4>
<p>I think it's something with the Emailauth:</p>
<blockquote>
<p>File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/auth.py", line 1021, in &gt; get_auth_handler<br>
    'Check your credentials' % (len(names), str(names)))<br>
boto.exception.NoAuthHandlerFound: No handler was ready to authenticate. 1 handlers were checked. ['HmacAuthV1Handler'] Check your &gt; credentials<br>
  Applying zerver.0060_move_avatars_to_be_uid_based...Zulip first start database initi failed in "initialize-database" exit code 1. &gt; Exiting.</p>
</blockquote>



<a name="639782"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639782" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639782">(Aug 28 2018 at 20:50)</a>:</h4>
<p>docker-compose version 1.22.0, build f46880fe</p>



<a name="639784"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639784" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639784">(Aug 28 2018 at 20:51)</a>:</h4>
<p>OK; I'm using 1.8.0; I wonder if that's related to the difference.</p>



<a name="639785"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639785" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639785">(Aug 28 2018 at 20:53)</a>:</h4>
<p>I could post the error log here so we can have a quick look together.<br>
Hard to say if it's the version of docker-compose. Might well be. Might be that there is another problem.</p>
<p>E.g. I guess without working Email Authentication Zulip can;t start up.</p>



<a name="639786"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639786" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639786">(Aug 28 2018 at 20:53)</a>:</h4>
<p>It's possible that Docker have changed the formatting rules for <code>docker-compose.yml</code> in a recent release...</p>



<a name="639788"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639788" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639788">(Aug 28 2018 at 20:54)</a>:</h4>
<p><span class="user-mention" data-user-id="77">@Alexander Trost</span> do you have any theories for what could be causing the error above?</p>



<a name="639789"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639789" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639789">(Aug 28 2018 at 20:55)</a>:</h4>
<p>should I post my yaml file here?</p>



<a name="639790"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639790" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639790">(Aug 28 2018 at 20:55)</a>:</h4>
<p>Just let me know what makes most sense. Maybe posting it in a private message makes more sense.</p>



<a name="639791"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639791" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639791">(Aug 28 2018 at 20:57)</a>:</h4>
<p>Well, the sort of thing I'd try is removing the quotes around "database" in that part of the config, and see if the error changes.</p>



<a name="639792"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639792" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639792">(Aug 28 2018 at 20:57)</a>:</h4>
<p>If so, that'd likely confirm the issue is that your docker-compose is assuming a different file format or something.</p>



<a name="639793"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639793" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639793">(Aug 28 2018 at 20:58)</a>:</h4>
<p>Ah sorry: this error I solved already:<br>
Complains about standard parts in the docker-compose.yml file like:</p>
<blockquote>
<p>ck@server:/opt/docker-compose/docker-zulip$ docker-compose pull<br>
ERROR: The Compose file './docker-compose.yml' is invalid because:<br>
services.zulip.environment contains {"DB_HOST": "database"}, which is an invalid type, it should be a string</p>
</blockquote>



<a name="639794"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639794" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639794">(Aug 28 2018 at 20:59)</a>:</h4>
<p>this came up during docker-compose pull.</p>
<p>I needed to indent the environment tags 1 space further and the error message went away.</p>
<p>I had a similar problem with another docker image that I am running.</p>



<a name="639796"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639796" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639796">(Aug 28 2018 at 21:00)</a>:</h4>
<p>The second error message from above is the outcome of the log of the zulip container.</p>



<a name="639797"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639797" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639797">(Aug 28 2018 at 21:01)</a>:</h4>
<p>my siutation is after <br>
      docker-compose up -d:</p>
<p>I am checking for the status of the containers:</p>
<div class="codehilite"><pre><span></span> docker-compose ps
</pre></div>


<blockquote>
<div class="codehilite"><pre><span></span>     Name                        Command               State    Ports
</pre></div>


<hr>
<p>docker-zulip_database_1    <a href="http://docker-entrypoint.sh" target="_blank" title="http://docker-entrypoint.sh">docker-entrypoint.sh</a> postgres    Exit 0        <br>
docker-zulip_memcached_1   /sbin/entrypoint.sh /usr/b ...   Exit 0        <br>
docker-zulip_rabbitmq_1    <a href="http://docker-entrypoint.sh" target="_blank" title="http://docker-entrypoint.sh">docker-entrypoint.sh</a> rabbi ...   Exit 0        <br>
docker-zulip_redis_1       /sbin/entrypoint.sh              Exit 0        <br>
docker-zulip_zulip_1       /sbin/entrypoint.sh app:run      Exit 1</p>
</blockquote>



<a name="639799"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639799" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639799">(Aug 28 2018 at 21:04)</a>:</h4>
<p>I then checked the log of zulip_zulip_1</p>
<p>I will post it now, but feel free to delete it again, if it's considered spamming.</p>



<a name="639800"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639800" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639800">(Aug 28 2018 at 21:06)</a>:</h4>
<p>ck@server:/opt/docker-compose/docker-zulip$ docker logs docker-zulip_zulip_1</p>
<blockquote>
<p>=== Begin Initial Configuration Phase ===<br>
Preparing and linking the uploads folder ...<br>
Prepared and linked the uploads directory.<br>
Executing nginx configuration ...<br>
Nginx configuration succeeded.<br>
Generating self-signed certificates ...<br>
+ KEYFILE=/etc/ssl/private/zulip.key<br>
+ CERTFILE=/etc/ssl/certs/zulip.combined-chain.crt<br>
+ '[' -n '' ']'<br>
+ '[' -z '' ']'<br>
+ '[' -e /etc/ssl/private/zulip.key ']'<br>
+ '[' -e /etc/ssl/certs/zulip.combined-chain.crt ']'<br>
+ rm -f /etc/ssl/private/zulip.key /etc/ssl/certs/zulip.combined-chain.crt<br>
++ mktemp<br>
[...]<br>
Setting key "REMOTE_POSTGRES_HOST", type "string" in file "/etc/zulip/settings.py".<br>
Setting key "REMOTE_POSTGRES_SSLMODE", type "string" in file "/etc/zulip/settings.py".<br>
Database configuration succeeded.<br>
Setting Zulip secrets ...<br>
Generating Zulip secrets ...<br>
Generated Camo config file /etc/default/camo<br>
Generated new secrets in /etc/zulip/zulip-secrets.conf.<br>
Secrets generation succeeded.<br>
Zulip secrets configuration succeeded.<br>
Activating authentication backends ...<br>
Setting key "AUTHENTICATION_BACKENDS", type "array" in file "/etc/zulip/settings.py".<br>
Adding authentication backend "EmailAuthBackend".<br>
Authentication backend activation succeeded.<br>
Executing Zulip configuration ...<br>
Setting key "EXTERNAL_HOST", type "string" in file "/etc/zulip/settings.py".<br>
Setting key "EMAIL_HOST", type "string" in file "/etc/zulip/settings.py".<br>
Setting key "ALLOWED_HOSTS", type "array" in file "/etc/zulip/settings.py".<br>
Setting key "ZULIP_ADMINISTRATOR", type "string" in file "/etc/zulip/settings.py".<br>
Setting key "USE_X_FORWARDED_HOST", type "bool" in file "/etc/zulip/settings.py".<br>
Setting key "REDIS_HOST", type "string" in file "/etc/zulip/settings.py".<br>
Setting key "RABBITMQ_HOST", type "string" in file "/etc/zulip/settings.py".<br>
Setting key "EMAIL_HOST_USER", type "string" in file "/etc/zulip/settings.py".<br>
Setting key "MEMCACHED_LOCATION", type "string" in file "/etc/zulip/settings.py".<br>
Setting key "EMAIL_USE_SSL", type "bool" in file "/etc/zulip/settings.py".<br>
Setting key "EMAIL_USE_TLS", type "bool" in file "/etc/zulip/settings.py".<br>
Setting key "EMAIL_PORT", type "integer" in file "/etc/zulip/settings.py".<br>
Zulip configuration succeeded.<br>
Auto backup enabled.<br>
=== End Initial Configuration Phase ===<br>
=== Begin Bootstrap Phase ===<br>
Waiting for database server to allow connections ...<br>
Executing Zulip first start init ...<br>
+++ readlink -f /home/zulip/deployments/current/scripts/setup/initialize-database<br>
++ dirname /home/zulip/deployments/2018-08-27-20-28-29/scripts/setup/initialize-database<br>
+ THIS_DIR=/home/zulip/deployments/2018-08-27-20-28-29/scripts/setup<br>
+ cd /home/zulip/deployments/2018-08-27-20-28-29/scripts/setup/../..<br>
+ ./manage.py checkconfig<br>
+ ./manage.py migrate --noinput<br>
Operations to perform:<br>
  Apply all migrations: analytics, auth, confirmation, contenttypes, otp_static, otp_totp, sessions, sites, social_django, two_factor, &gt; zerver<br>
Running migrations:<br>
  Applying contenttypes.0001_initial... OK<br>
  Applying auth.0001_initial... OK<br>
  Applying zerver.0001_initial... OK<br>
  Applying zerver.0029_realm_subdomain... OK<br>
  Applying zerver.0030_realm_org_type... OK<br>
  Applying zerver.0031_remove_system_avatar_source... OK<br>
[....]<br>
  Applying zerver.0056_userprofile_emoji_alt_code... OK<br>
  Applying zerver.0057_realmauditlog... OK<br>
  Applying zerver.0058_realm_email_changes_disabled... OK<br>
  Applying zerver.0059_userprofile_quota... OK<br>
2018-08-28 20:37:37.618 ERR  [boto] Caught exception reading instance data<br>
Traceback (most recent call last):<br>
  File "/usr/lib/python3.5/urllib/request.py", line 1254, in do_open<br>
    h.request(req.get_method(), req.selector, req.data, headers)<br>
  File "/usr/lib/python3.5/http/client.py", line 1106, in request<br>
    self._send_request(method, url, body, headers)<br>
  File "/usr/lib/python3.5/http/client.py", line 1151, in _send_request<br>
    self.endheaders(body)<br>
  File "/usr/lib/python3.5/http/client.py", line 1102, in endheaders<br>
    self._send_output(message_body)<br>
  File "/usr/lib/python3.5/http/client.py", line 934, in _send_output<br>
    self.send(msg)<br>
  File "/usr/lib/python3.5/http/client.py", line 877, in send<br>
    self.connect()<br>
  File "/usr/lib/python3.5/http/client.py", line 849, in connect<br>
    (self.host,self.port), self.timeout, self.source_address)<br>
  File "/usr/lib/python3.5/socket.py", line 711, in create_connection<br>
    raise err<br>
  File "/usr/lib/python3.5/socket.py", line 702, in create_connection<br>
    sock.connect(sa)<br>
socket.timeout: timed out</p>
<p>During handling of the above exception, another exception occurred:</p>
<p>Traceback (most recent call last):<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/utils.py", line 217, in retry_url<br>
    r = opener.open(req, timeout=timeout)<br>
  File "/usr/lib/python3.5/urllib/request.py", line 466, in open<br>
    response = self._open(req, data)<br>
  File "/usr/lib/python3.5/urllib/request.py", line 484, in _open<br>
    '_open', req)<br>
  File "/usr/lib/python3.5/urllib/request.py", line 444, in _call_chain<br>
    result = func(*args)<br>
  File "/usr/lib/python3.5/urllib/request.py", line 1282, in http_open<br>
    return self.do_open(http.client.HTTPConnection, req)<br>
  File "/usr/lib/python3.5/urllib/request.py", line 1256, in do_open<br>
    raise URLError(err)<br>
urllib.error.URLError: &lt;urlopen error timed out&gt;<br>
2018-08-28 20:37:37.907 ERR  [boto] Unable to read instance data, giving up<br>
Traceback (most recent call last):<br>
  File "./manage.py", line 36, in &lt;module&gt;<br>
    execute_from_command_line(sys.argv)<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py", &gt; line 364, in execute_from_command_line<br>
    utility.execute()<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py", &gt; line 356, in execute<br>
    self.fetch_command(subcommand).run_from_argv(self.argv)<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py", line &gt; 283, in run_from_argv<br>
    self.execute(*args, **cmd_options)<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py", line &gt; 330, in execute<br>
    output = self.handle(*args, **options)<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/commands/migrate.&gt; py", line 204, in handle<br>
    fake_initial=fake_initial,<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py", line &gt; 115, in migrate<br>
    state = self._migrate_all_forwards(state, plan, full_plan, fake=fake, fake_initial=fake_initial)<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py", line &gt; 145, in _migrate_all_forwards<br>
    state = self.apply_migration(state, migration, fake=fake, fake_initial=fake_initial)<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py", line &gt; 244, in apply_migration<br>
    state = migration.apply(state, schema_editor)<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/migration.py", &gt; line 129, in apply<br>
    operation.database_forwards(self.app_label, schema_editor, old_state, project_state)<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/operations/special.&gt; py", line 193, in database_forwards<br>
    self.code(from_state.apps, schema_editor)<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zerver/migrations/0060_move_avatars_to_be_uid_based.py", line 56, in &gt; move_avatars_to_be_uid_based<br>
    conn = S3Connection(settings.S3_KEY, settings.S3_SECRET_KEY)<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/connection.py", line 194, in &gt; __init__<br>
    validate_certs=validate_certs, profile_name=profile_name)<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/connection.py", line 569, in &gt; __init__<br>
    host, config, self.provider, self._required_auth_capability())<br>
  File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/auth.py", line 1021, in &gt; get_auth_handler<br>
    'Check your credentials' % (len(names), str(names)))<br>
boto.exception.NoAuthHandlerFound: No handler was ready to authenticate. 1 handlers were checked. ['HmacAuthV1Handler'] Check your &gt; credentials<br>
  Applying zerver.0060_move_avatars_to_be_uid_based...Zulip first start database initi failed in "initialize-database" exit code 1. Exiting.</p>
</blockquote>



<a name="639801"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639801" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639801">(Aug 28 2018 at 21:07)</a>:</h4>
<p>So something with the database.</p>



<a name="639802"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639802" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639802">(Aug 28 2018 at 21:08)</a>:</h4>
<p>The docker-compose.yml file looks like this:</p>
<blockquote>
<p>version: '2'<br>
services:<br>
  database:<br>
    image: 'zulip/zulip-postgresql'<br>
    environment:<br>
      POSTGRES_DB: zulip<br>
      POSTGRES_USER: zulip<br>
      POSTGRES_PASSWORD: zulip<br>
    volumes:<br>
      - '/opt/docker/zulip/postgresql/data:/var/lib/postgresql/data:rw'<br>
  memcached:<br>
    image: '<a href="http://quay.io/sameersbn/memcached:latest" target="_blank" title="http://quay.io/sameersbn/memcached:latest">quay.io/sameersbn/memcached:latest</a>'<br>
    restart: always<br>
  rabbitmq:<br>
    image: 'rabbitmq:3.7.7'<br>
    hostname: zulip-rabbit<br>
    restart: always<br>
    environment:<br>
        RABBITMQ_DEFAULT_USER: 'zulip'<br>
        RABBITMQ_DEFAULT_PASS: 'zulip'<br>
    volumes:<br>
      - '/opt/docker/zulip/rabbitmq:/var/lib/rabbitmq:rw'<br>
  redis:<br>
    image: '<a href="http://quay.io/sameersbn/redis:latest" target="_blank" title="http://quay.io/sameersbn/redis:latest">quay.io/sameersbn/redis:latest</a>'<br>
    volumes:<br>
      - '/opt/docker/zulip/redis:/var/lib/redis:rw'<br>
  zulip:<br>
    image: 'zulip/docker-zulip:1.9.0-rc1-2'<br>
    build:<br>
      context: .<br>
      args:<br>
        # Change these if you want to build zulip from a different repo/branch<br>
        ZULIP_GIT_URL: <a href="https://github.com/zulip/zulip.git" target="_blank" title="https://github.com/zulip/zulip.git">https://github.com/zulip/zulip.git</a><br>
        ZULIP_GIT_REF: 1.9.0-rc1<br>
        # Set this up if you plan to use your own CA certificate bundle for building<br>
        # CUSTOM_CA_CERTIFICATES:<br>
    ports:<br>
      - '3300:80'<br>
      - '3343:443'<br>
    environment:<br>
        DB_HOST: 'database'<br>
        DB_HOST_PORT: '5432'<br>
        DB_USER: 'zulip'<br>
        SSL_CERTIFICATE_GENERATION: 'self-signed'<br>
        SETTING_MEMCACHED_LOCATION: 'memcached:11211'<br>
        SETTING_RABBITMQ_HOST: 'rabbitmq'<br>
        SETTING_REDIS_HOST: 'redis'<br>
        SECRETS_email_password: 'dddd'<br>
        SECRETS_rabbitmq_password: 'zulip'<br>
        SECRETS_postgres_password: 'zulip'<br>
        SECRETS_secret_key: 'REPLACE_WITH_SECURE_SECRET_KEY'<br>
        SETTING_EXTERNAL_HOST: '<a href="http://zulip.example.com" target="_blank" title="http://zulip.example.com">zulip.example.com</a>'<br>
        SETTING_ALLOWED_HOSTS: "['<a href="http://zulip.example.com" target="_blank" title="http://zulip.example.com">zulip.example.com</a>', '127.0.0.1']"<br>
        SETTING_USE_X_FORWARDED_HOST: 'True'<br>
        SETTING_ZULIP_ADMINISTRATOR: '<a href="mailto:admin@example.com" title="mailto:admin@example.com">admin@example.com</a>'<br>
        SETTING_EMAIL_HOST: '<a href="http://office.example.com" target="_blank" title="http://office.example.com">office.example.com</a>'  # e.g. <a href="http://smtp.example.com" target="_blank" title="http://smtp.example.com">smtp.example.com</a><br>
        SETTING_EMAIL_HOST_USER: '<a href="mailto:admin@example.com" title="mailto:admin@example.com">admin@example.com</a>'<br>
        SETTING_EMAIL_PORT: '587'<br>
      # It seems that the email server needs to use ssl or tls and can't be used without it<br>
        SETTING_EMAIL_USE_SSL: 'False'<br>
        SETTING_EMAIL_USE_TLS: 'True'<br>
        ZULIP_AUTH_BACKENDS: 'EmailAuthBackend'<br>
      # Uncomment this when configuring the mobile push notifications service<br>
      # SETTING_PUSH_NOTIFICATION_BOUNCER_URL: '<a href="https://push.zulipchat.com" target="_blank" title="https://push.zulipchat.com">https://push.zulipchat.com</a>'<br>
    volumes:<br>
      - '/opt/docker/zulip/zulip:/data:rw'&gt;</p>
</blockquote>



<a name="639803"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639803" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639803">(Aug 28 2018 at 21:09)</a>:</h4>
<p>It sorta looks like <code>settings.LOCAL_UPLOADS_DIR</code> is somehow missing its default value.</p>



<a name="639804"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639804" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639804">(Aug 28 2018 at 21:10)</a>:</h4>
<p>(That should be being set by default with no action on your part)</p>



<a name="639805"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639805" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639805">(Aug 28 2018 at 21:12)</a>:</h4>
<p>Can you do <code>docker-compose exec zulip bash</code> and then look at <code>/etc/zulip/settings.py</code> and see what it has for <code>LOCAL_UPLOADS_DIR</code>?</p>



<a name="639806"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639806" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639806">(Aug 28 2018 at 21:13)</a>:</h4>
<p>(AFK for a bit)</p>



<a name="639807"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639807" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639807">(Aug 28 2018 at 21:15)</a>:</h4>
<p>can't do <code>docker-compose exec zulip bash</code> cause the container does not start up.</p>



<a name="639808"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639808" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639808">(Aug 28 2018 at 21:16)</a>:</h4>
<p>I will go off for tonight (CET). Will keep looking tomorrow. Thanks already for your help!</p>
<p>What a shame this doe not just run through. But there is always something, isn't it ;-)</p>



<a name="639853"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639853" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Trost <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639853">(Aug 29 2018 at 08:00)</a>:</h4>
<p><span class="user-mention" data-user-id="8324">@Chris</span> You can do <code>docker cp CONTAINER_NAME:FILE_PATH .</code> to copy the file out of the container (even if it is stopped)</p>



<a name="639854"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639854" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Trost <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639854">(Aug 29 2018 at 08:16)</a>:</h4>
<p><span class="user-mention" data-user-id="8324">@Chris</span> Is that a fresh install?<br>
<span class="user-mention" data-user-id="7">@Tim Abbott</span> The problem seems to be that the rabbitmq takes too long to start so a check like for the database would be needed</p>



<a name="639855"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639855" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Trost <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639855">(Aug 29 2018 at 08:20)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> What is the full name of the <code>EmailAuthBackend</code> in the AUTHENTICATION_BACKENDS list?</p>



<a name="639856"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639856" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Trost <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639856">(Aug 29 2018 at 08:20)</a>:</h4>
<p>Should it still be like this in the <code>settings.py</code> or just <code>EmailAuthBackend</code>?</p>
<div class="codehilite"><pre><span></span>AUTHENTICATION_BACKENDS = (&#39;zproject.backends.EmailAuthBackend&#39;,)
</pre></div>



<a name="639857"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639857" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639857">(Aug 29 2018 at 08:27)</a>:</h4>
<p><span class="user-mention" data-user-id="77">@Alexander Trost</span> Thanks for the 'docker cp' tip. I managed to get the setting.py file from the zulip container.</p>
<blockquote>
<p>REMOTE_POSTGRES_HOST = 'database'<br>
REMOTE_POSTGRES_SSLMODE = 'prefer'<br>
AUTHENTICATION_BACKENDS = ('zproject.backends.EmailAuthBackend',)<br>
EXTERNAL_HOST = '<a href="http://zulip.example.com" target="_blank" title="http://zulip.example.com">zulip.example.com</a>'<br>
EMAIL_HOST = '<a href="http://office.example.com" target="_blank" title="http://office.example.com">office.example.com</a>'<br>
ALLOWED_HOSTS = ['<a href="http://zulip.example.com" target="_blank" title="http://zulip.example.com">zulip.example.com</a>', '127.0.0.1']<br>
ZULIP_ADMINISTRATOR = '<a href="mailto:admin@example.com" title="mailto:admin@example.com">admin@example.com</a>'<br>
USE_X_FORWARDED_HOST = True<br>
REDIS_HOST = 'redis'<br>
RABBITMQ_HOST = 'rabbitmq'<br>
EMAIL_HOST_USER = '<a href="mailto:admin@example.com" title="mailto:admin@example.com">admin@example.com</a>'<br>
MEMCACHED_LOCATION = 'memcached:11211'<br>
EMAIL_USE_SSL = False<br>
EMAIL_USE_TLS = True<br>
EMAIL_PORT = 587</p>
</blockquote>



<a name="639858"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639858" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639858">(Aug 29 2018 at 08:28)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> It does not seem to have the Setting <code>LOCAL_UPLOADS_DIR</code></p>



<a name="639937"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/639937" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#639937">(Aug 29 2018 at 14:14)</a>:</h4>
<p><span class="user-mention" data-user-id="77">@Alexander Trost</span> <span class="user-mention" data-user-id="7">@Tim Abbott</span> Just let me know if you need anything else. Please just know that I am travelling tomorrow so might not come back before Friday.</p>



<a name="640076"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640076" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640076">(Aug 29 2018 at 19:55)</a>:</h4>
<p><span class="user-mention" data-user-id="77">@Alexander Trost</span> </p>
<blockquote>
<p><span class="user-mention" data-user-id="8324">@Chris</span> Is that a fresh install?</p>
</blockquote>
<p>Yes, it was a fresh docker install.<br>
But there were other docker instances running on the same machine. Is there something else I could do? Really would like to keep trying to get this running in Docker <span class="emoji emoji-1f642" title="slight smile">:slight_smile:</span></p>



<a name="640082"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640082" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640082">(Aug 29 2018 at 21:21)</a>:</h4>
<p><span class="user-mention" data-user-id="77">@Alexander Trost</span> does the Docker image generate its <code>/etc/zulip/settings.py</code> by first copying <code>prod_settings_template.py</code> and then adding things, or does it do something else?</p>



<a name="640162"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640162" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Trost <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640162">(Aug 30 2018 at 11:00)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span>  No it used the one that was created during build. So this commit "broke" it as there is no <code>prod_settings_template.py</code> copying in the <code>entrypoint.sh</code>, see <a href="https://github.com/zulip/docker-zulip/commit/62bf74190be763535b21d2032c2dd279bd31da38" target="_blank" title="https://github.com/zulip/docker-zulip/commit/62bf74190be763535b21d2032c2dd279bd31da38">https://github.com/zulip/docker-zulip/commit/62bf74190be763535b21d2032c2dd279bd31da38</a></p>



<a name="640163"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640163" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Trost <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640163">(Aug 30 2018 at 11:02)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Fix would be to add a <code>cp /home/zulip/.../prod_settings_template.py /etc/zulip/settings.py</code> as I'm understanding from you now, right?</p>



<a name="640359"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640359" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640359">(Aug 31 2018 at 04:21)</a>:</h4>
<p><span class="user-mention" data-user-id="77">@Alexander Trost</span> yes, that should be correct; can you try testing that?</p>



<a name="640433"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640433" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Nagy <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640433">(Aug 31 2018 at 10:53)</a>:</h4>
<p><code>AUTH_LDAP_USER_SEARCH</code> seems to be initialized with <code>LDAPSearch</code> which is not imported in <code>settings.py</code>. Maybe this is related to this issue?</p>



<a name="640524"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640524" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640524">(Aug 31 2018 at 17:52)</a>:</h4>
<p><span class="user-mention" data-user-id="9021">@Peter Nagy</span> I think that's possibly right; since <code>prod_settings_template.py</code> is where that gets imported...</p>



<a name="640616"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640616" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Trost <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640616">(Aug 31 2018 at 21:19)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Yes, I should be able to do that during the weekend.</p>



<a name="640618"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640618" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640618">(Aug 31 2018 at 21:20)</a>:</h4>
<p><span class="user-mention" data-user-id="77">@Alexander Trost</span> I merged an attempt at doing that which seems to work; probably worth your verifying though</p>



<a name="640702"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640702" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640702">(Sep 01 2018 at 12:16)</a>:</h4>
<p>Just let me know if / when I can help by reinstalling the docker image</p>



<a name="640789"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640789" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640789">(Sep 02 2018 at 03:05)</a>:</h4>
<p>Now's a great time to test</p>



<a name="640963"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640963" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640963">(Sep 03 2018 at 09:35)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-id="77">@Alexander Trost</span> It was not successful yet.<br>
I tried docker-compose pull and docker-compose up again with the following output:</p>
<p>ck@server:/opt/docker-compose/docker-zulip$ docker-compose up<br>
Starting docker-zulip_zulip_1     ... done<br>
Starting docker-zulip_rabbitmq_1  ... done<br>
Starting docker-zulip_memcached_1 ... done<br>
Starting docker-zulip_database_1  ... done<br>
Starting docker-zulip_redis_1     ... done<br>
Attaching to docker-zulip_rabbitmq_1, docker-zulip_zulip_1, docker-zulip_memcached_1, docker-zulip_database_1, docker-zulip_redis_1<br>
zulip_1      | === Begin Initial Configuration Phase ===<br>
zulip_1      | Preparing and linking the uploads folder ...<br>
zulip_1      | Prepared and linked the uploads directory.<br>
zulip_1      | Executing nginx configuration ...<br>
zulip_1      | Nginx configuration succeeded.<br>
zulip_1      | Certificates configuration succeeded.<br>
zulip_1      | Setting database configuration ...<br>
zulip_1      | Setting key "REMOTE_POSTGRES_HOST", type "string" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "REMOTE_POSTGRES_SSLMODE", type "string" in file "/etc/zulip/settings.py".<br>
zulip_1      | Database configuration succeeded.<br>
zulip_1      | Setting Zulip secrets ...<br>
zulip_1      | Secrets already generated/existing.<br>
redis_1      | Starting redis-server...<br>
redis_1      | 1:C 03 Sep 09:34:24.294 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo<br>
redis_1      | 1:C 03 Sep 09:34:24.294 # Redis version=4.0.9, bits=64, commit=00000000, modified=0, pid=1, just started<br>
redis_1      | 1:C 03 Sep 09:34:24.294 # Configuration loaded<br>
redis_1      |                 _._                                                  <br>
redis_1      |            _.-<code>__ ''-._                                             
redis_1      |       _.-</code>    <code>.  </code>_.  ''-._           Redis 4.0.9 (00000000/0) 64 bit<br>
redis_1      |   .-<code> .-```.  ```\/    _.,_ ''-._                                   
redis_1      |  (    '      ,       .-`  | `,    )     Running in standalone mode
redis_1      |  |`-._`-...-` __...-.</code>-._|'<code> _.-'|     Port: 6379
redis_1      |  |    </code>-._   <code>._    /     _.-'    |     PID: 1
redis_1      |   </code>-._    <code>-._  </code>-./  _.-'    _.-'                                   <br>
redis_1      |  |<code>-._</code>-._    <code>-.__.-'    _.-'_.-'|                                  
redis_1      |  |    </code>-._<code>-._        _.-'_.-'    |           http://redis.io        
redis_1      |   </code>-._    <code>-._</code>-.__.-'_.-'    _.-'                                   <br>
redis_1      |  |<code>-._</code>-._    <code>-.__.-'    _.-'_.-'|                                  
redis_1      |  |    </code>-._<code>-._        _.-'_.-'    |                                  
redis_1      |   </code>-._    <code>-._</code>-.__.-'_.-'    _.-'                                   <br>
redis_1      |       <code>-._    </code>-.__.-'    _.-'                                       <br>
redis_1      |           <code>-._        _.-'                                           
redis_1      |               </code>-.__.-'                                               <br>
redis_1      | <br>
redis_1      | 1:M 03 Sep 09:34:24.303 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.<br>
redis_1      | 1:M 03 Sep 09:34:24.303 # Server initialized<br>
redis_1      | 1:M 03 Sep 09:34:24.303 # WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.<br>
redis_1      | 1:M 03 Sep 09:34:24.303 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.<br>
redis_1      | 1:M 03 Sep 09:34:24.336 * DB loaded from disk: 0.032 seconds<br>
redis_1      | 1:M 03 Sep 09:34:24.336 * Ready to accept connections<br>
redis_1      | 1:M 03 Sep 09:34:24.336 * The server is now ready to accept connections at /var/run/redis/redis-server.sock<br>
zulip_1      | Zulip secrets configuration succeeded.<br>
zulip_1      | Activating authentication backends ...<br>
zulip_1      | Setting key "AUTHENTICATION_BACKENDS", type "array" in file "/etc/zulip/settings.py".<br>
zulip_1      | Adding authentication backend "EmailAuthBackend".<br>
zulip_1      | Authentication backend activation succeeded.<br>
zulip_1      | Executing Zulip configuration ...<br>
zulip_1      | Setting key "EXTERNAL_HOST", type "string" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "EMAIL_HOST", type "string" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "ALLOWED_HOSTS", type "array" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "ZULIP_ADMINISTRATOR", type "string" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "USE_X_FORWARDED_HOST", type "bool" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "REDIS_HOST", type "string" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "RABBITMQ_HOST", type "string" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "EMAIL_HOST_USER", type "string" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "MEMCACHED_LOCATION", type "string" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "EMAIL_USE_SSL", type "bool" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "EMAIL_USE_TLS", type "bool" in file "/etc/zulip/settings.py".<br>
zulip_1      | Setting key "EMAIL_PORT", type "integer" in file "/etc/zulip/settings.py".<br>
database_1   | 2018-09-03 09:34:25.319 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432<br>
database_1   | 2018-09-03 09:34:25.319 UTC [1] LOG:  listening on IPv6 address "::", port 5432<br>
database_1   | 2018-09-03 09:34:25.507 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"<br>
rabbitmq_1   | 2018-09-03 09:34:25.594 [info] &lt;0.33.0&gt; Application lager started on node 'rabbit@zulip-rabbit'<br>
database_1   | 2018-09-03 09:34:26.132 UTC [25] LOG:  database system was shut down at 2018-09-03 09:07:10 UTC<br>
database_1   | 2018-09-03 09:34:26.493 UTC [1] LOG:  database system is ready to accept connections<br>
rabbitmq_1   | 2018-09-03 09:34:27.865 [info] &lt;0.33.0&gt; Application mnesia started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.865 [info] &lt;0.33.0&gt; Application crypto started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.865 [info] &lt;0.33.0&gt; Application recon started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.865 [info] &lt;0.33.0&gt; Application jsx started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.866 [info] &lt;0.33.0&gt; Application os_mon started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.866 [info] &lt;0.33.0&gt; Application xmerl started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.867 [info] &lt;0.33.0&gt; Application inets started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.867 [info] &lt;0.33.0&gt; Application asn1 started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.867 [info] &lt;0.33.0&gt; Application public_key started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.868 [info] &lt;0.33.0&gt; Application ssl started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.868 [info] &lt;0.33.0&gt; Application ranch started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.868 [info] &lt;0.33.0&gt; Application ranch_proxy_protocol started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.868 [info] &lt;0.33.0&gt; Application rabbit_common started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:27.868 [info] &lt;0.230.0&gt; <br>
rabbitmq_1   |  Starting RabbitMQ 3.7.7 on Erlang 20.3.8.3<br>
rabbitmq_1   |  Copyright (C) 2007-2018 Pivotal Software, Inc.<br>
rabbitmq_1   |  Licensed under the MPL.  See <a href="http://www.rabbitmq.com/" target="_blank" title="http://www.rabbitmq.com/">http://www.rabbitmq.com/</a><br>
rabbitmq_1   | <br>
rabbitmq_1   |   ##  ##<br>
rabbitmq_1   |   ##  ##      RabbitMQ 3.7.7. Copyright (C) 2007-2018 Pivotal Software, Inc.<br>
rabbitmq_1   |   ##########  Licensed under the MPL.  See <a href="http://www.rabbitmq.com/" target="_blank" title="http://www.rabbitmq.com/">http://www.rabbitmq.com/</a><br>
rabbitmq_1   |   ######  ##<br>
rabbitmq_1   |   ##########  Logs: &lt;stdout&gt;<br>
rabbitmq_1   | <br>
rabbitmq_1   |               Starting broker...<br>
rabbitmq_1   | 2018-09-03 09:34:27.869 [info] &lt;0.230.0&gt; <br>
rabbitmq_1   |  node           : rabbit@zulip-rabbit<br>
rabbitmq_1   |  home dir       : /var/lib/rabbitmq<br>
rabbitmq_1   |  config file(s) : /etc/rabbitmq/rabbitmq.conf<br>
rabbitmq_1   |  cookie hash    : X4cGfaItX6dhi+addW4ndg==<br>
rabbitmq_1   |  log(s)         : &lt;stdout&gt;<br>
rabbitmq_1   |  database dir   : /var/lib/rabbitmq/mnesia/rabbit@zulip-rabbit<br>
rabbitmq_1   | 2018-09-03 09:34:27.884 [info] &lt;0.263.0&gt; Memory high watermark set to 6380 MiB (6690642329 bytes) of 15951 MiB (16726605824 bytes) total<br>
rabbitmq_1   | 2018-09-03 09:34:27.886 [info] &lt;0.265.0&gt; Enabling free disk space monitoring<br>
rabbitmq_1   | 2018-09-03 09:34:27.886 [info] &lt;0.265.0&gt; Disk free limit set to 50MB<br>
rabbitmq_1   | 2018-09-03 09:34:27.888 [info] &lt;0.267.0&gt; Limiting to approx 1048476 file handles (943626 sockets)<br>
rabbitmq_1   | 2018-09-03 09:34:27.888 [info] &lt;0.268.0&gt; FHC read buffering:  OFF<br>
rabbitmq_1   | 2018-09-03 09:34:27.888 [info] &lt;0.268.0&gt; FHC write buffering: ON<br>
rabbitmq_1   | 2018-09-03 09:34:27.889 [info] &lt;0.230.0&gt; Waiting for Mnesia tables for 30000 ms, 9 retries left<br>
rabbitmq_1   | 2018-09-03 09:34:28.177 [info] &lt;0.230.0&gt; Waiting for Mnesia tables for 30000 ms, 9 retries left<br>
rabbitmq_1   | 2018-09-03 09:34:28.177 [info] &lt;0.230.0&gt; Peer discovery backend rabbit_peer_discovery_classic_config does not support registration, skipping registration.<br>
rabbitmq_1   | 2018-09-03 09:34:28.178 [info] &lt;0.230.0&gt; Priority queues enabled, real BQ is rabbit_variable_queue<br>
rabbitmq_1   | 2018-09-03 09:34:28.271 [info] &lt;0.294.0&gt; Starting rabbit_node_monitor<br>
rabbitmq_1   |</p>



<a name="640964"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640964" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640964">(Sep 03 2018 at 09:36)</a>:</h4>
<p>rabbitmq_1   | 2018-09-03 09:34:28.178 [info] &lt;0.230.0&gt; Priority queues enabled, real BQ is rabbit_variable_queue<br>
rabbitmq_1   | 2018-09-03 09:34:28.271 [info] &lt;0.294.0&gt; Starting rabbit_node_monitor<br>
rabbitmq_1   | 2018-09-03 09:34:28.292 [info] &lt;0.322.0&gt; Making sure data directory '/var/lib/rabbitmq/mnesia/rabbit@zulip-rabbit/msg_stores/vhosts/628WB79CIFDYO9LJI6DKMI09L' for vhost '/' exists<br>
rabbitmq_1   | 2018-09-03 09:34:28.395 [info] &lt;0.322.0&gt; Starting message stores for vhost '/'<br>
rabbitmq_1   | 2018-09-03 09:34:28.396 [info] &lt;0.326.0&gt; Message store "628WB79CIFDYO9LJI6DKMI09L/msg_store_transient": using rabbit_msg_store_ets_index to provide index<br>
rabbitmq_1   | 2018-09-03 09:34:28.398 [info] &lt;0.322.0&gt; Started message store of type transient for vhost '/'<br>
rabbitmq_1   | 2018-09-03 09:34:28.398 [info] &lt;0.329.0&gt; Message store "628WB79CIFDYO9LJI6DKMI09L/msg_store_persistent": using rabbit_msg_store_ets_index to provide index<br>
rabbitmq_1   | 2018-09-03 09:34:28.401 [info] &lt;0.322.0&gt; Started message store of type persistent for vhost '/'<br>
rabbitmq_1   | 2018-09-03 09:34:28.455 [info] &lt;0.369.0&gt; started TCP Listener on [::]:5672<br>
rabbitmq_1   | 2018-09-03 09:34:28.456 [info] &lt;0.230.0&gt; Setting up a table for connection tracking on this node: 'tracked_connection_on_node_rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:28.456 [info] &lt;0.230.0&gt; Setting up a table for per-vhost connection counting on this node: 'tracked_connection_per_vhost_on_node_rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:28.457 [info] &lt;0.33.0&gt; Application rabbit started on node 'rabbit@zulip-rabbit'<br>
rabbitmq_1   | 2018-09-03 09:34:28.593 [info] &lt;0.5.0&gt; Server startup complete; 0 plugins started.<br>
rabbitmq_1   |  completed with 0 plugins.<br>
zulip_1      | Zulip configuration succeeded.<br>
zulip_1      | Auto backup enabled.<br>
zulip_1      | === End Initial Configuration Phase ===<br>
zulip_1      | === Begin Bootstrap Phase ===<br>
zulip_1      | Waiting for database server to allow connections ...<br>
zulip_1      | Executing Zulip first start init ...<br>
zulip_1      | +++ readlink -f /home/zulip/deployments/current/scripts/setup/initialize-database<br>
zulip_1      | ++ dirname /home/zulip/deployments/2018-08-27-20-28-29/scripts/setup/initialize-database<br>
zulip_1      | + THIS_DIR=/home/zulip/deployments/2018-08-27-20-28-29/scripts/setup<br>
zulip_1      | + cd /home/zulip/deployments/2018-08-27-20-28-29/scripts/setup/../..<br>
zulip_1      | + ./manage.py checkconfig<br>
zulip_1      | + ./manage.py migrate --noinput<br>
zulip_1      | Operations to perform:<br>
zulip_1      |   Apply all migrations: analytics, auth, confirmation, contenttypes, otp_static, otp_totp, sessions, sites, social_django, two_factor, zerver<br>
zulip_1      | Running migrations:<br>
rabbitmq_1   | 2018-09-03 09:34:39.467 [info] &lt;0.375.0&gt; accepting AMQP connection &lt;0.375.0&gt; (172.28.0.3:46832 -&gt; 172.28.0.2:5672)<br>
rabbitmq_1   | 2018-09-03 09:34:39.470 [info] &lt;0.375.0&gt; connection &lt;0.375.0&gt; (172.28.0.3:46832 -&gt; 172.28.0.2:5672): user 'zulip' authenticated and granted access to vhost '/'<br>
zulip_1      |   Applying zerver.0060_move_avatars_to_be_uid_based...2018-09-03 09:34:39.301 ERR  [boto] Caught exception reading instance data<br>
zulip_1      | Traceback (most recent call last):<br>
zulip_1      |   File "/usr/lib/python3.5/urllib/request.py", line 1254, in do_open<br>
zulip_1      |     h.request(req.get_method(), req.selector, req.data, headers)<br>
zulip_1      |   File "/usr/lib/python3.5/http/client.py", line 1106, in request<br>
zulip_1      |     self._send_request(method, url, body, headers)<br>
zulip_1      |   File "/usr/lib/python3.5/http/client.py", line 1151, in _send_request<br>
zulip_1      |     self.endheaders(body)<br>
zulip_1      |   File "/usr/lib/python3.5/http/client.py", line 1102, in endheaders<br>
zulip_1      |     self._send_output(message_body)<br>
zulip_1      |   File "/usr/lib/python3.5/http/client.py", line 934, in _send_output<br>
zulip_1      |     self.send(msg)<br>
zulip_1      |   File "/usr/lib/python3.5/http/client.py", line 877, in send<br>
zulip_1      |     self.connect()<br>
zulip_1      |   File "/usr/lib/python3.5/http/client.py", line 849, in connect<br>
zulip_1      |     (self.host,self.port), self.timeout, self.source_address)<br>
zulip_1      |   File "/usr/lib/python3.5/socket.py", line 711, in create_connection<br>
zulip_1      |     raise err<br>
zulip_1      |   File "/usr/lib/python3.5/socket.py", line 702, in create_connection<br>
zulip_1      |     sock.connect(sa)<br>
zulip_1      | socket.timeout: timed out<br>
zulip_1      | <br>
zulip_1      | During handling of the above exception, another exception occurred:<br>
zulip_1      | <br>
zulip_1      | Traceback (most recent call last):<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/utils.py", line 217, in retry_url<br>
zulip_1      |     r = opener.open(req, timeout=timeout)<br>
zulip_1      |   File "/usr/lib/python3.5/urllib/request.py", line 466, in open<br>
zulip_1      |     response = self._open(req, data)<br>
zulip_1      |   File "/usr/lib/python3.5/urllib/request.py", line 484, in _open<br>
zulip_1      |     '_open', req)<br>
zulip_1      |   File "/usr/lib/python3.5/urllib/request.py", line 444, in _call_chain<br>
zulip_1      |     result = func(*args)<br>
zulip_1      |   File "/usr/lib/python3.5/urllib/request.py", line 1282, in http_open<br>
zulip_1      |     return self.do_open(http.client.HTTPConnection, req)<br>
zulip_1      |   File "/usr/lib/python3.5/urllib/request.py", line 1256, in do_open<br>
zulip_1      |     raise URLError(err)<br>
zulip_1      | urllib.error.URLError: &lt;urlopen error timed out&gt;<br>
zulip_1      | 2018-09-03 09:34:39.485 ERR  [boto] Unable to read instance data, giving up<br>
zulip_1      | Traceback (most recent call last):<br>
zulip_1      |   File "./manage.py", line 36, in &lt;module&gt;<br>
zulip_1      |     execute_from_command_line(sys.argv)<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py", line 364, in execute_from_command_line<br>
zulip_1      |     utility.execute()<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/__init__.py", line 356, in execute<br>
zulip_1      |     self.fetch_command(subcommand).run_from_argv(self.argv)<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py", line 283, in run_from_argv<br>
zulip_1      |     self.execute(*args, **cmd_options)<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/base.py", line 330, in execute<br>
zulip_1      |     output = self.handle(*args, **options)<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/core/management/commands/migrate.py", line 204, in handle<br>
zulip_1      |     fake_initial=fake_initial,<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py", line 115, in migrate<br>
zulip_1      |     state = self._migrate_all_forwards(state, plan, full_plan, fake=fake, fake_initial=fake_initial)<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py", line 145, in _migrate_all_forwards<br>
zulip_1      |     state = self.apply_migration(state, migration, fake=fake, fake_initial=fake_initial)<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/executor.py", line 244, in apply_migration<br>
zulip_1      |     state = migration.apply(state, schema_editor)<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/migration.py", line 129, in apply<br>
zulip_1      |     operation.database_forwards(self.app_label, schema_editor, old_state, project_state)<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/django/db/migrations/operations/special.py", line 193, in database_forwards<br>
zulip_1      |     self.code(from_state.apps, schema_editor)<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zerver/migrations/0060_move_avatars_to_be_uid_based.py", line 56, in move_avatars_to_be_uid_based<br>
zulip_1      |     conn = S3Connection(settings.S3_KEY, settings.S3_SECRET_KEY)<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/s3/connection.py", line 194, in __init__<br>
zulip_1      |     validate_certs=validate_certs, profile_name=profile_name)<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/connection.py", line 569, in __init__<br>
zulip_1      |     host, config, self.provider, self._required_auth_capability())<br>
zulip_1      |   File "/home/zulip/deployments/2018-08-27-20-28-29/zulip-py3-venv/lib/python3.5/site-packages/boto/auth.py", line 1021, in get_auth_handler<br>
zulip_1      |     'Check your credentials' % (len(names), str(names)))<br>
zulip_1      | boto.exception.NoAuthHandlerFound: No handler was ready to authenticate. 1 handlers were checked. ['HmacAuthV1Handler'] Check your credentials<br>
rabbitmq_1   | 2018-09-03 09:34:39.736 [warning] &lt;0.375.0&gt; closing AMQP connection &lt;0.375.0&gt; (172.28.0.3:46832 -&gt; 172.28.0.2:5672, vhost: '/', user: 'zulip'):<br>
rabbitmq_1   | client unexpectedly closed TCP connection<br>
zulip_1      | Zulip first start database initi failed in "initialize-database" exit code 1. Exiting.<br>
docker-zulip_zulip_1 exited with code 1</p>



<a name="640965"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/640965" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#640965">(Sep 03 2018 at 09:37)</a>:</h4>
<p>So looks like still an issue with the database.</p>



<a name="641176"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/641176" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#641176">(Sep 04 2018 at 16:49)</a>:</h4>
<p><span class="user-mention" data-user-id="3028">@chris</span> did you rebase to the latest version of <code>docker-zulip</code> first?</p>



<a name="642347"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/642347" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#642347">(Sep 10 2018 at 08:34)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-id="77">@Alexander Trost</span> I got a slot for testing again. The install of the Zulip Docker image seems to have worked. I have problem with my Nginx Reverse proxy and will need to fix that to a proper configuration. Will let you know once done successfully.</p>



<a name="642349"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/642349" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#642349">(Sep 10 2018 at 09:08)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-id="77">@Alexander Trost</span> The Zulip Docker image works. I think there is an error in the documentation for the docker image running behind a reverse proxy (Nginx):</p>
<p><a href="https://github.com/zulip/docker-zulip/wiki/Proxying-via-nginx-on-host-machine" target="_blank" title="https://github.com/zulip/docker-zulip/wiki/Proxying-via-nginx-on-host-machine">https://github.com/zulip/docker-zulip/wiki/Proxying-via-nginx-on-host-machine</a></p>
<p>In my opinion the proxy_pass must go to port 80 and not port 443. The "double SSL proxy" does not work in my opinion.<br>
Therefore the nginx configuration file should be:  </p>
<div class="codehilite"><pre><span></span>    location / {
          proxy_pass  http://127.0.0.1:8088;    # Port that docker-zulip is listening on
   }
</pre></div>


<p>instead of  </p>
<div class="codehilite"><pre><span></span>    location / {
            proxy_pass  https://127.0.0.1:8089;    # Port that docker-zulip is listening on
  }
</pre></div>


<p>What do you think? Please advise in case my proposal should be insecure.</p>
<p>Edit: At least the proxy_pass to port 80 makes it work on my system.</p>



<a name="642354"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/642354" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#642354">(Sep 10 2018 at 09:30)</a>:</h4>
<p>-</p>



<a name="642774"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/642774" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#642774">(Sep 11 2018 at 22:38)</a>:</h4>
<p><span class="user-mention" data-user-id="2915">@chris</span> hmm, I don't think proxying to port 80 should be required there.</p>



<a name="811599"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811599" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amrish Ilyas <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811599">(Jan 24 2020 at 21:26)</a>:</h4>
<p>Dear all, I was, too, trying to get a docker instance up and running, and was following the steps given in <a href="https://github.com/zulip/docker-zulip" target="_blank" title="https://github.com/zulip/docker-zulip">https://github.com/zulip/docker-zulip</a> 1:1.</p>
<p>After configuring and giving the server a <code>docker-compose up -d</code>, the server, indeed, does "print a bunch of output" (as written in the instructions on how to set this up), only it does so for 5+ minutes and eventually finishes this way:</p>
<div class="codehilite"><pre><span></span>writing to /home/zulip/zulip/var/6d74d8a6-9e1a-45ec-9921-1dbdcddf43b4/provision_version

Zulip development environment setup succeeded!

WARNING: This shell does not have the Zulip Python 3 virtualenv activated.
Zulip commands will fail until you activate the virtualenv.

To update the shell, run:
    source /srv/zulip-py3-venv/bin/activate
or just close this shell and start a new one (with Vagrant, `vagrant ssh`).
</pre></div>


<p>I'm not sure what "This shell" he is talking about; my server (host) does not have a /srv/zulipy-py3-venv/bin/... directory, and the Zulip container is not actually running at this point, so I can't get into its own shell. When looking from another shell on the host, I can see that the docker-zulip is not running:</p>
<div class="codehilite"><pre><span></span>ilyas@v16384:~$ sudo docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</pre></div>


<p>And, uh, despite having given him the <code>-d</code> option, it does not return to shell, just hangs.</p>
<p>Just like <span class="user-mention" data-user-id="14112">@Raju Devidas</span> , I'm trying to get this working for the third day in a row (meanwhile, I gave up on trying it via Plesk the GUI way).</p>
<p>Is there anyone out there with ideas about this? What am I missing? I have no clue at this point anymore. <span aria-label="hurt" class="emoji emoji-1f915" role="img" title="hurt">:hurt:</span></p>



<a name="811610"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811610" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811610">(Jan 24 2020 at 21:42)</a>:</h4>
<p><span class="user-mention" data-user-id="14507">@Amrish Ilyas</span> can you provide more output?  Those lines are part of the setup process for a Zulip development environment, which might appear as part of building your own image.</p>



<a name="811611"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811611" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811611">(Jan 24 2020 at 21:42)</a>:</h4>
<p>Are you not using <code>docker-compose pull</code> to use the prebuilt images?</p>



<a name="811619"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811619" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amrish Ilyas <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811619">(Jan 24 2020 at 21:48)</a>:</h4>
<p>Yes I did <code>docker-compose pull</code>, exactly as in <a href="https://github.com/zulip/docker-zulip" target="_blank" title="https://github.com/zulip/docker-zulip">https://github.com/zulip/docker-zulip</a>. And then <code>docker-compose up -d</code>. It was not my intention to set up a <strong>development environment</strong>, btw.</p>
<p>I let it run and it went on, like 30 or so minutes later. It is still spitting out stuff. Shall report back soon.</p>



<a name="811621"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811621" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811621">(Jan 24 2020 at 21:49)</a>:</h4>
<p>OK, if you can upload a file containing the log output from running it, that'd be helpful.</p>



<a name="811623"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811623" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811623">(Jan 24 2020 at 21:49)</a>:</h4>
<p>A <code>docker-compose build</code> will certainly spend a while building the image if you have slow Internet.</p>



<a name="811624"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811624" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811624">(Jan 24 2020 at 21:50)</a>:</h4>
<p>And <code>docker-compose up</code> will generally build an image if one hasn't been pulled.</p>



<a name="811692"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811692" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amrish Ilyas <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811692">(Jan 24 2020 at 22:32)</a>:</h4>
<p>Alright, it went on and finished by now. (I can't connect to the Zulip server, but that's another story I will be following up later.)</p>
<p>Here's the terminal output (where, I hope, you can see I followed the instructions): <a href="https://pastebin.com/dPemGasn" target="_blank" title="https://pastebin.com/dPemGasn">https://pastebin.com/dPemGasn</a> (beware, it's the whole stuff!)</p>
<p>From here:</p>
<div class="codehilite"><pre><span></span>ilyas@v16384:~/docker-zulip$ sudo docker-compose pull
[sudo] Passwort für ilyas:
WARNING: The GVqF variable is not set. Defaulting to a blank string.
Pulling database  ... done
Pulling memcached ... done
Pulling rabbitmq  ... done
Pulling redis     ... done
</pre></div>


<p>...it seems it didn't pull the docker-zulip image itself, so next thing it said it is going to build it:</p>
<div class="codehilite"><pre><span></span>ilyas@v16384:~/docker-zulip$ sudo docker-compose up -d
WARNING: The GVqF variable is not set. Defaulting to a blank string.
**Building zulip**
</pre></div>



<a name="811693"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811693" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amrish Ilyas <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811693">(Jan 24 2020 at 22:40)</a>:</h4>
<p>PS, something seems to be missing, no?:</p>
<div class="codehilite"><pre><span></span>ilyas@v16384:~/docker-zulip$ sudo docker ps
CONTAINER ID        IMAGE                       COMMAND                  CREATED             STATUS              PORTS                                                        NAMES
df2f56ee703e        memcached:alpine            <span class="s2">&quot;docker-entrypoint.s…&quot;</span>   <span class="m">34</span> minutes ago      Up <span class="m">34</span> minutes       <span class="m">11211</span>/tcp                                                    docker-zulip_memcached_1
a37a7067273e        zulip/zulip-postgresql:10   <span class="s2">&quot;docker-entrypoint.s…&quot;</span>   <span class="m">34</span> minutes ago      Up <span class="m">34</span> minutes       <span class="m">5432</span>/tcp                                                     docker-zulip_database_1
a001dbe4e2f1        redis:alpine                <span class="s2">&quot;docker-entrypoint.s…&quot;</span>   <span class="m">34</span> minutes ago      Up <span class="m">34</span> minutes       <span class="m">6379</span>/tcp                                                     docker-zulip_redis_1
034fc0de4706        rabbitmq:3.7.7              <span class="s2">&quot;docker-entrypoint.s…&quot;</span>   <span class="m">34</span> minutes ago      Up <span class="m">34</span> minutes       <span class="m">4369</span>/tcp, <span class="m">5671</span>-5672/tcp, <span class="m">25672</span>/tcp         docker-zulip_rabbitmq_1
</pre></div>



<a name="811721"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811721" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811721">(Jan 25 2020 at 01:10)</a>:</h4>
<p>I'm guessing the issue is whatever caused this to be displayed:<br>
<code>WARNING: The GVqF variable is not set. Defaulting to a blank string.</code></p>



<a name="811722"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811722" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811722">(Jan 25 2020 at 01:11)</a>:</h4>
<p>That could be an issue with your changes to the docker-compose.yml?</p>



<a name="811723"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811723" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811723">(Jan 25 2020 at 01:11)</a>:</h4>
<p><span class="user-mention" data-user-id="14507">@Amrish Ilyas</span> for me, <code>docker-compose pull</code> doesn't display that warning and does download a <code>zulip</code> container image as well as the others.</p>



<a name="811725"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811725" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811725">(Jan 25 2020 at 01:12)</a>:</h4>
<p>Correct output from the <code>docker-compose pull</code> command should look like this:</p>
<div class="codehilite"><pre><span></span>tabbott@coset:~/docker-zulip$ docker-compose pull
Pulling redis (redis:alpine)...
alpine: Pulling from library/redis
Digest: sha256:cb9783b1c39bb34f8d6572406139ab325c4fac0b28aaa25d5350495637bb2f76
Status: Image is up to date for redis:alpine
Pulling zulip (zulip/docker-zulip:2.1.2-0)...
2.1.2-0: Pulling from zulip/docker-zulip
Digest: sha256:4f86a2c12b02cd36621a1461628bd3fdaa72d416c1cbef7085c28486245d2f17
Status: Image is up to date for zulip/docker-zulip:2.1.2-0
Pulling memcached (memcached:alpine)...
alpine: Pulling from library/memcached
Digest: sha256:a5937f7b44e7482c6119fe53e8b6ed62241e222f5ef92407a9085ca16742b396
Status: Image is up to date for memcached:alpine
Pulling rabbitmq (rabbitmq:3.7.7)...
3.7.7: Pulling from library/rabbitmq
Digest: sha256:a8094b952b9fe778f4e70efaca98494e167088ef3272944a28b89caf6e098790
Status: Image is up to date for rabbitmq:3.7.7
Pulling database (zulip/zulip-postgresql:10)...
10: Pulling from zulip/zulip-postgresql
Digest: sha256:7541f451aa8e6f7b91cb860a4dee33105e3da28693d0e06431c30792939c1d6e
Status: Image is up to date for zulip/zulip-postgresql:10
</pre></div>


<p>(Well, if you run it twice)</p>



<a name="811781"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811781" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amrish Ilyas <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811781">(Jan 25 2020 at 08:08)</a>:</h4>
<blockquote>
<p>That could be an issue with your changes to the docker-compose.yml?</p>
</blockquote>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span>  Oh, I only set all the passwords, external host, email stuff and ports. Can you identify a problem here? -&gt; <a href="https://pastebin.com/P0jRFVnj" target="_blank" title="https://pastebin.com/P0jRFVnj">https://pastebin.com/P0jRFVnj</a> (erased the email settings for obvious reasons). I did look up how to set the containers exposed ports right (container:host or host:container), but maybe I got it the wrong way. Wouldn't think that's the reason for this, though. :/</p>
<p>Couldn't find anything about a GVqF variable anywhere. It's a standard Ubuntu 18.04 LTS vhost I'm trying to get this set up (w/ enough RAM, really). Docker-compose is version 1.25.0, build 0a186604. Docker itself is version 19.03.5, build 633a0ea838.</p>
<p>Just as a side note, I did set up a Zulip server on real hardware for my organization, and it's phantastic. Love it very much, you are doing a great job!!</p>



<a name="811928"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811928" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811928">(Jan 26 2020 at 06:18)</a>:</h4>
<p><span class="user-mention" data-user-id="14507">@Amrish Ilyas</span> OK, I think I see what the problem is.  The <code>GVqF</code> variable is I think coming from the fact that your redis password in that file has some special characters in it that aren't being escaped properly when going through Docker's environment variable system <span aria-label="frown" class="emoji emoji-1f641" role="img" title="frown">:frown:</span>.  Let me open an issue for this bug.  <span class="user-mention" data-user-id="699">@Anders Kaseorg</span> FYI.</p>



<a name="811929"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/811929" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#811929">(Jan 26 2020 at 06:22)</a>:</h4>
<p><a href="https://github.com/zulip/docker-zulip/issues/238" target="_blank" title="https://github.com/zulip/docker-zulip/issues/238">https://github.com/zulip/docker-zulip/issues/238</a></p>



<a name="812113"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/812113" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amrish Ilyas <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#812113">(Jan 26 2020 at 17:04)</a>:</h4>
<p>Thank you Tim. I wouldn't have looked for a "GVqF variable" in my own strings...</p>
<p>For this to get finally going, I changed all the passwords to letters and numbers only (after removing all containers and images for a fresh start). The error does not come up anymore, but for some odd reason, the Zulip docker image was still not getting pulled... <span aria-label="dizzy" class="emoji emoji-1f635" role="img" title="dizzy">:dizzy:</span></p>
<p>I had to remove / outcomment the following lines from <code>docker-compose.yml</code>to finally have it pulled along with the other images:</p>
<div class="codehilite"><pre><span></span>    <span class="nt">build</span><span class="p">:</span>
      <span class="nt">context</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.</span>
      <span class="nt">args</span><span class="p">:</span>
        <span class="c1"># Change these if you want to build zulip from a different repo/branch</span>
        <span class="nt">ZULIP_GIT_URL</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/zulip/zulip.git</span>
        <span class="nt">ZULIP_GIT_REF</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2.1.2</span>
</pre></div>



<a name="812123"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/812123" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#812123">(Jan 26 2020 at 23:52)</a>:</h4>
<p><span class="user-mention" data-user-id="14507">@Amrish Ilyas</span> what version of <code>docker-compose</code> are you using?</p>



<a name="812124"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/812124" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#812124">(Jan 26 2020 at 23:52)</a>:</h4>
<p>It may be that Docker changed its defaults for whether to prefer building over using a pulled image, and that's the source of the discrepancy.</p>



<a name="812272"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/812272" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amrish Ilyas <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#812272">(Jan 27 2020 at 07:23)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> It's <code>docker-compose version 1.25.0, build 0a186604</code>.</p>
<p>Under "New Features" for this version, <a href="https://docs.docker.com/release-notes/docker-compose/" target="_blank" title="https://docs.docker.com/release-notes/docker-compose/">they write</a>: "Pulling only of images that cannot be built". Maybe that's it.</p>



<a name="812571"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/docker-compose%20install/near/812571" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/docker-compose.20install.html#812571">(Jan 27 2020 at 23:24)</a>:</h4>
<p><span class="user-mention" data-user-id="14507">@Amrish Ilyas</span> I see, it does sound like that new feature makes it impossible to provide configuration for building an email without editing <code>docker-compose.yml</code> while also allowing pulling.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>