<html>
<head><meta charset="utf-8"><title>CSRF verification failed · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/CSRF.20verification.20failed.html">CSRF verification failed</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1597049"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/CSRF%20verification%20failed/near/1597049" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SimonD <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/CSRF.20verification.20failed.html#1597049">(Jun 22 2023 at 10:03)</a>:</h4>
<p>Hello,</p>
<p>Thanks for your support.</p>
<p>I've seen this post too.<br>
But our nginx is correclty configured (verified twice) and proxy headers are present...</p>
<p>So I don't understand where the proble coms from...</p>
<p>I know the security issue, but our Zulip instance is only internal instance (no public access anymore). So I've applied it.</p>
<p>Thanks</p>



<a name="1597153"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/CSRF%20verification%20failed/near/1597153" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/CSRF.20verification.20failed.html#1597153">(Jun 22 2023 at 14:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="12178">Alex Vandiver</span> has marked this topic as unresolved.</p>



<a name="1597154"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/CSRF%20verification%20failed/near/1597154" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/CSRF.20verification.20failed.html#1597154">(Jun 22 2023 at 14:17)</a>:</h4>
<p><span class="user-mention" data-user-id="27256">@SimonD</span>: Having <code>localhost</code> in <code>CSRF_TRUSTED_ORIGINS</code> exposes your users to attacks which can very easily steal their data.  If you do nothing else, please remove <code>http://127.0.0.1</code> and <code>http://localhost</code> from <code>CSRF_TRUSTED_ORIGINS</code>.  They are not helping your problem, and are <em>very</em> exploitable configuration.  It does not matter if your Zulip instance is not public -- that configuration makes that moot.</p>
<p>If you look at <code>/var/log/nginx/access.log</code>, do you see requests always coming from the same IP address?  Do you have the IP address of your proxy set in <code>/etc/zulip/zulip.conf</code>?</p>



<a name="1603543"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/CSRF%20verification%20failed/near/1603543" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SimonD <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/CSRF.20verification.20failed.html#1603543">(Jul 04 2023 at 10:08)</a>:</h4>
<p>Hi,<br>
Sorry for my late reply.<br>
Yes I see IP address of incomming connection (not always the same)<br>
Regards,</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>