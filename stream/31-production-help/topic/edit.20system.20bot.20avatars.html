<html>
<head><meta charset="utf-8"><title>edit system bot avatars · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html">edit system bot avatars</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="639361"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/639361" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#639361">(Aug 28 2018 at 07:15)</a>:</h4>
<p>Hi,<br>
where can we change the avatars / icons for the system bots, such as Welcome bot and Notification bot?</p>



<a name="639567"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/639567" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#639567">(Aug 28 2018 at 17:02)</a>:</h4>
<p>Are these editable or at least configurable, or should we just look for the references from the source code and replace the images?</p>



<a name="639568"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/639568" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#639568">(Aug 28 2018 at 17:05)</a>:</h4>
<p>They aren't editable/configurable at the moment, though there is a project to make that happen</p>



<a name="639569"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/639569" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#639569">(Aug 28 2018 at 17:05)</a>:</h4>
<p>for now just replacing the images in the source is the best bet</p>



<a name="639586"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/639586" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#639586">(Aug 28 2018 at 18:02)</a>:</h4>
<p>right. so they're also cross-realm</p>



<a name="639587"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/639587" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#639587">(Aug 28 2018 at 18:02)</a>:</h4>
<p>thanks</p>



<a name="1262971"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1262971" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kendall Martin <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1262971">(Oct 05 2021 at 14:40)</a>:</h4>
<p>Is there a way by now to use custom avatars for system bots? I haven't been able to find it. I'd like upload a custom image for Notification bot because <a href="http://gravatar.com">gravatar.com</a> is being blocked on my system and so it doesn't display properly.</p>



<a name="1262990"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1262990" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1262990">(Oct 05 2021 at 16:07)</a>:</h4>
<p><span class="user-mention" data-user-id="14101">@Kendall Martin</span> it's likely possible with shell access to the Zulip server by just calling the upload code:</p>
<div class="codehilite"><pre><span></span><code>        user_profile = get_system_bot(settings.NOTIFICATION_BOT)
        user_file = ... # Get the data
        upload_avatar_image(user_file, user_profile, user_profile)
        avatar_source = UserProfile.AVATAR_FROM_USER
        do_change_avatar_fields(user_profile, avatar_source, acting_user=user_profile)
</code></pre></div>



<a name="1262991"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1262991" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1262991">(Oct 05 2021 at 16:07)</a>:</h4>
<p>(totally untested)</p>



<a name="1262992"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1262992" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1262992">(Oct 05 2021 at 16:07)</a>:</h4>
<p>If this is Zulip Cloud, probably we should test that flow and then do that for the system bots for everyone.</p>



<a name="1461550"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1461550" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Frankowski <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1461550">(Nov 09 2022 at 11:45)</a>:</h4>
<p>Hi,<br>
any progress with this possibility?<br>
I tried mentioned code but got an error:</p>
<div class="codehilite"><pre><span></span><code>In [3]: upload_avatar_image(user_file, user_profile, user_profile)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
&lt;ipython-input-3-f2c9c9f553fc&gt; in &lt;cell line: 1&gt;()
----&gt; 1 upload_avatar_image(user_file, user_profile, user_profile)

NameError: name &#39;upload_avatar_image&#39; is not defined
</code></pre></div>
<p>How to manage with changing system bot avatars?</p>



<a name="1461693"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1461693" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1461693">(Nov 09 2022 at 20:02)</a>:</h4>
<p><span class="user-mention" data-user-id="25186">@Adam Frankowski</span> you need to import that function; run <code>from zerver.lib.upload import *</code> first.</p>



<a name="1462144"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1462144" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Adam Frankowski <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1462144">(Nov 10 2022 at 09:58)</a>:</h4>
<p>I figured it in the meantime but faced another problem:</p>
<div class="codehilite"><pre><span></span><code>In [7]:         upload_avatar_image(user_file, user_profile, user_profile)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
&lt;ipython-input-7-f2c9c9f553fc&gt; in &lt;cell line: 1&gt;()
----&gt; 1 upload_avatar_image(user_file, user_profile, user_profile)

~/deployments/2022-11-04-14-35-10/zerver/lib/upload.py in upload_avatar_image(user_file, acting_user_profile, target_user_profile, content_type)
   1070     content_type: Optional[str] = None,
   1071 ) -&gt; None:
-&gt; 1072     upload_backend.upload_avatar_image(
   1073         user_file, acting_user_profile, target_user_profile, content_type=content_type
   1074     )

~/deployments/2022-11-04-14-35-10/zerver/lib/upload.py in upload_avatar_image(self, user_file, acting_user_profile, target_user_profile, content_type)
    899         file_path = user_avatar_path(target_user_profile)
    900
--&gt; 901         image_data = user_file.read()
    902         self.write_avatar_images(file_path, image_data)
    903

AttributeError: &#39;str&#39; object has no attribute &#39;read&#39;
</code></pre></div>
<p>I tried to define content type as "image/png" but error message is the same.</p>



<a name="1462363"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1462363" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1462363">(Nov 10 2022 at 19:18)</a>:</h4>
<p><span class="user-mention" data-user-id="25186">@Adam Frankowski</span> the <code>user_file</code> argument is supposed to be a Python File object, not a string.</p>



<a name="1642869"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1642869" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philipp Huebner <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1642869">(Sep 19 2023 at 14:49)</a>:</h4>
<p>Hi, are there any plans to make this more easily accessible?</p>



<a name="1643260"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1643260" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1643260">(Sep 19 2023 at 19:31)</a>:</h4>
<p><span class="user-mention" data-user-id="22107">@Philipp Huebner</span> yes, though it's sorta a larger project -- we want to move the system bots to be per-realm, rather than global per-server, and then it should be possible to enable managing their avatars.</p>



<a name="1643503"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1643503" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philipp Huebner <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1643503">(Sep 20 2023 at 06:33)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Looking forward to that! We now managed to to set the internal bots' avatars via django shell, but it seems both a server restart and a client restart are necessary for the small version left of messages to be correctly shown, whereas the large version when you view the bots' profile pages is updated right away.</p>



<a name="1643505"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1643505" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Philipp Huebner <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1643505">(Sep 20 2023 at 06:35)</a>:</h4>
<p>We did it this way:</p>
<div class="codehilite"><pre><span></span><code>from zerver.lib.upload import *
from zerver.actions.user_settings import *
user_profile = get_system_bot(settings.NOTIFICATION_BOT, 1)
user_file = open(&quot;/tmp/some_file.png&quot;, &quot;rb&quot;)
upload_avatar_image(user_file, user_profile, user_profile)
avatar_source = UserProfile.AVATAR_FROM_USER
do_change_avatar_fields(user_profile, avatar_source, acting_user=user_profile)
</code></pre></div>



<a name="1644883"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/edit%20system%20bot%20avatars/near/1644883" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/edit.20system.20bot.20avatars.html#1644883">(Sep 21 2023 at 19:20)</a>:</h4>
<p>Yeah that's probably a caching thing; system bots are not in any realm which likely breaks the live update logic.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>