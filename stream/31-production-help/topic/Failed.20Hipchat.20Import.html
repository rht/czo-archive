<html>
<head><meta charset="utf-8"><title>Failed Hipchat Import · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html">Failed Hipchat Import</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="674702"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/674702" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Mitchell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#674702">(Dec 20 2018 at 22:55)</a>:</h4>
<p>I posted this here: <a href="https://github.com/zulip/zulip/issues/11099" target="_blank" title="https://github.com/zulip/zulip/issues/11099">https://github.com/zulip/zulip/issues/11099</a>, but I probably should have posted here.</p>
<p>Recently ran the Hipchat import into Zulip. Went pretty much without a hitch. However, all of the file attachments are showing broken link(s) despite being located in the directories to which the link is referencing. (For instance https://{myhostname}/user_uploads/1/GqBt9KPBWKVraAGWAbr7LXNC/upload.png shows as a broken link, even though the file exists in /home/zulip/uploads/files/1/GqBt9KPBWKVraAGWAbr7LXNC).<br>
I tried going in and adding all of the files to the zulip.zerver_attachment table (they weren't in there). But no effect. Is this a bug or am I doing it wrong?</p>



<a name="674703"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/674703" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#674703">(Dec 20 2018 at 23:40)</a>:</h4>
<p><span class="user-mention" data-user-id="10725">@Keith Mitchell</span> thanks for the report! Are you running on 1.9, 1.9.1, or the latest master? There's been a lot of recent work on the import, so all 3 of those will likely have different behavior :).</p>
<p>The person who knows most about this is travelling, but will hopefully see this in not too long.</p>



<a name="674704"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/674704" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#674704">(Dec 20 2018 at 23:42)</a>:</h4>
<p>also to answer your question, it is a bug; the intended behavior is for attachments to work without further action needed</p>



<a name="674705"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/674705" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Mitchell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#674705">(Dec 20 2018 at 23:45)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="131">@Rishi Gupta</span> thank you, it's "zulip_version":"1.9.1"</p>



<a name="674715"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/674715" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#674715">(Dec 21 2018 at 03:31)</a>:</h4>
<p><span class="user-mention" data-user-id="10725">@Keith Mitchell</span> I would recommend following our advice of upgrading to master before doing a HipChat import, which it sounds like you didn't do?</p>



<a name="674716"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/674716" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#674716">(Dec 21 2018 at 03:31)</a>:</h4>
<p>I don't remember this bug specifically, but in general we've fixed a number of bugs since 1.9.1.</p>



<a name="674728"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/674728" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Mitchell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#674728">(Dec 21 2018 at 04:00)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span>  I just followed the instructions here: <a href="https://zulip.readthedocs.io/en/stable/production/index.html" target="_blank" title="https://zulip.readthedocs.io/en/stable/production/index.html">https://zulip.readthedocs.io/en/stable/production/index.html</a></p>
<p>Didn't see anything in there about upgrading to master.  I just downloaded this tarball per the instructions.<br>
<a href="https://www.zulip.org/dist/releases/zulip-server-latest.tar.gz" target="_blank" title="https://www.zulip.org/dist/releases/zulip-server-latest.tar.gz">https://www.zulip.org/dist/releases/zulip-server-latest.tar.gz</a></p>



<a name="674729"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/674729" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Mitchell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#674729">(Dec 21 2018 at 04:04)</a>:</h4>
<p>But now that I'm looking over the instructions again, I see this section in the <a href="https://zulipchat.com/help/import-from-hipchat" target="_blank" title="https://zulipchat.com/help/import-from-hipchat">https://zulipchat.com/help/import-from-hipchat</a> page, "Because the import tool is very new, you will need to upgrade your Zulip server to the latest master branch, using  upgrade-zulip-from-git."</p>
<p>Will go back and start over.</p>



<a name="675117"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675117" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Mitchell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675117">(Dec 21 2018 at 20:21)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-id="131">@Rishi Gupta</span> redid the import, and now all of the linked files are there, but the only chat history I can see are my side of the conversation from Hipchat.  I'm the only user in our Zulip instance right now.  Is this normal behavior?</p>



<a name="675129"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675129" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675129">(Dec 21 2018 at 20:26)</a>:</h4>
<p>interesting!</p>



<a name="675130"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675130" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675130">(Dec 21 2018 at 20:26)</a>:</h4>
<p>thanks again for the report; will likely have to wait for Tim</p>



<a name="675149"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675149" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675149">(Dec 21 2018 at 21:15)</a>:</h4>
<blockquote>
<p>Because the import tool is very new, you will need to upgrade your Zulip server to the latest master branch, using  upgrade-zulip-from-git.</p>
</blockquote>
<p>This probably should be said at step 0 until it is no longer beta.</p>



<a name="675150"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675150" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675150">(Dec 21 2018 at 21:18)</a>:</h4>
<p>Probably that implicit requirement has tripped some people.</p>



<a name="675151"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675151" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Mitchell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675151">(Dec 21 2018 at 21:22)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-id="131">@Rishi Gupta</span> as a follow-up, it appears the import in master only imported conversations for hipchat guest users and myself (since I was already in the organization), although I did the import with the --destroy-rebuild-database switch.  Will try again with the --import-into-nonempty before wiping everything and starting over from scratch.</p>



<a name="675153"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675153" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675153">(Dec 21 2018 at 21:35)</a>:</h4>
<p>It looks like <span class="user-mention" data-user-id="58">@Steve Howell</span> is not subscribed to this stream.</p>



<a name="675407"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675407" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Mitchell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675407">(Dec 22 2018 at 22:45)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-id="131">@Rishi Gupta</span> As a follow up to my follow up, starting over from scratch produced the same results as doing a re-import using the master branch from github did in my original environment.  Only MY messages and files were imported, even though when setting up the new instance I did NOT use my e-mail address in any of the setup steps.  (I am the admin for the HipChat instance).</p>



<a name="675408"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675408" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675408">(Dec 22 2018 at 22:48)</a>:</h4>
<p>Unfortunately things are a bit slow over the holidays; hopefully we'll be able to get back to you soon though. Sounds almost surely to be a bug in the import tool.</p>



<a name="675487"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675487" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675487">(Dec 23 2018 at 12:15)</a>:</h4>
<p><span class="user-mention" data-user-id="10725">@Keith Mitchell</span> can you provide a bit more detail on how you're checking that only your messages/files were imported?</p>



<a name="675488"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675488" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675488">(Dec 23 2018 at 12:16)</a>:</h4>
<p>One possibility here is that stream messages are imported, but your subscriptions are not being properly imported, so you need to go to "manage streams" and subscribe to the streams you want in order to see the history.</p>



<a name="675500"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675500" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675500">(Dec 23 2018 at 12:34)</a>:</h4>
<p>(The main thing that's a bit janky with the hipchat import tool is that HipChat doesn't export which users were in which public rooms, and I'm curious if that's actually what's going on here and we just need to document it, or what)</p>



<a name="675666"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/675666" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Mitchell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#675666">(Dec 23 2018 at 21:25)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> in every single stream I'm a member of, I only see messages from me in each stream.  Had someone else join the Zulip instance, and they saw no message history whatsoever.</p>
<p>On another note.  Redid everything for the third time, but did the import on the 1.9.1 release version then upgraded to GIT Master.  Attachments in streams are now fixed, but avatars are broken.  Not the end of the world, it's a lot better now.</p>



<a name="676255"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/676255" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#676255">(Dec 28 2018 at 01:48)</a>:</h4>
<p><span class="user-mention" data-user-id="10725">@Keith Mitchell</span> ahh, yeah, you have to upgrade before doing the import.  I believe avatars being imported incorrectly is the main open bug in master.  <span class="user-mention" data-user-id="58">@Steve Howell</span> I believe the plan was that you'd clean up and fix the coverage issues before we merged.  Instead I've added nocoverage tags and merged as <a href="https://github.com/zulip/zulip/commit/c995e8e2ae7dcb4a3fa94a437de6530c5732e94e" target="_blank" title="https://github.com/zulip/zulip/commit/c995e8e2ae7dcb4a3fa94a437de6530c5732e94e">c995e8e2ae7dcb4a3fa94a437de6530c5732e94e</a>.  <span class="user-mention" data-user-id="1113">@Aditya Bansal</span> do you have time to do the refactoring and tests for the nocoverage code added there?  I think it should be similar to other upload backend tests you've written.</p>



<a name="676256"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/676256" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#676256">(Dec 28 2018 at 01:48)</a>:</h4>
<p><span class="user-mention" data-user-id="10725">@Keith Mitchell</span> you should be able to resync from master and get a version with avatars importing properly.  Sorry for the trouble!</p>



<a name="676312"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Failed%20Hipchat%20Import/near/676312" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aditya Bansal <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Failed.20Hipchat.20Import.html#676312">(Dec 28 2018 at 03:06)</a>:</h4>
<p>Sure <span class="user-mention" data-user-id="7">@Tim Abbott</span> <br>
Will let you know when I have a PR ready :)</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>