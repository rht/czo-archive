<html>
<head><meta charset="utf-8"><title>✔ Upgrade to latest 5.0 Dev · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Upgrade.20to.20latest.205.2E0.20Dev.html">✔ Upgrade to latest 5.0 Dev</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1274409"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Upgrade%20to%20latest%205.0%20Dev/near/1274409" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Upgrade.20to.20latest.205.2E0.20Dev.html#1274409">(Oct 30 2021 at 08:53)</a>:</h4>
<p>How is the best way to keep up to date to latest Dev branch 5.x. I see my version is different than the one used here:  Version 5.0-dev-2500-g73710e1cf0 <br>
Version 5.0-dev-1042-g906a75ac00 - My release.</p>



<a name="1274410"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Upgrade%20to%20latest%205.0%20Dev/near/1274410" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Upgrade.20to.20latest.205.2E0.20Dev.html#1274410">(Oct 30 2021 at 08:53)</a>:</h4>
<p>Then I receive in end: </p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>Done <span class="k">in</span> <span class="m">16</span>.53s.
Using cached node modules from /srv/zulip-npm-cache/680c6a7db98f77c92735f335580e85ff7acc2193/node_modules
+ ./tools/setup/emoji/build_emoji
build_emoji: Using cached emojis from /srv/zulip-emoji-cache/6b1c0aff5d7a20084dc50f56491b07237b1ac5ec/emoji
+ ./scripts/setup/inline_email_css.py
+ ./tools/setup/generate_zulip_bots_static_files.py
+ ./tools/setup/build_pygments_data
/home/zulip/deployments/2021-10-30-08-49-58/zulip-py3-venv/lib/python3.8/site-packages/traitlets/config/loader.py:795: SyntaxWarning: <span class="s2">"is"</span> with a literal. Did you mean <span class="s2">"=="</span>?
  <span class="k">if</span> len<span class="o">(</span>key<span class="o">)</span> is <span class="m">1</span>:
/home/zulip/deployments/2021-10-30-08-49-58/zulip-py3-venv/lib/python3.8/site-packages/traitlets/config/loader.py:804: SyntaxWarning: <span class="s2">"is"</span> with a literal. Did you mean <span class="s2">"=="</span>?
  <span class="k">if</span> len<span class="o">(</span>key<span class="o">)</span> is <span class="m">1</span>:
+ ./tools/setup/build_timezone_values
+ ./tools/webpack --quiet
<span class="o">(</span>node:2130706<span class="o">)</span> V8: /srv/zulip-npm-cache/680c6a7db98f77c92735f335580e85ff7acc2193/node_modules/ttf2woff2/jssrc/ttf2woff2.js:3 Invalid asm.js: Invalid member of stdlib
<span class="o">(</span>Use <span class="sb">`</span>node --trace-warnings ...<span class="sb">`</span> to show where the warning was created<span class="o">)</span>

Error running a subcommand of ./tools/update-prod-static: ./tools/webpack --quiet
Actual error output <span class="k">for</span> the subcommand is just above this.

Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"/home/zulip/deployments/2021-10-30-08-49-58/scripts/lib/upgrade-zulip-stage-2"</span>, line <span class="m">220</span>, <span class="k">in</span> &lt;module&gt;
    subprocess.check_call<span class="o">([</span><span class="s2">"./tools/update-prod-static"</span><span class="o">]</span>, <span class="nv">preexec_fn</span><span class="o">=</span>su_to_zulip<span class="o">)</span>
  File <span class="s2">"/usr/lib/python3.8/subprocess.py"</span>, line <span class="m">364</span>, <span class="k">in</span> check_call
    raise CalledProcessError<span class="o">(</span>retcode, cmd<span class="o">)</span>
subprocess.CalledProcessError: Command <span class="s1">'['</span>./tools/update-prod-static<span class="s1">']'</span> returned non-zero <span class="nb">exit</span> status <span class="m">1</span>.

Zulip upgrade failed <span class="o">(</span><span class="nb">exit</span> code <span class="m">1</span><span class="o">)</span>!

The upgrade process is designed to be idempotent, so you can retry after resolving whatever issue caused the failure <span class="o">(</span>there should be a traceback above<span class="o">)</span>. A log of this installation is available <span class="k">in</span> /var/log/zulip/upgrade.log
</code></pre></div>



<a name="1274413"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Upgrade%20to%20latest%205.0%20Dev/near/1274413" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Upgrade.20to.20latest.205.2E0.20Dev.html#1274413">(Oct 30 2021 at 10:43)</a>:</h4>
<p><span class="user-mention" data-user-id="20576">@Cosmic Sound</span> That version numbering corresponds to running the <code>main</code> branch (because 5.0 hasn't been released yet). Can you show the specific command you're running when you get this error?</p>
<p>The expected way to upgrade to the latest state of the <code>main</code> branch would be as in <a href="https://zulip.readthedocs.io/en/latest/production/upgrade-or-modify.html#upgrading-from-a-git-repository">https://zulip.readthedocs.io/en/latest/production/upgrade-or-modify.html#upgrading-from-a-git-repository</a> :</p>
<div class="codehilite"><pre><span></span><code>/home/zulip/deployments/current/scripts/upgrade-zulip-from-git main
</code></pre></div>



<a name="1274416"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Upgrade%20to%20latest%205.0%20Dev/near/1274416" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Upgrade.20to.20latest.205.2E0.20Dev.html#1274416">(Oct 30 2021 at 11:11)</a>:</h4>
<p><span class="user-mention" data-user-id="10349">@Mateusz Mandera</span>  yes I have runned same command:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>/home/zulip/deployments/current/scripts/upgrade-zulip-from-git main
</code></pre></div>



<a name="1274422"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Upgrade%20to%20latest%205.0%20Dev/near/1274422" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Upgrade.20to.20latest.205.2E0.20Dev.html#1274422">(Oct 30 2021 at 11:31)</a>:</h4>
<p><span class="user-mention" data-user-id="20576">@Cosmic Sound</span> Hmm, are you running the upgrade with the server up? I wonder if this could be the server running out of memory, since it can demonstrate in this way and is common during the <code>webpack</code> stage. You could try running the upgrade after <code>supervisorctl stop all</code></p>



<a name="1274428"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Upgrade%20to%20latest%205.0%20Dev/near/1274428" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Upgrade.20to.20latest.205.2E0.20Dev.html#1274428">(Oct 30 2021 at 11:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="10349">Mateusz Mandera</span>  I think you were right!</p>



<a name="1274583"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Upgrade%20to%20latest%205.0%20Dev/near/1274583" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Upgrade.20to.20latest.205.2E0.20Dev.html#1274583">(Nov 01 2021 at 09:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="10349">Mateusz Mandera</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>