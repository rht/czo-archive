<html>
<head><meta charset="utf-8"><title>Error after timezone change · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Error.20after.20timezone.20change.html">Error after timezone change</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="950049"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Error%20after%20timezone%20change/near/950049" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cesar Celis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Error.20after.20timezone.20change.html#950049">(Jul 23 2020 at 14:31)</a>:</h4>
<p>Hello everyone, first of all, sorry if my problem has been answered before: I installed zulip 3.0 in Ubuntu 20.04 LTS, everything went smooth until today. All services in just one server running fine. Minutes ago, i had to change the IP server 192.168.1.79 to 192.168.1.80.<br>
After that there's no zulip services...</p>



<a name="950070"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Error%20after%20timezone%20change/near/950070" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cesar Celis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Error.20after.20timezone.20change.html#950070">(Jul 23 2020 at 15:04)</a>:</h4>
<div class="codehilite"><pre><span></span><code>root@vms-ftp-zulip:/var/log/zulip# supervisorctl status all
process-fts-updates                                             RUNNING   pid 32617, uptime 0:09:24
zulip-django                                                    RUNNING   pid 32615, uptime 0:09:24
zulip-tornado                                                   RUNNING   pid 32616, uptime 0:09:24
zulip-workers:zulip_deliver_enqueued_emails                     RUNNING   pid 32633, uptime 0:09:24
zulip-workers:zulip_deliver_scheduled_messages                  RUNNING   pid 32634, uptime 0:09:24
zulip-workers:zulip_events_deferred_work                        RUNNING   pid 32618, uptime 0:09:24
zulip-workers:zulip_events_digest_emails                        RUNNING   pid 32619, uptime 0:09:24
zulip-workers:zulip_events_email_mirror                         RUNNING   pid 32620, uptime 0:09:24
zulip-workers:zulip_events_email_senders                        RUNNING   pid 32625, uptime 0:09:24
zulip-workers:zulip_events_embed_links                          RUNNING   pid 32621, uptime 0:09:24
zulip-workers:zulip_events_embedded_bots                        RUNNING   pid 32622, uptime 0:09:24
zulip-workers:zulip_events_error_reports                        RUNNING   pid 32623, uptime 0:09:24
zulip-workers:zulip_events_invites                              RUNNING   pid 32624, uptime 0:09:24
zulip-workers:zulip_events_missedmessage_emails                 RUNNING   pid 32626, uptime 0:09:24
zulip-workers:zulip_events_missedmessage_mobile_notifications   RUNNING   pid 32627, uptime 0:09:24
zulip-workers:zulip_events_outgoing_webhooks                    RUNNING   pid 32628, uptime 0:09:24
zulip-workers:zulip_events_signups                              RUNNING   pid 32629, uptime 0:09:24
zulip-workers:zulip_events_user_activity                        RUNNING   pid 32630, uptime 0:09:24
zulip-workers:zulip_events_user_activity_interval               RUNNING   pid 32631, uptime 0:09:24
zulip-workers:zulip_events_user_presence                        RUNNING   pid 32632, uptime 0:09:24
root@vms-ftp-zulip:/var/log/zulip#
</code></pre></div>



<a name="950071"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Error%20after%20timezone%20change/near/950071" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cesar Celis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Error.20after.20timezone.20change.html#950071">(Jul 23 2020 at 15:06)</a>:</h4>
<p>All services seems to be running ok, of course error.log shows:</p>
<div class="codehilite"><pre><span></span><code>  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/contrib/sessions/backends/base.py&quot;, line 65, in get
    return self._session.get(key, default)
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/contrib/sessions/backends/base.py&quot;, line 194, in _get_session
    self._session_cache = self.load()
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/contrib/sessions/backends/cached_db.py&quot;, line 35, in load
    s = self._get_session_from_db()
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/contrib/sessions/backends/db.py&quot;, line 32, in _get_session_from_db
    return self.model.objects.get(
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/db/models/manager.py&quot;, line 82, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/db/models/query.py&quot;, line 402, in get
    num = len(clone)
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/db/models/query.py&quot;, line 256, in __len__
    self._fetch_all()
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/db/models/query.py&quot;, line 1242, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/db/models/query.py&quot;, line 55, in __iter__
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/db/models/sql/compiler.py&quot;, line 1173, in execute_sql
    return list(result)
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/db/models/sql/compiler.py&quot;, line 1552, in cursor_iter
    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/db/models/sql/compiler.py&quot;, line 1552, in &lt;lambda&gt;
    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/db/utils.py&quot;, line 96, in inner
    return func(*args, **kwargs)
  File &quot;/srv/zulip-venv-cache/21952fdbf83c32a04953681b368a5aaf116934fe/zulip-py3-venv/lib/python3.8/site-packages/django/db/backends/postgresql/utils.py&quot;, line 6, in utc_tzinfo_factory
    raise AssertionError(&quot;database connection isn&#39;t set to UTC&quot;)
AssertionError: database connection isn&#39;t set to UTC
</code></pre></div>



<a name="950079"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Error%20after%20timezone%20change/near/950079" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cesar Celis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Error.20after.20timezone.20change.html#950079">(Jul 23 2020 at 15:23)</a>:</h4>
<p>I can't find any IP neither than localhost in any configuration file, so... i'm lost.</p>



<a name="950370"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Error%20after%20timezone%20change/near/950370" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Error.20after.20timezone.20change.html#950370">(Jul 23 2020 at 17:38)</a>:</h4>
<p><span class="user-mention" data-user-id="10549">@Cesar Celis</span> that looks to be some sort of locale issue -- not one I've seen before.</p>



<a name="950374"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Error%20after%20timezone%20change/near/950374" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Error.20after.20timezone.20change.html#950374">(Jul 23 2020 at 17:39)</a>:</h4>
<p><a href="https://stackoverflow.com/questions/38807296/django-1-9-2-assertionerror-database-connection-isnt-set-to-utc">https://stackoverflow.com/questions/38807296/django-1-9-2-assertionerror-database-connection-isnt-set-to-utc</a> may be helpful.</p>



<a name="950945"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Error%20after%20timezone%20change/near/950945" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cesar Celis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Error.20after.20timezone.20change.html#950945">(Jul 23 2020 at 21:13)</a>:</h4>
<p>Well, <span class="user-mention" data-user-id="7">@Tim Abbott</span> you solved. Thanks.!</p>



<a name="950978"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Error%20after%20timezone%20change/near/950978" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cesar Celis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Error.20after.20timezone.20change.html#950978">(Jul 23 2020 at 21:52)</a>:</h4>
<p>Don't you think this should be documented?</p>



<a name="951217"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Error%20after%20timezone%20change/near/951217" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Error.20after.20timezone.20change.html#951217">(Jul 24 2020 at 00:44)</a>:</h4>
<p>Well, I've never seen the error before in a Zulip context and googling for it finds Django documentation for fixing it, so I'm not sure it makes sense to add something to our own documentation to cover it.</p>



<a name="951218"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Error%20after%20timezone%20change/near/951218" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Error.20after.20timezone.20change.html#951218">(Jul 24 2020 at 00:44)</a>:</h4>
<p>So I think this is probably a case where it's not worth documenting as the extra clutter in the documentation making it harder to find more common exceptions isn't worth it.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>