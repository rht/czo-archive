<html>
<head><meta charset="utf-8"><title>restart-server resends email notifications · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/restart-server.20resends.20email.20notifications.html">restart-server resends email notifications</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1360306"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/restart-server%20resends%20email%20notifications/near/1360306" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/restart-server.20resends.20email.20notifications.html#1360306">(Apr 05 2022 at 08:24)</a>:</h4>
<p>Hello, <br>
do you know why <em>restart-server --fill-cache</em> is causing old pms (already read) to be send to users as email notifications?</p>



<a name="1360307"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/restart-server%20resends%20email%20notifications/near/1360307" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/restart-server.20resends.20email.20notifications.html#1360307">(Apr 05 2022 at 08:26)</a>:</h4>
<p>zulip_version   "2.1.8"</p>



<a name="1360497"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/restart-server%20resends%20email%20notifications/near/1360497" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/restart-server.20resends.20email.20notifications.html#1360497">(Apr 05 2022 at 17:03)</a>:</h4>
<p><span class="user-mention" data-user-id="23218">@jo</span>: Zulip 2.1 isn't really supported anymore -- please upgrade!</p>
<p>That said, it's likely that some of the workers are starting to send notifications and crashing.</p>



<a name="1360498"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/restart-server%20resends%20email%20notifications/near/1360498" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/restart-server.20resends.20email.20notifications.html#1360498">(Apr 05 2022 at 17:03)</a>:</h4>
<p>3 messages were moved here from <a class="stream-topic" data-stream-id="9" href="/#narrow/stream/9-issues/topic/email.20notifications">#issues &gt; email notifications</a> by <span class="user-mention silent" data-user-id="12178">Alex Vandiver</span>.</p>



<a name="1360578"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/restart-server%20resends%20email%20notifications/near/1360578" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/restart-server.20resends.20email.20notifications.html#1360578">(Apr 05 2022 at 18:57)</a>:</h4>
<p>Yeah, I think the most likely explanation is that some unrelated past incident caused the queue worker for the outgoing email notifications queue to not be running, and restarting the server started it up and caused it to clear its queue.</p>



<a name="1361083"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/restart-server%20resends%20email%20notifications/near/1361083" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/restart-server.20resends.20email.20notifications.html#1361083">(Apr 06 2022 at 07:11)</a>:</h4>
<p>Thanks for replies</p>



<a name="1361084"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/restart-server%20resends%20email%20notifications/near/1361084" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/restart-server.20resends.20email.20notifications.html#1361084">(Apr 06 2022 at 07:12)</a>:</h4>
<p>the thing is that it happens each time I restart the server</p>



<a name="1361091"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/restart-server%20resends%20email%20notifications/near/1361091" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/restart-server.20resends.20email.20notifications.html#1361091">(Apr 06 2022 at 07:41)</a>:</h4>
<p>Could you tell me where I could check that queue ?</p>



<a name="1361495"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/restart-server%20resends%20email%20notifications/near/1361495" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/restart-server.20resends.20email.20notifications.html#1361495">(Apr 06 2022 at 22:04)</a>:</h4>
<p><span class="user-mention" data-user-id="23218">@jo</span> <code>rabbitmqctl list_queues</code> will check the current queue contents, but you might want to look at <code>/var/log/zulip/events*.log</code> ; the <code>missedmessage_emails worker</code> and <code>send_email</code> logs will likely have some details.</p>



<a name="1361774"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/restart-server%20resends%20email%20notifications/near/1361774" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/restart-server.20resends.20email.20notifications.html#1361774">(Apr 07 2022 at 07:11)</a>:</h4>
<p>Thanks, will check it</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>