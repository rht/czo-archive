<html>
<head><meta charset="utf-8"><title>internal server error · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html">internal server error</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="278398"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/278398" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zachary Hui <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#278398">(Sep 09 2017 at 01:38)</a>:</h4>
<p>Every time I launch the server, I am unable to create an organization because it says there is an internal server error, I followed all of the steps correctly.</p>



<a name="278399"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/278399" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#278399">(Sep 09 2017 at 01:41)</a>:</h4>
<p>Welcome <span class="user-mention" data-user-email="zachhui@gmail.com" data-user-id="3242">@Zachary Hui</span>. Is there anything in <code>/var/log/zulip/errors.log</code>?</p>



<a name="278400"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/278400" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zachary Hui <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#278400">(Sep 09 2017 at 01:45)</a>:</h4>
<p><span class="user-mention" data-user-email="rishig@zulipchat.com" data-user-id="131">@Rishi Gupta</span> would i access that with nano /var/log/zulip/erros.log?</p>



<a name="278401"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/278401" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#278401">(Sep 09 2017 at 01:45)</a>:</h4>
<p>sure, or you could <code>tail -n 100 /var/log/zulip/errors.log</code></p>



<a name="278402"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/278402" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zachary Hui <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#278402">(Sep 09 2017 at 01:55)</a>:</h4>
<p><span class="user-mention" data-user-email="rishig@zulipchat.com" data-user-id="131">@Rishi Gupta</span> hold on, I just noticed that Google Cloud blocks SMTP ports so I need to do a relay give me a bit</p>



<a name="278404"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/278404" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zachary Hui <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#278404">(Sep 09 2017 at 02:29)</a>:</h4>
<blockquote>
<p>sure, or you could <code>tail -n 100 /var/log/zulip/errors.log</code></p>
</blockquote>
<p>There is nothing in that file</p>



<a name="278611"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/278611" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zachary Hui <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#278611">(Sep 09 2017 at 23:48)</a>:</h4>
<p>I still need help solving this, no matter what I do there is an internal server error</p>



<a name="278615"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/278615" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zachary Hui <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#278615">(Sep 09 2017 at 23:56)</a>:</h4>
<p><span class="user-mention" data-user-email="rishig@zulipchat.com" data-user-id="131">@Rishi Gupta</span> after finalizing the mail server and getting it to work, it tells me "AttributeError: 'module' object has no attribute 'plugin'</p>



<a name="278623"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/278623" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#278623">(Sep 10 2017 at 01:17)</a>:</h4>
<p>hmm. As a next step I would look through the other logs in <code>/var/log/zulip/</code> to see what could be wrong. <br>
If you can't get it to work, there is also a hosted version of zulip, available at <a href="http://zulipchat.com" target="_blank" title="http://zulipchat.com">zulipchat.com</a>, that might even be free for your use case (it's free for all educational uses under 100 users, and heavily discounted or free for most uses beyond that).</p>



<a name="278682"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/278682" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zachary Hui <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#278682">(Sep 10 2017 at 04:33)</a>:</h4>
<p>Is there a reason why I am getting this error? <span class="user-mention" data-user-email="rishig@zulipchat.com" data-user-id="131">@Rishi Gupta</span></p>



<a name="278685"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/278685" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zachary Hui <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#278685">(Sep 10 2017 at 04:49)</a>:</h4>
<p>Also, the logs don't show any errors other than "AttributeError: 'module' object has no attribute 'plugin'</p>



<a name="279492"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/279492" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#279492">(Sep 12 2017 at 09:21)</a>:</h4>
<p><span class="user-mention" data-user-email="zachhui@gmail.com" data-user-id="3242">@Zachary Hui</span> can you paste the full traceback containing the error into Zulip, not just the last line?  It's impossible to help you debug when you don't give details.  Look in the history of this stream and you can see how most folks do it.  If I had to guess, you have a configuration problem, but it's not clear what it is.</p>



<a name="282121"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/282121" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tomasz Kolek <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#282121">(Sep 15 2017 at 15:25)</a>:</h4>
<div class="codehilite"><pre><span></span>Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2017-09-14-17-12-17/zulip-venv/lib/python2.7/site-packages/django/core/handlers/exception.py&quot;, line 101, in get_exception_response
    callback, param_dict = resolver.resolve_error_handler(status_code)
  File &quot;/home/zulip/deployments/2017-09-14-17-12-17/zulip-venv/lib/python2.7/site-packages/django/urls/resolvers.py&quot;, line 326, in resolve_error_handler
    callback = getattr(self.urlconf_module, &#39;handler%s&#39; % view_type, None)
  File &quot;/home/zulip/deployments/2017-09-14-17-12-17/zulip-venv/lib/python2.7/site-packages/django/utils/functional.py&quot;, line 35, in __get__
    res = instance.__dict__[self.name] = self.func(instance)
  File &quot;/home/zulip/deployments/2017-09-14-17-12-17/zulip-venv/lib/python2.7/site-packages/django/urls/resolvers.py&quot;, line 306, in urlconf_module
    return import_module(self.urlconf_name)
  File &quot;/usr/lib/python2.7/importlib/__init__.py&quot;, line 37, in import_module
    __import__(name)
  File &quot;./zproject/urls.py&quot;, line 7, in &lt;module&gt;
    import zerver.forms
  File &quot;./zerver/forms.py&quot;, line 14, in &lt;module&gt;
    from zerver.lib.actions import do_change_password, is_inactive, user_email_is_unique
  File &quot;./zerver/lib/actions.py&quot;, line 24, in &lt;module&gt;
    from zerver.lib.message import (
  File &quot;./zerver/lib/message.py&quot;, line 10, in &lt;module&gt;
    from zerver.lib.avatar import avatar_url_from_dict
  File &quot;./zerver/lib/avatar.py&quot;, line 11, in &lt;module&gt;
    from zerver.lib.upload import upload_backend, MEDIUM_AVATAR_SIZE
  File &quot;./zerver/lib/upload.py&quot;, line 17, in &lt;module&gt;
    from boto.s3.bucket import Bucket
  File &quot;/home/zulip/deployments/2017-09-14-17-12-17/zulip-venv/lib/python2.7/site-packages/boto/__init__.py&quot;, line 1216, in &lt;module&gt;
    boto.plugin.load_plugins(config)
AttributeError: &#39;module&#39; object has no attribute &#39;plugin&#39;
</pre></div>



<a name="282122"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/282122" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tomasz Kolek <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#282122">(Sep 15 2017 at 15:26)</a>:</h4>
<p>I also tried to set it up on Google Engine but I probably met the same problem like OP</p>



<a name="282133"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/282133" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#282133">(Sep 15 2017 at 15:52)</a>:</h4>
<p><span class="user-mention" data-user-email="tomasz-kolek@o2.pl" data-user-id="107">@Tomasz Kolek</span> this is <a href="https://github.com/zulip/zulip/issues/4839" target="_blank" title="https://github.com/zulip/zulip/issues/4839">https://github.com/zulip/zulip/issues/4839</a></p>



<a name="282134"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/282134" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#282134">(Sep 15 2017 at 15:52)</a>:</h4>
<p><span class="user-mention" data-user-email="zachhui@gmail.com" data-user-id="3242">@Zachary Hui</span> FYI as well</p>



<a name="618006"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618006" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618006">(Jul 25 2018 at 23:21)</a>:</h4>
<p>After setting up my organization, on a fresh docker-zulip install, I'm getting an internal server error. Looks like the RabbitMQ connection closed, based on the zulip error log. There are no logs in the rabbitmq container, in <code>/var/log/rabbitmq</code>.</p>



<a name="618010"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618010" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618010">(Jul 25 2018 at 23:23)</a>:</h4>
<p><span class="user-mention" data-user-id="8742">@Jeaye</span> that's likely authentication not working for connecting to rabbitmq?</p>



<a name="618011"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618011" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618011">(Jul 25 2018 at 23:23)</a>:</h4>
<p>(Just in terms of what causes rabbitmq connection errors, in general)</p>



<a name="618012"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618012" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618012">(Jul 25 2018 at 23:23)</a>:</h4>
<p>So worth checking if it's the same password issue you had with postgres?</p>



<a name="618013"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618013" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618013">(Jul 25 2018 at 23:26)</a>:</h4>
<p>Everything was working just fine until the organization was created. If it were a passphrase issue, this would've likely shown up earlier. At any rate, I created these images with these passphrases and haven't changed them since.</p>



<a name="618014"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618014" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618014">(Jul 25 2018 at 23:29)</a>:</h4>
<p>If I delete <code>/opt/docker/zulip/postgresql/data</code> and restart the containers, I can get back to the log in screen. Since I don't know much about  RabbitMQ, should I be able to see the log in screen if RabbitMQ isn't working?</p>



<a name="618016"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618016" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618016">(Jul 25 2018 at 23:32)</a>:</h4>
<p>We don't access RabbitMQ at all in the logged-out pages.</p>



<a name="618017"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618017" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618017">(Jul 25 2018 at 23:32)</a>:</h4>
<p>Which is why this is the failure mode you get if rabbitmq is messed up (a 500 the moment you would be taken to the logged-in app).</p>



<a name="618025"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618025" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618025">(Jul 25 2018 at 23:33)</a>:</h4>
<p>I'm going to play with changing the rabbitmq password on my docker environment and see if I can reproduce</p>



<a name="618026"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618026" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618026">(Jul 25 2018 at 23:34)</a>:</h4>
<p>Yeah, with this new info, I'll revisit my assumptions. If it is the problem, this passphrase handling is a serious nuisance for any production environment. :(</p>



<a name="618028"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618028" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618028">(Jul 25 2018 at 23:34)</a>:</h4>
<p>Thanks for the quick info, Tim.</p>



<a name="618030"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618030" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618030">(Jul 25 2018 at 23:36)</a>:</h4>
<p>Yeah, agreed, I'm hoping to find time to work on making that work as documented on Friday.</p>



<a name="618035"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618035" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618035">(Jul 25 2018 at 23:43)</a>:</h4>
<p>That would be superb. Hopefully I can help a bit.</p>



<a name="618036"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618036" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618036">(Jul 25 2018 at 23:44)</a>:</h4>
<p>To start with, <a href="https://github.com/zulip/docker-zulip/pull/144" target="_blank" title="https://github.com/zulip/docker-zulip/pull/144">https://github.com/zulip/docker-zulip/pull/144</a></p>



<a name="618065"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618065" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618065">(Jul 26 2018 at 00:31)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> If I change my <code>SECRETS_rabbitmq_password</code> to be something different, RabbitMQ fails to start up, saying authentication failed. This means, since I created the image with my chosen passphrase, and I don't get the startup error with my passphrase set, but I do when I intentionally break it, that RabbitMQ is authenticating properly.</p>



<a name="618066"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618066" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618066">(Jul 26 2018 at 00:31)</a>:</h4>
<p>I hope that makes sense.</p>



<a name="618067"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618067" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618067">(Jul 26 2018 at 00:37)</a>:</h4>
<p>However, I've deleted everything and I'm trying this again with all default passphrases.</p>



<a name="618068"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618068" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618068">(Jul 26 2018 at 00:37)</a>:</h4>
<p>We'll see in... an hour or so, after the images are built.</p>



<a name="618072"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618072" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618072">(Jul 26 2018 at 01:06)</a>:</h4>
<p>Same exact issue, with all default passphrases, a clean data dir, and brand new images.</p>



<a name="618247"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618247" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618247">(Jul 26 2018 at 16:56)</a>:</h4>
<p>I can reproduce that not working.  Or more correctly, the <code>SECRETS</code> part is working -- <code>/etc/zulip/zulip-secrets.conf</code> has the right content.  But the RabbitMQ Docker image doesn't accept that password, i.e. the <code>RABBITMQ_USER_PASS</code> setting seems to have no effect.</p>



<a name="618248"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618248" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618248">(Jul 26 2018 at 16:56)</a>:</h4>
<p>It's weird, because their documentation is pretty clear, the RabbitMQ container code doesn't have any storage volumes declared, etc.</p>



<a name="618249"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618249" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618249">(Jul 26 2018 at 16:59)</a>:</h4>
<p>I guess one reasonably possibility is that the rabbitmq image 3.5. is buggy; I'm going to try upgrading.</p>



<a name="618250"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618250" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618250">(Jul 26 2018 at 16:59)</a>:</h4>
<p>No luck with that.</p>



<a name="618251"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618251" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618251">(Jul 26 2018 at 17:01)</a>:</h4>
<p><a href="https://github.com/docker-library/rabbitmq/issues/150" target="_blank" title="https://github.com/docker-library/rabbitmq/issues/150">https://github.com/docker-library/rabbitmq/issues/150</a> seems like exactly our problem.</p>



<a name="618252"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618252" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618252">(Jul 26 2018 at 17:10)</a>:</h4>
<p><span class="user-mention" data-user-id="8742">@Jeaye</span> I just posted a comment on that issue; it seems very likely that the described bug in <code>rabbitmq-server</code> is the problem here.</p>



<a name="618253"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618253" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618253">(Jul 26 2018 at 17:11)</a>:</h4>
<p>I don't have a clear workaround yet.  I also don't understand how it's possible that RabbitMQ ends up apparently storing state in between sessions.</p>



<a name="618257"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618257" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618257">(Jul 26 2018 at 17:17)</a>:</h4>
<p>Posted a few more comments on that issue; I think if you <code>docker-compose rm rabbitmq</code>, you can then change the password.</p>



<a name="618258"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/618258" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#618258">(Jul 26 2018 at 17:17)</a>:</h4>
<p>Can you confirm?</p>



<a name="619302"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619302" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619302">(Jul 27 2018 at 16:31)</a>:</h4>
<p>Thanks for looking into this <span class="user-mention" data-user-id="7">@Tim Abbott</span>. As I mentioned in my last comment, this doesn't work for me <em>at all</em>, given completely fresh images and containers and default passphrases.I don't think the changing of the passphrase, just with the RabbitMQ integration not yet working with docker-zulip.</p>



<a name="619303"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619303" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619303">(Jul 27 2018 at 16:31)</a>:</h4>
<p>Are you able to confirm with me that docker-zulip works for you, out of the box, with no passphrases changed?</p>



<a name="619332"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619332" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619332">(Jul 27 2018 at 16:51)</a>:</h4>
<p>Yes, it does, and I was able to change the password after doing the <code>docker-compose rm</code> dance I described.</p>



<a name="619349"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619349" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619349">(Jul 27 2018 at 16:56)</a>:</h4>
<p>Hmm, I'll give it a go. Thank you.</p>



<a name="619602"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619602" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619602">(Jul 27 2018 at 18:58)</a>:</h4>
<p>I have tried the rabbitmq dance you described and, still, after creating my organization, I get the 500. I have not changed any passphrases and everything has remained constant since I built all images from scratch.</p>



<a name="619604"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619604" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619604">(Jul 27 2018 at 18:59)</a>:</h4>
<p>My <code>/etc/zulip/zulip-secrets.conf</code> is correct, but I simply cannot create an org without getting an immediate 500.</p>



<a name="619606"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619606" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619606">(Jul 27 2018 at 19:00)</a>:</h4>
<p>Can you show the traceback from the 500 you're currently getting?</p>



<a name="619608"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619608" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619608">(Jul 27 2018 at 19:04)</a>:</h4>
<div class="codehilite"><pre><span></span>2018-07-27 18:55:11.357 ERR  [pika.adapters.base_connection] Socket Error: 104
2018-07-27 18:55:11.359 WARN [pika.adapters.base_connection] Connection is closed but not stopping IOLoop
2018-07-27 18:55:11.359 WARN [zulip.queue] TornadoQueueClient lost connection to RabbitMQ, reconnecting in 2 secs...
2018-07-27 18:55:11.365 ERR  [pika.adapters.base_connection] Socket Error: 104
2018-07-27 18:55:11.374 ERR  [pika.adapters.base_connection] Socket Error: 104
2018-07-27 18:55:11.364 ERR  [pika.adapters.base_connection] Socket Error: 104
2018-07-27 18:55:11.391 ERR  [pika.adapters.base_connection] Socket Error: 104
2018-07-27 18:55:11.392 ERR  [pika.adapters.blocking_connection] Connection close detected; result=BlockingConnection__OnClosedArgs(connection=&lt;SelectConnection CLOSED socket=None params=&lt;ConnectionParameters host=rabbitmq port=5672 virtual_host=/ ssl=False&gt;&gt;, reason_code=-1, reason_text=&quot;ConnectionResetError(104, &#39;Connection reset by peer&#39;)&quot;)
2018-07-27 18:55:11.355 ERR  [pika.adapters.base_connection] Socket Error: 104
2018-07-27 18:55:11.393 ERR  [pika.adapters.base_connection] Socket Error: 104
2018-07-27 18:55:11.400 ERR  [pika.adapters.blocking_connection] Connection close detected; result=BlockingConnection__OnClosedArgs(connection=&lt;SelectConnection CLOSED socket=None params=&lt;ConnectionParameters host=rabbitmq port=5672 virtual_host=/ ssl=False&gt;&gt;, reason_code=-1, reason_text=&quot;ConnectionResetError(104, &#39;Connection reset by peer&#39;)&quot;)
2018-07-27 18:55:11.393 ERR  [pika.adapters.base_connection] Socket Error: 104
2018-07-27 18:55:11.404 ERR  [pika.adapters.blocking_connection] Connection close detected; result=BlockingConnection__OnClosedArgs(connection=&lt;SelectConnection CLOSED socket=None params=&lt;ConnectionParameters host=rabbitmq port=5672 virtual_host=/ ssl=False&gt;&gt;, reason_code=-1, reason_text=&quot;ConnectionResetError(104, &#39;Connection reset by peer&#39;)&quot;)
2018-07-27 18:55:11.367 ERR  [pika.adapters.blocking_connection] Connection close detected; result=BlockingConnection__OnClosedArgs(connection=&lt;SelectConnection CLOSED socket=None params=&lt;ConnectionParameters host=rabbitmq port=5672 virtual_host=/ ssl=False&gt;&gt;, reason_code=-1, reason_text=&quot;ConnectionResetError(104, &#39;Connection reset by peer&#39;)&quot;)
2018-07-27 18:55:11.378 ERR  [pika.adapters.blocking_connection] Connection close detected; result=BlockingConnection__OnClosedArgs(connection=&lt;SelectConnection CLOSED socket=None params=&lt;ConnectionParameters host=rabbitmq port=5672 virtual_host=/ ssl=False&gt;&gt;, reason_code=-1, reason_text=&quot;ConnectionResetError(104, &#39;Connection reset by peer&#39;)&quot;)
2018-07-27 18:55:12.634 WARN [pika.connection] Suppressing close request on &lt;ExceptionFreeTornadoConnection CLOSED socket=None params=&lt;ConnectionParameters host=rabbitmq port=5672 virtual_host=/ ssl=False&gt;&gt;
2018-07-27 18:55:12.635 WARN [pika.adapters.base_connection] Connection is closed but not stopping IOLoop
2018-07-27 18:56:43.080 ERR  [django.request] Internal Server Error: /accounts/register/
Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/exception.py&quot;, line 41, in inner
    response = get_response(request)
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py&quot;, line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py&quot;, line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File &quot;./zerver/decorator.py&quot;, line 127, in wrapper
    return func(request, *args, **kwargs)
  File &quot;./zerver/views/registration.py&quot;, line 200, in accounts_register
    realm = do_create_realm(string_id, realm_name)
  File &quot;./zerver/lib/actions.py&quot;, line 3200, in do_create_realm
    admin_realm = get_system_bot(settings.NOTIFICATION_BOT).realm
  File &quot;./zerver/lib/cache.py&quot;, line 166, in func_with_caching
    val = func(*args, **kwargs)
  File &quot;./zerver/models.py&quot;, line 1738, in get_system_bot
    return UserProfile.objects.select_related().get(email__iexact=email.strip())
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/django/db/models/query.py&quot;, line 380, in get
    self.model._meta.object_name
zerver.models.DoesNotExist: UserProfile matching query does not exist.
</pre></div>



<a name="619694"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619694" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619694">(Jul 27 2018 at 20:45)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Any updated suggestions, given the stack trace?</p>



<a name="619696"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619696" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619696">(Jul 27 2018 at 20:47)</a>:</h4>
<p>OK, that's a very different error.  Did you by any chance remove some things from <code>/opt/docker</code> but not others?  It sorta looks like the first-time startup code was not run to setup the database.</p>



<a name="619697"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619697" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619697">(Jul 27 2018 at 20:48)</a>:</h4>
<p>i.e. you probably need to remove <code>$DATA_DIR/.initiated</code>, and then restart it.</p>



<a name="619701"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619701" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619701">(Jul 27 2018 at 20:54)</a>:</h4>
<p>Hm, yeah, that sounds like something I could've done.</p>



<a name="619714"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619714" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619714">(Jul 27 2018 at 21:12)</a>:</h4>
<p>I completely wiped out <code>/opt/docker/*</code> and then added the certs back in. Then set up another org and I got another 500. This is the log:</p>
<div class="codehilite"><pre><span></span>2018-07-27 21:10:37.600 ERR  [django.request] Internal Server Error: /
Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/connection.py&quot;, line 177, in _read_from_socket
    raise socket.error(SERVER_CLOSED_CONNECTION_ERROR)
OSError: Connection closed by server.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/client.py&quot;, line 2879, in execute
    return execute(conn, stack, raise_on_error)
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/client.py&quot;, line 2764, in _execute_transaction
    self.parse_response(connection, &#39;_&#39;)
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/client.py&quot;, line 2838, in parse_response
    self, connection, command_name, **options)
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/client.py&quot;, line 680, in parse_response
    response = connection.read_response()
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/connection.py&quot;, line 624, in read_response
    response = self._parser.read_response()
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/connection.py&quot;, line 284, in read_response
    response = self._buffer.readline()
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/connection.py&quot;, line 216, in readline
    self._read_from_socket()
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/connection.py&quot;, line 191, in _read_from_socket
    (e.args,))
redis.exceptions.ConnectionError: Error while reading from socket: (&#39;Connection closed by server.&#39;,)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/connection.py&quot;, line 177, in _read_from_socket
    raise socket.error(SERVER_CLOSED_CONNECTION_ERROR)
OSError: Connection closed by server.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/exception.py&quot;, line 41, in inner
    response = get_response(request)
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py&quot;, line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/django/core/handlers/base.py&quot;, line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File &quot;./zerver/views/home.py&quot;, line 85, in home
    return home_real(request)
  File &quot;./zerver/decorator.py&quot;, line 376, in _wrapped_view
    return view_func(request, *args, **kwargs)
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/django/contrib/auth/decorators.py&quot;, line 23, in _wrapped_view
    return view_func(request, *args, **kwargs)
  File &quot;./zerver/decorator.py&quot;, line 429, in _wrapped_view_func
    return rate_limit()(view_func)(request, *args, **kwargs)
  File &quot;./zerver/decorator.py&quot;, line 796, in wrapped_func
    rate_limit_user(request, user, domain)
  File &quot;./zerver/decorator.py&quot;, line 747, in rate_limit_user
    ratelimited, time = is_ratelimited(entity)
  File &quot;./zerver/lib/rate_limiter.py&quot;, line 149, in is_ratelimited
    rule_timestamps = pipe.execute()  # type: List[Optional[bytes]]
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/client.py&quot;, line 2894, in execute
    return execute(conn, stack, raise_on_error)
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/client.py&quot;, line 2764, in _execute_transaction
    self.parse_response(connection, &#39;_&#39;)
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/client.py&quot;, line 2838, in parse_response
    self, connection, command_name, **options)
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/client.py&quot;, line 680, in parse_response
    response = connection.read_response()
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/connection.py&quot;, line 624, in read_response
    response = self._parser.read_response()
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/connection.py&quot;, line 284, in read_response
    response = self._buffer.readline()
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/connection.py&quot;, line 216, in readline
    self._read_from_socket()
  File &quot;/home/zulip/deployments/2018-07-26-00-59-43/zulip-py3-venv/lib/python3.5/site-packages/redis/connection.py&quot;, line 191, in _read_from_socket
    (e.args,))
redis.exceptions.ConnectionError: Error while reading from socket: (&#39;Connection closed by server.&#39;,)
</pre></div>



<a name="619716"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619716" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619716">(Jul 27 2018 at 21:12)</a>:</h4>
<p>That one is failure connecting to redis.</p>



<a name="619719"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619719" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619719">(Jul 27 2018 at 21:14)</a>:</h4>
<p>Yep. Note, I have changed absolutely no passphrases, or anything within my <code>docker-compose.yaml</code> since I created the images.</p>



<a name="619722"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619722" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619722">(Jul 27 2018 at 21:15)</a>:</h4>
<p>Everything is default except for the following:</p>
<div class="codehilite"><pre><span></span><span class="gh">diff --git a/docker-compose.yml b/docker-compose.yml</span>
<span class="gh">index fd2a419..7fdc30a 100644</span>
<span class="gd">--- a/docker-compose.yml</span>
<span class="gi">+++ b/docker-compose.yml</span>
<span class="gu">@@ -33,7 +33,7 @@ services:</span>
       DB_HOST: &quot;database&quot;
       DB_HOST_PORT: &quot;5432&quot;
       DB_USER: &quot;zulip&quot;
<span class="gd">-      SSL_CERTIFICATE_GENERATION: &quot;self-signed&quot;</span>
<span class="gi">+      SSL_CERTIFICATE_GENERATION: &quot;certbot&quot;</span>
       SETTING_MEMCACHED_LOCATION: &quot;memcached:11211&quot;
       SETTING_RABBITMQ_HOST: &quot;rabbitmq&quot;
       SETTING_REDIS_HOST: &quot;redis&quot;
<span class="gu">@@ -41,10 +41,10 @@ services:</span>
       SECRETS_rabbitmq_password: &quot;zulip&quot;
       SECRETS_postgres_password: &quot;zulip&quot;
       SECRETS_secret_key: &quot;REPLACE_WITH_SECURE_SECRET_KEY&quot;
<span class="gd">-      SETTING_EXTERNAL_HOST: &quot;localhost.localdomain&quot;</span>
<span class="gd">-      SETTING_ZULIP_ADMINISTRATOR: &quot;admin@example.com&quot;</span>
<span class="gi">+      SETTING_EXTERNAL_HOST: &quot;zulip.my-company.com&quot;</span>
<span class="gi">+      SETTING_ZULIP_ADMINISTRATOR: &quot;ops@my-company.com&quot;</span>
       SETTING_EMAIL_HOST: &quot;&quot;  # e.g. smtp.example.com
<span class="gd">-      SETTING_EMAIL_HOST_USER: &quot;noreply@example.com&quot;</span>
<span class="gi">+      SETTING_EMAIL_HOST_USER: &quot;ops@my-company.com&quot;</span>
       SETTING_EMAIL_PORT: &quot;587&quot;
       # It seems that the email server needs to use ssl or tls and can&#39;t be used without it
       SETTING_EMAIL_USE_SSL: &quot;False&quot;
</pre></div>



<a name="619724"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619724" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619724">(Jul 27 2018 at 21:15)</a>:</h4>
<p>Hmm, and you don't have anything firewall-like setup?</p>



<a name="619725"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619725" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619725">(Jul 27 2018 at 21:21)</a>:</h4>
<p>This is just a default Debian 9 on Digital Ocean. I haven't configured anything, apart from installing vim and tmux.</p>



<a name="619728"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619728" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619728">(Jul 27 2018 at 21:28)</a>:</h4>
<p>This gets me into a redis shell just fine: <code>redis-cli -h $(docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' dockerzulip_redis_1)</code></p>



<a name="619729"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619729" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619729">(Jul 27 2018 at 21:29)</a>:</h4>
<p>No errors within <code>/var/log/redis</code> in the redis container.</p>



<a name="619730"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619730" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619730">(Jul 27 2018 at 21:29)</a>:</h4>
<p>Ok I'll try testing on DO in a bit in case that helps</p>



<a name="619731"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619731" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619731">(Jul 27 2018 at 21:29)</a>:</h4>
<p>Today's hectic with all the HN interest</p>



<a name="619732"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619732" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619732">(Jul 27 2018 at 21:29)</a>:</h4>
<p>Yeah, I bet. Thanks for the help. :)</p>



<a name="619733"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/619733" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#619733">(Jul 27 2018 at 21:30)</a>:</h4>
<p>I'll try this locally, without certbot, to see if it's the same.</p>



<a name="620034"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/620034" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#620034">(Jul 28 2018 at 17:56)</a>:</h4>
<p>I haven't been able to test locally, due to some docker issues on Arch. I'm hoping you were able to test on DO.</p>



<a name="620413"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/620413" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#620413">(Jul 29 2018 at 02:26)</a>:</h4>
<p>Ok, was just able to test within a Debian 9 VM with vagrant and I was able to create the org properly. I'll make a fresh Debian 9 droplet on DO and try again.</p>



<a name="620417"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/620417" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#620417">(Jul 29 2018 at 03:11)</a>:</h4>
<p>Worked on a fresh droplet, with all defaults. Will try adding in certbot, to see if that causes issues.</p>



<a name="620446"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/620446" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeaye <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#620446">(Jul 29 2018 at 06:57)</a>:</h4>
<p>Well, I've been able to get everything working properly now, just spinning up a new droplet, configuring my <code>docker-compose.yml</code> once, and building all images and containers. My original droplet must've ended up in a bad state, somehow or another.</p>



<a name="620981"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/620981" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#620981">(Jul 30 2018 at 17:21)</a>:</h4>
<p>OK, cool, glad to hear it!</p>



<a name="725595"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/725595" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SSD <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#725595">(Mar 29 2019 at 07:35)</a>:</h4>
<p>Just now upgraded from Ubuntu 16.04 &gt; 18.04, Postgres 9.5 &gt; 10, re-overwrote <code>/etc/nginx/nginx.conf</code> with default from <a href="https://github.com/zulip/zulip/blob/master/puppet/zulip/files/nginx/nginx.conf" target="_blank" title="https://github.com/zulip/zulip/blob/master/puppet/zulip/files/nginx/nginx.conf">https://github.com/zulip/zulip/blob/master/puppet/zulip/files/nginx/nginx.conf</a>, and had to create <code>/etc/nginx/dhparam.pem</code> because this did not exist before.  When I visit Zulip realms (Electron or web) I get <code>Internal Server Error</code>.  Looking at <code>/var/log/nginx/error.log</code> shows me:</p>
<p><code>2019/03/29 07:32:15 [error] 1712#1712: *18 connect() failed (111: Connection refused) while connecting to upstream, client: &lt;ip-redacted&gt;, server: , request: "GET /sockjs/info?cb=yovog9_dxd HTTP/1.1", upstream: "http://127.0.0.1:9993/sockjs/info?cb=yovog9_dxd",</code></p>
<p>So it looks like nginx can not connect to the upstream.  <code>netstat</code> shows nothing listening on port <code>9993</code>.  When I upgraded, accidentally overwrite <code>/etc/nginx/nginx.conf</code> and re-overwrite with file from here: <a href="https://github.com/zulip/zulip/blob/master/puppet/zulip/files/nginx/nginx.conf" target="_blank" title="https://github.com/zulip/zulip/blob/master/puppet/zulip/files/nginx/nginx.conf">https://github.com/zulip/zulip/blob/master/puppet/zulip/files/nginx/nginx.conf</a></p>
<p>Is there a better <code>nginx.conf</code>file I should use?  Is there something else to de-bug?</p>



<a name="725789"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/725789" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#725789">(Mar 29 2019 at 21:22)</a>:</h4>
<p><span class="user-mention" data-user-id="5955">@SSD</span> you should use <code>/home/zulip/deployments/current/scripts/zulip-puppet-apply</code> to fix your configuration.</p>



<a name="725790"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/725790" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#725790">(Mar 29 2019 at 21:23)</a>:</h4>
<p>(or equivalently, the zulip upgrade tool re-upgrading to the same version)</p>



<a name="725791"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/725791" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#725791">(Mar 29 2019 at 21:24)</a>:</h4>
<p>(I'm not sure what version of Zulip you're using, but in general, copying files out of <code>puppet</code> is the wrong approach; you should use <code>zulip-puppet-apply</code>, which will apply conditionals based on your system's details.</p>



<a name="725876"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/725876" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SSD <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#725876">(Mar 30 2019 at 00:53)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> You said </p>
<blockquote>
<p>you should use /home/zulip/deployments/current/scripts/zulip-puppet-apply to fix your configuration</p>
</blockquote>
<p>Are you sure?  I'm not using puppet.  The problem I found is that Ubuntu 18.04 defaults to python 3.6 and Zulip could not handle that so I had to manually install 3.5.  Then supervisor needed to keep python 2.7.  Finally got it figured out and the site is up although search does not work.  That's a different issue now though.</p>
<p>Do you still think there is value in running <code>zulip-puppet-apply</code>?  What function does it serve?</p>



<a name="725914"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/725914" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SSD <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#725914">(Mar 30 2019 at 03:16)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> You said </p>
<blockquote>
<p>you should use /home/zulip/deployments/current/scripts/zulip-puppet-apply to fix your configuration</p>
</blockquote>
<p>Are you sure?  I'm not using puppet.  The problem I found is that Ubuntu 18.04 defaults to python 3.6 and Zulip could not handle that so I had to manually install 3.5.  Then supervisor needed to keep python 2.7.  Finally got it figured out and the site is up although search does not work.  That's a different issue now though.</p>
<p>Anyway I  tried <code>zulip-puppet-apply</code> and got this error:</p>
<div class="codehilite"><pre><span></span>Error: Evaluation Error: No matching entry for selector parameter with value &#39;buster/sid&#39; (file: /home/zulip/deployments/2019-02-18-04-38-59/puppet/zulip/manifests/base.pp, line: 5, column: 23) on node zulip
</pre></div>


<p>I have bug reports in the Github Issues board but I have not heard back on any of them for some time.</p>



<a name="726055"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/726055" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#726055">(Mar 31 2019 at 00:32)</a>:</h4>
<p><span class="user-mention" data-user-id="5955">@SSD</span> I've been sick with the flu this week, can you share details on the GitHub issues?</p>



<a name="726056"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/726056" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#726056">(Mar 31 2019 at 00:32)</a>:</h4>
<p>Zulip uses puppet to manage its configuration, and that configuration depends on what version of Linux you're using.</p>



<a name="726058"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/726058" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#726058">(Mar 31 2019 at 00:34)</a>:</h4>
<p>Zulip expects Python 3.6 on Ubuntu 18.04; you should not have needed to do anything strange like downgrading packages.</p>



<a name="726059"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/726059" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#726059">(Mar 31 2019 at 00:35)</a>:</h4>
<p>What you might need to do is run <code>upgrade-zulip</code> to re-install the current version of Zulip you had, in order to have it re-compile the Python dependencies for the new version of Python.</p>



<a name="726060"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/726060" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#726060">(Mar 31 2019 at 00:36)</a>:</h4>
<blockquote>
<p>Error: Evaluation Error: No matching entry for selector parameter with value 'buster/sid' (file: /home/zulip/deployments/2019-02-18-04-38-59/puppet/zulip/manifests/base.pp, line: 5, column: 23) on node zulip</p>
</blockquote>
<p>This error is suspicious to me -- that suggestions you're not actually running Ubuntu 18.04?</p>



<a name="726459"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/726459" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SSD <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#726459">(Apr 01 2019 at 03:57)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> This is probably the place to start: <a href="https://github.com/zulip/zulip/issues/12009" target="_blank" title="https://github.com/zulip/zulip/issues/12009">https://github.com/zulip/zulip/issues/12009</a>.  I hope you are feeling better.</p>



<a name="726460"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/726460" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SSD <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#726460">(Apr 01 2019 at 04:10)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Just pinged you on GitHub with the details.</p>



<a name="727182"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/727182" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SSD <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#727182">(Apr 03 2019 at 06:57)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> I can't tell if you wrote back to me here.  I don't see any messages here but it's very confusing.  I don't see any replies to any of my GitHub Issues.  How can I correctly report Issues and get feedback please?</p>



<a name="727343"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/727343" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#727343">(Apr 03 2019 at 16:04)</a>:</h4>
<p>Tim is still sick (though recovering). For fast replies I'd recommend looking into a Zulip support contract (you can email <a href="mailto:support@zulipchat.com" title="mailto:support@zulipchat.com">support@zulipchat.com</a> for more details).</p>



<a name="727772"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/727772" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#727772">(Apr 04 2019 at 00:40)</a>:</h4>
<p><span class="user-mention" data-user-id="5955">@SSD</span> so, I think you've ended up with your system in a state that'll be hard for me to debug and get into a normal state (e.g. we never recommend force-changing the Python version on the system).</p>



<a name="727774"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/727774" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#727774">(Apr 04 2019 at 00:41)</a>:</h4>
<p>I think given that you're on 2.0.x and have upgraded your database, what you should do is a fresh installation on Ubuntu 18.04, and then use our documented backup + restore procedure to migrate your data over to the newly installed system in a known-good state: <a href="https://zulip.readthedocs.io/en/latest/production/maintain-secure-upgrade.html#backups" target="_blank" title="https://zulip.readthedocs.io/en/latest/production/maintain-secure-upgrade.html#backups">https://zulip.readthedocs.io/en/latest/production/maintain-secure-upgrade.html#backups</a></p>



<a name="727880"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/727880" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SSD <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#727880">(Apr 04 2019 at 04:40)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> It's easy for me to re-vert the python change but before I changed versions Zulip would not start at all and our organization depends on it so it was completely necessary to change python.  There was nothing in the docs about Zulip being incompatible with Ubuntu 18.04 so I had no reason to worry until after I upgaded and Zulip failed to start.  There were also nginx problems to de-bug.  Anyway are you sure it's not caused by the earlier error I've been waiting for feedback on for about a month?  <a href="https://github.com/zulip/zulip/issues/11905" target="_blank" title="https://github.com/zulip/zulip/issues/11905">https://github.com/zulip/zulip/issues/11905</a></p>
<p>Anyway I am good at de-bugging in tandem if that is helpful.  Or really any feedback at all would be nice.  All of my Issues are being unanswered and the docs are not telling me things like "don't upgrade to Ubuntu 18.04 and if you do, here's how to get Zulip working".  I do not have a customized system.  Ubuntu is very default, Zulip is very default.  Nothing else runs on this server.  I manage about 200 servers and I have a good idea what I'm doing.</p>



<a name="727881"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/727881" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SSD <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#727881">(Apr 04 2019 at 04:41)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> The first issue is Search.  Why would this not work?  What could it be?  That will tell us where to start.  Then the process of creating docs for Ubuntu 18.04 users is yours and I will help share my issues if you want.</p>



<a name="1455409"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/1455409" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hulk <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#1455409">(Oct 26 2022 at 10:40)</a>:</h4>
<p>Hi every one can any buddy help me my zulip server is showing internal error and when i check its status this is showing <a href="/user_uploads/2/69/2_1V_A7wcz5i8fFPEK_WjFdd/Screenshot_2022-10-26_16-09-09.png">Screenshot_2022-10-26_16-09-09.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/69/2_1V_A7wcz5i8fFPEK_WjFdd/Screenshot_2022-10-26_16-09-09.png" title="Screenshot_2022-10-26_16-09-09.png"><img src="/user_uploads/2/69/2_1V_A7wcz5i8fFPEK_WjFdd/Screenshot_2022-10-26_16-09-09.png"></a></div>



<a name="1455418"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/1455418" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#1455418">(Oct 26 2022 at 11:30)</a>:</h4>
<p>A message was moved here from <a class="stream-topic" data-stream-id="9" href="/#narrow/stream/9-issues/topic/good.20first.20issue">#issues &gt; good first issue</a> by <span class="user-mention silent" data-user-id="21836">Lauryn Menard</span>.</p>



<a name="1455482"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/internal%20server%20error/near/1455482" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/internal.20server.20error.html#1455482">(Oct 26 2022 at 14:12)</a>:</h4>
<p><span class="user-mention" data-user-id="25115">@hulk</span> Can you show <code>/var/log/zulip/errors.log</code>?</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>