<html>
<head><meta charset="utf-8"><title>Django cannot connect to Tornado server · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html">Django cannot connect to Tornado server</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1061867"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061867" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061867">(Nov 11 2020 at 23:35)</a>:</h4>
<p>Hi,<br>
I'm installing zulip and get this error:</p>
<div class="codehilite"><pre><span></span><code>Django cannot connect to Tornado server. (http://127.0.0.1:9993); try restarting
</code></pre></div>
<p>Could help me, please?</p>



<a name="1061868"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061868" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061868">(Nov 11 2020 at 23:42)</a>:</h4>
<p>Is this a production installation or a development environment?</p>



<a name="1061869"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061869" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061869">(Nov 11 2020 at 23:43)</a>:</h4>
<p>our production zulip server</p>



<a name="1061870"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061870" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061870">(Nov 11 2020 at 23:44)</a>:</h4>
<p>the connection is up/down every time</p>



<a name="1061871"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061871" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061871">(Nov 11 2020 at 23:45)</a>:</h4>
<p>I ask because port 9993 is only used in the development environment—are you using the development environment as a “production” server?</p>



<a name="1061872"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061872" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061872">(Nov 11 2020 at 23:46)</a>:</h4>
<p>ok, thanks Anders!</p>



<a name="1061873"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061873" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061873">(Nov 11 2020 at 23:47)</a>:</h4>
<p>You really shouldn’t do that because the development environment is slower and deliberately insecure.</p>



<a name="1061874"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061874" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061874">(Nov 11 2020 at 23:47)</a>:</h4>
<p>please, where i can read about how i do the setup for production?</p>



<a name="1061875"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061875" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061875">(Nov 11 2020 at 23:47)</a>:</h4>
<p><a href="https://zulip.readthedocs.io/en/stable/production/">https://zulip.readthedocs.io/en/stable/production/</a></p>



<a name="1061876"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061876" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061876">(Nov 11 2020 at 23:48)</a>:</h4>
<p>ok, thanks</p>



<a name="1061879"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061879" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061879">(Nov 12 2020 at 00:03)</a>:</h4>
<p>I follow stable -&gt; production documentation. But I don't see where setup for correct this error.<br>
From error log:</p>
<div class="codehilite"><pre><span></span><code> requests.exceptions.ConnectionError: HTTPConnectionPool(host=&#39;127.0.0.1&#39;, port=9993):
Max retries exceeded with url: /api/v1/events/internal (Caused by
NewConnectionError(&#39;&lt;urllib3.connection.HTTPConnection object at 0x7f0b8f65fa90&gt;:
Failed to establish  a new connection: [Errno 111] Connection refused&#39;))
</code></pre></div>



<a name="1061880"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061880" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061880">(Nov 12 2020 at 00:04)</a>:</h4>
<p>and</p>
<div class="codehilite"><pre><span></span><code>f&quot;Django cannot connect to Tornado server ({tornado_uri}); try restarting&quot;)
requests.exceptions.ConnectionError: Django cannot connect to Tornado server
(http://127.0.0.1:9993); try restarting
</code></pre></div>



<a name="1061881"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061881" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061881">(Nov 12 2020 at 00:16)</a>:</h4>
<p>i install latest release:</p>
<div class="codehilite"><pre><span></span><code>wget https://www.zulip.org/dist/releases/zulip-server-latest.tar.gz
</code></pre></div>



<a name="1061882"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061882" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061882">(Nov 12 2020 at 00:24)</a>:</h4>
<p>Unless you have manually configured port 9993 somewhere, I don’t think there’s any way to get such an error involving port 9993 unless you’re still using the development environment.</p>



<a name="1061883"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061883" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061883">(Nov 12 2020 at 00:26)</a>:</h4>
<p>What is the full path to the log file where you found that error?</p>



<a name="1061884"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061884" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061884">(Nov 12 2020 at 00:27)</a>:</h4>
<p>I don't put port 9993</p>



<a name="1061885"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061885" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061885">(Nov 12 2020 at 00:27)</a>:</h4>
<p>I'm sure</p>



<a name="1061886"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061886" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061886">(Nov 12 2020 at 00:32)</a>:</h4>
<p>And? What is the full path to the log file where you found that error?</p>



<a name="1061887"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061887" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061887">(Nov 12 2020 at 00:32)</a>:</h4>
<p>tail -f /var/log/zulip/errors.log</p>



<a name="1061888"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061888" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061888">(Nov 12 2020 at 00:40)</a>:</h4>
<p>I don't create a new zulip organization. I migrate mattermost organization</p>



<a name="1061889"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061889" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061889">(Nov 12 2020 at 00:46)</a>:</h4>
<p>Can you paste the output of <code>supervisorctl status</code> and <code>netstat -tlpn</code>?</p>



<a name="1061890"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061890" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061890">(Nov 12 2020 at 00:48)</a>:</h4>
<div class="codehilite"><pre><span></span><code>supervisorctl status
process-fts-updates                              RUNNING   pid 27145, uptime 0:45:58
zulip-django                                     RUNNING   pid 27143, uptime 0:45:58
zulip-tornado                                    RUNNING   pid 16188, uptime 0:00:40
zulip-workers:zulip_deliver_enqueued_emails      RUNNING   pid 15849, uptime 0:01:31
zulip-workers:zulip_deliver_scheduled_messages   RUNNING   pid 16324, uptime 0:00:32
zulip-workers:zulip_events                       RUNNING   pid 15877, uptime 0:00:54
</code></pre></div>



<a name="1061892"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061892" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061892">(Nov 12 2020 at 00:49)</a>:</h4>
<p><code>zulip-tornado</code> has only been running for 40 seconds? Have you checked /var/log/zulip/tornado.log?</p>



<a name="1061893"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061893" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061893">(Nov 12 2020 at 00:50)</a>:</h4>
<p><code>zulip-tornado</code> restart every time</p>



<a name="1061894"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061894" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061894">(Nov 12 2020 at 00:51)</a>:</h4>
<div class="codehilite"><pre><span></span><code>tail -f /var/log/zulip/errors.log
f&quot;Django cannot connect to Tornado server ({tornado_uri}); try restarting&quot;)
</code></pre></div>



<a name="1061895"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061895" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061895">(Nov 12 2020 at 00:51)</a>:</h4>
<p>Is there anything in /var/log/zulip/tornado.log (not errors.log)?</p>



<a name="1061896"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061896" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061896">(Nov 12 2020 at 00:54)</a>:</h4>
<div class="codehilite"><pre><span></span><code>tail -f /var/log/zulip/tornado.log
Tornado server is running at http://127.0.0.1:9993/
INFO [:9993] Tornado 9993  50.1% busy over the past 18.0 seconds
...
</code></pre></div>



<a name="1061897"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061897" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061897">(Nov 12 2020 at 00:55)</a>:</h4>
<div class="codehilite"><pre><span></span><code>netstat -tlpn
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.0.1:5672          0.0.0.0:*               LISTEN      -
tcp        0      0 127.0.0.1:25672         0.0.0.0:*               LISTEN      -
tcp        0      0 127.0.0.1:9993          0.0.0.0:*               LISTEN      17790/python3
tcp        0      0 127.0.0.1:6379          0.0.0.0:*               LISTEN      -
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      180/nginx: worker p
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -
tcp        0      0 127.0.0.1:5432          0.0.0.0:*               LISTEN      -
tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN      -
tcp        0      0 0.0.0.0:443             0.0.0.0:*               LISTEN      180/nginx: worker p
tcp6       0      0 ::1:6379                :::*                    LISTEN      -
tcp6       0      0 :::9292                 :::*                    LISTEN      -
tcp6       0      0 :::80                   :::*                    LISTEN      180/nginx: worker p
tcp6       0      0 :::4369                 :::*                    LISTEN      -
tcp6       0      0 :::22                   :::*                    LISTEN      -
tcp6       0      0 ::1:5432                :::*                    LISTEN      -
tcp6       0      0 :::25                   :::*                    LISTEN      -
tcp6       0      0 :::443                  :::*                    LISTEN      180/nginx: worker p
</code></pre></div>



<a name="1061898"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061898" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061898">(Nov 12 2020 at 00:55)</a>:</h4>
<p>You’ll need to look at more than two lines of tornado.log.</p>



<a name="1061899"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061899" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061899">(Nov 12 2020 at 00:56)</a>:</h4>
<div class="codehilite"><pre><span></span><code>tail -f /var/log/zulip/tornado.log
2020-11-12 00:51:25.228 INFO [:9993] Tornado 9993   0.0% busy over the past  0.0 seconds
2020-11-12 00:51:45.879 INFO [zr:9993] 181.94.47.38    GET     400   8ms (db: 3ms/2q) (+start: 14.3s) /json/events (11@root via ZulipElectron)
2020-11-12 00:51:45.879 INFO [zr:9993] status=400, data=b&#39;{&quot;result&quot;:&quot;error&quot;,&quot;msg&quot;:&quot;Bad event queue id: 1605142226:0&quot;,&quot;queue_id&quot;:&quot;1605142226:0&quot;,&quot;code&quot;:&quot;BAD_EVENT_QUEUE_ID&quot;}\n&#39;, uid=11@root
2020-11-12 00:51:45.880 INFO [:9993] Tornado 9993  81.8% busy over the past 20.7 seconds
2020-11-12 00:51:45.983 INFO [zr:9993] 127.0.0.1       POST    200   3ms (db: 1ms/2q) /api/v1/events/internal [1605142260:0/0] (11@root via internal)
2020-11-12 00:51:46.396 INFO [zr:9993] 127.0.0.1       POST    200   4ms (db: 1ms/1q) /api/v1/events/internal [1605142260:0/0] (11@root via internal)
2020-11-12 00:51:55.242 INFO [:9993] Tornado 9993  56.3% busy over the past 30.0 seconds
Tornado server is running at http://127.0.0.1:9993/
2020-11-12 00:52:13.622 INFO [:9993] Tornado 9993 loaded 0 event queues in 0.000s
2020-11-12 00:52:13.625 INFO [:9993] Tornado 9993   0.0% busy over the past  0.0 seconds
2020-11-12 00:52:43.686 INFO [:9993] Tornado 9993   0.0% busy over the past 30.0 seconds
2020-11-12 00:52:50.311 INFO [:9993] Tornado 9993   6.7% busy over the past 36.7 seconds
2020-11-12 00:52:50.360 INFO [zr:9993] 127.0.0.1       POST    200  40ms (db: 2ms/3q) /api/v1/events/internal [1605142332:0/0] (11@root via internal)
2020-11-12 00:52:50.534 INFO [zr:9993] 127.0.0.1       POST    200   2ms (db: 1ms/1q) /api/v1/events/internal [1605142332:0/0] (11@root via internal)
Tornado server is running at http://127.0.0.1:9993/
2020-11-12 00:53:16.861 INFO [:9993] Tornado 9993 loaded 0 event queues in 0.000s
2020-11-12 00:53:16.863 INFO [:9993] Tornado 9993   0.0% busy over the past  0.0 seconds
2020-11-12 00:53:25.839 INFO [:9993] Tornado 9993   0.0% busy over the past  9.0 seconds
2020-11-12 00:53:34.821 INFO [zr:9993] 181.94.47.38    GET     400   6ms (db: 2ms/2q) (+start: 37ms) /json/events (11@root via ZulipElectron)
2020-11-12 00:53:34.822 INFO [zr:9993] status=400, data=b&#39;{&quot;result&quot;:&quot;error&quot;,&quot;msg&quot;:&quot;Bad event queue id: 1605142332:0&quot;,&quot;queue_id&quot;:&quot;1605142332:0&quot;,&quot;code&quot;:&quot;BAD_EVENT_QUEUE_ID&quot;}\n&#39;, uid=11@root
2020-11-12 00:53:34.823 INFO [:9993] Tornado 9993  50.1% busy over the past 18.0 seconds
Tornado server is running at http://127.0.0.1:9993/
2020-11-12 00:54:05.793 INFO [:9993] Tornado 9993 loaded 0 event queues in 0.003s
2020-11-12 00:54:05.798 INFO [:9993] Tornado 9993   0.0% busy over the past  0.0 seconds
2020-11-12 00:54:18.110 INFO [:9993] Tornado 9993   0.0% busy over the past 12.3 seconds
2020-11-12 00:54:18.146 INFO [zr:9993] 127.0.0.1       POST    200  19ms (db: 6ms/3q) (+start: 8ms) /api/v1/events/internal [1605142417:0/0] (11@root via internal)
2020-11-12 00:54:18.341 INFO [zr:9993] 127.0.0.1       POST    200   5ms (db: 1ms/1q) /api/v1/events/internal [1605142417:0/0] (11@root via internal)
2020-11-12 00:54:51.515 INFO [:9993] Tornado 9993  70.7% busy over the past 45.7 seconds
2020-11-12 00:54:58.679 INFO [:9993] Tornado 9993  61.1% busy over the past 52.9 seconds
Tornado server is running at http://127.0.0.1:9993/
2020-11-12 00:55:22.015 INFO [:9993] Tornado 9993 loaded 0 event queues in 0.001s
2020-11-12 00:55:22.064 INFO [:9993] Tornado 9993   0.0% busy over the past  0.0 seconds
Tornado server is running at http://127.0.0.1:9993/
2020-11-12 00:55:47.850 INFO [:9993] Tornado 9993 loaded 0 event queues in 0.003s
2020-11-12 00:55:48.072 INFO [:9993] Tornado 9993   0.0% busy over the past  0.0 seconds
</code></pre></div>



<a name="1061902"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061902" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061902">(Nov 12 2020 at 00:59)</a>:</h4>
<p>Is it possible that your server is running out of memory and OOM-killing the Tornado server repeatedly? Check <code>dmesg</code>.</p>



<a name="1061903"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061903" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061903">(Nov 12 2020 at 01:02)</a>:</h4>
<div class="codehilite"><pre><span></span><code>dmesg
...
Memory cgroup stats for /lxc/102/ns/user.slice/user-111.slice/user-runtime-dir@111.service: cache:108KB rss:0KB rss_huge:0KB shmem:0KB mapped_file:0KB dirty:0KB writeback:0KB swap:0KB inactive_anon:0KB active_anon:0KB inactive_file:0KB active_file:0KB unevictable:0KB
...
Memory cgroup out of memory: Kill process 30835 (python3) score 52 or sacrifice child
[24797770.289920] Killed process 30835 (python3) total-vm:318272kB, anon-rss:110544kB, file-rss:0kB, shmem-rss:0kB
[24797770.292982] oom_reaper: reaped process 30835 (python3), now anon-rss:0kB, file-rss:0kB, shmem-rss:0kB
</code></pre></div>



<a name="1061904"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061904" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061904">(Nov 12 2020 at 01:03)</a>:</h4>
<p>you are right Anders.</p>



<a name="1061905"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061905" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061905">(Nov 12 2020 at 01:03)</a>:</h4>
<p>the server is a LXC</p>



<a name="1061906"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061906" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061906">(Nov 12 2020 at 01:03)</a>:</h4>
<p>Yeah that would do it. Sorry for the initial confusion. How much RAM do you have?</p>



<a name="1061907"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061907" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061907">(Nov 12 2020 at 01:04)</a>:</h4>
<div class="codehilite"><pre><span></span><code>free -h
              total        used        free      shared  buff/cache   available
Mem:          2,0Gi       859Mi        36Mi       1,1Gi       1,1Gi       1,2Gi
Swap:            0B          0B          0B
</code></pre></div>



<a name="1061908"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061908" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061908">(Nov 12 2020 at 01:05)</a>:</h4>
<p>2 GB might be barely enough if you have few users and nothing else running on the server, but we recommend more.</p>



<a name="1061909"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061909" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061909">(Nov 12 2020 at 01:06)</a>:</h4>
<p>ok. Whats is your recomendation, please?</p>



<a name="1061910"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061910" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061910">(Nov 12 2020 at 01:07)</a>:</h4>
<p>And given that it’s LXC, I’m guessing there’s something else running on it. If it’s easy to add more RAM, try that; perhaps start with 4 GB and see how that goes.</p>



<a name="1061911"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061911" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061911">(Nov 12 2020 at 01:08)</a>:</h4>
<p>we are 20 (aprox)</p>



<a name="1061912"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061912" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061912">(Nov 12 2020 at 01:09)</a>:</h4>
<p>ok, THANKS Anders!</p>



<a name="1061914"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061914" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061914">(Nov 12 2020 at 01:16)</a>:</h4>
<p>all is OK now!</p>



<a name="1061916"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1061916" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> wekun <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1061916">(Nov 12 2020 at 01:17)</a>:</h4>
<p>Thanks very much!</p>



<a name="1065900"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Django%20cannot%20connect%20to%20Tornado%20server/near/1065900" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Django.20cannot.20connect.20to.20Tornado.20server.html#1065900">(Nov 19 2020 at 01:37)</a>:</h4>
<p>I wonder if there's a way we could make OOM issues like this more discoverable (E.g. by having them result in something in <code>/var/log/zulip/errors.log</code>, with a link to docs?)</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>