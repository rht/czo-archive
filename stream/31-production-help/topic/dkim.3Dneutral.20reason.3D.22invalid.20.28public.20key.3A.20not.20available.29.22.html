<html>
<head><meta charset="utf-8"><title>dkim=neutral reason=&quot;invalid (public key: not available)&quot; · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html">dkim=neutral reason=&quot;invalid (public key: not available)&quot;</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1068115"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1068115" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Schridde <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1068115">(Nov 21 2020 at 20:20)</a>:</h4>
<p>Hi!</p>
<p>I get <code>Authentication-Results: spamfilter02.heinlein-hosting.de (amavisd-new); dkim=neutral reason="invalid (public key: not available)"</code> for emails coming from Zulip (for my <a href="http://x.zulipchat.com">x.zulipchat.com</a> organisation). Does anyone else see the same with their email provider?</p>
<p>--Dennis</p>



<a name="1068354"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1068354" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1068354">(Nov 23 2020 at 03:54)</a>:</h4>
<p><span class="user-mention" data-user-id="12320">@Dennis Schridde</span> I believe that this error has to do with how you've setup DKIM for your domain's outgoing email.</p>



<a name="1068355"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1068355" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1068355">(Nov 23 2020 at 03:55)</a>:</h4>
<p><a href="https://www.dmarcanalyzer.com/dkim/dkim-check/">https://www.dmarcanalyzer.com/dkim/dkim-check/</a> may be a useful resource in helping debug your outgoing email configuration.</p>



<a name="1068591"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1068591" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Schridde <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1068591">(Nov 23 2020 at 06:53)</a>:</h4>
<p>But I get that for emails coming <em>from</em> zulip, not for emails I send.</p>



<a name="1068598"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1068598" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Schridde <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1068598">(Nov 23 2020 at 08:31)</a>:</h4>
<p>Some more details: For <a href="http://chat.zulip.org">chat.zulip.org</a> (which uses a different email address of mine) I see:</p>
<div class="codehilite"><pre><span></span><code>Authentication-Results: [REDACTED];
    dkim=pass (1024-bit key) header.d=zulip.tabbott.net header.i=@zulip.tabbott.net header.b=pIgopixY;
    dkim-atps=neutral
</code></pre></div>
<p>For <a href="http://abc.zulipchat.com">abc.zulipchat.com</a> (using a different email address / provider) I see:</p>
<div class="codehilite"><pre><span></span><code>Authentication-Results: spamfilter05.heinlein-hosting.de (amavisd-new);
    dkim=neutral reason=&quot;invalid (public key: not available)&quot;
    header.d=zulip.com header.b=Ge1LjWav; dkim=pass (1024-bit key)
    header.d=mandrillapp.com header.b=VMqwnPC9
</code></pre></div>
<p>And indeed, <a href="https://www.dmarcanalyzer.com/dkim/dkim-check/">the tool you recommended</a> says for <a href="https://www.dmarcanalyzer.com/dkim/dkim-check/?dmarcdns[type]=dkim&amp;dmarcdns[selector]=mandrill&amp;dmarcdns[domain]=zulip.com">https://www.dmarcanalyzer.com/dkim/dkim-check/?dmarcdns[type]=dkim&amp;dmarcdns[selector]=mandrill&amp;dmarcdns[domain]=zulip.com</a> (using the selector and domain from <code>DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; s=mandrill; d=zulip.com;</code> as found in the email from <a href="http://zulipchat.com">zulipchat.com</a> that failed verification): <code>We could not detect a DKIM record with the specified selector on this domain.</code></p>
<p>On the other hand, it says for <a href="https://www.dmarcanalyzer.com/dkim/dkim-check/?dmarcdns[type]=dkim&amp;dmarcdns[selector]=pic&amp;dmarcdns[domain]=zulip.tabbott.net">https://www.dmarcanalyzer.com/dkim/dkim-check/?dmarcdns[type]=dkim&amp;dmarcdns[selector]=pic&amp;dmarcdns[domain]=zulip.tabbott.net</a> (using the selector and domain from <code>DKIM-Signature: a=rsa-sha256; v=1; c=relaxed/relaxed; d=zulip.tabbott.net; [...] s=pic;</code> as found in the email from <a href="http://chat.zulip.org">chat.zulip.org</a>): <code>This seems to be a valid DKIM Record.</code></p>
<p>This seems to confirm the findings of the <a href="http://mailbox.org">mailbox.org</a> / Heinlein mail server: The DKIM key that signs messages for <a href="http://zulipchat.com">zulipchat.com</a> is not published to DNS.</p>



<a name="1068874"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1068874" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1068874">(Nov 23 2020 at 19:21)</a>:</h4>
<p>Oh, interesting, I'd been confused as thinking you were reporting something for self-hosting.</p>



<a name="1068875"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1068875" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1068875">(Nov 23 2020 at 19:21)</a>:</h4>
<p>If this is an <a href="http://abc.zulipchat.com">abc.zulipchat.com</a> issue, that's absolutely our problem.  <span class="user-mention" data-user-id="12178">@Alex Vandiver</span> are you up for helping investigate this?</p>



<a name="1068876"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1068876" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1068876">(Nov 23 2020 at 19:22)</a>:</h4>
<p>It seems possible that we ended up with an inconsistency here when we moved from the <a href="http://zulipchat.com">zulipchat.com</a> domain to the <a href="http://zulip.com">zulip.com</a> domain.</p>



<a name="1068894"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1068894" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1068894">(Nov 23 2020 at 21:22)</a>:</h4>
<p>Yup, I can absolutely poke at this some, either today or tomorrow.</p>



<a name="1069976"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1069976" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Schridde <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1069976">(Nov 25 2020 at 18:05)</a>:</h4>
<p>Is there anything I can do to help here?</p>



<a name="1069996"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1069996" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1069996">(Nov 25 2020 at 18:37)</a>:</h4>
<p>I've copied the public key from <code>mandrill._domainkey.zulip.com</code> over to <code>mandrill._domainkey.zulipchat.com</code>, and DMARCanalyzer is happy now.  Let me know if that clears up the feedback you're getting from your spamfilter.</p>



<a name="1070584"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/dkim%3Dneutral%20reason%3D%22invalid%20%28public%20key%3A%20not%20available%29%22/near/1070584" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Schridde <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/dkim.3Dneutral.20reason.3D.22invalid.20.28public.20key.3A.20not.20available.29.22.html#1070584">(Nov 26 2020 at 18:09)</a>:</h4>
<p>Thanks! That worked:</p>
<div class="codehilite"><pre><span></span><code>Authentication-Results: spamfilter01.heinlein-hosting.de (amavisd-new);
    dkim=pass (1024-bit key) header.d=zulip.com header.b=bzDxs7pM;
    dkim=pass (1024-bit key) header.d=mandrillapp.com header.b=BJggau+Y
</code></pre></div>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>