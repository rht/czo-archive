<html>
<head><meta charset="utf-8"><title>After Reverting to earlier version · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html">After Reverting to earlier version</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="21721"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21721" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21721">(Sep 03 2016 at 06:22)</a>:</h4>
<p>2016-09-03 02:19:22,112 ERROR    Traceback (most recent call last):<br>
  File "/usr/lib/python2.7/dist-packages/django/core/handlers/base.py", line 132, in get_response<br>
    response = wrapped_callback(request, *callback_args, **callback_kwargs)<br>
  File "/usr/lib/python2.7/dist-packages/django/views/decorators/csrf.py", line 58, in wrapped_view<br>
    return view_func(*args, **kwargs)<br>
  File "/home/zulip/deployments/2016-06-05-12-26-07/zerver/views/messages.py", line 43, in &lt;lambda&gt;<br>
    rest_dispatch = csrf_exempt((lambda request, *args, <strong>kwargs: _rest_dispatch(request, globals(), *args, </strong>kwargs)))<br>
  File "/usr/lib/python2.7/dist-packages/django/views/decorators/csrf.py", line 58, in wrapped_view<br>
    return view_func(*args, **kwargs)<br>
  File "/home/zulip/deployments/2016-06-05-12-26-07/zerver/lib/rest.py", line 91, in rest_dispatch<br>
    return target_function(request, **kwargs)<br>
  File "/usr/lib/python2.7/dist-packages/django/utils/decorators.py", line 110, in _wrapped_view<br>
    response = view_func(request, *args, **kwargs)<br>
  File "/home/zulip/deployments/2016-06-05-12-26-07/zerver/decorator.py", line 386, in _wrapped_view_func<br>
    return authenticate_log_and_execute_json(request, view_func, *args, **kwargs)<br>
  File "/home/zulip/deployments/2016-06-05-12-26-07/zerver/decorator.py", line 366, in authenticate_log_and_execute_json<br>
    process_client(request, user_profile, True)<br>
  File "/home/zulip/deployments/2016-06-05-12-26-07/zerver/decorator.py", line 137, in process_client<br>
    update_user_activity(request, user_profile)<br>
  File "/home/zulip/deployments/2016-06-05-12-26-07/zerver/decorator.py", line 72, in update_user_activity<br>
    queue_json_publish("user_activity", event, lambda event: None)<br>
  File "/home/zulip/deployments/2016-06-05-12-26-07/zerver/lib/queue.py", line 268, in queue_json_publish<br>
    get_queue_client().json_publish(queue_name, event)<br>
  File "/home/zulip/deployments/2016-06-05-12-26-07/zerver/lib/queue.py", line 249, in get_queue_client<br>
    queue_client = SimpleQueueClient()<br>
  File "/home/zulip/deployments/2016-06-05-12-26-07/zerver/lib/queue.py", line 28, in __init__<br>
    self._connect()<br>
  File "/home/zulip/deployments/2016-06-05-12-26-07/zerver/lib/queue.py", line 32, in _connect<br>
    self.connection = pika.BlockingConnection(self._get_parameters())<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/blocking_connection.py", line 339, in __init__<br>
    self._process_io_for_connection_setup()<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/blocking_connection.py", line 374, in _process_io_for_connection_setup<br>
    self._open_error_result.is_ready)<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/blocking_connection.py", line 410, in _flush_output<br>
    self._impl.ioloop.poll()<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/select_connection.py", line 602, in poll<br>
    self._process_fd_events(fd_event_map, write_only)<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/select_connection.py", line 443, in _process_fd_events<br>
    handler(fileno, events, write_only=write_only)<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/base_connection.py", line 364, in _handle_events<br>
    self._handle_read()<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/base_connection.py", line 407, in _handle_read<br>
    return self._handle_error(error)<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/base_connection.py", line 338, in _handle_error<br>
    self._handle_disconnect()<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/base_connection.py", line 288, in _handle_disconnect<br>
    self._adapter_disconnect()<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/select_connection.py", line 95, in _adapter_disconnect<br>
    super(SelectConnection, self)._adapter_disconnect()<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/base_connection.py", line 154, in _adapter_disconnect<br>
    self._check_state_on_disconnect()<br>
  File "/usr/lib/python2.7/dist-packages/pika/adapters/base_connection.py", line 173, in _check_state_on_disconnect<br>
    raise exceptions.ProbableAuthenticationError<br>
ProbableAuthenticationError</p>



<a name="21722"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21722" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21722">(Sep 03 2016 at 06:23)</a>:</h4>
<p><strong>probable Authentication error ??</strong></p>



<a name="21723"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21723" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21723">(Sep 03 2016 at 06:23)</a>:</h4>
<p>I tried to log out and log back in ..</p>



<a name="21724"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21724" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21724">(Sep 03 2016 at 06:24)</a>:</h4>
<p>One thing of interest, I did change to an Encrypt SSL Cert as well</p>



<a name="21725"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21725" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21725">(Sep 03 2016 at 06:25)</a>:</h4>
<p>I just get a Loading Spinner and teh Red message at top right that it is Unable ot connect to Zulip</p>



<a name="21726"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21726" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21726">(Sep 03 2016 at 06:28)</a>:</h4>
<p><strong>sudo supervisorctl status</strong></p>
<p>process-fts-updates                                             RUNNING   pid 5160, uptime 0:15:31<br>
zulip-django                                                    RUNNING   pid 5158, uptime 0:15:31<br>
zulip-senders:zulip-events-message_sender-0                     RUNNING   pid 4268, uptime 0:00:02<br>
zulip-senders:zulip-events-message_sender-1                     RUNNING   pid 4260, uptime 0:00:02<br>
zulip-senders:zulip-events-message_sender-2                     STARTING  <br>
zulip-senders:zulip-events-message_sender-3                     RUNNING   pid 4220, uptime 0:00:03<br>
zulip-senders:zulip-events-message_sender-4                     RUNNING   pid 4289, uptime 0:00:01<br>
zulip-tornado                                                   RUNNING   pid 5159, uptime 0:15:31<br>
zulip-workers:zulip-deliver-enqueued-emails                     RUNNING   pid 5167, uptime 0:15:31<br>
zulip-workers:zulip-events-confirmation-emails                  RUNNING   pid 4299, uptime 0:00:01<br>
zulip-workers:zulip-events-digest_emails                        RUNNING   pid 4250, uptime 0:00:02<br>
zulip-workers:zulip-events-email_mirror                         STARTING  <br>
zulip-workers:zulip-events-error_reports                        RUNNING   pid 4302, uptime 0:00:01<br>
zulip-workers:zulip-events-feedback_messages                    RUNNING   pid 4228, uptime 0:00:03<br>
zulip-workers:zulip-events-missedmessage_mobile_notifications   STARTING  <br>
zulip-workers:zulip-events-missedmessage_reminders              RUNNING   pid 4310, uptime 0:00:01<br>
zulip-workers:zulip-events-signups                              RUNNING   pid 4282, uptime 0:00:01<br>
zulip-workers:zulip-events-slowqueries                          RUNNING   pid 4264, uptime 0:00:02<br>
zulip-workers:zulip-events-user-activity                        RUNNING   pid 4239, uptime 0:00:02<br>
zulip-workers:zulip-events-user-activity-interval               RUNNING   pid 4234, uptime 0:00:03<br>
zulip-workers:zulip-events-user-presence                        RUNNING   pid 4240, uptime 0:00:02</p>



<a name="21727"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21727" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21727">(Sep 03 2016 at 06:31)</a>:</h4>
<p><a href="/user_uploads/2/11/gflGTIP1FLnxPjcqyIy_9Gxn/Screen-Shot-2016-09-03-at-2.31.11-PM.png" target="_blank" title="Screen-Shot-2016-09-03-at-2.31.11-PM.png">Screen-Shot-2016-09-03-at-2.31.11-PM.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/2/11/gflGTIP1FLnxPjcqyIy_9Gxn/Screen-Shot-2016-09-03-at-2.31.11-PM.png" target="_blank" title="Screen-Shot-2016-09-03-at-2.31.11-PM.png"><img src="/user_uploads/2/11/gflGTIP1FLnxPjcqyIy_9Gxn/Screen-Shot-2016-09-03-at-2.31.11-PM.png"></a></div>



<a name="21728"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21728" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21728">(Sep 03 2016 at 07:25)</a>:</h4>
<p>hm. Probably you will have to wait till more experienced people wake up, but the low uptimes suggests that all the services are crashing and auto-restarting</p>



<a name="21729"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21729" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21729">(Sep 03 2016 at 07:26)</a>:</h4>
<p>(and probably eating up a lot of cpu? would be another indication of that)</p>



<a name="21730"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21730" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21730">(Sep 03 2016 at 07:26)</a>:</h4>
<p>also I think this is unrelated to your first problem, but there is a 1.4.1 that solves some problems with the 1.4.0 upgrade path, at <a href="https://dl.dropboxusercontent.com/u/23782125/zulip-server-1.4.1.tar.gz" target="_blank" title="https://dl.dropboxusercontent.com/u/23782125/zulip-server-1.4.1.tar.gz">https://dl.dropboxusercontent.com/u/23782125/zulip-server-1.4.1.tar.gz</a></p>



<a name="21731"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21731" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21731">(Sep 03 2016 at 07:32)</a>:</h4>
<p>Thanks rishi, will try taht .. I have tried making my own tarball, but get anotehr probelm ..</p>



<a name="21732"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21732" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21732">(Sep 03 2016 at 07:32)</a>:</h4>
<p>File "./tools/../zproject/settings.py", line 85, in &lt;module&gt;<br>
    from .prod_settings import *<br>
ImportError: No module named prod_settings</p>



<a name="21733"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21733" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21733">(Sep 03 2016 at 07:33)</a>:</h4>
<p>Are you making the tarball from checking out the git repo? I think local_settings.py was renamed to prod_settings.py in 1.4.0</p>



<a name="21734"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21734" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21734">(Sep 03 2016 at 07:34)</a>:</h4>
<p>yep, fresh clone ..</p>



<a name="21735"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21735" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21735">(Sep 03 2016 at 07:35)</a>:</h4>
<p>I was tryinmg to remove the failing modiule form teh requirements to see if it would install, as that module was alredady ok</p>



<a name="21736"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21736" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21736">(Sep 03 2016 at 07:35)</a>:</h4>
<p>hm, let me check if the 1.4.1 changes were pushed to the repo</p>



<a name="21737"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21737" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21737">(Sep 03 2016 at 07:35)</a>:</h4>
<p>same error on 1.4.1 sadly</p>



<a name="21738"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21738" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21738">(Sep 03 2016 at 07:35)</a>:</h4>
<p>ollecting pydns==2.3.6 (from -r /home/zulip/deployments/2016-09-03-15-33-32/requirements/py2_common.txt (line 4))<br>
  Using cached pydns-2.3.6.tar.gz<br>
    Complete output from command python setup.py egg_info:<br>
    Traceback (most recent call last):<br>
      File "&lt;string&gt;", line 1, in &lt;module&gt;<br>
      File "/tmp/pip-build-05upf9u7/pydns/setup.py", line 12, in &lt;module&gt;<br>
        import DNS<br>
      File "/tmp/pip-build-05upf9u7/pydns/DNS/__init__.py", line 14, in &lt;module&gt;<br>
        import Type,Opcode,Status,Class<br>
    ImportError: No module named 'Type'</p>



<a name="21739"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21739" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21739">(Sep 03 2016 at 07:38)</a>:</h4>
<p>this unfortunately might have to wait for someone more experienced tomorrow :/.</p>



<a name="21740"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/After%20Reverting%20to%20earlier%20version/near/21740" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/After.20Reverting.20to.20earlier.20version.html#21740">(Sep 03 2016 at 07:38)</a>:</h4>
<p>Ok, thanks heaps for your help</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>