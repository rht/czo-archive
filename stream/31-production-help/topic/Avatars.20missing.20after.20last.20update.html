<html>
<head><meta charset="utf-8"><title>Avatars missing after last update · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html">Avatars missing after last update</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1459396"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459396" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459396">(Nov 04 2022 at 15:54)</a>:</h4>
<p>There are several issues in latest release. Missing last button from main menu. Custom avatars do not get displayed.</p>



<a name="1459397"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459397" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459397">(Nov 04 2022 at 15:57)</a>:</h4>
<p><a href="/user_uploads/2/bf/xWvHfKXB6nVAx2e6oPqcC2LW/4EBC1BE9-4487-4C63-A1B9-69344FBEA0F9.png">4EBC1BE9-4487-4C63-A1B9-69344FBEA0F9.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/bf/xWvHfKXB6nVAx2e6oPqcC2LW/4EBC1BE9-4487-4C63-A1B9-69344FBEA0F9.png" title="4EBC1BE9-4487-4C63-A1B9-69344FBEA0F9.png"><img src="/user_uploads/2/bf/xWvHfKXB6nVAx2e6oPqcC2LW/4EBC1BE9-4487-4C63-A1B9-69344FBEA0F9.png"></a></div>



<a name="1459398"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459398" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459398">(Nov 04 2022 at 15:57)</a>:</h4>
<p>I am on latest git main release 6 dev.</p>



<a name="1459399"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459399" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459399">(Nov 04 2022 at 15:58)</a>:</h4>
<p>Its weird cause here the button is displayed when i switch to my server is not anymore.</p>



<a name="1459402"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459402" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Bobbe <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459402">(Nov 04 2022 at 16:04)</a>:</h4>
<p>Thanks for the report, <span class="user-mention" data-user-id="20576">@Cosmic Sound</span>! It looks like the app is having trouble loading uploaded avatars.</p>
<p>Some questions to help debug:</p>
<ul>
<li>Is it a self-hosted server?</li>
<li>Do you have a good Internet connection?</li>
<li>In the mobile app, if you look at a message with an uploaded photo in it, does it show a preview of the photo, or just a broken-link placeholder where the preview should be? If you tap the preview or placeholder, does it open the lightbox where you can pan/zoom?</li>
</ul>



<a name="1459413"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459413" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459413">(Nov 04 2022 at 16:34)</a>:</h4>
<p>yes it is self hosted server running latest main git release</p>



<a name="1459414"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459414" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459414">(Nov 04 2022 at 16:34)</a>:</h4>
<p>My connection is over 200 Mbs so yes i would say good enough</p>



<a name="1459415"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459415" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459415">(Nov 04 2022 at 16:37)</a>:</h4>
<p>Here is a printscren. Seems images upload works well yet avatar has broken placeholder only for the ones with custom avatars. The rest seem to be fine. Those auto generated</p>



<a name="1459416"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459416" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459416">(Nov 04 2022 at 16:37)</a>:</h4>
<p><a href="/user_uploads/2/9b/5DEzpZ72flWEj5qJe1EAxlk2/1A8408D9-3C6E-4D6A-8EBF-1AF676F23F15.png">1A8408D9-3C6E-4D6A-8EBF-1AF676F23F15.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/9b/5DEzpZ72flWEj5qJe1EAxlk2/1A8408D9-3C6E-4D6A-8EBF-1AF676F23F15.png" title="1A8408D9-3C6E-4D6A-8EBF-1AF676F23F15.png"><img src="/user_uploads/2/9b/5DEzpZ72flWEj5qJe1EAxlk2/1A8408D9-3C6E-4D6A-8EBF-1AF676F23F15.png"></a></div>



<a name="1459418"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459418" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459418">(Nov 04 2022 at 16:37)</a>:</h4>
<p>I believe it could be related to my latest update</p>



<a name="1459420"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459420" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459420">(Nov 04 2022 at 16:37)</a>:</h4>
<p>Yet it came out successfully no errors</p>



<a name="1459421"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459421" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459421">(Nov 04 2022 at 16:42)</a>:</h4>
<p>Yet it seems it is also on desktop, so I think this is not related to the iOS app.</p>



<a name="1459422"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459422" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459422">(Nov 04 2022 at 16:43)</a>:</h4>
<p>Maybe someone could move this topic into production help.</p>



<a name="1459423"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459423" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459423">(Nov 04 2022 at 16:45)</a>:</h4>
<p>This topic was moved here from <a class="stream-topic" data-stream-id="48" href="/#narrow/stream/48-mobile/topic/Avatars.20missing.20after.20last.20update">#mobile &gt; Avatars missing after last update</a> by <span class="user-mention silent" data-user-id="13313">Chris Bobbe</span>.</p>



<a name="1459425"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459425" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459425">(Nov 04 2022 at 16:48)</a>:</h4>
<p>It is very weird, users imported from mattermost a year ago, have avatars, new users who used the account dont have it</p>



<a name="1459426"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459426" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459426">(Nov 04 2022 at 16:48)</a>:</h4>
<p>Also the main view is a bit broken.</p>



<a name="1459427"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459427" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459427">(Nov 04 2022 at 16:48)</a>:</h4>
<p><a href="/user_uploads/2/a1/aJtzfci44CQwlioKmTwBUahl/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/a1/aJtzfci44CQwlioKmTwBUahl/image.png" title="image.png"><img src="/user_uploads/2/a1/aJtzfci44CQwlioKmTwBUahl/image.png"></a></div>



<a name="1459428"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459428" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Bobbe <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459428">(Nov 04 2022 at 16:53)</a>:</h4>
<p>Thanks for that screenshot. It's from the desktop app, right? Which platform?</p>
<p>Do you see the same problem in the web app?</p>
<p>I'm curious if there's something funny with the avatar image URLs. Are you familiar with using a browser's inspector, like in Chrome DevTools? If so, it could be helpful to know what the <code>src</code> attribute of the image tag in the web app looks like. The one for my avatar here on <a href="http://chat.zulip.org">chat.zulip.org</a> is <code>https://chat.zulip.org/user_avatars/2/08fb6d007eb10a56efee1d64760fbeb6111c4352.png?version=2&amp;s=50</code>, for example. It could be interesting to know if the avatars on your server look much different from that.</p>



<a name="1459463"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459463" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459463">(Nov 04 2022 at 18:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="20576">Cosmic Sound</span> <a href="#narrow/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update/near/1459426">said</a>:</p>
<blockquote>
<p>Also the main view is a bit broken.</p>
</blockquote>
<p>Created a separate thread for the left sidebar part of this as <a class="stream-topic" data-stream-id="9" href="/#narrow/stream/9-issues/topic/left_side_userlist.20broken">#issues &gt; left_side_userlist broken</a>; thanks for the report!</p>



<a name="1459565"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459565" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459565">(Nov 04 2022 at 19:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="13313">Chris Bobbe</span> <a href="#narrow/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update/near/1459428">said</a>:</p>
<blockquote>
<p>Thanks for that screenshot. It's from the desktop app, right? Which platform?</p>
<p>Do you see the same problem in the web app?</p>
<p>I'm curious if there's something funny with the avatar image URLs. Are you familiar with using a browser's inspector, like in Chrome DevTools? If so, it could be helpful to know what the <code>src</code> attribute of the image tag in the web app looks like. The one for my avatar here on <a href="http://chat.zulip.org">chat.zulip.org</a> is <code>https://chat.zulip.org/user_avatars/2/08fb6d007eb10a56efee1d64760fbeb6111c4352.png?version=2&amp;s=50</code>, for example. It could be interesting to know if the avatars on your server look much different from that.</p>
</blockquote>
<p>I am on macos, using latest version of desktop app, and same on ios using latest mobile app, this I doubt it is related to the apps, in any way. Let me try the browser view.</p>



<a name="1459573"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459573" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459573">(Nov 04 2022 at 19:49)</a>:</h4>
<p>It is clearly not the apps here, since this does not replicate on this server, only on my self hosted, until now imho if its present on desktop and ios app, since they are only wrappers around the web app, I doubt it will be any different.</p>



<a name="1459636"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459636" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459636">(Nov 04 2022 at 20:47)</a>:</h4>
<p><a href="/user_uploads/2/b7/Z1XV6V02TcMs7sCO2ClI1tnE/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/b7/Z1XV6V02TcMs7sCO2ClI1tnE/image.png" title="image.png"><img src="/user_uploads/2/b7/Z1XV6V02TcMs7sCO2ClI1tnE/image.png"></a></div>



<a name="1459694"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459694" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Bobbe <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459694">(Nov 04 2022 at 21:28)</a>:</h4>
<blockquote>
<p>The one for my avatar here on <a href="http://chat.zulip.org">chat.zulip.org</a> is <code>https://chat.zulip.org/user_avatars/2/08fb6d007eb10a56efee1d64760fbeb6111c4352.png?version=2&amp;s=50</code>, for example. It could be interesting to know if the avatars on your server look much different from that.</p>
</blockquote>
<p>Hmm, from a quick look at your screenshot, the avatar URLs on your org look like they're in that same form too. I don't yet have a theory for why the server would be giving 404s though.</p>
<p>Perhaps someone who works closer to the server code than I do can investigate?</p>



<a name="1459695"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459695" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Bobbe <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459695">(Nov 04 2022 at 21:28)</a>:</h4>
<p>(deleted—double-send from web app)</p>



<a name="1459697"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1459697" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Bobbe <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1459697">(Nov 04 2022 at 21:28)</a>:</h4>
<p>(deleted—triple-send from web app)</p>



<a name="1461739"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1461739" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Bobbe <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1461739">(Nov 09 2022 at 21:53)</a>:</h4>
<p>Bump, for someone who focuses on server code:</p>
<blockquote>
<p>I don't yet have a theory for why the server would be giving 404s though.</p>
</blockquote>



<a name="1462075"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1462075" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1462075">(Nov 10 2022 at 06:07)</a>:</h4>
<p><span class="user-mention" data-user-id="20576">@Cosmic Sound</span> can you check whether the files in question exist in <code>/home/zulip/uploads/user_avatars/</code> on your server? (Or are you using the S3 backend?)</p>



<a name="1462079"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1462079" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1462079">(Nov 10 2022 at 06:09)</a>:</h4>
<p>I don't think we've changed anything material in the uploads/avatars code path in this release, so I'm wondering if there's something else going on with your installation (did you do a backup/restore, perhaps)?</p>



<a name="1462235"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1462235" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1462235">(Nov 10 2022 at 16:09)</a>:</h4>
<p>The "you do not have permission to access the requested resource" interleaved in there is also interesting -- but I can't tell what URL that was for.</p>



<a name="1463121"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463121" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463121">(Nov 13 2022 at 13:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="7">Tim Abbott</span> <a href="#narrow/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update/near/1462075">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="20576">Cosmic Sound</span> can you check whether the files in question exist in <code>/home/zulip/uploads/user_avatars/</code> on your server? (Or are you using the S3 backend?)</p>
</blockquote>
<p>I am checking now, not using S3.</p>



<a name="1463122"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463122" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463122">(Nov 13 2022 at 13:11)</a>:</h4>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>ubuntu@chat:/home/zulip/uploads$ ls
files
ubuntu@chat:/home/zulip/uploads$ <span class="nb">pwd</span>
/home/zulip/uploads
</code></pre></div>



<a name="1463123"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463123" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463123">(Nov 13 2022 at 13:12)</a>:</h4>
<p>It seems there is no such folder, and is weird since this looks to be changed in 4th of november, this was previous upgrades where I had issuess.</p>



<a name="1463124"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463124" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463124">(Nov 13 2022 at 13:15)</a>:</h4>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="m">2022</span>-10-18-18-17-31  <span class="m">2022</span>-11-04-03-39-36  <span class="m">2022</span>-11-04-03-45-30
</code></pre></div>
<p>these were previous upgrades, yet the last upgrade had issues so we had to make some repairs. It seems what ever done completely wiped all images.</p>



<a name="1463125"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463125" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463125">(Nov 13 2022 at 13:22)</a>:</h4>
<p>I will attempt a restore previous to all the last 2 upgrades, and rerun upgrades to see if the issue persists.</p>



<a name="1463126"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463126" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463126">(Nov 13 2022 at 13:38)</a>:</h4>
<p>Ok, so to narrow it a bit, I have restored a backup previous the upgrades, and run the upgrade again, the upgrade was successfull this time, yet all images are gone.</p>



<a name="1463128"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463128" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463128">(Nov 13 2022 at 13:38)</a>:</h4>
<p><a href="/user_uploads/2/5d/ySxMqc5w5-hEJ4LID93-0ySW/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/5d/ySxMqc5w5-hEJ4LID93-0ySW/image.png" title="image.png"><img src="/user_uploads/2/5d/ySxMqc5w5-hEJ4LID93-0ySW/image.png"></a></div>



<a name="1463129"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463129" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463129">(Nov 13 2022 at 13:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="20576">Cosmic Sound</span> <a href="#narrow/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update/near/1463121">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="7">Tim Abbott</span> <a href="#narrow/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update/near/1462075">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="20576">Cosmic Sound</span> can you check whether the files in question exist in <code>/home/zulip/uploads/user_avatars/</code> on your server? (Or are you using the S3 backend?)</p>
</blockquote>
<p>I am checking now, not using S3.</p>
</blockquote>
<p>such folder does not even exists.</p>



<a name="1463130"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463130" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463130">(Nov 13 2022 at 13:40)</a>:</h4>
<p>The previous folder was there because I tried to upload an image</p>



<a name="1463131"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463131" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463131">(Nov 13 2022 at 13:59)</a>:</h4>
<p>So it is either the last upgrade made form git main or previous one that broke all avatars.</p>



<a name="1463133"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463133" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463133">(Nov 13 2022 at 14:00)</a>:</h4>
<p>For now I will restore a backup from 29th last month, and will stick with it, since this matter is fixed.</p>



<a name="1463509"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463509" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463509">(Nov 14 2022 at 18:29)</a>:</h4>
<p><span class="user-mention" data-user-id="20576">@Cosmic Sound</span> sorry, I had a typo -- the path would be <code>/home/zulip/uploads/avatars/</code>.</p>



<a name="1463510"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463510" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463510">(Nov 14 2022 at 18:31)</a>:</h4>
<p>I don't believe we've had any migrations in recent years that would affect avatars, so I'm quite puzzled; the last one a <code>grep</code> finds was from 2019.</p>



<a name="1463511"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463511" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463511">(Nov 14 2022 at 18:33)</a>:</h4>
<p>Do your backup tarballs contain the avatar files? You can use <code>tar -tf</code> to inspect that.</p>



<a name="1463512"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463512" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463512">(Nov 14 2022 at 18:34)</a>:</h4>
<p>I wonder if the backup/restore steps are part of the issue you're seeing; one theory would be that there's something wrong with either creating the backups or <code>restore-backup</code> such that those files are being lost?</p>



<a name="1463573"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463573" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463573">(Nov 14 2022 at 19:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="7">Tim Abbott</span> <a href="#narrow/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update/near/1463509">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="20576">Cosmic Sound</span> sorry, I had a typo -- the path would be <code>/home/zulip/uploads/avatars/</code>.</p>
</blockquote>
<p>It is very weird, last backup where I had the folder is 2 months old. Trying now to upgrade that release and see what happends</p>



<a name="1463623"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463623" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463623">(Nov 14 2022 at 19:23)</a>:</h4>
<p>OK, so that suggests that the folder was somehow deleted on the system 2 months ago; but if that was the case, how was it not noticed until the upgrade?</p>



<a name="1463624"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463624" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463624">(Nov 14 2022 at 19:23)</a>:</h4>
<p>(I suppose there could be some story where all the browsers had the avatars in their cache?)</p>



<a name="1463751"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463751" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463751">(Nov 14 2022 at 20:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="7">Tim Abbott</span> <a href="#narrow/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update/near/1463623">said</a>:</p>
<blockquote>
<p>OK, so that suggests that the folder was somehow deleted on the system 2 months ago; but if that was the case, how was it not noticed until the upgrade?</p>
</blockquote>
<p>also for me its is a mystery will need to look into this a bit more.</p>



<a name="1463753"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Avatars%20missing%20after%20last%20update/near/1463753" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cosmic Sound <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Avatars.20missing.20after.20last.20update.html#1463753">(Nov 14 2022 at 20:38)</a>:</h4>
<p>yet now seems all is good. could be somehow was deleted by mistake since I was cleaning up the old mattermost imports.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>