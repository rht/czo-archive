<html>
<head><meta charset="utf-8"><title>user login problem · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html">user login problem</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="656873"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/656873" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#656873">(Oct 30 2018 at 11:12)</a>:</h4>
<p>Hi everyone,</p>
<p>we have one user on our zulip installation who has problems logging on. After typing in e-mail/password combination theres no error message but he still keeps staying on the login site. I can see a "Sending notifiy_new_login email" in the worker.log so I suspect the login is fine.<br>
This happens on different browsers on different computers. I can login with my user on his system.</p>
<p>I'm not sure where to search for the culprit and am thankful for someone pushing me in the right direction.</p>
<p>Marc</p>



<a name="656874"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/656874" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#656874">(Oct 30 2018 at 11:15)</a>:</h4>
<p>Using zulip 1.9.0-rc2 docker installation</p>



<a name="656877"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/656877" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#656877">(Oct 30 2018 at 13:20)</a>:</h4>
<p>it works again, what I did was change the user Full Name (replacing the umlaut ö) and de- and reactivating the user.<br>
After that i was able to login with the e-mail (case sensitive) when I logged on with all lower cases it did not work but not show a error message either. Changing the mail adress to all lower case seemed to "fix" it and I'm getting an error message now when trying to log in with mixed case.</p>
<p>Not sure if it was really the User reconfiguration, so if anyone has an idea where to look on why this happened, that'd be great</p>



<a name="656939"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/656939" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#656939">(Oct 30 2018 at 18:21)</a>:</h4>
<p><span class="user-mention" data-user-id="10058">@Marc Samendinger</span> I suspect the issue is that he had some sort of invalid cookie in his browser, an the deactivate+reactivate expired that cookie.</p>



<a name="656940"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/656940" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#656940">(Oct 30 2018 at 18:22)</a>:</h4>
<p>Do you by any chance serve multiple Zulip organizations on your server, or recently switch domains for your Zulip server?</p>



<a name="656941"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/656941" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#656941">(Oct 30 2018 at 18:22)</a>:</h4>
<p>There are some possible corner cases around that which could have caused this that we could investigate.</p>



<a name="657054"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/657054" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#657054">(Oct 31 2018 at 08:14)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> the instance got installed last week, we're evaluating atm.</p>
<div class="codehilite"><pre><span></span>zulip@59979c0b0b34:~/deployments/current$ ./manage.py list_realms
id    string_id                                name
--    ---------                                ----
<span class="m">1</span>     zulip                                    None
<span class="m">2</span>                                              HWA AG
</pre></div>



<a name="657055"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/657055" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#657055">(Oct 31 2018 at 08:16)</a>:</h4>
<p>there are multiple realms, but I guess the zulip one is the system realm.<br>
I have to ask if the domain was changed after installation</p>



<a name="657056"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/657056" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#657056">(Oct 31 2018 at 08:44)</a>:</h4>
<p>domain was not changed</p>



<a name="657101"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/657101" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#657101">(Oct 31 2018 at 16:43)</a>:</h4>
<p><span class="user-mention" data-user-id="10058">@Marc Samendinger</span> OK, thanks for the info.  I haven't heard of a similar issue from other users.  One thing that's interesting about your report is that you said he had issues with different browsers on different computers, which suggests maybe it isn't a cookie issue.  Can you talk a bit about how your installation is configured?  E.g. is it using LDAP authentication?  I'd like to carefully read the codepath looking for any path that would lead to a redirect back to the login screen after sending the notify_new_login email...</p>



<a name="658223"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658223" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658223">(Nov 05 2018 at 09:10)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> We're using the docker image, the docker-compose.yml is not modified, except the obvious things like email, smtphost etc.</p>
<div class="codehilite"><pre><span></span>version: <span class="s1">&#39;2&#39;</span>
services:
  database:
    image: <span class="s1">&#39;zulip/zulip-postgresql&#39;</span>
    environment:
      POSTGRES_DB: zulip
      POSTGRES_USER: zulip
      POSTGRES_PASSWORD: zulip
    volumes:
      - <span class="s1">&#39;/opt/docker/zulip/postgresql/data:/var/lib/postgresql/data:rw&#39;</span>
  memcached:
    image: <span class="s1">&#39;quay.io/sameersbn/memcached:latest&#39;</span>
    restart: always
  rabbitmq:
    image: <span class="s1">&#39;rabbitmq:3.7.7&#39;</span>
    hostname: zulip-rabbit
    restart: always
    environment:
        RABBITMQ_DEFAULT_USER: <span class="s1">&#39;zulip&#39;</span>
        RABBITMQ_DEFAULT_PASS: <span class="s1">&#39;zulip&#39;</span>
    volumes:
      - <span class="s1">&#39;/opt/docker/zulip/rabbitmq:/var/lib/rabbitmq:rw&#39;</span>
  redis:
    image: <span class="s1">&#39;quay.io/sameersbn/redis:latest&#39;</span>
    volumes:
      - <span class="s1">&#39;/opt/docker/zulip/redis:/var/lib/redis:rw&#39;</span>
  zulip:
    image: <span class="s1">&#39;zulip/docker-zulip:1.9.0-rc2-0&#39;</span>
    build:
      context: .
      args:
        <span class="c1"># Change these if you want to build zulip from a different repo/branch</span>
        ZULIP_GIT_URL: https://github.com/zulip/zulip.git
        ZULIP_GIT_REF: <span class="m">1</span>.9.0-rc2
        <span class="c1"># Set this up if you plan to use your own CA certificate bundle for building</span>
        <span class="c1"># CUSTOM_CA_CERTIFICATES:</span>
    ports:
      - <span class="s1">&#39;80:80&#39;</span>
      - <span class="s1">&#39;443:443&#39;</span>
    environment:
      DB_HOST: <span class="s1">&#39;database&#39;</span>
      DB_HOST_PORT: <span class="s1">&#39;5432&#39;</span>
      DB_USER: <span class="s1">&#39;zulip&#39;</span>
      SSL_CERTIFICATE_GENERATION: <span class="s1">&#39;self-signed&#39;</span>
      SETTING_MEMCACHED_LOCATION: <span class="s1">&#39;memcached:11211&#39;</span>
      SETTING_RABBITMQ_HOST: <span class="s1">&#39;rabbitmq&#39;</span>
      SETTING_REDIS_HOST: <span class="s1">&#39;redis&#39;</span>
      SECRETS_email_password: <span class="s1">&#39;123456789&#39;</span>
      SECRETS_rabbitmq_password: <span class="s1">&#39;zulip&#39;</span>
      SECRETS_postgres_password: <span class="s1">&#39;zulip&#39;</span>
      SECRETS_secret_key: <span class="s1">&#39;REPLACE_WITH_SECURE_SECRET_KEY&#39;</span>
      SETTING_EXTERNAL_HOST: <span class="s1">&#39;zulip.hwa.local&#39;</span>
      SETTING_ZULIP_ADMINISTRATOR: <span class="s1">&#39;zulip@hwaag.com&#39;</span>
      SETTING_EMAIL_HOST: <span class="s1">&#39;smtp.hwa.local&#39;</span>  <span class="c1"># e.g. smtp.example.com</span>
      SETTING_EMAIL_HOST_USER: <span class="s1">&#39;&#39;</span>
      SETTING_EMAIL_PORT: <span class="s1">&#39;25&#39;</span>
      <span class="c1"># It seems that the email server needs to use ssl or tls and can&#39;t be used without it</span>
      SETTING_EMAIL_USE_SSL: <span class="s1">&#39;False&#39;</span>
      SETTING_EMAIL_USE_TLS: <span class="s1">&#39;True&#39;</span>
      ZULIP_AUTH_BACKENDS: <span class="s1">&#39;EmailAuthBackend&#39;</span>
      <span class="c1"># Uncomment this when configuring the mobile push notifications service</span>
      <span class="c1"># SETTING_PUSH_NOTIFICATION_BOUNCER_URL: &#39;https://push.zulipchat.com&#39;</span>
    volumes:
      - <span class="s1">&#39;/opt/docker/zulip/zulip:/data:rw&#39;</span>
</pre></div>



<a name="658224"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658224" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658224">(Nov 05 2018 at 09:12)</a>:</h4>
<p>We havent't changed the Authentication Backend so are still using EmailAuthBackend. If there is any other info that might be helpful, please let me know and I will get the info.<br>
Sorry for replying late but I haven't been in the office for the last days.</p>



<a name="658225"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658225" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658225">(Nov 05 2018 at 09:30)</a>:</h4>
<p>One more thing that might be interesting, the user reported that he wanted to reset the password after he was unable to login. He received the reset mail but clicking on it only gave the message that the link is not valid.</p>



<a name="658227"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658227" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658227">(Nov 05 2018 at 09:35)</a>:</h4>
<p><span class="user-mention" data-user-id="10058">@Marc Samendinger</span> are you hosting the server behind a proxy or something?</p>



<a name="658228"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658228" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658228">(Nov 05 2018 at 09:36)</a>:</h4>
<p>I'm having a hard time coming up with plausible theories for why this would be broken for this one user but not for everyone else.</p>



<a name="658229"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658229" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658229">(Nov 05 2018 at 09:36)</a>:</h4>
<p>inside the docker container is a nginx engine running</p>



<a name="658230"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658230" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658230">(Nov 05 2018 at 09:38)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> </p>
<div class="codehilite"><pre><span></span>server <span class="o">{</span>
    listen <span class="m">80</span><span class="p">;</span>
    <span class="k">return</span> <span class="m">301</span> https://<span class="nv">$host$request_uri</span><span class="p">;</span>
<span class="o">}</span>

include /etc/nginx/zulip-include/upstreams<span class="p">;</span>

server <span class="o">{</span>
    listen <span class="m">443</span><span class="p">;</span>

    ssl on<span class="p">;</span>
    ssl_certificate /etc/ssl/certs/zulip.combined-chain.crt<span class="p">;</span>
    ssl_certificate_key /etc/ssl/private/zulip.key<span class="p">;</span>

    location /user_avatars <span class="o">{</span>
        add_header X-Content-Type-Options nosniff<span class="p">;</span>
        add_header Content-Security-Policy <span class="s2">&quot;default-src &#39;none&#39; img-src &#39;self&#39;&quot;</span><span class="p">;</span>
        include /etc/nginx/zulip-include/uploads.types<span class="p">;</span>
        <span class="nb">alias</span> /home/zulip/uploads/avatars<span class="p">;</span>
    <span class="o">}</span>

    location /local-static <span class="o">{</span>
        <span class="nb">alias</span> /home/zulip/local-static<span class="p">;</span>
    <span class="o">}</span>

    include /etc/nginx/zulip-include/certbot<span class="p">;</span>
    include /etc/nginx/zulip-include/app<span class="p">;</span>
    include /etc/nginx/zulip-include/uploads.route<span class="p">;</span>
<span class="o">}</span>
</pre></div>



<a name="658231"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658231" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658231">(Nov 05 2018 at 09:42)</a>:</h4>
<p>theres nothing in the nginx error.log, I'm searching through the access.log</p>



<a name="658233"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658233" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658233">(Nov 05 2018 at 09:51)</a>:</h4>
<p>to me it looks OK, will it help to have the logs? just let me know which logs can help, if any.</p>



<a name="658234"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658234" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658234">(Nov 05 2018 at 10:00)</a>:</h4>
<p>It happened at  08:42</p>
<div class="codehilite"><pre><span></span>/var/log/zulip/server.log

<span class="m">2018</span>-10-30 <span class="m">08</span>:40:34.590 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   8ms <span class="o">(</span>lp: <span class="m">16</span>.3s<span class="o">)</span> <span class="o">(</span>db: 1ms/1q<span class="o">)</span> /json/events <span class="o">[</span><span class="m">1540706471</span>:6/1/message<span class="o">]</span> <span class="o">(</span>U.Ser@hwaag.com via website<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:40:49.023 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  11ms <span class="o">(</span>db: 2ms/3q<span class="o">)</span> /json/users/me/presence <span class="o">(</span>U.Ser@hwaag.com via website<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:41:25.708 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   3ms <span class="o">(</span>lp: <span class="m">51</span>.0s<span class="o">)</span> /json/events <span class="o">[</span><span class="m">1540706471</span>:6/1/heartbeat<span class="o">]</span> <span class="o">(</span>U.Ser@hwaag.com via website<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:41:38.996 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  11ms <span class="o">(</span>db: 2ms/3q<span class="o">)</span> /json/users/me/presence <span class="o">(</span>U.Ser@hwaag.com via website<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:41:58.081 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   3ms <span class="o">(</span>lp: <span class="m">32</span>.4s<span class="o">)</span> /json/events <span class="o">[</span><span class="m">1540706471</span>:6/1/update_message_flags<span class="o">]</span> <span class="o">(</span>U.Ser@hwaag.com via website<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:41:58.084 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  16ms <span class="o">(</span>db: 0ms/3q<span class="o">)</span> /json/messages/flags <span class="o">[</span>add read/2<span class="o">]</span> actually <span class="m">2</span> <span class="o">(</span>U.Ser@hwaag.com via website<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:42:28.981 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  19ms <span class="o">(</span>db: 2ms/3q<span class="o">)</span> /json/users/me/presence <span class="o">(</span>U.Ser@hwaag.com via website<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:42:41.811 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">302</span>   1ms / <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:42:41.814 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">301</span>   1ms /login <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:42:41.828 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>  11ms <span class="o">(</span>db: 2ms/2q<span class="o">)</span> /login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:42:43.125 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   3ms <span class="o">(</span>lp: <span class="m">45</span>.0s<span class="o">)</span> /json/events <span class="o">[</span><span class="m">1540706471</span>:6/1/heartbeat<span class="o">]</span> <span class="o">(</span>U.Ser@hwaag.com via website<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:42:53.324 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  29ms <span class="o">(</span>md: 7ms/1<span class="o">)</span> <span class="o">(</span>db: 1ms/3q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:01.522 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  16ms <span class="o">(</span>db: 1ms/3q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:15.545 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  13ms <span class="o">(</span>db: 1ms/3q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:18.959 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  15ms <span class="o">(</span>db: 2ms/3q<span class="o">)</span> /json/users/me/presence <span class="o">(</span>U.Ser@hwaag.com via website<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:20.479 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">302</span>  28ms <span class="o">(</span>db: 3ms/6q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:20.490 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">302</span>   6ms <span class="o">(</span>db: 1ms/4q<span class="o">)</span> / <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:20.493 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">301</span>   1ms /login <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:20.507 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>  11ms <span class="o">(</span>db: 1ms/2q<span class="o">)</span> /login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:27.254 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">302</span>  29ms <span class="o">(</span>db: 2ms/8q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:27.267 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">302</span>   8ms <span class="o">(</span>db: 0ms/4q<span class="o">)</span> / <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:27.270 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">301</span>   1ms /login <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:27.288 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>  15ms <span class="o">(</span>db: 5ms/2q<span class="o">)</span> /login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:36.150 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   3ms <span class="o">(</span>lp: <span class="m">53</span>.0s<span class="o">)</span> /json/events <span class="o">[</span><span class="m">1540706471</span>:6/1/heartbeat<span class="o">]</span> <span class="o">(</span>U.Ser@hwaag.com via website<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:38.910 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  16ms <span class="o">(</span>db: 2ms/3q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:41.856 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   SOCKET  <span class="m">200</span>   0ms /socket/close <span class="o">[</span><span class="nv">transport</span><span class="o">=</span>websocket<span class="o">]</span> <span class="o">(</span>U.Ser@hwaag.com via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:43:47.893 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  13ms <span class="o">(</span>db: 1ms/3q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:44:11.897 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  17ms <span class="o">(</span>db: 2ms/3q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:44:22.825 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   8ms <span class="o">(</span>db: 1ms/2q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:44:31.484 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  24ms <span class="o">(</span>md: 10ms/1<span class="o">)</span> <span class="o">(</span>db: 1ms/3q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:44:35.398 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  22ms <span class="o">(</span>db: 3ms/3q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:44:36.941 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   9ms <span class="o">(</span>db: 1ms/2q<span class="o">)</span> /accounts/password/reset/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:44:46.204 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">302</span>  <span class="m">5</span>.5s <span class="o">(</span>db: 2ms/2q<span class="o">)</span> /accounts/password/reset/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:44:46.215 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   6ms <span class="o">(</span>db: 1ms/1q<span class="o">)</span> /accounts/password/reset/done/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:44:58.077 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>  25ms <span class="o">(</span>db: 2ms/2q<span class="o">)</span> /accounts/password/reset/MjU/50v-65a3e400cc86a76059e6/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:05.528 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   8ms <span class="o">(</span>db: 1ms/2q<span class="o">)</span> /accounts/password/reset/MjU/50v-65a3e400cc86a76059e6/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:13.398 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">302</span>   1ms / <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:13.401 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">301</span>   1ms /login <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:13.412 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   9ms <span class="o">(</span>db: 1ms/2q<span class="o">)</span> /login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:17.073 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">302</span>  25ms <span class="o">(</span>db: 3ms/8q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:17.084 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">302</span>   6ms <span class="o">(</span>db: 1ms/4q<span class="o">)</span> / <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:17.087 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">301</span>   1ms /login <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:17.102 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>  13ms <span class="o">(</span>db: 2ms/2q<span class="o">)</span> /login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:25.252 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">200</span>  14ms <span class="o">(</span>db: 1ms/3q<span class="o">)</span> /accounts/login/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:27.270 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   8ms <span class="o">(</span>db: 1ms/2q<span class="o">)</span> /accounts/password/reset/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:52.997 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   POST    <span class="m">302</span>  <span class="m">5</span>.3s <span class="o">(</span>db: 1ms/2q<span class="o">)</span> /accounts/password/reset/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:45:53.016 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>  12ms <span class="o">(</span>db: 2ms/1q<span class="o">)</span> /accounts/password/reset/done/ <span class="o">(</span>unauth via ?<span class="o">)</span>
<span class="m">2018</span>-10-30 <span class="m">08</span>:46:13.890 INFO <span class="o">[</span>zr<span class="o">]</span> <span class="m">192</span>.168.58.19   GET     <span class="m">200</span>   8ms <span class="o">(</span>db: 1ms/2q<span class="o">)</span> /accounts/password/reset/MjU/50v-65a3e400cc86a76059e6/ <span class="o">(</span>unauth via ?<span class="o">)</span>
</pre></div>



<a name="658412"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658412" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658412">(Nov 06 2018 at 04:04)</a>:</h4>
<p>Yeah, I don't see a request coming in at all to the GitLab endpoint, which makes me think the problem is on the GitLab side. <span class="user-mention" data-user-id="10058">@Marc Samendinger</span></p>



<a name="658433"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658433" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658433">(Nov 06 2018 at 07:50)</a>:</h4>
<p>I'm a bit confused <span class="user-mention" data-user-id="7">@Tim Abbott</span>  what do you mean with "problem is on the GitLab side" we're not using GitLab authentication, the only authentication we use is the EmailAuthBackend</p>



<a name="658598"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658598" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658598">(Nov 06 2018 at 20:27)</a>:</h4>
<p><span class="user-mention" data-user-id="10058">@Marc Samendinger</span> oh, oops, I confused what you were talking about with another issue someone was having related to GitLab.</p>



<a name="658599"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658599" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658599">(Nov 06 2018 at 20:29)</a>:</h4>
<p>Can you give details on the specific browsers and versions (and have the user check that clearing cookies doesn't resolve the issue)?  Aside from the claim that they used multiple browsers on different computers, this sounds a lot like a problem where some browser extension is disabling cookies (or similar).</p>



<a name="658890"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/658890" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Samendinger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#658890">(Nov 07 2018 at 09:52)</a>:</h4>
<p>I think to further debug we'll have to wait for the problem to happen again then. <br>
Versions in use are:<br>
Internet Explorer 11.0.9600.19035<br>
Chrome 70.0.3538.77<br>
Chrome Canary 72.0.3602.0 <br>
After the login was not working I reset his password and tried to login from my computer. That didn't work either, while I was able to login with my user, so I don't think it was a cookie issue.<br>
On both Chrome installations there are no extensions  installed besides the ones that came with the Chrome installation (Google Docs Offline, Docs, Sheets and Slides)<br>
If it happens again I will snapshot the installation and copy it to my lab environment to make further tests.</p>
<p>Thank you for the time you put into this <span class="user-mention" data-user-id="7">@Tim Abbott</span> ! highly appreciated :)</p>



<a name="659774"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/659774" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Williamson <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#659774">(Nov 09 2018 at 01:39)</a>:</h4>
<p>Anyone available to provide some assistance?</p>



<a name="659789"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/659789" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#659789">(Nov 09 2018 at 04:51)</a>:</h4>
<p><span class="user-mention" data-user-id="10238">@Caleb Williamson</span> is this part of <span class="user-mention" data-user-id="10058">@Marc Samendinger</span>'s question?</p>



<a name="660697"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/660697" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stavros Korokithakis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#660697">(Nov 12 2018 at 23:59)</a>:</h4>
<p>I am getting the exact same error on <a href="https://codeshelter.zulipchat.com/" target="_blank" title="https://codeshelter.zulipchat.com/">https://codeshelter.zulipchat.com/</a>. I am trying to log in, it succeeds, I see the messages for one second, then a red message flashes and I am bounced back to the login page. It's caused by a 401 that is being returned by <code>https://codeshelter.zulipchat.com/json/events?dont_block=false&amp;queue_id=1541572314:83407&amp;last_event_id=-1&amp;client_gravatar=true</code>.</p>



<a name="660699"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/660699" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stavros Korokithakis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#660699">(Nov 13 2018 at 00:00)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> I am not sure whether this needs to be escalated, as it involves the main server (<a href="http://zulipchat.com" target="_blank" title="http://zulipchat.com">zulipchat.com</a>) and it's preventing me from logging in.</p>



<a name="660700"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/660700" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stavros Korokithakis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#660700">(Nov 13 2018 at 00:01)</a>:</h4>
<p>It happens on both Firefox and Chrome, incognito or not.</p>



<a name="660707"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/660707" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#660707">(Nov 13 2018 at 00:23)</a>:</h4>
<p><span class="user-mention" data-user-id="6757">@Stavros Korokithakis</span> we're looking into this as a high priority; it seems to be a recent regression.</p>



<a name="660708"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/660708" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stavros Korokithakis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#660708">(Nov 13 2018 at 00:23)</a>:</h4>
<p>Ah, alas :( Any workarounds I can do now to log in?</p>



<a name="660710"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/660710" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#660710">(Nov 13 2018 at 00:24)</a>:</h4>
<p>Not yet.</p>



<a name="660711"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/660711" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stavros Korokithakis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#660711">(Nov 13 2018 at 00:33)</a>:</h4>
<p>Err, it's fixed now...</p>



<a name="661250"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/661250" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stavros Korokithakis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#661250">(Nov 14 2018 at 15:27)</a>:</h4>
<p>I tried to create another organization and I am getting hit by the same bug... Can someone delete that so I can recreate my account and log in? The domain is "elation".</p>



<a name="661486"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/661486" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#661486">(Nov 14 2018 at 20:05)</a>:</h4>
<p><span class="user-mention" data-user-id="6757">@Stavros Korokithakis</span> can you try logging in again now?</p>



<a name="661602"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/661602" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stavros Korokithakis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#661602">(Nov 14 2018 at 22:18)</a>:</h4>
<p>That worked, thanks, but the underlying bug is still there, it seems.</p>



<a name="661603"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/661603" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#661603">(Nov 14 2018 at 22:33)</a>:</h4>
<p><span class="user-mention" data-user-id="6757">@Stavros Korokithakis</span> yes, definitely.  What I've now confirmed is that if we flush memcached (one of the steps in the upgrade process), it fixes the issue for everyone who got into the bad state by resetting their password.  We're still trying to debug why resetting one's password started resulting in users entering this state in the last few days.</p>



<a name="661604"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/661604" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stavros Korokithakis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#661604">(Nov 14 2018 at 22:36)</a>:</h4>
<p>Can you trace the code to see why authentication fails? My guess is that Django stores the password using one hashing method but the cache thinks it's another method.</p>



<a name="661605"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/661605" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#661605">(Nov 14 2018 at 22:59)</a>:</h4>
<p>(Not going to do the debugging play-by-play here since this is pretty complicated)</p>



<a name="661671"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/661671" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stavros Korokithakis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#661671">(Nov 15 2018 at 00:56)</a>:</h4>
<p>Maybe you aren't updating the password hash in the session in Memcached, so the session authentication middleware sees that the hash is changed and immediately invalidates the session</p>



<a name="661672"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/661672" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stavros Korokithakis <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#661672">(Nov 15 2018 at 00:58)</a>:</h4>
<p>Hmm, no, you are...</p>



<a name="661745"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/661745" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#661745">(Nov 15 2018 at 06:18)</a>:</h4>
<p><span class="user-mention" data-user-id="6757">@Stavros Korokithakis</span> we believe this issue is now resolved: Several affected users have reported this issue as fixed, and after our latest change intended to fix this, we can no longer reproduce the issue.  Please let us know if you're still experiencing problems logging in, and sorry for the inconvenience!</p>



<a name="661746"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/661746" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#661746">(Nov 15 2018 at 06:19)</a>:</h4>
<p>The problem here appears to be some as-yet-undetermined bug in Django's <code>cached_db</code> session management layer; we were able to reproduce that (A) flushing that cache fixed any users in the broken state, and our resolution at this time is to switch to the non-cache-using <code>db</code> session layer, which has a likely invisible performance cost and seems to have resolved the problem.</p>



<a name="661747"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/user%20login%20problem/near/661747" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/user.20login.20problem.html#661747">(Nov 15 2018 at 06:19)</a>:</h4>
<p>I expect to be doing further work to debug the root cause, since this is a nasty problem we'd like to get fixed in Django upstream.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>