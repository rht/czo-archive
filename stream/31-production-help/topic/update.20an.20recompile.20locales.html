<html>
<head><meta charset="utf-8"><title>update an recompile locales · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html">update an recompile locales</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1369767"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1369767" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1369767">(Apr 19 2022 at 07:12)</a>:</h4>
<p>Hello,<br>
I have seen that in deployments I have json and po files for locales. I want to update the locales to change some string. I guess changing the json the restarting Zulip would work. But how to do with the po? Need to be complied to mo? How?<br>
Is everything in<code>/home/zulip/deployments/${install_date}/locale/${locale}/</code>. Right?</p>



<a name="1369922"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1369922" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1369922">(Apr 19 2022 at 17:17)</a>:</h4>
<p>This topic was moved here from <a class="stream-topic" data-stream-id="2" href="/#narrow/stream/2-general/topic/update.20an.20recompile.20locales">#general &gt; update an recompile locales</a> by <span class="user-mention silent" data-user-id="19257">Alya Abbott</span>.</p>



<a name="1370110"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370110" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370110">(Apr 19 2022 at 21:09)</a>:</h4>
<p><span class="user-mention" data-user-id="24035">@Ghazi Triki</span> you need to run <code>manage.py compilemessages</code> after changing the strings to compile it.</p>



<a name="1370111"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370111" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370111">(Apr 19 2022 at 21:09)</a>:</h4>
<p>You can read more about this <code>.po</code> =&gt; <code>.mo</code> process in the Django documentation.</p>



<a name="1370112"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370112" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370112">(Apr 19 2022 at 21:10)</a>:</h4>
<p>Amazing, looks easy, thank you <span class="user-mention" data-user-id="7">@Tim Abbott</span></p>



<a name="1370172"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370172" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370172">(Apr 19 2022 at 22:26)</a>:</h4>
<p>OK updated json and mo files wiht <code>sed</code>then delted <code>.po</code> files, now when I execute <code>./manage.py compilemessages</code> I get this error</p>
<div class="codehilite"><pre><span></span><code>zulip@echat:~/deployments/2022-04-18-13-42-51$ ./manage.py compilemessages -s
fatal: not a git repository (or any of the parent directories): .git
Traceback (most recent call last):
  File &quot;./manage.py&quot;, line 157, in &lt;module&gt;
    execute_from_command_line(sys.argv)
  File &quot;./manage.py&quot;, line 122, in execute_from_command_line
    utility.execute()
  File &quot;/srv/zulip-venv-cache/726c7d1d35d9cd61bb4b70e98167a1db7b0c524d/zulip-py3-venv/lib/python3.8/site-packages/django/core/management/__init__.py&quot;, line 413, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File &quot;/srv/zulip-venv-cache/726c7d1d35d9cd61bb4b70e98167a1db7b0c524d/zulip-py3-venv/lib/python3.8/site-packages/django/core/management/base.py&quot;, line 354, in run_from_argv
    self.execute(*args, **cmd_options)
  File &quot;/srv/zulip-venv-cache/726c7d1d35d9cd61bb4b70e98167a1db7b0c524d/zulip-py3-venv/lib/python3.8/site-packages/django/core/management/base.py&quot;, line 398, in execute
    output = self.handle(*args, **options)
  File &quot;/home/zulip/deployments/2022-04-18-13-42-51/zerver/management/commands/compilemessages.py&quot;, line 30, in handle
    self.extract_language_options()
  File &quot;/home/zulip/deployments/2022-04-18-13-42-51/zerver/management/commands/compilemessages.py&quot;, line 118, in extract_language_options
    percentage = self.get_translation_percentage(locale_path, locale)
  File &quot;/home/zulip/deployments/2022-04-18-13-42-51/zerver/management/commands/compilemessages.py&quot;, line 143, in get_translation_percentage
    po = polib.pofile(self.get_po_filename(locale_path, locale))
  File &quot;/srv/zulip-venv-cache/726c7d1d35d9cd61bb4b70e98167a1db7b0c524d/zulip-py3-venv/lib/python3.8/site-packages/polib.py&quot;, line 130, in pofile
    return _pofile_or_mofile(pofile, &#39;pofile&#39;, **kwargs)
  File &quot;/srv/zulip-venv-cache/726c7d1d35d9cd61bb4b70e98167a1db7b0c524d/zulip-py3-venv/lib/python3.8/site-packages/polib.py&quot;, line 78, in _pofile_or_mofile
    instance = parser.parse()
  File &quot;/srv/zulip-venv-cache/726c7d1d35d9cd61bb4b70e98167a1db7b0c524d/zulip-py3-venv/lib/python3.8/site-packages/polib.py&quot;, line 1428, in parse
    raise IOError(&#39;Syntax error in po file %s(line %s)&#39; %
OSError: Syntax error in po file (line 1)
</code></pre></div>



<a name="1370174"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370174" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370174">(Apr 19 2022 at 22:31)</a>:</h4>
<p>Looks like I messed it up, mo is complied and po is not hhhh</p>



<a name="1370183"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370183" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370183">(Apr 19 2022 at 22:46)</a>:</h4>
<p>OK Got everything complied, but the updated locales strings are not showing in the html tempaltes of zserver, <span class="user-mention" data-user-id="7">@Tim Abbott</span> any clue?</p>



<a name="1370288"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370288" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370288">(Apr 20 2022 at 00:16)</a>:</h4>
<p><span class="user-mention" data-user-id="24035">@Ghazi Triki</span> I think actually you need to follow <a href="https://zulip.readthedocs.io/en/latest/production/upgrade-or-modify.html#making-changes">these instructions</a>.</p>



<a name="1370538"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370538" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370538">(Apr 20 2022 at 11:22)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Read it. Here is what I have done. I've updated locales in po file, compiled them, the restarted Zulip<br>
As example if I change the string "Log in to Zulip" in the files it does not work, then when I do a change in /home/zulip/deployments/2022-04-18-13-42-51/templates/zerver/login.html anything then just reload the page it works !! Locales sttrings not being fetched properly?</p>



<a name="1370539"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370539" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370539">(Apr 20 2022 at 11:30)</a>:</h4>
<p>I have this compiled in .mo</p>
<div class="codehilite" data-code-language="Gettext Catalog"><pre><span></span><code><span class="kd">#: templates/zerver/login.html:13</span>
<span class="nv">msgid</span> <span class="s">"Log in to Zulip"</span>
<span class="nv">msgstr</span> <span class="s">"Log in to virtual chat server"</span>
</code></pre></div>



<a name="1370544"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370544" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370544">(Apr 20 2022 at 11:55)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> I not a Django expert but I can confirm that locales string are not loaded in the production tempaltes, only the msgid is being used as fallback</p>



<a name="1370618"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370618" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370618">(Apr 20 2022 at 15:51)</a>:</h4>
<p><span class="user-mention" data-user-id="24035">@Ghazi Triki</span> can you explain more precisely what you're trying to do?  It sounds like you might be trying to change the English versions of strings using the translation system?</p>



<a name="1370619"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370619" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370619">(Apr 20 2022 at 15:52)</a>:</h4>
<p>In general if you follow the instructions I linked last, you'll generate a Git branch for your changes, and then <code>upgrade-zulip-from-git</code> can be used to install the changes correctly.</p>



<a name="1370622"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370622" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370622">(Apr 20 2022 at 15:53)</a>:</h4>
<p>I don't think the i18n system is used at all for the English (United States) locale -- I would expect it to just use the string in the template, which is written in American English in the first place.</p>



<a name="1370623"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1370623" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1370623">(Apr 20 2022 at 15:53)</a>:</h4>
<p>Generally we don't recommend doing any hand-editing in a production environment at all; make your changes and verify them in a development environment and then use the upgrade tool as documented, and you'll not run into this sort of trouble.</p>



<a name="1372584"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1372584" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1372584">(Apr 24 2022 at 15:58)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> I made updates on a fork, then built using <code>upgrade-zulip-from-git</code>. I don't see my locales changes.</p>



<a name="1372592"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1372592" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1372592">(Apr 24 2022 at 17:25)</a>:</h4>
<p><span class="user-mention" data-user-id="24035">@Ghazi Triki</span> can you answer my question above about whether you're trying to change English strings?</p>



<a name="1372606"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1372606" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1372606">(Apr 24 2022 at 18:45)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Yes English and non-English string values</p>



<a name="1373152"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373152" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373152">(Apr 25 2022 at 20:17)</a>:</h4>
<p>Let me describe what I have done</p>



<a name="1373158"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373158" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373158">(Apr 25 2022 at 20:20)</a>:</h4>
<p>1 - I forked the repo, created a new branch <code>eChat</code> from tag <code>v5.1</code><br>
2 - In po and json locales I replaced values (not keys) from "Zulip" to "eChat"<br>
3 - I replaced few images as logos<br>
4 - In my production server in configured <code> /etc/zulip/zulip.conf</code> to fetch from my git fork,<br>
5 - I upgraded Zulip using <code>sudo /home/zulip/deployments/current/scripts/upgrade-zulip-from-git echat</code></p>



<a name="1373160"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373160" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373160">(Apr 25 2022 at 20:21)</a>:</h4>
<p>Now in Zulip I still see Zulip string and images</p>



<a name="1373163"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373163" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373163">(Apr 25 2022 at 20:23)</a>:</h4>
<p><span class="user-mention" data-user-id="24035">@Ghazi Triki</span> yeah, I think the problem is that locale files aren't used for English (it instead just uses the strings in the HTML template itself, I think), and most references to Zulip are not tagged for translation.</p>



<a name="1373165"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373165" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373165">(Apr 25 2022 at 20:24)</a>:</h4>
<p>I'm not entirely sure about that -- we have no reason to test adding translation files for the default locale.</p>



<a name="1373167"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373167" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373167">(Apr 25 2022 at 20:25)</a>:</h4>
<p>Is there a reason you're not just changing the default strings directly in HTML templates (etc.) on your fork?</p>



<a name="1373169"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373169" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373169">(Apr 25 2022 at 20:28)</a>:</h4>
<p>As example  in<code>templates/zerver/register.html</code></p>



<a name="1373170"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373170" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373170">(Apr 25 2022 at 20:28)</a>:</h4>
<p>I can find this string</p>



<a name="1373171"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373171" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373171">(Apr 25 2022 at 20:28)</a>:</h4>
<div class="codehilite" data-code-language="HTML"><pre><span></span><code><span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">"source_realm_id"</span> <span class="na">class</span><span class="o">=</span><span class="s">"inline-block"</span><span class="p">&gt;</span>{{ _('Import settings from existing Zulip account') }}<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</code></pre></div>



<a name="1373172"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373172" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373172">(Apr 25 2022 at 20:30)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Do you mean that in locales are loaded for all languages except English? So for English the key is used as fallback string?</p>



<a name="1373178"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373178" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373178">(Apr 25 2022 at 20:33)</a>:</h4>
<p><span class="user-mention" data-user-id="24035">@Ghazi Triki</span> the <code>en</code> locale key is just used to define what strings exist for uploading to Transifex.</p>



<a name="1373179"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373179" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373179">(Apr 25 2022 at 20:34)</a>:</h4>
<p>mmm I switch the language to French and I can see the updated references !</p>



<a name="1373180"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373180" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373180">(Apr 25 2022 at 20:34)</a>:</h4>
<p>Any way to force loading <code>en</code> custom locales?</p>



<a name="1373199"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373199" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373199">(Apr 25 2022 at 20:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="24035">Ghazi Triki</span> <a href="#narrow/stream/31-production-help/topic/update.20an.20recompile.20locales/near/1373180">said</a>:</p>
<blockquote>
<p>Any way to force loading <code>en</code> custom locales?</p>
</blockquote>
<p>You can try spelunking the i18n code in <code>zerver/lib/i18n.py</code> and <code>static/js/i18n.ts</code>.</p>



<a name="1373200"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373200" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373200">(Apr 25 2022 at 20:53)</a>:</h4>
<p>I don't recall how this is implement, but it's decently likely there's an <code>en</code> conditional in there.</p>



<a name="1373217"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373217" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373217">(Apr 25 2022 at 21:00)</a>:</h4>
<p>Having that <code>en</code> exception is probably not-quite-right.  There are times when a concept has one word in English, but may have mulitple different words in other languages -- for example, "Home" might be used in two places in the UI, one for a home address, and the other to go to the main page of the app.  Having an <code>en</code> PO file means we can make the base strings be "Home address" and "Go to Homepage" and <em>translate</em> those en english to both be "Home," while leaving translators with the ability to translate those as <em>different</em> words in other languages.</p>
<p>It also allows easier changes like this one, where an english concept is localized into a different term.</p>



<a name="1373218"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373218" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373218">(Apr 25 2022 at 21:01)</a>:</h4>
<p>Well I think the "Home address" type case is handled by i18n systems with a separate context that goes alongside the string (Though we don't use that feature).</p>



<a name="1373219"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373219" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373219">(Apr 25 2022 at 21:01)</a>:</h4>
<p>That’s what <a href="https://docs.transifex.com/localization-tips-workflows/the-complete-guide-to-adding-context-to-strings">context</a> is for.</p>



<a name="1373221"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373221" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373221">(Apr 25 2022 at 21:02)</a>:</h4>
<p>So I think we're just getting a small performance optimization for English uses by skipping translating X =&gt; X.</p>



<a name="1373222"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373222" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373222">(Apr 25 2022 at 21:03)</a>:</h4>
<p>I don't think context solves the problem of there being one "Home" string which has two different semantic uses?</p>



<a name="1373223"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373223" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373223">(Apr 25 2022 at 21:04)</a>:</h4>
<p>You distinguish the strings by adding the context in the source code, e.g. with <a href="https://docs.djangoproject.com/en/4.0/topics/i18n/translation/#contextual-markers-1">Django’s <code>pgettext</code></a>.</p>



<a name="1373224"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373224" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373224">(Apr 25 2022 at 21:05)</a>:</h4>
<p>(Our custom <code>compilemessages</code> code likely doesn’t handle this, but we should fix it.)</p>



<a name="1373225"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373225" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373225">(Apr 25 2022 at 21:06)</a>:</h4>
<p>Ah, neat!  The Django docs are more useful than the Transifex ones on this front.  That's a feature I didn't know about before.</p>



<a name="1373226"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373226" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373226">(Apr 25 2022 at 21:07)</a>:</h4>
<p>But the point about using it for locale-specific terminology still stands, I think?</p>



<a name="1373227"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373227" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373227">(Apr 25 2022 at 21:09)</a>:</h4>
<p>Not sure which point you mean? But the idea is that if two strings are the same but with different contexts, that makes them not the same; they can be translated independently.</p>



<a name="1373228"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373228" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373228">(Apr 25 2022 at 21:10)</a>:</h4>
<p>Yeah, I get the contexts allow different translations.</p>
<p>I mean that <code>en</code> PO files allow one to localize "Zulip" as "Cool Chat" in english</p>



<a name="1373234"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373234" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373234">(Apr 25 2022 at 21:13)</a>:</h4>
<p>Yeah it might be nice to have an option to skip that optimization, but I think it’s up to Django.</p>



<a name="1373245"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373245" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373245">(Apr 25 2022 at 21:29)</a>:</h4>
<p>I guess here !!</p>



<a name="1373246"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373246" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373246">(Apr 25 2022 at 21:29)</a>:</h4>
<p><a href="https://github.com/zulip/zulip/blob/main/zerver/lib/i18n.py#L40-L41">https://github.com/zulip/zulip/blob/main/zerver/lib/i18n.py#L40-L41</a></p>



<a name="1373247"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373247" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373247">(Apr 25 2022 at 21:29)</a>:</h4>
<p>If I remove that condition it should work</p>



<a name="1373248"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373248" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373248">(Apr 25 2022 at 21:29)</a>:</h4>
<p>Wait actually, this optimization isn’t a thing. I just edited that string in <code>locale/en/LC_MESSAGES/django.po</code>, ran <code>manage.py compilemessages</code>, and it worked; the dev server shows my edited string.</p>



<a name="1373249"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373249" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373249">(Apr 25 2022 at 21:31)</a>:</h4>
<p>Ah yeah; that conditional is for frontend translations. (“Import settings from existing Zulip account” is a backend translation.)</p>



<a name="1373250"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373250" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373250">(Apr 25 2022 at 21:32)</a>:</h4>
<p>So we should re-jigger to we just skip the warning at <a href="https://github.com/zulip/zulip/blob/main/zerver/lib/i18n.py#L48">https://github.com/zulip/zulip/blob/main/zerver/lib/i18n.py#L48</a> for <code>en</code>, and otherwise not short-circuit it?</p>



<a name="1373251"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373251" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373251">(Apr 25 2022 at 21:32)</a>:</h4>
<p>(also, why is that a <code>print</code>?)</p>



<a name="1373253"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373253" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373253">(Apr 25 2022 at 21:33)</a>:</h4>
<p><span class="user-mention" data-user-id="699">@Anders Kaseorg</span> it works on dev but not working in production (does not make sense to me)</p>



<a name="1373255"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373255" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373255">(Apr 25 2022 at 21:35)</a>:</h4>
<p>Note that <code>locale/en/LC_MESSAGES/django.po</code> is not in the Git repository. It’s generated by <code>manage.py makemessages --locale=en</code>. You’ll need to <code>git add -f locale/en/LC_MESSAGES/django.po</code> and commit it if you want a production server installed from Git to see it.</p>



<a name="1373256"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373256" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373256">(Apr 25 2022 at 21:35)</a>:</h4>
<p>ahhh I see !! <code>en</code> not <code>en-US</code> !</p>



<a name="1373257"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373257" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373257">(Apr 25 2022 at 21:36)</a>:</h4>
<p>So I should just copy en-US to en and it should work, now I get it <span class="user-mention" data-user-id="699">@Anders Kaseorg</span></p>



<a name="1373259"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373259" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373259">(Apr 25 2022 at 21:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="12178">Alex Vandiver</span> <a href="#narrow/stream/31-production-help/topic/update.20an.20recompile.20locales/near/1373250">said</a>:</p>
<blockquote>
<p>So we should re-jigger to we just skip the warning at <a href="https://github.com/zulip/zulip/blob/main/zerver/lib/i18n.py#L48">https://github.com/zulip/zulip/blob/main/zerver/lib/i18n.py#L48</a> for <code>en</code>, and otherwise not short-circuit it?</p>
</blockquote>
<p>That would add a slightly unfortunate bloat to the non-cacheable <code>page_params</code> for our most common language. We may want to build a way to serve the translation data through cacheable static JSON files first.</p>



<a name="1373261"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373261" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373261">(Apr 25 2022 at 21:42)</a>:</h4>
<p>I don't see a <code>locale/en/</code> at current; how would that result in a large <code>page_params</code>, unless the user has added one?</p>



<a name="1373262"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373262" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373262">(Apr 25 2022 at 21:49)</a>:</h4>
<p>Hmm. We invoke <code>manage.py makemessages --locale=en</code> which generates it from various odd commands in the dev environment (<code>test-all</code>, <code>check-capitalization</code>, <code>check-frontend-i18n</code>, <code>push-translations</code>), and might propagate it to release tarballs if it exists?</p>



<a name="1373264"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373264" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373264">(Apr 25 2022 at 21:50)</a>:</h4>
<p>If we fix that, it’s probably fine.</p>



<a name="1373265"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373265" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373265">(Apr 25 2022 at 21:52)</a>:</h4>
<p>Oh, <code>build-release-tarball</code> runs from a temporary copy of the tree from the Git index, so it’s probably fine already.</p>



<a name="1373274"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373274" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373274">(Apr 25 2022 at 22:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="699">Anders Kaseorg</span> <a href="#narrow/stream/31-production-help/topic/update.20an.20recompile.20locales/near/1373259">said</a>:</p>
<blockquote>
<p>That would add a slightly unfortunate bloat to the non-cacheable <code>page_params</code> for our most common language. We may want to build a way to serve the translation data through cacheable static JSON files first.</p>
</blockquote>
<p>I guess that could work as long as we ensure that static JSON file is loaded before the JS -- I vaguely recall a benefit of moving it into <code>page_params</code> was avoiding having to deal with races where JS code was run before translation data was available, but could be misremembering.</p>



<a name="1373279"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373279" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373279">(Apr 25 2022 at 22:07)</a>:</h4>
<p>If that is a problem, we’re going to need to tackle it eventually for <a href="https://github.com/zulip/zulip/pull/18785">#18785</a>.</p>



<a name="1373287"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373287" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373287">(Apr 25 2022 at 22:10)</a>:</h4>
<p>Webpack has experimental top-level <code>await</code> support; we could use that hammer in <code>i18n.ts</code> if nothing else.</p>



<a name="1373293"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373293" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373293">(Apr 25 2022 at 22:12)</a>:</h4>
<p>Looks like I triggered a feature discussion, <span class="user-mention" data-user-id="699">@Anders Kaseorg</span> copying the en-us locale to en for production should be fine for me until this i18n issues is resolved?</p>



<a name="1373299"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373299" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373299">(Apr 25 2022 at 22:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="699">Anders Kaseorg</span> <a href="#narrow/stream/31-production-help/topic/update.20an.20recompile.20locales/near/1373287">said</a>:</p>
<blockquote>
<p>Webpack has experimental top-level <code>await</code> support; we could use that hammer in <code>i18n.ts</code> if nothing else.</p>
</blockquote>
<p>Yeah; there's probably a few ways around it; we just want to make sure the transition doesn't add an extra RTT for no reasons, which may be mostly covered by caching.</p>



<a name="1373328"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373328" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373328">(Apr 25 2022 at 22:41)</a>:</h4>
<p><span class="user-mention" data-user-id="24035">@Ghazi Triki</span> I don’t know where you got an “en-us” locale—we only have <code>en</code> and <code>en_GB</code>—so I can’t say whether that is a reasonable thing to copy.</p>
<p>(I would still recommend editing English strings in the source rather than attempting to do this through the translation system.)</p>



<a name="1373646"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373646" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373646">(Apr 26 2022 at 10:23)</a>:</h4>
<p><span class="user-mention" data-user-id="699">@Anders Kaseorg</span> sorry I meant en-GB. I copied it to "en" then deployed and it did not work. What should I do?</p>



<a name="1373763"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373763" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373763">(Apr 26 2022 at 18:18)</a>:</h4>
<p>We left the realm of “should” at the beginning of this discussion. What you should do is edit the strings in the source rather than attempting to do this through the translation system. You are forging an uncharted path here—which you’re allowed to try to do, but you can’t expect guidance at each step.</p>



<a name="1373937"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373937" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ghazi Triki <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373937">(Apr 26 2022 at 21:38)</a>:</h4>
<p><span class="user-mention" data-user-id="699">@Anders Kaseorg</span> surely not asking for guidance, but pointed the team to a path where localisation is not really working because of an exceptional condition in the code. I have followed all what have been shared but it did not give the right effect. Many thank all for your guidance</p>



<a name="1373950"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373950" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373950">(Apr 26 2022 at 22:02)</a>:</h4>
<p>You're not trying to localize -- you're trying to white-label using the localization system. It's not designed for that, and I don't think it makes sense for us to all spend time debugging for you why that hack isn't working for you.</p>



<a name="1373951"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/update%20an%20recompile%20locales/near/1373951" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/update.20an.20recompile.20locales.html#1373951">(Apr 26 2022 at 22:03)</a>:</h4>
<p>We've told you a non-hacky way to do what you're trying to achieve; you're of course welcome to keep doing something hacky for your installation instead, but we need to focus on improving Zulip for all its users, so we can't spend more attention on debugging this hack for you.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>