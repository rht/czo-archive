<html>
<head><meta charset="utf-8"><title>Install fails w/ RabbitMQ on OpenVZ VM · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Install.20fails.20w.2F.20RabbitMQ.20on.20OpenVZ.20VM.html">Install fails w/ RabbitMQ on OpenVZ VM</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="827357"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Install%20fails%20w/%20RabbitMQ%20on%20OpenVZ%20VM/near/827357" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Roman Bannack <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Install.20fails.20w.2F.20RabbitMQ.20on.20OpenVZ.20VM.html#827357">(Mar 06 2020 at 20:12)</a>:</h4>
<p>Dear all,</p>
<p>on my clean Ubuntu VM (OpenVZ), Zulip install fails because it can't install and/or start RabbitMQ Server. Here is from Zulips install log, <a href="https://pastebin.com/dMfLzk5M" target="_blank" title="https://pastebin.com/dMfLzk5M">full log here</a>:</p>
<div class="codehilite"><pre><span></span>Setting up rabbitmq-server <span class="o">(</span><span class="m">3</span>.6.10-1<span class="o">)</span> ...
Job <span class="k">for</span> rabbitmq-server.service failed because the control process exited with error code.
invoke-rc.d: initscript rabbitmq-server, action <span class="s2">&quot;start&quot;</span> failed.
● rabbitmq-server.service - RabbitMQ Messaging Server
   Loaded: loaded <span class="o">(</span>/lib/systemd/system/rabbitmq-server.service<span class="p">;</span> enabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
   Active: failed <span class="o">(</span>Result: exit-code<span class="o">)</span> since Fri <span class="m">2020</span>-03-06 <span class="m">20</span>:49:24 CET<span class="p">;</span> 9ms ago
  Process: <span class="m">16748</span> <span class="nv">ExecStartPost</span><span class="o">=</span>/usr/lib/rabbitmq/bin/rabbitmq-server-wait <span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span><span class="m">134</span><span class="o">)</span>
  Process: <span class="m">16747</span> <span class="nv">ExecStart</span><span class="o">=</span>/usr/sbin/rabbitmq-server <span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span><span class="m">134</span><span class="o">)</span>
 Main PID: <span class="m">16747</span> <span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span><span class="m">134</span><span class="o">)</span>

Mar <span class="m">06</span> <span class="m">20</span>:49:24 h08150821.stratoserver.net systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>: Starting RabbitMQ Messaging Server...
Mar <span class="m">06</span> <span class="m">20</span>:49:24 h08150821.stratoserver.net systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>: rabbitmq-server.service: Main process exited, <span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span><span class="m">134</span>/n/a
Mar <span class="m">06</span> <span class="m">20</span>:49:24 h08150821.stratoserver.net rabbitmq<span class="o">[</span><span class="m">16748</span><span class="o">]</span>: Failed to create dirty cpu scheduler thread <span class="m">13</span>, <span class="nv">error</span> <span class="o">=</span> <span class="m">11</span>
Mar <span class="m">06</span> <span class="m">20</span>:49:24 h08150821.stratoserver.net rabbitmq<span class="o">[</span><span class="m">16748</span><span class="o">]</span>: Aborted
Mar <span class="m">06</span> <span class="m">20</span>:49:24 h08150821.stratoserver.net systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>: rabbitmq-server.service: Control process exited, <span class="nv">code</span><span class="o">=</span>exited <span class="nv">status</span><span class="o">=</span><span class="m">134</span>
Mar <span class="m">06</span> <span class="m">20</span>:49:24 h08150821.stratoserver.net systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>: rabbitmq-server.service: Failed with result <span class="s1">&#39;exit-code&#39;</span>.
Mar <span class="m">06</span> <span class="m">20</span>:49:24 h08150821.stratoserver.net systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>: Failed to start RabbitMQ Messaging Server.
dpkg: error processing package rabbitmq-server <span class="o">(</span>--configure<span class="o">)</span>:
 installed rabbitmq-server package post-installation script subprocess returned error <span class="nb">exit</span> status <span class="m">1</span>
Errors were encountered <span class="k">while</span> processing:
 rabbitmq-server
E: Sub-process /usr/bin/dpkg returned an error code <span class="o">(</span><span class="m">1</span><span class="o">)</span>

Zulip installation failed <span class="o">(</span><span class="nb">exit</span> code <span class="m">100</span><span class="o">)</span>!
</pre></div>


<p>RabbitMQ-Server can not be installed/started manually, either (basically, same log output as above).</p>
<p>After a lot of research I somewhere read that this is some OpenVZ issue. But is it?</p>
<p>What I want to find out is whether I can get this running somehow on the current VM without changing providers, tariffs etc., or what the problem really is in the first place.</p>
<p>Any info/input appreciated!</p>



<a name="827385"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Install%20fails%20w/%20RabbitMQ%20on%20OpenVZ%20VM/near/827385" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Install.20fails.20w.2F.20RabbitMQ.20on.20OpenVZ.20VM.html#827385">(Mar 06 2020 at 20:37)</a>:</h4>
<p><span class="user-mention" data-user-id="14475">@Roman Bannack</span> I'd certainly believe that OpenVZ doesn't support RabbitMQ; it has a bunch of limits on what one is allowed to do.</p>



<a name="827387"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Install%20fails%20w/%20RabbitMQ%20on%20OpenVZ%20VM/near/827387" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Install.20fails.20w.2F.20RabbitMQ.20on.20OpenVZ.20VM.html#827387">(Mar 06 2020 at 20:38)</a>:</h4>
<p>This thread seems to suggest rabbitmq is just not supported there, and you'll need to use another hosting environment:</p>
<p><a href="https://groups.google.com/forum/#!topic/rabbitmq-users/l1DLd8-VTPc" target="_blank" title="https://groups.google.com/forum/#!topic/rabbitmq-users/l1DLd8-VTPc">https://groups.google.com/forum/#!topic/rabbitmq-users/l1DLd8-VTPc</a></p>



<a name="827455"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Install%20fails%20w/%20RabbitMQ%20on%20OpenVZ%20VM/near/827455" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Roman Bannack <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Install.20fails.20w.2F.20RabbitMQ.20on.20OpenVZ.20VM.html#827455">(Mar 06 2020 at 23:29)</a>:</h4>
<p>Thank you for this feedback. It's a pity, but now, at least, it's clear.</p>



<a name="828016"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Install%20fails%20w/%20RabbitMQ%20on%20OpenVZ%20VM/near/828016" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> PeGaSuS <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Install.20fails.20w.2F.20RabbitMQ.20on.20OpenVZ.20VM.html#828016">(Mar 07 2020 at 15:24)</a>:</h4>
<p>there are lots of good providers using KVM virtualization which is better. you can try/take a look at: Scaleway, Digital Ocean, OVH, Vpsag.. I've been in all of them and never had issues :)</p>



<a name="830009"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Install%20fails%20w/%20RabbitMQ%20on%20OpenVZ%20VM/near/830009" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hendrik Visage <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Install.20fails.20w.2F.20RabbitMQ.20on.20OpenVZ.20VM.html#830009">(Mar 11 2020 at 15:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="14475">Roman Bannack</span> <a href="#narrow/stream/31-production-help/topic/Install.20fails.20w.2F.20RabbitMQ.20on.20OpenVZ.20VM/near/827357" title="#narrow/stream/31-production-help/topic/Install.20fails.20w.2F.20RabbitMQ.20on.20OpenVZ.20VM/near/827357">said</a>:</p>
<blockquote>
<p>on my clean Ubuntu VM (OpenVZ), Zulip install fails because it can't install and/or start RabbitMQ Server. Here is from Zulips install log, <a href="https://pastebin.com/dMfLzk5M" target="_blank" title="https://pastebin.com/dMfLzk5M">full log here</a>:</p>
<p>Any info/input appreciated!</p>
</blockquote>
<p>I've seem similar with LXC on ProxMox, but recalled it's the <code>redis</code>that failed. Using the LXC I had to enable nested settings, as the "problems" is that <code>redis</code> (and then <code>rabbitmq</code> too I guess) makes use of certain lowlevel kernel/devices that is not exported in the usual or un-privileged cases, so yes, to run inside the Linux based containers, you'll need much more permissive stuff ;( time for VMs or run those only in VMs and the rest in LXC/OpenVZs <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>