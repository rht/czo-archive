<html>
<head><meta charset="utf-8"><title>zulip + nix · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html">zulip + nix</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="193918"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/193918" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Sagar <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#193918">(Apr 28 2017 at 15:52)</a>:</h4>
<p>Has anyone looked into installing Zulip on NixOS or writing a nix derivation for it?</p>



<a name="193919"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/193919" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#193919">(Apr 28 2017 at 15:54)</a>:</h4>
<p>I haven't heard of anybody trying it.</p>



<a name="193940"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/193940" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#193940">(Apr 28 2017 at 16:59)</a>:</h4>
<p><span class="user-mention" data-user-email="vaibhavsagar@gmail.com" data-user-id="174">@Vaibhav Sagar</span> I know <span class="user-mention" data-user-email="zulip@edanaher.net" data-user-id="420">@Evan Danaher</span> successfully installed the Zulip development environment on NixOS.</p>



<a name="193941"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/193941" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#193941">(Apr 28 2017 at 17:00)</a>:</h4>
<p>I'm not sure anyone's attempted the production configuration side of things</p>



<a name="194265"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/194265" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vaibhav Sagar <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#194265">(Apr 29 2017 at 01:59)</a>:</h4>
<p>Thanks! Just wondering if it's been done before and I couldn't find anything online. I'm pretty new to it myself but it might be fun to try when I have more experience.</p>



<a name="204148"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204148" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204148">(May 17 2017 at 04:05)</a>:</h4>
<p>Hi I am new in here, is it normal to have <code>Warning: Could not retrieve fact fqdn</code> when installing in production?</p>



<a name="204149"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204149" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204149">(May 17 2017 at 04:07)</a>:</h4>
<p><span class="user-mention" data-user-email="chester.lee.cold@gmail.com" data-user-id="2354">@Chester Li</span> I don't think so; the problem likely has to do with your /etc/hosts configuration</p>



<a name="204150"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204150" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204150">(May 17 2017 at 04:07)</a>:</h4>
<p>Or /etc/hostname</p>



<a name="204151"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204151" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204151">(May 17 2017 at 04:08)</a>:</h4>
<p>It shouldn't be a big problem; once install completes, you can iteratively debug using <code>/home/zulip/deployments/current/scripts/zulip-puppet-apply</code> while editing your DNS configuration</p>



<a name="204152"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204152" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204152">(May 17 2017 at 04:08)</a>:</h4>
<p>My /etc/hostname is a one-line file with <code>zenlayer</code>, there is no /etc/host</p>



<a name="204155"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204155" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204155">(May 17 2017 at 04:08)</a>:</h4>
<p>my installation failed</p>



<a name="204159"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204159" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204159">(May 17 2017 at 04:09)</a>:</h4>
<p>can you post <code>/var/log/zulip/install.log</code>?</p>



<a name="204164"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204164" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204164">(May 17 2017 at 04:12)</a>:</h4>
<p><a href="/user_uploads/2/ae/Ze4bk5tCLnRipwuHJxj93Ve3/install.log" target="_blank" title="install.log">install.log</a></p>



<a name="204165"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204165" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204165">(May 17 2017 at 04:12)</a>:</h4>
<p>oh, the problem is just that you didn't setup the SSL certificates</p>



<a name="204166"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204166" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204166">(May 17 2017 at 04:13)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> I have uploaded it</p>



<a name="204167"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204167" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204167">(May 17 2017 at 04:13)</a>:</h4>
<div class="codehilite"><pre><span></span>nginx: [emerg] BIO_new_file(&quot;/etc/ssl/certs/zulip.combined-chain.crt&quot;) failed (SSL: error:02001002:system library:fopen:No such file or directory:fopen(&#39;/etc/ssl/certs/zulip.combined
</pre></div>



<a name="204168"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204168" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204168">(May 17 2017 at 04:13)</a>:</h4>
<p>you can fix that, and then rerun the install script</p>



<a name="204169"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204169" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204169">(May 17 2017 at 04:13)</a>:</h4>
<p>I cp my certs into /root/certs and use <code>ln -s</code> to config symlinks</p>



<a name="204170"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204170" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204170">(May 17 2017 at 04:14)</a>:</h4>
<p>It's probably a typo, then -- look at the path in the error message and check to make sure it exists</p>



<a name="204172"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204172" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204172">(May 17 2017 at 04:16)</a>:</h4>
<p>No typo found..... probably i should inspect my previous ssl setup steps</p>



<a name="204174"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204174" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204174">(May 17 2017 at 04:17)</a>:</h4>
<p>You suggestion is so helpful, thank you <span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span></p>



<a name="204175"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204175" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204175">(May 17 2017 at 04:19)</a>:</h4>
<p>I haven't setup my nginx yet, would it be a problem on this stage?</p>



<a name="204176"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204176" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204176">(May 17 2017 at 04:27)</a>:</h4>
<p>Zulip installs nginx for you</p>



<a name="204184"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204184" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204184">(May 17 2017 at 05:22)</a>:</h4>
<p>Thank you! I change my cert dir to absolute directory, now it works</p>



<a name="204186"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204186" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204186">(May 17 2017 at 05:23)</a>:</h4>
<p>Awesome!  Is there something we should tweak in the documentation to help the next person?</p>



<a name="204213"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204213" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204213">(May 17 2017 at 05:39)</a>:</h4>
<p><span class="user-mention" data-user-email="chester.lee.cold@gmail.com" data-user-id="2354">@Chester Li</span> wait, are you running zulip-prod on NixOS?</p>



<a name="204215"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204215" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204215">(May 17 2017 at 05:51)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> in <a href="https://zulip.readthedocs.io/en/latest/ssl-certificates.html" target="_blank" title="https://zulip.readthedocs.io/en/latest/ssl-certificates.html">https://zulip.readthedocs.io/en/latest/ssl-certificates.html</a>, I think it would be a good idea to remid developers to use absolute directory of real certs, like <code>ln -s /etc/letsencrypt/live/YOUR_DOMAIN/privkey.pem</code> instead of <code>cd /etc</code> + <code>ln -s /letsencrypt/live/YOUR_DOMAIN/privkey.pem</code></p>



<a name="204217"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204217" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204217">(May 17 2017 at 05:53)</a>:</h4>
<p><span class="user-mention" data-user-email="rhtbot@protonmail.com" data-user-id="2328">@Rein Zustand</span> nope, I am running zulip on ubuntu, perhaps I am on a wrong topic....</p>



<a name="204220"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204220" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204220">(May 17 2017 at 06:20)</a>:</h4>
<p><span class="user-mention" data-user-email="chester.lee.cold@gmail.com" data-user-id="2354">@Chester Li</span> I see, no worries (at least the build err was solved). As with the documentation, the step already uses absolute paths, and there are just way too many possible combinations of human/buildenv errs to be anticipated by the doc.</p>



<a name="204221"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/zulip%20%2B%20nix/near/204221" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/zulip.20.2B.20nix.html#204221">(May 17 2017 at 06:21)</a>:</h4>
<p>gotcha\</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>