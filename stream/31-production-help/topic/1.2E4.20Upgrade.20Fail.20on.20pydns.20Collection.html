<html>
<head><meta charset="utf-8"><title>1.4 Upgrade Fail on pydns Collection · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/1.2E4.20Upgrade.20Fail.20on.20pydns.20Collection.html">1.4 Upgrade Fail on pydns Collection</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="21719"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/1.4%20Upgrade%20Fail%20on%20pydns%20Collection/near/21719" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/1.2E4.20Upgrade.20Fail.20on.20pydns.20Collection.html#21719">(Sep 03 2016 at 05:36)</a>:</h4>
<p>Collecting pydns==2.3.6 (from -r /home/zulip/deployments/2016-09-03-13-13-17/requirements/py2_common.txt (line 4))<br>
  Downloading pydns-2.3.6.tar.gz<br>
    Complete output from command python setup.py egg_info:<br>
    Traceback (most recent call last):<br>
      File "&lt;string&gt;", line 1, in &lt;module&gt;<br>
      File "/tmp/pip-build-ao65bx0y/pydns/setup.py", line 12, in &lt;module&gt;<br>
        import DNS<br>
      File "/tmp/pip-build-ao65bx0y/pydns/DNS/__init__.py", line 14, in &lt;module&gt;<br>
        import Type,Opcode,Status,Class<br>
    ImportError: No module named 'Type'</p>
<div class="codehilite"><pre>----------------------------------------
</pre></div>


<p>Command "python setup.py egg_info" failed with error code 1 in /tmp/pip-build-ao65bx0y/pydns/<br>
Traceback (most recent call last):<br>
  File "/home/zulip/deployments/2016-09-03-13-13-17/scripts/lib/create-production-venv", line 22, in &lt;module&gt;<br>
    cached_venv_path = setup_virtualenv(args.target, os.path.join(ZULIP_PATH, "requirements", "py2_prod.txt"))<br>
  File "/home/zulip/deployments/2016-09-03-13-13-17/scripts/lib/setup_venv.py", line 70, in setup_virtualenv<br>
    do_setup_virtualenv(cached_venv_path, requirements_file, virtualenv_args or [])<br>
  File "/home/zulip/deployments/2016-09-03-13-13-17/scripts/lib/setup_venv.py", line 97, in do_setup_virtualenv<br>
    run(["pip", "install", "--no-deps", "--requirement", requirements_file])<br>
  File "/home/zulip/deployments/2016-09-03-13-13-17/scripts/lib/zulip_tools.py", line 93, in run<br>
    raise subprocess.CalledProcessError(rc, args) # type: ignore # <a href="https://github.com/python/typeshed/pull/329" target="_blank" title="https://github.com/python/typeshed/pull/329">https://github.com/python/typeshed/pull/329</a><br>
subprocess.CalledProcessError: Command '['pip', 'install', '--no-deps', '--requirement', '/home/zulip/deployments/2016-09-03-13-13-17/requirements/py2_prod.txt']' returned non-zero exit status 1<br>
Traceback (most recent call last):<br>
  File "/home/zulip/deployments/2016-09-03-13-13-17/scripts/lib/upgrade-zulip-stage-2", line 46, in &lt;module&gt;<br>
    os.path.join(deploy_path, "zulip-venv")])<br>
  File "/usr/lib/python2.7/subprocess.py", line 540, in check_call<br>
    raise CalledProcessError(retcode, cmd)<br>
subprocess.CalledProcessError: Command '['/home/zulip/deployments/2016-09-03-13-13-17/scripts/lib/create-production-venv', '/home/zulip/deployments/2016-09-03-13-13-17/zulip-venv']' returned non-zero exit status 1<br>
Traceback (most recent call last):<br>
  File "/home/zulip/deployments/current/scripts/lib/upgrade-zulip", line 53, in &lt;module&gt;<br>
    subprocess.check_call([os.path.abspath("./scripts/lib/upgrade-zulip-stage-2"), deploy_path])<br>
  File "/usr/lib/python2.7/subprocess.py", line 540, in check_call<br>
    raise CalledProcessError(retcode, cmd)<br>
subprocess.CalledProcessError: Command '['/home/zulip/deployments/2016-09-03-13-13-17/scripts/lib/upgrade-zulip-stage-2', '/home/zulip/deployments/2016-09-03-13-13-17']' returned non-zero exit status 1</p>



<a name="21720"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/1.4%20Upgrade%20Fail%20on%20pydns%20Collection/near/21720" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/1.2E4.20Upgrade.20Fail.20on.20pydns.20Collection.html#21720">(Sep 03 2016 at 06:22)</a>:</h4>
<p><strong>So I rolled back to an earlier version .. then rabbitMq would not start. I finally got teh resolved and got rabbit running, now I can log in but cannot get any messages .. this is in teh error log</strong></p>



<a name="21748"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/1.4%20Upgrade%20Fail%20on%20pydns%20Collection/near/21748" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/1.2E4.20Upgrade.20Fail.20on.20pydns.20Collection.html#21748">(Sep 04 2016 at 01:08)</a>:</h4>
<p>So I found a WAY TO REMOVE TEH REQUIREMENT FOR PYDNS AND RUN STAGE 2, NOW I GET THIS ERROR</p>



<a name="21749"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/1.4%20Upgrade%20Fail%20on%20pydns%20Collection/near/21749" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/1.2E4.20Upgrade.20Fail.20on.20pydns.20Collection.html#21749">(Sep 04 2016 at 01:08)</a>:</h4>
<p>Collecting python-ldap==2.4.27 (from -r /home/zulip/deployments/2016-09-04-08-51-51/requirements/py2_common.txt (line 7))<br>
  Downloading python-ldap-2.4.27.tar.gz (125kB)<br>
    100% |████████████████████████████████| 133kB 1.1MB/s <br>
    Complete output from command python setup.py egg_info:<br>
    Traceback (most recent call last):<br>
      File "&lt;string&gt;", line 1, in &lt;module&gt;<br>
      File "/tmp/pip-build-2kd4aowv/python-ldap/setup.py", line 53<br>
        print name + ': ' + cfg.get('_ldap', name)<br>
                 ^<br>
    SyntaxError: invalid syntax</p>



<a name="21750"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/1.4%20Upgrade%20Fail%20on%20pydns%20Collection/near/21750" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/1.2E4.20Upgrade.20Fail.20on.20pydns.20Collection.html#21750">(Sep 04 2016 at 02:01)</a>:</h4>
<p>Ok, FINALLY Figured it out .. I needed to upgrade my virtualenv .. </p>



<a name="21751"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/1.4%20Upgrade%20Fail%20on%20pydns%20Collection/near/21751" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/1.2E4.20Upgrade.20Fail.20on.20pydns.20Collection.html#21751">(Sep 04 2016 at 02:01)</a>:</h4>
<p>sudo pip install --upgrade virtualenv</p>



<a name="21752"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/1.4%20Upgrade%20Fail%20on%20pydns%20Collection/near/21752" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/1.2E4.20Upgrade.20Fail.20on.20pydns.20Collection.html#21752">(Sep 04 2016 at 02:06)</a>:</h4>
<p><img alt=":clapping_hands:" class="emoji" src="/static/third/gemoji/images/emoji/clapping_hands.png" title=":clapping_hands:"> </p>



<a name="21753"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/1.4%20Upgrade%20Fail%20on%20pydns%20Collection/near/21753" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/1.2E4.20Upgrade.20Fail.20on.20pydns.20Collection.html#21753">(Sep 04 2016 at 02:28)</a>:</h4>
<p><span class="user-mention" data-user-email="rishig@zulipchat.com">@Rishi Gupta</span> Thanks for the help, it was basically an old virtualenv that was causing the issue, not sure if it shoudl be updated as part of the upgrade or not, but it did not upgrade on my system .. all working now, but I stil had teh rabbitmq uninstall/reinstall to do to keep rabbitmq running</p>



<a name="21771"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/1.4%20Upgrade%20Fail%20on%20pydns%20Collection/near/21771" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/1.2E4.20Upgrade.20Fail.20on.20pydns.20Collection.html#21771">(Sep 04 2016 at 06:56)</a>:</h4>
<p>cool, thanks for the report! We will definitely look into that on our end. Thanks for pulling through!</p>



<a name="21772"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/1.4%20Upgrade%20Fail%20on%20pydns%20Collection/near/21772" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Cupitt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/1.2E4.20Upgrade.20Fail.20on.20pydns.20Collection.html#21772">(Sep 04 2016 at 06:56)</a>:</h4>
<p><img alt=":thumbsup:" class="emoji" src="/static/third/gemoji/images/emoji/thumbsup.png" title=":thumbsup:"> </p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>