<html>
<head><meta charset="utf-8"><title>Liveblog: Zulip Upgrade (1.5.1 -&gt; 1.6.0) · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html">Liveblog: Zulip Upgrade (1.5.1 -&gt; 1.6.0)</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="232437"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232437" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232437">(Jun 20 2017 at 17:45)</a>:</h4>
<p>Hello everyone!  It's time for your new edition of Akamai's Zulip Upgrade Live Blog, brought to you by your friendly Akamai Zulip Administrators (me and <span class="user-mention" data-user-email="timapril@gmail.com" data-user-id="73">@Tim April</span>).</p>



<a name="232438"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232438" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232438">(Jun 20 2017 at 17:45)</a>:</h4>
<p>In about 30-40 minutes, I'm going to be <del>catastrophically breaking</del> upgrading our version of Zulip.</p>



<a name="232439"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232439" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232439">(Jun 20 2017 at 17:46)</a>:</h4>
<p>As I've done previously, I plan to live post the progress so you can get some feedback about what an upgrade in a somewhat strange environment looks like.</p>



<a name="232440"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232440" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232440">(Jun 20 2017 at 17:47)</a>:</h4>
<p>Sounds good!  FYI we are a bit short staffed this week due to Tim being on vacation and a couple folks being at a conference, but hopefully things will run smoothly.</p>



<a name="232442"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232442" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232442">(Jun 20 2017 at 17:49)</a>:</h4>
<p>No problem -- this is more for your information about what things look like for someone in the field with a large installation, rather than us looking for help.</p>



<a name="232444"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232444" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232444">(Jun 20 2017 at 17:54)</a>:</h4>
<p>If this is your first time tuning in, a few things that you should know about our Zulip installation.  Ours is one of the oldest continually operating Zulip instances out there; our installation started with a Zulip corporate instance before Dropbox acquired Zulip Inc. the first time around and dates back to 2013.</p>



<a name="232445"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232445" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232445">(Jun 20 2017 at 17:55)</a>:</h4>
<p>Over the last 4 years, we've send just a smidge over a million messages, essentially all of which are from humans.  (Our percentage of bot:humans is extremely low.)</p>



<a name="232446"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232446" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232446">(Jun 20 2017 at 17:56)</a>:</h4>
<p>It's fair to say that every Zulip instance out there is either younger, smaller, or less active than Akamai's, so Akamai is definitely a great case study.</p>



<a name="232447"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232447" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232447">(Jun 20 2017 at 17:56)</a>:</h4>
<p>(and most are all three)</p>



<a name="232448"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232448" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232448">(Jun 20 2017 at 17:57)</a>:</h4>
<p>We operate in a HA configuration using postgresql streaming replication, on machines in a somewhat confined environment.  Our upgrades are traditionally a bit strange, as the machines that run zulip don't have access to the internet as a whole directly.  This means puppet upgrades can be "interesting"; usually, they involve reverse SSH tunnels, LD_PRELOAD hooks, and me tearing my hair out trying to figure out why everything broke five minutes after I stopped looking at it.</p>



<a name="232449"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232449" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232449">(Jun 20 2017 at 17:57)</a>:</h4>
<p>(Because the LD_PRELOAD hook got passed to a child process and I closed my SSH tunnel!)</p>



<a name="232450"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232450" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232450">(Jun 20 2017 at 17:57)</a>:</h4>
<p>Anyway, stay tuned -- we've got a few things to meet about before we start the upgrade, and then we'll get right into giving you all some feedback.</p>



<a name="232451"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232451" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232451">(Jun 20 2017 at 17:58)</a>:</h4>
<p>(ETA 45min)</p>



<a name="232507"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232507" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232507">(Jun 20 2017 at 19:37)</a>:</h4>
<p>Going to be delayed a bunch of hours now, unfortunately.  Later tonight, probably ~9 PM EST.</p>



<a name="232526"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232526" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sampriti Panda <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232526">(Jun 20 2017 at 20:09)</a>:</h4>
<p>Around how many users does the Akamai Zulip instance have?</p>



<a name="232633"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232633" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232633">(Jun 20 2017 at 22:37)</a>:</h4>
<p>Very interesting -- thanks <span class="user-mention" data-user-email="hlieberman@setec.io" data-user-id="110">@Harlan Lieberman-Berg</span> for the context, and looking forward to following the actual upgrade :)</p>



<a name="232678"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232678" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim April <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232678">(Jun 21 2017 at 01:02)</a>:</h4>
<p><span class="user-mention" data-user-email="sampdingo@hotmail.com" data-user-id="720">@Sampriti Panda</span> it depends on what you mean by users. Do you mean active or total in the system?</p>



<a name="232686"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232686" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232686">(Jun 21 2017 at 01:32)</a>:</h4>
<p>Hello everyone!  I'm a bit late, but hopefully still fashionable.</p>



<a name="232688"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232688" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232688">(Jun 21 2017 at 01:36)</a>:</h4>
<p>Our theme song tonight is: <a href="https://www.youtube.com/watch?v=S-WaSXrqqZ4" target="_blank" title="https://www.youtube.com/watch?v=S-WaSXrqqZ4">https://www.youtube.com/watch?v=S-WaSXrqqZ4</a></p>
<div class="youtube-video message_inline_image"><a data-id="S-WaSXrqqZ4" href="https://www.youtube.com/watch?v=S-WaSXrqqZ4" target="_blank" title="https://www.youtube.com/watch?v=S-WaSXrqqZ4"><img src="https://i.ytimg.com/vi/S-WaSXrqqZ4/default.jpg"></a></div>



<a name="232689"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232689" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232689">(Jun 21 2017 at 01:36)</a>:</h4>
<p>Upgrade is beginning now.</p>



<a name="232690"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232690" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232690">(Jun 21 2017 at 01:37)</a>:</h4>
<p>First thing I'm doing a little bit different than previously.  Rather than muck about getting internet to the host using proxychains for the entire upgrade, I'm going to just concentrate on getting it for the one piece I know needs it: apt.</p>



<a name="232691"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232691" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232691">(Jun 21 2017 at 01:37)</a>:</h4>
<p>To that end, I'm going to do some horrible things to the path to wrap just apt in proxychains.</p>



<a name="232694"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232694" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232694">(Jun 21 2017 at 01:43)</a>:</h4>
<p>This seems to have worked, if hacky as hell.</p>



<a name="232695"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232695" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232695">(Jun 21 2017 at 01:43)</a>:</h4>
<p>I'm pulling down the tarball now.</p>



<a name="232696"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232696" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232696">(Jun 21 2017 at 01:45)</a>:</h4>
<p>sha1sum matches -- yay</p>



<a name="232697"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232697" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232697">(Jun 21 2017 at 01:47)</a>:</h4>
<p>Running the zulip puppet apply to see if there's local changes.</p>



<a name="232698"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232698" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232698">(Jun 21 2017 at 01:49)</a>:</h4>
<p>Hm, unfortunately, the way I hacked together apt seems to be making the puppet apply unhappy.</p>



<a name="232699"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232699" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232699">(Jun 21 2017 at 01:49)</a>:</h4>
<p>Getting an error "Error: Could not find class apt for &lt;host&gt; on node &lt;host&gt;".</p>



<a name="232700"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232700" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232700">(Jun 21 2017 at 01:49)</a>:</h4>
<p>Debugging.</p>



<a name="232701"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232701" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232701">(Jun 21 2017 at 01:51)</a>:</h4>
<p>Aha.  It appears the path is being overridden inside the upgrade script.</p>



<a name="232702"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232702" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232702">(Jun 21 2017 at 01:51)</a>:</h4>
<p>Fair enough.</p>



<a name="232703"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232703" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232703">(Jun 21 2017 at 01:51)</a>:</h4>
<p>I'll solve that with a sledgehammer: move the real apt binaries somewhere else and put my wrappers in /usr/bin.</p>



<a name="232704"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232704" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232704">(Jun 21 2017 at 01:54)</a>:</h4>
<p>And now I'm running the upgrade script.</p>



<a name="232705"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232705" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232705">(Jun 21 2017 at 01:55)</a>:</h4>
<p>Tarball is unpacking.</p>



<a name="232706"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232706" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232706">(Jun 21 2017 at 01:55)</a>:</h4>
<p>Apt is running now.</p>



<a name="232707"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232707" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232707">(Jun 21 2017 at 01:55)</a>:</h4>
<p>My hacky apt wrapper is working -- yay!</p>



<a name="232708"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232708" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232708">(Jun 21 2017 at 01:55)</a>:</h4>
<p>A few upgrades: notably, postgresql.</p>



<a name="232709"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232709" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232709">(Jun 21 2017 at 01:56)</a>:</h4>
<p>Apt is complete.  Pip is installing some things.</p>



<a name="232710"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232710" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232710">(Jun 21 2017 at 01:56)</a>:</h4>
<p>setuptools, in particular.</p>



<a name="232711"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232711" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232711">(Jun 21 2017 at 01:57)</a>:</h4>
<p>Aha, now, that's going to not work.</p>



<a name="232712"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232712" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232712">(Jun 21 2017 at 01:57)</a>:</h4>
<p>Because pip isn't wrapped.</p>



<a name="232713"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232713" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232713">(Jun 21 2017 at 01:57)</a>:</h4>
<p>Sure enough, the script crashed.</p>



<a name="232714"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232714" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232714">(Jun 21 2017 at 01:58)</a>:</h4>
<p>Not a problem though.</p>



<a name="232715"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232715" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232715">(Jun 21 2017 at 01:58)</a>:</h4>
<p>Just do the same hacks to pip and rerun the script</p>



<a name="232716"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232716" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232716">(Jun 21 2017 at 02:01)</a>:</h4>
<p>Bloo, it's using the version of pip from inside the venv!</p>



<a name="232717"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232717" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232717">(Jun 21 2017 at 02:04)</a>:</h4>
<p>So, I could add the hack directly to the scripts, but this is starting to go down a scary path.</p>



<a name="232719"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232719" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232719">(Jun 21 2017 at 02:05)</a>:</h4>
<p>Instead, we'll just wrap the whole thing in proxychains, and then restart everything again a second time to get rid of all the proxychains LD_PRELOAD nonsense later.</p>



<a name="232721"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232721" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232721">(Jun 21 2017 at 02:07)</a>:</h4>
<p>Alright, rerunning now.</p>



<a name="232722"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232722" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232722">(Jun 21 2017 at 02:07)</a>:</h4>
<p>(But I'm not happy about it!)</p>



<a name="232723"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232723" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232723">(Jun 21 2017 at 02:07)</a>:</h4>
<p>It's installing a bunch of the python packages...</p>



<a name="232724"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232724" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232724">(Jun 21 2017 at 02:09)</a>:</h4>
<p>Interestingly, something has already broken the currently running Zulip, though it shouldn't have yet.</p>



<a name="232725"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232725" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232725">(Jun 21 2017 at 02:10)</a>:</h4>
<p>My guess is that Zulip crashed when Postgresql was upgraded during the early apt update</p>



<a name="232726"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232726" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232726">(Jun 21 2017 at 02:10)</a>:</h4>
<p>That might be something to move later if at all possible.</p>



<a name="232727"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232727" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232727">(Jun 21 2017 at 02:10)</a>:</h4>
<p>Because now we have hard downtime while waiting for all these python packages to download and install.</p>



<a name="232728"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232728" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232728">(Jun 21 2017 at 02:11)</a>:</h4>
<p>Now onto installing the python packages.</p>



<a name="232729"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232729" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232729">(Jun 21 2017 at 02:12)</a>:</h4>
<p>Now installing node.</p>



<a name="232730"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232730" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232730">(Jun 21 2017 at 02:12)</a>:</h4>
<p>supervisorctl stopping.</p>



<a name="232731"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232731" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232731">(Jun 21 2017 at 02:12)</a>:</h4>
<p>puppet running.</p>



<a name="232732"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232732" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232732">(Jun 21 2017 at 02:13)</a>:</h4>
<p>And puppet crashed out complaining of rabbitmq locks not being there.</p>



<a name="232733"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232733" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232733">(Jun 21 2017 at 02:13)</a>:</h4>
<p>Because there's no /etc/rabbitmq directory created.</p>



<a name="232734"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232734" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232734">(Jun 21 2017 at 02:13)</a>:</h4>
<p>But puppet isn't checking for it.</p>



<a name="232735"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232735" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232735">(Jun 21 2017 at 02:13)</a>:</h4>
<p>So it just tries to create files under /etc/rabbitmq and crashes when it can't.</p>



<a name="232736"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232736" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232736">(Jun 21 2017 at 02:13)</a>:</h4>
<p>(Bug!)</p>



<a name="232737"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232737" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232737">(Jun 21 2017 at 02:14)</a>:</h4>
<p>At this point, we're far in enough I'd rather not rerun all of step2</p>



<a name="232738"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232738" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232738">(Jun 21 2017 at 02:14)</a>:</h4>
<p>So I'm going to take over running the steps by hand.</p>



<a name="232739"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232739" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232739">(Jun 21 2017 at 02:16)</a>:</h4>
<p>Rerunning ./scripts/zulip-puppet-apply with --force</p>



<a name="232740"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232740" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232740">(Jun 21 2017 at 02:16)</a>:</h4>
<p>Finished successfully.</p>



<a name="232741"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232741" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232741">(Jun 21 2017 at 02:16)</a>:</h4>
<p>apt has nothing left to upgrade.</p>



<a name="232742"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232742" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232742">(Jun 21 2017 at 02:16)</a>:</h4>
<p>Running database migrations.</p>



<a name="232743"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232743" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232743">(Jun 21 2017 at 02:18)</a>:</h4>
<p>Running the restart-server script.</p>



<a name="232744"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232744" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232744">(Jun 21 2017 at 02:18)</a>:</h4>
<p>Spewing our usual friendly WARNING SESSION DATA CORRUPTED</p>



<a name="232745"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232745" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232745">(Jun 21 2017 at 02:18)</a>:</h4>
<p>Which is normal.</p>



<a name="232746"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232746" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232746">(Jun 21 2017 at 02:19)</a>:</h4>
<p><a href="https://cdn0.vox-cdn.com/thumbor/_JI6MgeGQfe7BxV1fpL0CBpD2w0=/6x0:895x500/1600x900/cdn0.vox-cdn.com/uploads/chorus_image/image/49493993/this-is-fine.0.jpg" target="_blank" title="https://cdn0.vox-cdn.com/thumbor/_JI6MgeGQfe7BxV1fpL0CBpD2w0=/6x0:895x500/1600x900/cdn0.vox-cdn.com/uploads/chorus_image/image/49493993/this-is-fine.0.jpg">https://cdn0.vox-cdn.com/thumbor/_JI6MgeGQfe7BxV1fpL0CBpD2w0=/6x0:895x500/1600x900/cdn0.vox-cdn.com/uploads/chorus_image/image/49493993/this-is-fine.0.jpg</a></p>
<div class="message_inline_image"><a href="https://cdn0.vox-cdn.com/thumbor/_JI6MgeGQfe7BxV1fpL0CBpD2w0=/6x0:895x500/1600x900/cdn0.vox-cdn.com/uploads/chorus_image/image/49493993/this-is-fine.0.jpg" target="_blank" title="https://cdn0.vox-cdn.com/thumbor/_JI6MgeGQfe7BxV1fpL0CBpD2w0=/6x0:895x500/1600x900/cdn0.vox-cdn.com/uploads/chorus_image/image/49493993/this-is-fine.0.jpg"><img src="https://cdn0.vox-cdn.com/thumbor/_JI6MgeGQfe7BxV1fpL0CBpD2w0=/6x0:895x500/1600x900/cdn0.vox-cdn.com/uploads/chorus_image/image/49493993/this-is-fine.0.jpg"></a></div>



<a name="232747"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232747" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232747">(Jun 21 2017 at 02:22)</a>:</h4>
<p>Things appear to have restarted correctly.</p>



<a name="232748"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232748" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232748">(Jun 21 2017 at 02:22)</a>:</h4>
<p>Now, disconnecting.  This will cause the proxychains stuff to break, if any of it is left.</p>



<a name="232749"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232749" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232749">(Jun 21 2017 at 02:22)</a>:</h4>
<p>And indeed, there was something!</p>



<a name="232750"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232750" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232750">(Jun 21 2017 at 02:22)</a>:</h4>
<p>Running supervisorctl restart all</p>



<a name="232751"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232751" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232751">(Jun 21 2017 at 02:24)</a>:</h4>
<p><span class="user-mention" data-user-email="timapril@gmail.com" data-user-id="73">@Tim April</span>, please login and test for me.</p>



<a name="232752"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232752" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232752">(Jun 21 2017 at 02:25)</a>:</h4>
<p>Logs appear normal.</p>



<a name="232753"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232753" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232753">(Jun 21 2017 at 02:25)</a>:</h4>
<p>Websocket connection is stable.</p>



<a name="232754"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232754" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim April <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232754">(Jun 21 2017 at 02:25)</a>:</h4>
<p><img alt=":thumbs_up:" class="emoji" src="/static/generated/emoji/images/emoji/unicode/1f44d.png" title=":thumbs_up:"></p>



<a name="232755"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232755" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232755">(Jun 21 2017 at 02:25)</a>:</h4>
<p>Interestingly, there appear to be long-polling HTTP connections even though I have an open websockets connection.</p>



<a name="232758"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232758" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232758">(Jun 21 2017 at 02:27)</a>:</h4>
<p>Which is unexpected.  <span class="user-mention" data-user-email="timapril@gmail.com" data-user-id="73">@Tim April</span>, do you see them too?  (long-poll requests to /json/events)</p>



<a name="232759"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232759" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim April <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232759">(Jun 21 2017 at 02:28)</a>:</h4>
<p>ya</p>



<a name="232763"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232763" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232763">(Jun 21 2017 at 02:29)</a>:</h4>
<p>they seem to happen with each message, and also a POST to report_send_time, presence... a bunch of things.</p>



<a name="232765"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232765" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232765">(Jun 21 2017 at 02:29)</a>:</h4>
<p>Did you guys intend to change something with the way you handle these connections?</p>



<a name="232766"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232766" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim April <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232766">(Jun 21 2017 at 02:29)</a>:</h4>
<p><span class="user-mention" data-user-email="hlieberman@setec.io" data-user-id="110">@Harlan Lieberman-Berg</span> do we have the websocket disabled in the config?</p>



<a name="232767"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232767" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232767">(Jun 21 2017 at 02:29)</a>:</h4>
<p>It's still connecting to the websocket, so, I doubt it.</p>



<a name="232768"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232768" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232768">(Jun 21 2017 at 02:30)</a>:</h4>
<p>An interesting question for one of the Zulip upstream folks.</p>



<a name="232769"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232769" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232769">(Jun 21 2017 at 02:31)</a>:</h4>
<p>But it still seems to be working.</p>



<a name="232770"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232770" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232770">(Jun 21 2017 at 02:32)</a>:</h4>
<p>Maybe it's always been that way!</p>



<a name="232771"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232771" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232771">(Jun 21 2017 at 02:32)</a>:</h4>
<p><a href="https://github.com/zulip/zulip/issues/1712" target="_blank" title="https://github.com/zulip/zulip/issues/1712">https://github.com/zulip/zulip/issues/1712</a> seems to indicate it might be.</p>



<a name="232772"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232772" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232772">(Jun 21 2017 at 02:32)</a>:</h4>
<p>Either way, the upgrade seems to have been done.  Happy to answer questions from anyone about why I did things the way I did, or anything else.</p>



<a name="232773"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232773" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232773">(Jun 21 2017 at 02:32)</a>:</h4>
<p>I will file that bug about the puppet config.</p>



<a name="232775"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232775" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim April <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232775">(Jun 21 2017 at 02:35)</a>:</h4>
<p>i have noticed it here and now I see it on the Akamai zulip, but I now see the "Drafts" link below the message box even if I do not have any draft messages.  I'm not sure if I am the only one thats bothered by it, but i figured I would mention it</p>



<a name="232776"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232776" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232776">(Jun 21 2017 at 02:35)</a>:</h4>
<p>I don't know puppet well, but it looks like we try to create the directory, but one of the files that we create within the directory comes before and outside the place where we declare the directory.  It doesn't seem to have recent changes, though, so it's curious that it happens now.</p>



<a name="232777"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232777" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232777">(Jun 21 2017 at 02:37)</a>:</h4>
<p>And, yeah, <span class="user-mention" data-user-email="timapril@gmail.com" data-user-id="73">@Tim April</span>, we should hide the button if you don't have any drafts.</p>



<a name="232778"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/232778" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#232778">(Jun 21 2017 at 02:37)</a>:</h4>
<p>The new drafts feature is nice, but it's really rough around the edges visually.  It's a good reminder to take a V2 pass at that.</p>



<a name="233296"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233296" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233296">(Jun 21 2017 at 15:45)</a>:</h4>
<p><span class="user-mention" data-user-email="sampdingo@hotmail.com" data-user-id="720">@Sampriti Panda</span>, we've got about 250 users who are consistently active users.</p>



<a name="233297"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233297" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233297">(Jun 21 2017 at 15:45)</a>:</h4>
<p>(Measured by looking back over the last 30-90 days)</p>



<a name="233299"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233299" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233299">(Jun 21 2017 at 15:46)</a>:</h4>
<p>In terms of users who "have logged in once" (i.e., what /stats reports), we have around 2k.</p>



<a name="233718"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233718" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233718">(Jun 21 2017 at 18:47)</a>:</h4>
<p>Post-upgrade, things are going fairly well.</p>



<a name="233719"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233719" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233719">(Jun 21 2017 at 18:47)</a>:</h4>
<p>We've had a few complaints about font changes, misc. UX stuff.</p>



<a name="233720"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233720" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233720">(Jun 21 2017 at 18:48)</a>:</h4>
<p>One thing that does seem to be broken completely is that auto-registration doesn't seem to be working.</p>



<a name="233724"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233724" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233724">(Jun 21 2017 at 18:54)</a>:</h4>
<p>We're using the RemoteUser authentication method, but</p>



<a name="233726"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233726" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233726">(Jun 21 2017 at 18:55)</a>:</h4>
<p>Now, it seems that users need an invite regardless of the status of the "Users need an invite" toggle in the admin settings.</p>



<a name="233971"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233971" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233971">(Jun 21 2017 at 21:44)</a>:</h4>
<blockquote>
<p>Now, it seems that users need an invite regardless of the status of the "Users need an invite" toggle in the admin settings.</p>
</blockquote>
<p>Interesting! That sounds like an important bug to fix :)</p>
<p><span class="user-mention" data-user-email="hlieberman@setec.io" data-user-id="110">@Harlan Lieberman-Berg</span> , can you say more about how you've configured authentication?</p>



<a name="233973"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233973" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233973">(Jun 21 2017 at 21:46)</a>:</h4>
<blockquote>
<p>We've had a few complaints about font changes, misc. UX stuff.</p>
</blockquote>
<p>We'd be glad to see issue reports for these -- if you're up for filing some of them or if you want to encourage those users to file them with us upstream, that'd be helpful. Or if they turn out to be already-reported issues, then chiming in in a comment to say they've seen it too and been bothered by it.</p>



<a name="233975"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233975" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233975">(Jun 21 2017 at 21:49)</a>:</h4>
<p>Sure. Unfortunately, it looks like the iOS mobile app doesn't allow for github login, so please forgive any spelling errors or delays.</p>



<a name="233976"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233976" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233976">(Jun 21 2017 at 21:50)</a>:</h4>
<p>Our Zulip authentication system is based on top of our corporate auth structure. People identify themselves using client TLS certificates and an SSO portal.</p>



<a name="233977"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233977" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233977">(Jun 21 2017 at 21:51)</a>:</h4>
<blockquote>
<p>My guess is that Zulip crashed when Postgresql was upgraded during the early apt update</p>
</blockquote>
<p>It's a known issue (that doesn't seem to have an issue in the tracker -- guess I should fix that!) that when PostgreSQL is restarted, some components of Zulip notice and start talking to the new server and others don't. The main symptom is that while most everything works, you can browse and read messages, etc., you can't send messages.</p>
<p>This usually comes up when <code>apt</code> restarts postgres on upgrade. The fix is to restart Zulip right after.</p>



<a name="233978"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233978" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233978">(Jun 21 2017 at 21:51)</a>:</h4>
<p>When you hit the Zulip server, it checks for an active authentication cookie. If there isn't one, you get redirected to our SSO environment.</p>



<a name="233980"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233980" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233980">(Jun 21 2017 at 21:53)</a>:</h4>
<p>You get authenticated as normal and then redirected to an Apache module on the Zulip server that checks your authentication. If it matches, it sets your username into the request to the login page.</p>



<a name="233981"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233981" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233981">(Jun 21 2017 at 21:53)</a>:</h4>
<p>Zulip then checks usernames on the server side and issues it's own cookie.</p>



<a name="233982"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233982" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233982">(Jun 21 2017 at 21:54)</a>:</h4>
<p>That's the loin flow.</p>



<a name="233983"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233983" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233983">(Jun 21 2017 at 21:55)</a>:</h4>
<p>Previously, first time users would automatically be registered on their first login.</p>



<a name="233984"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/233984" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#233984">(Jun 21 2017 at 21:55)</a>:</h4>
<p>For some reason, that no longer seems to be happening.</p>



<a name="234004"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/234004" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#234004">(Jun 21 2017 at 22:07)</a>:</h4>
<p>Cool, thanks. I guess the next step is to try to reproduce that in a development environment -- if nobody else steps up to try that today, I'll file an issue so it isn't lost. (And maybe attempt the repro myself.)</p>



<a name="234037"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/234037" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#234037">(Jun 21 2017 at 22:25)</a>:</h4>
<p>Sounds good. Let me know if you want help; I can provide the config files and explain in more specifics.</p>



<a name="234245"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/234245" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#234245">(Jun 22 2017 at 03:36)</a>:</h4>
<p><span class="user-mention" data-user-email="hlieberman@setec.io" data-user-id="110">@Harlan Lieberman-Berg</span> I've also filed <a href="https://github.com/zulip/zulip/pull/5513" target="_blank" title="https://github.com/zulip/zulip/pull/5513">#5513</a>, as a feature idea to better support this kind of offline install and upgrade.</p>



<a name="234246"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/234246" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#234246">(Jun 22 2017 at 03:36)</a>:</h4>
<p>Yeah, I saw that go through.  It's awesome!</p>



<a name="234247"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/234247" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#234247">(Jun 22 2017 at 03:37)</a>:</h4>
<p>FYI, I'm probably going to be opening a couple of issues in the next day or two with an eye towards trying to get the mobile apps working with this kind of cert-based stuff.  Not sure how easy that's going to be -- particularly on iOS, it might be painful.</p>



<a name="234248"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/234248" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#234248">(Jun 22 2017 at 03:37)</a>:</h4>
<p>Great, will be glad to have those reports</p>



<a name="234250"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/234250" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#234250">(Jun 22 2017 at 03:38)</a>:</h4>
<p>If you're interested in writing up a doc on how you tunneled things for your upgrade, a PR for that would be a great step forward for <a href="https://github.com/zulip/zulip/pull/5513" target="_blank" title="https://github.com/zulip/zulip/pull/5513">#5513</a></p>



<a name="234252"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/234252" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#234252">(Jun 22 2017 at 03:40)</a>:</h4>
<p>Sounds good.  The solution we use is probably not the one that's a good idea for everyone (particularly because it sucks for us), but one of my coworkers has a better solution that uses iptables rules.  I'll see if he feels comfortable writing it up.</p>



<a name="235572"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/235572" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#235572">(Jun 23 2017 at 15:24)</a>:</h4>
<p>Just opened <a href="https://github.com/zulip/zulip/pull/5538" target="_blank" title="https://github.com/zulip/zulip/pull/5538">#5538</a> to track the registration issue.</p>



<a name="235588"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/235588" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#235588">(Jun 23 2017 at 15:35)</a>:</h4>
<p>Looks like the login in <code>auth.py</code> around <code>login_or_register_remote_user</code> changed in 1.6.</p>



<a name="235590"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/235590" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#235590">(Jun 23 2017 at 15:35)</a>:</h4>
<p>I'm guessing that's where the break happened.</p>



<a name="237937"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/237937" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#237937">(Jun 26 2017 at 21:34)</a>:</h4>
<p><span class="user-mention" data-user-email="hlieberman@setec.io" data-user-id="110">@Harlan Lieberman-Berg</span> I didn't read the full text here; is there anything else we should be tracking from your experience?</p>



<a name="237939"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/237939" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#237939">(Jun 26 2017 at 21:34)</a>:</h4>
<p>There's two tickets open as a result of which, only one of which is really painful to me.</p>



<a name="237940"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/237940" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#237940">(Jun 26 2017 at 21:34)</a>:</h4>
<p>The other one, I think one of my coworkers is going to take a look at giving you some recommendations on.</p>



<a name="237942"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/237942" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#237942">(Jun 26 2017 at 21:35)</a>:</h4>
<p>Which one is really painful?</p>



<a name="237943"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/237943" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#237943">(Jun 26 2017 at 21:35)</a>:</h4>
<p><a href="https://github.com/zulip/zulip/pull/5538" target="_blank" title="https://github.com/zulip/zulip/pull/5538">#5538</a></p>



<a name="237947"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/237947" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#237947">(Jun 26 2017 at 21:36)</a>:</h4>
<p>OK, agreed that's a top priority issue.</p>



<a name="237948"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/237948" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#237948">(Jun 26 2017 at 21:37)</a>:</h4>
<p>It's pretty weird.</p>



<a name="237949"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/237949" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#237949">(Jun 26 2017 at 21:37)</a>:</h4>
<p>If you want, I can take a whack at reproducing it in a dev environment.</p>



<a name="237950"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/237950" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#237950">(Jun 26 2017 at 21:37)</a>:</h4>
<p>Up to you.</p>



<a name="237951"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/237951" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#237951">(Jun 26 2017 at 21:38)</a>:</h4>
<p>I imagine someone will look soon regardless but certainly a confirmation it reproduces there would be handy</p>



<a name="237953"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Liveblog%3A%20Zulip%20Upgrade%20%281.5.1%20-%3E%201.6.0%29/near/237953" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harlan Lieberman-Berg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Liveblog.3A.20Zulip.20Upgrade.20.281.2E5.2E1.20-.3E.201.2E6.2E0.29.html#237953">(Jun 26 2017 at 21:39)</a>:</h4>
<p>Sounds good.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>