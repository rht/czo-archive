<html>
<head><meta charset="utf-8"><title>push not working · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/push.20not.20working.html">push not working</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1239257"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/push%20not%20working/near/1239257" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/push.20not.20working.html#1239257">(Jul 27 2021 at 09:53)</a>:</h4>
<p>Currently Push is not working for my installation and I get a exception email every time one should be sent.</p>



<a name="1239258"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/push%20not%20working/near/1239258" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/push.20not.20working.html#1239258">(Jul 27 2021 at 09:53)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2021-06-03-21-00-31/zerver/worker/queue_processors.py&quot;, line 299, in do_consume
    consume_func(events)
  File &quot;/home/zulip/deployments/2021-06-03-21-00-31/zerver/worker/queue_processors.py&quot;, line 339, in &lt;lambda&gt;
    consume_func = lambda events: self.consume(events[0])
  File &quot;/home/zulip/deployments/2021-06-03-21-00-31/zerver/worker/queue_processors.py&quot;, line 666, in consume
    handle_push_notification(event[&quot;user_profile_id&quot;], event)
  File &quot;/home/zulip/deployments/2021-06-03-21-00-31/zerver/decorator.py&quot;, line 830, in wrapped_func
    ret = func(*args, **kwargs)
  File &quot;/home/zulip/deployments/2021-06-03-21-00-31/zerver/lib/push_notifications.py&quot;, line 907, in handle_push_notification
    send_notifications_to_bouncer(user_profile_id, apns_payload, gcm_payload, gcm_options)
  File &quot;/home/zulip/deployments/2021-06-03-21-00-31/zerver/lib/push_notifications.py&quot;, line 407, in send_notifications_to_bouncer
    send_json_to_push_bouncer(&quot;POST&quot;, &quot;push/notify&quot;, post_data)
  File &quot;/home/zulip/deployments/2021-06-03-21-00-31/zerver/lib/remote_server.py&quot;, line 104, in send_json_to_push_bouncer
    send_to_push_bouncer(
  File &quot;/home/zulip/deployments/2021-06-03-21-00-31/zerver/lib/remote_server.py&quot;, line 57, in send_to_push_bouncer
    res = requests.request(
  File &quot;/srv/zulip-venv-cache/32fcc960bfb7387aa422d8595f3e85936ecbc5eb/zulip-py3-venv/lib/python3.8/site-packages/requests/api.py&quot;, line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File &quot;/srv/zulip-venv-cache/32fcc960bfb7387aa422d8595f3e85936ecbc5eb/zulip-py3-venv/lib/python3.8/site-packages/requests/sessions.py&quot;, line 542, in request
    resp = self.send(prep, **send_kwargs)
  File &quot;/srv/zulip-venv-cache/32fcc960bfb7387aa422d8595f3e85936ecbc5eb/zulip-py3-venv/lib/python3.8/site-packages/requests/sessions.py&quot;, line 655, in send
    r = adapter.send(request, **kwargs)
  File &quot;/srv/zulip-venv-cache/32fcc960bfb7387aa422d8595f3e85936ecbc5eb/zulip-py3-venv/lib/python3.8/site-packages/requests/adapters.py&quot;, line 439, in send
    resp = conn.urlopen(
  File &quot;/srv/zulip-venv-cache/32fcc960bfb7387aa422d8595f3e85936ecbc5eb/zulip-py3-venv/lib/python3.8/site-packages/urllib3/connectionpool.py&quot;, line 699, in urlopen
    httplib_response = self._make_request(
  File &quot;/srv/zulip-venv-cache/32fcc960bfb7387aa422d8595f3e85936ecbc5eb/zulip-py3-venv/lib/python3.8/site-packages/urllib3/connectionpool.py&quot;, line 445, in _make_request
    six.raise_from(e, None)
  File &quot;&lt;string&gt;&quot;, line 3, in raise_from
  File &quot;/srv/zulip-venv-cache/32fcc960bfb7387aa422d8595f3e85936ecbc5eb/zulip-py3-venv/lib/python3.8/site-packages/urllib3/connectionpool.py&quot;, line 440, in _make_request
    httplib_response = conn.getresponse()
  File &quot;/usr/lib/python3.8/http/client.py&quot;, line 1347, in getresponse
    response.begin()
  File &quot;/usr/lib/python3.8/http/client.py&quot;, line 307, in begin
    version, status, reason = self._read_status()
  File &quot;/usr/lib/python3.8/http/client.py&quot;, line 268, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), &quot;iso-8859-1&quot;)
  File &quot;/usr/lib/python3.8/socket.py&quot;, line 669, in readinto
    return self._sock.recv_into(b)
  File &quot;/usr/lib/python3.8/ssl.py&quot;, line 1241, in recv_into
    return self.read(nbytes, buffer)
  File &quot;/usr/lib/python3.8/ssl.py&quot;, line 1099, in read
    return self._sslobj.read(len, buffer)
  File &quot;/home/zulip/deployments/2021-06-03-21-00-31/zerver/worker/queue_processors.py&quot;, line 201, in timer_expired
    raise WorkerTimeoutException(limit, event_count)
zerver.worker.queue_processors.WorkerTimeoutException: Timed out after 30 seconds processing 1 events
</code></pre></div>



<a name="1239259"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/push%20not%20working/near/1239259" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/push.20not.20working.html#1239259">(Jul 27 2021 at 09:54)</a>:</h4>
<p>Is there any problem with the Zulip push service?</p>



<a name="1239312"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/push%20not%20working/near/1239312" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/push.20not.20working.html#1239312">(Jul 27 2021 at 16:00)</a>:</h4>
<p><span class="user-mention" data-user-id="10530">@Ricardo Duarte</span>: Google's notification service looks to have been having severely elevated tail latencies in this time period, which caused the push bouncer to not be able to return in time to satisfy the local queue worker.</p>
<p>This looks to have lasted a couple hours and then resolved.  Frustratingly, Google doesn't note anything on <a href="https://status.firebase.google.com/">its status board</a>.  If you're still seeing errors, let us know, but I don't see any notable non-200 responses from the push bouncer anymore.</p>
<p>I'll file a ticket to fix the timeouts on the push bouncer side, and we'll need to make sure that the queueing system can propagate the right thing through in those instances.</p>



<a name="1241021"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/push%20not%20working/near/1241021" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/push.20not.20working.html#1241021">(Jul 30 2021 at 09:23)</a>:</h4>
<p>Today:</p>



<a name="1241022"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/push%20not%20working/near/1241022" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/push.20not.20working.html#1241022">(Jul 30 2021 at 09:23)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Error generated by Anonymous user (not logged in) on 506b677277ac deployment

Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2021-07-25-23-24-50/zerver/worker/queue_processors.py&quot;, line 305, in do_consume
    consume_func(events)
  File &quot;/home/zulip/deployments/2021-07-25-23-24-50/zerver/worker/queue_processors.py&quot;, line 345, in &lt;lambda&gt;
    consume_func = lambda events: self.consume(events[0])
  File &quot;/home/zulip/deployments/2021-07-25-23-24-50/zerver/worker/queue_processors.py&quot;, line 680, in consume
    handle_remove_push_notification(event[&quot;user_profile_id&quot;], message_ids)
  File &quot;/home/zulip/deployments/2021-07-25-23-24-50/zerver/lib/push_notifications.py&quot;, line 825, in handle_remove_push_notification
    send_notifications_to_bouncer(user_profile_id, apns_payload, gcm_payload, gcm_options)
  File &quot;/home/zulip/deployments/2021-07-25-23-24-50/zerver/lib/push_notifications.py&quot;, line 407, in send_notifications_to_bouncer
    send_json_to_push_bouncer(&quot;POST&quot;, &quot;push/notify&quot;, post_data)
  File &quot;/home/zulip/deployments/2021-07-25-23-24-50/zerver/lib/remote_server.py&quot;, line 104, in send_json_to_push_bouncer
    send_to_push_bouncer(
  File &quot;/home/zulip/deployments/2021-07-25-23-24-50/zerver/lib/remote_server.py&quot;, line 57, in send_to_push_bouncer
    res = requests.request(
  File &quot;/srv/zulip-venv-cache/cc77818846b328558cc9444c67cbbe0121ca80f4/zulip-py3-venv/lib/python3.8/site-packages/requests/api.py&quot;, line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File &quot;/srv/zulip-venv-cache/cc77818846b328558cc9444c67cbbe0121ca80f4/zulip-py3-venv/lib/python3.8/site-packages/requests/sessions.py&quot;, line 542, in request
    resp = self.send(prep, **send_kwargs)
  File &quot;/srv/zulip-venv-cache/cc77818846b328558cc9444c67cbbe0121ca80f4/zulip-py3-venv/lib/python3.8/site-packages/requests/sessions.py&quot;, line 655, in send
    r = adapter.send(request, **kwargs)
  File &quot;/srv/zulip-venv-cache/cc77818846b328558cc9444c67cbbe0121ca80f4/zulip-py3-venv/lib/python3.8/site-packages/requests/adapters.py&quot;, line 439, in send
    resp = conn.urlopen(
  File &quot;/srv/zulip-venv-cache/cc77818846b328558cc9444c67cbbe0121ca80f4/zulip-py3-venv/lib/python3.8/site-packages/urllib3/connectionpool.py&quot;, line 699, in urlopen
    httplib_response = self._make_request(
  File &quot;/srv/zulip-venv-cache/cc77818846b328558cc9444c67cbbe0121ca80f4/zulip-py3-venv/lib/python3.8/site-packages/urllib3/connectionpool.py&quot;, line 382, in _make_request
    self._validate_conn(conn)
  File &quot;/srv/zulip-venv-cache/cc77818846b328558cc9444c67cbbe0121ca80f4/zulip-py3-venv/lib/python3.8/site-packages/urllib3/connectionpool.py&quot;, line 1010, in _validate_conn
    conn.connect()
  File &quot;/srv/zulip-venv-cache/cc77818846b328558cc9444c67cbbe0121ca80f4/zulip-py3-venv/lib/python3.8/site-packages/urllib3/connection.py&quot;, line 353, in connect
    conn = self._new_conn()
  File &quot;/srv/zulip-venv-cache/cc77818846b328558cc9444c67cbbe0121ca80f4/zulip-py3-venv/lib/python3.8/site-packages/urllib3/connection.py&quot;, line 169, in _new_conn
    conn = connection.create_connection(
  File &quot;/srv/zulip-venv-cache/cc77818846b328558cc9444c67cbbe0121ca80f4/zulip-py3-venv/lib/python3.8/site-packages/urllib3/util/connection.py&quot;, line 86, in create_connection
    sock.connect(sa)
  File &quot;/home/zulip/deployments/2021-07-25-23-24-50/zerver/worker/queue_processors.py&quot;, line 351, in timer_expired
    raise WorkerTimeoutException(limit, len(events))
zerver.worker.queue_processors.WorkerTimeoutException: Timed out after 30 seconds processing 1 events
</code></pre></div>



<a name="1241023"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/push%20not%20working/near/1241023" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ricardo Duarte <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/push.20not.20working.html#1241023">(Jul 30 2021 at 09:26)</a>:</h4>
<p>I'm also not getting any push messages since I upgraded to v.4</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>