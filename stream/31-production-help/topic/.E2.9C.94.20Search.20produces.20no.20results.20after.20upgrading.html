<html>
<head><meta charset="utf-8"><title>✔ Search produces no results after upgrading · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html">✔ Search produces no results after upgrading</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1380458"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380458" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380458">(May 12 2022 at 11:22)</a>:</h4>
<p>After upgrading Zulip to current latest version along with Postgresql 9.5 =&gt; 14, Ubuntu Xenial to focal, the search produces no results -- but I'm not finding any errors either. The <code>process-fts-updates</code> service is running and I have tried running <code>reindex-textual-data</code>.</p>



<a name="1380460"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380460" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380460">(May 12 2022 at 11:23)</a>:</h4>
<p>Did you run step 6 of <a href="https://zulip.readthedocs.io/en/latest/production/upgrade-or-modify.html#upgrading-from-ubuntu-18-04-bionic-to-20-04-focal">https://zulip.readthedocs.io/en/latest/production/upgrade-or-modify.html#upgrading-from-ubuntu-18-04-bionic-to-20-04-focal</a> ?</p>



<a name="1380461"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380461" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380461">(May 12 2022 at 11:24)</a>:</h4>
<p>Ah, you said so</p>



<a name="1380462"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380462" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380462">(May 12 2022 at 11:24)</a>:</h4>
<p>The previous Zulip version was something from about 2020-03-05</p>



<a name="1380463"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380463" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380463">(May 12 2022 at 11:24)</a>:</h4>
<p>so this was quite a leap.</p>



<a name="1380464"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380464" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380464">(May 12 2022 at 11:24)</a>:</h4>
<p>Possibly actually even older.</p>



<a name="1380465"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380465" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380465">(May 12 2022 at 11:25)</a>:</h4>
<p>I'm unfortunately on my way to sleep, so I can't debug, but my first suspicions is still somewhat the indexing.</p>



<a name="1380466"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380466" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380466">(May 12 2022 at 11:25)</a>:</h4>
<p>That would be logical. Any hints on where to look for errors</p>



<a name="1380467"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380467" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380467">(May 12 2022 at 11:25)</a>:</h4>
<p>Did you do a <code>/home/zulip/deployments/current/manage.py audit_fts_indexes</code> ?</p>



<a name="1380468"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380468" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380468">(May 12 2022 at 11:25)</a>:</h4>
<p>nope. I'll try that.</p>



<a name="1380469"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380469" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380469">(May 12 2022 at 11:25)</a>:</h4>
<p>That's from <a href="https://zulip.readthedocs.io/en/latest/production/upgrade-or-modify.html#upgrading-from-ubuntu-16-04-xenial-to-18-04-bionic">https://zulip.readthedocs.io/en/latest/production/upgrade-or-modify.html#upgrading-from-ubuntu-16-04-xenial-to-18-04-bionic</a></p>



<a name="1380470"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380470" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380470">(May 12 2022 at 11:26)</a>:</h4>
<p>actually that sounds like something I did during the upgrade</p>



<a name="1380471"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380471" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380471">(May 12 2022 at 11:26)</a>:</h4>
<p>Since you did Xenial -&gt; Focal, both of those sets of steps are applicaable</p>



<a name="1380472"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380472" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380472">(May 12 2022 at 11:26)</a>:</h4>
<p>but not now related to trying to fix the search issue</p>



<a name="1380474"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380474" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380474">(May 12 2022 at 11:26)</a>:</h4>
<p>yes I've done that during the upgrade</p>



<a name="1380483"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380483" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380483">(May 12 2022 at 11:54)</a>:</h4>
<p>Is there possibly a setting that has been introduced to settings.py in the recent years such as choosing which search engine to use</p>



<a name="1380484"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380484" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380484">(May 12 2022 at 11:55)</a>:</h4>
<p>that would now be missing since my settings.py is from 2020</p>



<a name="1380486"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380486" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380486">(May 12 2022 at 11:57)</a>:</h4>
<p>I'll try enabling pgroonga</p>



<a name="1380487"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380487" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380487">(May 12 2022 at 11:58)</a>:</h4>
<p><code>psycopg2.errors.UndefinedObject: access method "pgroonga" does not exist</code></p>



<a name="1380488"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380488" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380488">(May 12 2022 at 12:00)</a>:</h4>
<p>ok I'm missing the plugin</p>



<a name="1380489"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380489" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380489">(May 12 2022 at 12:06)</a>:</h4>
<p>Seems to work now. I installed the pgroonga extension in the process of following the pgroonga instructions from <a href="https://zulip.readthedocs.io/en/latest/subsystems/full-text-search.html">https://zulip.readthedocs.io/en/latest/subsystems/full-text-search.html</a></p>



<a name="1380490"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380490" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380490">(May 12 2022 at 12:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="9287">Antti Kanes</span> has marked this topic as resolved.</p>



<a name="1380519"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1380519" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1380519">(May 12 2022 at 18:08)</a>:</h4>
<p>Were you previously using pgroonga?  Or were you switching to pgroonga for the first time?</p>



<a name="1381483"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1381483" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1381483">(May 17 2022 at 08:15)</a>:</h4>
<p>I was using whatever was default a couple of years ago. Switched to pgroonga to get at least something working since whatever it was before did not work anymore after upgrade.</p>



<a name="1381484"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Search%20produces%20no%20results%20after%20upgrading/near/1381484" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antti Kanes <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Search.20produces.20no.20results.20after.20upgrading.html#1381484">(May 17 2022 at 08:18)</a>:</h4>
<p>So at the point where the search was not working, there was no setting related to search in my settings.py - I configured it according to the pgroonga setup instructions and installed the postresql plugin and got things working.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>