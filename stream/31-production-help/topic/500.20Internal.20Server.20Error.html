<html>
<head><meta charset="utf-8"><title>500 Internal Server Error · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html">500 Internal Server Error</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="218966"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/218966" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#218966">(Jun 04 2017 at 23:38)</a>:</h4>
<p>Hi all,<br>
Trying to get a production server installed and running. Was able to successfully install and initialize the database. Was even able to generate a realm and receive the activation link. However, after following the link I receive "500: Internal server error".</p>
<p>My error.log file shows the following:</p>
<div class="codehilite"><pre><span></span>2017-06-04 19:09:25,259 WARNING  TornadoQueueClient lost connection to RabbitMQ, reconnecting...
2017-06-04 19:19:26,604 WARNING  TornadoQueueClient lost connection to RabbitMQ, reconnecting...
2017-06-04 19:19:28,605 CRITICAL Failed to reconnect to RabbitMQ, retrying...
2017-06-04 19:19:30,606 CRITICAL Failed to reconnect to RabbitMQ, retrying...
2017-06-04 19:19:32,607 CRITICAL Failed to reconnect to RabbitMQ, retrying...
2017-06-04 19:19:34,608 CRITICAL Failed to reconnect to RabbitMQ, retrying...
2017-06-04 19:19:36,609 CRITICAL Failed to reconnect to RabbitMQ, retrying...
2017-06-04 19:19:38,618 CRITICAL Failed to reconnect to RabbitMQ, retrying...
2017-06-04 19:22:30,704 WARNING  TornadoQueueClient lost connection to RabbitMQ, reconnecting...
2017-06-04 19:22:32,706 CRITICAL Failed to reconnect to RabbitMQ, retrying...
</pre></div>


<p>I've already attempted rerunning scripts/setup/configure-rabbitmq and am at a bit of a loss here. Any suggestions of where to look next?</p>



<a name="218968"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/218968" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrea  Longo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#218968">(Jun 04 2017 at 23:54)</a>:</h4>
<p>Have you tried manually restarting rabbitmq? Sometimes I've had to do that because of some peculiarities of my VM. <br>
<code>/etc/init.d/rabbitmq-server restart</code></p>



<a name="218969"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/218969" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrea  Longo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#218969">(Jun 04 2017 at 23:55)</a>:</h4>
<p><span class="user-mention" data-user-email="maxnl2@gmail.com" data-user-id="2529">@Max Levine</span> I don't have a proper answer, but at least it won't hurt anything to try that. (As root, btw.)</p>



<a name="218970"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/218970" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#218970">(Jun 04 2017 at 23:58)</a>:</h4>
<p>I had tried that before. Just gave it another shot and it still is giving me the same issue. The log file shows 2 new entires</p>
<div class="codehilite"><pre><span></span>2017-06-04 19:56:00,204 WARNING  TornadoQueueClient lost connection to RabbitMQ, reconnecting...
2017-06-04 19:56:02,228 CRITICAL Failed to reconnect to RabbitMQ, retrying...
</pre></div>



<a name="218972"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/218972" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrea  Longo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#218972">(Jun 04 2017 at 23:59)</a>:</h4>
<p>Are you seeing an exception in server.log?</p>



<a name="218997"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/218997" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#218997">(Jun 05 2017 at 01:12)</a>:</h4>
<p><span class="user-mention" data-user-email="maxnl2@gmail.com" data-user-id="2529">@Max Levine</span> so after you ran <code>configure-rabbitmq</code>, did you restart the Zulip server?</p>



<a name="219013"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219013" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219013">(Jun 05 2017 at 04:09)</a>:</h4>
<p><span class="user-mention" data-user-email="zulip@feorlen.org" data-user-id="397">@Andrea  Longo</span> Looking in server.log I see many "Tornado   0.0% busy over the past X seconds" lines. These stand out:</p>
<div class="codehilite"><pre><span></span>2017-06-05 00:05:03,959 INFO     172.31.205.122  GET     302   1ms / (unauth via ?)
2017-06-05 00:05:03,973 INFO     172.31.205.122  GET     301   2ms /login (unauth via ?)
2017-06-05 00:05:04,075 INFO     172.31.205.122  GET     200  88ms (db: 1ms/1q) /login/ (unauth via ?)
2017-06-05 00:06:52,234 INFO     172.31.205.12   GET     200  13ms (db: 1ms/3q) /accounts/do_confirm/badb3c6a0d2271086deea3aa15fd1da0acd03036 (unauth via ?)
2017-06-05 00:06:53,111 INFO     172.31.205.12   POST    500 830ms (db: 7ms/5q) /accounts/register/ (unauth via ?)
</pre></div>


<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span>  I thought I had, but just to be sure I re-ran configure-rabbitmq and rebooted again. Still having the same issue.</p>
<p>Interestingly, I don't see additional "Failed to reconnect" messages. So I think we've moved past one issue and onto another?</p>



<a name="219668"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219668" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrea  Longo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219668">(Jun 05 2017 at 23:54)</a>:</h4>
<p>The unauth stuff looks like browser access. For example, this is what I see when I load the login page before I'm logged in: </p>
<div class="codehilite"><pre><span></span>2017-06-05 23:46:42,451 INFO     1.2.3.4     GET     200  34ms (db: 2ms/2q) /accounts/login/ (unauth via ?)
</pre></div>


<p>When you see that in the log, you are getting the 500? I presume at this point you still haven't completed your own admin account creation. If something goes wrong while you are using the one-time link, I'm not exactly sure what happens. (I'll have to explore that when my test server is free.)</p>



<a name="219673"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219673" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219673">(Jun 06 2017 at 00:05)</a>:</h4>
<p><span class="user-mention" data-user-email="maxnl2@gmail.com" data-user-id="2529">@Max Levine</span> do you have any error logs (e.g. in <code>errors.log</code>) for that 500?  If I had to guess, your email configure has a problem, but one could check directly :).</p>



<a name="219694"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219694" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219694">(Jun 06 2017 at 00:25)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> I am pretty sure I have my email configured properly. The test email came through ok, and I am able to use the one time link to browse to the install and input an admin email address. I receive the email with the activation link, it's when I open that link that I get the 500 error.<br>
In the errors.log file there are no new entires, so I think I did need to run the configure-rabbitmq script as well.</p>



<a name="219697"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219697" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219697">(Jun 06 2017 at 00:26)</a>:</h4>
<p>hmm, interesting</p>



<a name="219699"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219699" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219699">(Jun 06 2017 at 00:26)</a>:</h4>
<p>Zulip should never 500 without logging something</p>



<a name="219716"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219716" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219716">(Jun 06 2017 at 00:37)</a>:</h4>
<p>The only log entries I see that stand out are the browser access. I can see where it shows me accessing the page. I know I get the 500. Nothing else in errors.log<br>
I'll look further to see if I can find anything more</p>



<a name="219719"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219719" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219719">(Jun 06 2017 at 00:37)</a>:</h4>
<p>Try <code>django.log</code> as well</p>



<a name="219721"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219721" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219721">(Jun 06 2017 at 00:38)</a>:</h4>
<p>(that and tornado.log have raw stdout, so if the failure is somehow happening too early for error reporting to work, something will be there)</p>



<a name="219726"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219726" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219726">(Jun 06 2017 at 00:44)</a>:</h4>
<p>Well this is something. django.log</p>
<div class="codehilite"><pre><span></span>Traceback (most recent call last):
  File &quot;./zerver/logging_handlers.py&quot;, line 41, in emit
    user_full_name = user_profile.full_name
  File &quot;/home/zulip/deployments/2017-06-04-20-50-09/zulip-venv/lib/python2.7/site-packages/django/utils/functional.py&quot;, line 235, in inner
    return func(self._wrapped, *args)
AttributeError: &#39;AnonymousUser&#39; object has no attribute &#39;full_name&#39;
</pre></div>


<p>Nothing in tornado.log</p>



<a name="219728"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219728" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219728">(Jun 06 2017 at 00:55)</a>:</h4>
<p>Ahh, yeah, OK, so the problem is the error handling itself is failing</p>



<a name="219729"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219729" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219729">(Jun 06 2017 at 00:55)</a>:</h4>
<p>That's a bug we fixed not long ago</p>



<a name="219730"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219730" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219730">(Jun 06 2017 at 00:56)</a>:</h4>
<p>I'd recommend that you upgrade to Zulip 1.6 (coming out very soon); you can do so via Git here: <a href="https://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html#upgrading-from-a-git-repository" target="_blank" title="https://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html#upgrading-from-a-git-repository">https://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html#upgrading-from-a-git-repository</a></p>



<a name="219731"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219731" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219731">(Jun 06 2017 at 00:56)</a>:</h4>
<p>That will make debugging a lot easier</p>



<a name="219732"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/219732" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#219732">(Jun 06 2017 at 00:56)</a>:</h4>
<p>because you're not getting the real exception here</p>



<a name="223550"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/223550" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#223550">(Jun 10 2017 at 01:48)</a>:</h4>
<p>Ok. So, I've started over with 1.6, I'm still getting an error after clicking the link in the realm creation email. It's no longer saying it's an error 500, but I am getting an email of the error I'm getting:</p>
<div class="codehilite"><pre><span></span>Traceback (most recent call last):
 File &quot;/home/zulip/deployments/2017-06-09-15-58-54/zulip-venv/lib/python2.7/site-packages/django/core/handlers/exception.py&quot;, line 42, in inner
   response = get_response(request)
 File &quot;/home/zulip/deployments/2017-06-09-15-58-54/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 249, in _legacy_get_response
   response = self._get_response(request)
 File &quot;/home/zulip/deployments/2017-06-09-15-58-54/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 187, in _get_response
   response = self.process_exception_by_middleware(e, request)
 File &quot;/home/zulip/deployments/2017-06-09-15-58-54/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 185, in _get_response
   response = wrapped_callback(request, *callback_args, **callback_kwargs)
 File &quot;./zerver/decorator.py&quot;, line 118, in wrapper
   return func(request, *args, **kwargs)
 File &quot;./zerver/views/registration.py&quot;, line 192, in accounts_register
   org_type = int(form.cleaned_data[&#39;realm_org_type&#39;])
ValueError: invalid literal for int() with base 10: &#39;&#39;


Request info:
- path: /accounts/register/
- POST: {u&#39;full_name&#39;: [u&#39;&#39;], u&#39;csrfmiddlewaretoken&#39;: [u&#39;**********&#39;], u&#39;from_confirmation&#39;: [u&#39;1&#39;], u&#39;key&#39;: [u&#39;**********&#39;]}
- REMOTE_ADDR: &quot;[u&#39;172.31.205.12&#39;]&quot;
- QUERY_STRING: &quot;[u&#39;&#39;]&quot;
- SERVER_NAME: &quot;[u&#39;&#39;]&quot;
</pre></div>



<a name="227587"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227587" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227587">(Jun 15 2017 at 00:47)</a>:</h4>
<p><span class="user-mention" data-user-email="maxnl2@gmail.com" data-user-id="2529">@Max Levine</span> this one is quite mysterious; did you end up figuring it out?  I don't think we've seen it before.</p>



<a name="227688"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227688" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227688">(Jun 15 2017 at 03:00)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> I haven't had a chance to look into this yet. I'm going to try and find some time over the next few days to actually go over logs. I'll admit, I'm not a Linux expert by any means. I don't do any programming and while I can work my way around command line I'm much more efficient working in a GUI. I guess that's likely to happen when your primary role is helpdesk lol</p>
<p>I'll see if I can dive into this with my director who is much more proficient at this stuff than I am. I'll let you know if I find anything. Thanks for the follow up!</p>



<a name="227690"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227690" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227690">(Jun 15 2017 at 03:01)</a>:</h4>
<p>OK, cool.  I suspect it may be something silly like you didn't pick an organization type and the error handling for that case is buggy.</p>



<a name="227715"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227715" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227715">(Jun 15 2017 at 03:39)</a>:</h4>
<p>Well, I don't think I've even gotten that far? I ran generate_realm_creation_link, opened the URL and input my email address, and then clicked the link in the email to activate. I received an error and that was the traceback that was automatically generated to the administrator address.</p>
<p>So basically I'm stuck between the last two bullet points on step 5 here <a href="https://zulip.readthedocs.io/en/latest/prod-install.html" target="_blank" title="https://zulip.readthedocs.io/en/latest/prod-install.html">https://zulip.readthedocs.io/en/latest/prod-install.html</a></p>
<p>Do I need to set an organization type before following this step? I was under the impression that this would be something I would setup after I successfully log in to the web ui.</p>
<p>I am using LDAP for authentication. I was able to test it and it was able to resolve my email address to my name, so I think I have that configured properly. The email address I'm trying to use to setup the organization is in LDAP, is that a problem?</p>



<a name="227733"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227733" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227733">(Jun 15 2017 at 04:05)</a>:</h4>
<p>Wait, did you get the error when clicking the link, or after filling out the form?</p>



<a name="227734"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227734" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227734">(Jun 15 2017 at 04:06)</a>:</h4>
<p>I bet the problem is that you need to use email authentication to create the organization</p>



<a name="227735"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227735" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227735">(Jun 15 2017 at 04:06)</a>:</h4>
<p>Even if you're later going to use LDAP only</p>



<a name="227884"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227884" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227884">(Jun 15 2017 at 05:50)</a>:</h4>
<p>When clicking the link from the "Activate your Zulip account" email.</p>
<p>Ah, that would definitely explain it. That was not clear to me. So I need to enable email authentication at first, or in addition to LDAP? And once I'm going to LDAP, would I disable email authentication? And can I use an email address that will be in LDAP once LDAP is enabled? So many unanswered questions.  You've got me thinking about it, so I'm going to log in and play around a bit</p>



<a name="227890"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227890" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227890">(Jun 15 2017 at 05:52)</a>:</h4>
<p>in addition to LDAP</p>



<a name="227892"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227892" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227892">(Jun 15 2017 at 05:53)</a>:</h4>
<p>You can disable it as soon as you've created the organization.  I think you had bad luck, in that we updated the docs to make the fact that email auth is required clear in the last week, probably after you started installation.</p>



<a name="227897"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227897" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227897">(Jun 15 2017 at 05:54)</a>:</h4>
<p>I was going to say, there's a theme at my current company where we'll find a way to break things no matter how much they've been tested. Hopefully I'll be successful now!</p>



<a name="227900"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227900" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227900">(Jun 15 2017 at 05:56)</a>:</h4>
<p>I'm curious, where in the documentation does it state that you need to have email auth enabled?</p>



<a name="227917"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227917" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227917">(Jun 15 2017 at 06:04)</a>:</h4>
<p>The last bullet in <a href="http://zulip.readthedocs.io/en/latest/prod-install.html#step-3-configure-zulip" target="_blank" title="http://zulip.readthedocs.io/en/latest/prod-install.html#step-3-configure-zulip">http://zulip.readthedocs.io/en/latest/prod-install.html#step-3-configure-zulip</a></p>



<a name="227920"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227920" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227920">(Jun 15 2017 at 06:07)</a>:</h4>
<p>Well, I went and enabled email auth, tried to activate, and I'm still getting an error. It looks identical to the one from before. </p>
<div class="codehilite"><pre><span></span>Traceback (most recent call last):
 File &quot;/home/zulip/deployments/2017-06-15-01-54-21/zulip-venv/lib/python2.7/site-packages/django/core/handlers/exception.py&quot;, line 42, in inner
   response = get_response(request)
 File &quot;/home/zulip/deployments/2017-06-15-01-54-21/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 249, in _legacy_get_response
   response = self._get_response(request)
 File &quot;/home/zulip/deployments/2017-06-15-01-54-21/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 187, in _get_response
   response = self.process_exception_by_middleware(e, request)
 File &quot;/home/zulip/deployments/2017-06-15-01-54-21/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 185, in _get_response
   response = wrapped_callback(request, *callback_args, **callback_kwargs)
 File &quot;./zerver/decorator.py&quot;, line 118, in wrapper
   return func(request, *args, **kwargs)
 File &quot;./zerver/views/registration.py&quot;, line 192, in accounts_register
   org_type = int(form.cleaned_data[&#39;realm_org_type&#39;])
ValueError: invalid literal for int() with base 10: &#39;&#39;


Request info:
- path: /accounts/register/
- POST: {u&#39;full_name&#39;: [u&#39;&#39;], u&#39;csrfmiddlewaretoken&#39;: [u&#39;**********&#39;], u&#39;from_confirmation&#39;: [u&#39;1&#39;], u&#39;key&#39;: [u&#39;**********&#39;]}
- REMOTE_ADDR: &quot;[u&#39;172.31.205.122&#39;]&quot;
- QUERY_STRING: &quot;[u&#39;&#39;]&quot;
- SERVER_NAME: &quot;[u&#39;&#39;]&quot;
</pre></div>



<a name="227921"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227921" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227921">(Jun 15 2017 at 06:08)</a>:</h4>
<p><span class="user-mention" data-user-email="maxnl2@gmail.com" data-user-id="2529">@Max Levine</span> did you restart the server after enabling auth?</p>



<a name="227922"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227922" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227922">(Jun 15 2017 at 06:08)</a>:</h4>
<p>Otherwise, you're still running the old configuration :)</p>



<a name="227923"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227923" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227923">(Jun 15 2017 at 06:08)</a>:</h4>
<p>If so, I'd recommend proceeding with the print-debugging approach I suggested.</p>



<a name="227924"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227924" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227924">(Jun 15 2017 at 06:08)</a>:</h4>
<p>Also <span class="user-mention" data-user-email="zulip@feorlen.org" data-user-id="397">@Andrea  Longo</span> have you ever seen this exception before?  It'd be awesome if we could reproduce it, which I've been unable to do.</p>



<a name="227925"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227925" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227925">(Jun 15 2017 at 06:08)</a>:</h4>
<p>I actually reverted to my pre-install snapshot, installed, configured, and initialized the DB</p>



<a name="227926"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227926" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227926">(Jun 15 2017 at 06:09)</a>:</h4>
<p>So I think it has to be running with that auth enabled. I'm double checking to make sure it's all configured right</p>



<a name="227929"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227929" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227929">(Jun 15 2017 at 06:09)</a>:</h4>
<p>hmm, weird</p>



<a name="227930"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227930" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227930">(Jun 15 2017 at 06:09)</a>:</h4>
<p>Just to be clear, this is happening after you fill out the form, right?</p>



<a name="227931"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227931" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227931">(Jun 15 2017 at 06:10)</a>:</h4>
<p>If our internal SMTP server supports sending emails without authentication, I shouldn't need to input an email_host_user or email_password, right?</p>



<a name="227935"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227935" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227935">(Jun 15 2017 at 06:11)</a>:</h4>
<p>Yeah, that should work.  Also the error would be very different were that the problem</p>



<a name="227937"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227937" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227937">(Jun 15 2017 at 06:11)</a>:</h4>
<p>Well, what form? I used the URL generated by the create realm command and  input my email address on the website. I received the activation email and attempted to load the URL to complete activation. This is where I'm getting this error. I haven't done any setup on the organization or input any information about the organization yet</p>



<a name="227939"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227939" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227939">(Jun 15 2017 at 06:12)</a>:</h4>
<p>Oh, that's interesting.</p>



<a name="227940"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227940" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227940">(Jun 15 2017 at 06:12)</a>:</h4>
<p>I had assumed you were getting this error on the following step.</p>



<a name="227944"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227944" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227944">(Jun 15 2017 at 06:13)</a>:</h4>
<p>Not quite. This is exactly where I was having an issue last week, but at that point I didn't have the email auth enabled</p>



<a name="227946"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227946" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227946">(Jun 15 2017 at 06:14)</a>:</h4>
<p>I need to head to sleep, but I think <span class="user-mention" data-user-email="yo@vishnuks.com" data-user-id="52">@Vishnu Ks</span> or <span class="user-mention" data-user-email="umair.waheed@gmail.com" data-user-id="92">@Umair Khan</span> should be able to help with this.    I think we should print-debug to get to the bottom of this, but it sounds like somehow it's skipping the step of showing you the realm creation form, which looks like this:<br>
<a href="/user_uploads/2/87/uUgtIsW8iXKulweIcgPT2jzH/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/87/uUgtIsW8iXKulweIcgPT2jzH/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/2/87/uUgtIsW8iXKulweIcgPT2jzH/pasted_image.png"></a></div>



<a name="227947"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227947" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227947">(Jun 15 2017 at 06:15)</a>:</h4>
<p>And throwing the error you'd get if you somehow filled out that form without answering the radio button question, which is kinda impossible.</p>



<a name="227948"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227948" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227948">(Jun 15 2017 at 06:15)</a>:</h4>
<p>I've not seen that form once yet. I need to head to sleep as well, but will try and find some time tomorrow to look into this more</p>



<a name="227951"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227951" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227951">(Jun 15 2017 at 06:22)</a>:</h4>
<p>I don't see any information about print-debugging, maybe you had mentioned it in a different thread? I'm thinking you're referring to this? <a href="https://zulip.readthedocs.io/en/latest/testing-with-casper.html" target="_blank" title="https://zulip.readthedocs.io/en/latest/testing-with-casper.html">https://zulip.readthedocs.io/en/latest/testing-with-casper.html</a></p>



<a name="227956"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227956" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227956">(Jun 15 2017 at 06:34)</a>:</h4>
<p>I just mean adding <code>print()</code> statements in the code and then restarting the server to see what the values are.</p>



<a name="227958"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227958" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227958">(Jun 15 2017 at 06:37)</a>:</h4>
<p><span class="user-mention" data-user-email="maxnl2@gmail.com" data-user-id="2529">@Max Levine</span>, can you post the url you are clicking?</p>



<a name="227961"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227961" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227961">(Jun 15 2017 at 06:39)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> Where would I add those?<br>
<span class="user-mention" data-user-email="umair.waheed@gmail.com" data-user-id="92">@Umair Khan</span> <a href="https://zulip.mkoss.com/accounts/do_confirm/c98e7942a7a923072595c8efca097dc528b7bba4" target="_blank" title="https://zulip.mkoss.com/accounts/do_confirm/c98e7942a7a923072595c8efca097dc528b7bba4">https://zulip.mkoss.com/accounts/do_confirm/c98e7942a7a923072595c8efca097dc528b7bba4</a></p>



<a name="227962"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227962" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227962">(Jun 15 2017 at 06:39)</a>:</h4>
<p>Thanks.</p>



<a name="227984"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227984" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227984">(Jun 15 2017 at 06:56)</a>:</h4>
<p>I am guessing that you have set <code>POPULATE_PROFILE_VIA_LDAP=True</code>?</p>



<a name="227992"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227992" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227992">(Jun 15 2017 at 07:03)</a>:</h4>
<p><span class="user-mention" data-user-email="maxnl2@gmail.com" data-user-id="2529">@Max Levine</span>, I have only tested this on the console but I think setting <code>POPULATE_PROFILE_VIA_LDAP</code> to  <code>True</code> can lead to the error you are getting. In that code path ,<code>form.is_valid()</code> gives <code>True</code>.</p>



<a name="227996"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227996" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227996">(Jun 15 2017 at 07:10)</a>:</h4>
<p>I haven't intentionally set that,  I'm not even sure where I would set it. I only filled out sections present in the default settings.py file. I don't see a line <code>POPULATE_PROFILE_VIA_LDAP</code> in there, so I wouldn't have set it. I did run <code>manage.py sync_ldap_user_data</code> which completed without issue. I actually have tried disabled LDAP now, just leaving email and restarted the server. After it came back up I tried to follow the activation link again and it generated the same error as before.</p>



<a name="227998"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227998" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Levine <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227998">(Jun 15 2017 at 07:11)</a>:</h4>
<p>I'm off for the night. I'm in eastern time and it got to be a bit later than I realized. Thanks for the help tonight. I'll check back in tomorrow</p>



<a name="227999"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/227999" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#227999">(Jun 15 2017 at 07:11)</a>:</h4>
<p>Cool</p>



<a name="228045"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228045" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228045">(Jun 15 2017 at 08:56)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span>, so the problem occurs when:<br>
1. LDAP auth is enabled.<br>
2. <code>realm_creation</code> is <code>True</code>.<br>
3. <code>TERMS_OF_SERVICE</code> is <code>False</code><br>
4. <code>ldap_attrs[settings.AUTH_LDAP_USER_ATTR_MAP['full_name']][0]</code> returns a name.<br>
5. request.POST.get('from_confirmation') is <code>True</code></p>
<p>Problem can be reproduced in <a href="https://github.com/zulip/zulip/pull/5402" target="_blank" title="https://github.com/zulip/zulip/pull/5402">#5402</a>.</p>



<a name="228047"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228047" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228047">(Jun 15 2017 at 08:58)</a>:</h4>
<p>Cool, nice debugging!  I guess it's not clear to me why that set of things would interact badly.  Simplest might be to ignore LDAP names during realm creation, but it seems like there's probably a more root cause fix we could do here?</p>



<a name="228048"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228048" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228048">(Jun 15 2017 at 08:59)</a>:</h4>
<p>It seems that we assume that when LDAP auth is enabled, we can't follow <code>realm_creation</code> code path.</p>



<a name="228050"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228050" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228050">(Jun 15 2017 at 09:00)</a>:</h4>
<p>We intentionally setup our form so that it becomes valid and we bypass the flow in which form is shown to the user.</p>



<a name="228051"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228051" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228051">(Jun 15 2017 at 09:01)</a>:</h4>
<div class="codehilite"><pre><span></span>148                         # We don&#39;t use initial= here, because if the form is
149                         # complete (that is, no additional fields need to be
150                         # filled out by the user) we want the form to validate,
151                         # so they can be directly registered without having to
152                         # go through this interstitial.
153                         form = RegistrationForm({&#39;full_name&#39;: ldap_full_name})
</pre></div>



<a name="228065"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228065" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228065">(Jun 15 2017 at 09:15)</a>:</h4>
<p>Ahh, that makes sense.  I think that code path should just have a <code>not realm_creation</code> check in it.</p>



<a name="228066"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228066" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228066">(Jun 15 2017 at 09:15)</a>:</h4>
<p>Yeah, that should fix this.</p>



<a name="228067"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228067" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228067">(Jun 15 2017 at 09:16)</a>:</h4>
<p>Shall I go ahead with the fix?</p>



<a name="228069"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228069" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228069">(Jun 15 2017 at 09:16)</a>:</h4>
<p>yep!</p>



<a name="228070"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228070" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228070">(Jun 15 2017 at 09:16)</a>:</h4>
<p>Cool.</p>



<a name="228200"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228200" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228200">(Jun 15 2017 at 10:48)</a>:</h4>
<p>Fixed here: <a href="https://github.com/zulip/zulip/pull/5402" target="_blank" title="https://github.com/zulip/zulip/pull/5402">#5402</a></p>



<a name="228347"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228347" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrea  Longo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228347">(Jun 15 2017 at 14:04)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-email="umair.waheed@gmail.com" data-user-id="92">@Umair Khan</span> No, I hadn't seen that error before but I haven't tried LDAP. I wonder if enabling Open Directory on my OS X Server box would be sufficient to test this.</p>



<a name="228348"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/228348" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrea  Longo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#228348">(Jun 15 2017 at 14:05)</a>:</h4>
<p>Awesome to have a fix, LDAP is fussy business but important to many folk's infra.</p>



<a name="229394"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/229394" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrea  Longo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#229394">(Jun 15 2017 at 23:51)</a>:</h4>
<p>I'm trying to set up Open Directory for a test, but I'm having problems getting Zulip to connect to it. Does anyone have a sample configuration? I can ldapsearch, but <code>manage.py query_ldap</code> says it can't reach it.</p>



<a name="229440"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/229440" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#229440">(Jun 16 2017 at 01:30)</a>:</h4>
<p><a href="https://github.com/zulip/zulip/issues/349" target="_blank" title="https://github.com/zulip/zulip/issues/349">https://github.com/zulip/zulip/issues/349</a> could be helpful</p>



<a name="229480"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/229480" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrea  Longo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#229480">(Jun 16 2017 at 03:31)</a>:</h4>
<p>Looks like my OD problem is with a self-signed cert. But in the process, I got a new 500 error: <a href="https://github.com/zulip/zulip/issues/5431" target="_blank" title="https://github.com/zulip/zulip/issues/5431">https://github.com/zulip/zulip/issues/5431</a></p>



<a name="229481"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/229481" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrea  Longo <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#229481">(Jun 16 2017 at 03:33)</a>:</h4>
<p>Still trying to get Zulip login working, may be something with my server and OD.</p>



<a name="258948"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/258948" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> zhangqx <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#258948">(Jul 28 2017 at 13:02)</a>:</h4>
<p>I'm running  ' /home/zulip/deployments/current/manage.py generate_realm_creation_link ' ,but there is error like this,why  <a href="/user_uploads/2/ac/N6UcmfAB3NJ0LeRaphM_b0IO/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/ac/N6UcmfAB3NJ0LeRaphM_b0IO/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/2/ac/N6UcmfAB3NJ0LeRaphM_b0IO/pasted_image.png"></a></div>



<a name="258954"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/258954" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> zhangqx <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#258954">(Jul 28 2017 at 13:47)</a>:</h4>
<p>I have test '/home/zulip/deployments/current/manage.py send_test_email <a href="mailto:username@example.com" title="mailto:username@example.com">username@example.com</a> ',it is successful。</p>



<a name="258955"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/258955" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aditya Bansal <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#258955">(Jul 28 2017 at 13:48)</a>:</h4>
<p>what does this <code>/var/log/zulip/errors.log</code> say?</p>



<a name="258964"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/258964" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> zhangqx <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#258964">(Jul 28 2017 at 15:04)</a>:</h4>
<p><a href="/user_uploads/2/d2/B-g55c1-_LIdWU3qZRM4sZvL/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/d2/B-g55c1-_LIdWU3qZRM4sZvL/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/2/d2/B-g55c1-_LIdWU3qZRM4sZvL/pasted_image.png"></a></div>



<a name="258965"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/258965" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> zhangqx <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#258965">(Jul 28 2017 at 15:04)</a>:</h4>
<p><a href="/user_uploads/2/52/3grbb0KDonQijyNwoZkGFRRx/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/52/3grbb0KDonQijyNwoZkGFRRx/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/2/52/3grbb0KDonQijyNwoZkGFRRx/pasted_image.png"></a></div>



<a name="259040"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/259040" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#259040">(Jul 28 2017 at 17:12)</a>:</h4>
<p><span class="user-mention" data-user-email="elek-bot@chat.zulip.org" data-user-id="2899">@zhangqx</span> that log error looks like somehow RabbitMQ isn't setup properly.  I think <code>scripts/setup/configure-rabbitmq</code> should help.</p>



<a name="259980"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/259980" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> zhangqx <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#259980">(Jul 30 2017 at 10:06)</a>:</h4>
<blockquote>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> I am pretty sure I have my email configured properly. The test email came through ok, and I am able to use the one time link to browse to the install and input an admin email address. I receive the email with the activation link, it's when I open that link that I get the 500 error.<br>
In the errors.log file there are no new entires, so I think I did need to run the configure-rabbitmq script as well.</p>
</blockquote>
<p>I get a same error ,but the <code>django.log</code> is not similar with that </p>
<div class="codehilite"><pre><span></span>2017-07-29 08:19:49,101 ERROR    Internal Server Error: /accounts/login/
Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/core/handlers/exception.py&quot;, line 41, in inner
    response = get_response(request)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 187, in _get_response
    response = self.process_exception_by_middleware(e, request)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File &quot;./zerver/views/auth.py&quot;, line 448, in login_page
    extra_context=extra_context, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/views.py&quot;, line 54, in inner
    return func(*args, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/views.py&quot;, line 139, in login
    return LoginView.as_view(**kwargs)(request, *args, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/views/generic/base.py&quot;, line 68, in view
    return self.dispatch(request, *args, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py&quot;, line 67, in _wrapper
    return bound_func(*args, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/views/decorators/debug.py&quot;, line 76, in sensitive_post_parameters_wrapper
    return view(request, *args, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py&quot;, line 63, in bound_func
    return func.__get__(self, type(self))(*args2, **kwargs2)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py&quot;, line 67, in _wrapper
    return bound_func(*args, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py&quot;, line 149, in _wrapped_view
    response = view_func(request, *args, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py&quot;, line 63, in bound_func
    return func.__get__(self, type(self))(*args2, **kwargs2)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py&quot;, line 67, in _wrapper
    return bound_func(*args, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/views/decorators/cache.py&quot;, line 57, in _wrapped_view_func
    response = view_func(request, *args, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/utils/decorators.py&quot;, line 63, in bound_func
    return func.__get__(self, type(self))(*args2, **kwargs2)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/views.py&quot;, line 90, in dispatch
    return super(LoginView, self).dispatch(request, *args, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/views/generic/base.py&quot;, line 88, in dispatch
    return handler(request, *args, **kwargs)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/views/generic/edit.py&quot;, line 183, in post
    return self.form_valid(form)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/views.py&quot;, line 117, in form_valid
    auth_login(self.request, form.get_user())
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/contrib/auth/__init__.py&quot;, line 160, in login
    user_logged_in.send(sender=user.__class__, request=request, user=user)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/dispatch/dispatcher.py&quot;, line 193, in send
    for receiver in self._live_receivers(sender)
  File &quot;./zerver/signals.py&quot;, line 91, in email_on_new_login
    send_email_to_user(&#39;zerver/emails/notify_new_login&#39;, user, context=context)
  File &quot;./zerver/lib/send_email.py&quot;, line 60, in send_email_to_user
    from_address=from_address, context=context)
  File &quot;./zerver/lib/send_email.py&quot;, line 55, in send_email
    return mail.send() &gt; 0
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/core/mail/message.py&quot;, line 348, in send
    return self.get_connection(fail_silently).send_messages([self])
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/core/mail/backends/smtp.py&quot;, line 111, in send_messages
    sent = self._send(message)
  File &quot;/home/zulip/deployments/2017-07-28-13-43-19/zulip-venv/lib/python2.7/site-packages/django/core/mail/backends/smtp.py&quot;, line 127, in _send
    self.connection.sendmail(from_email, recipients, message.as_bytes(linesep=&#39;\r\n&#39;))
  File &quot;/usr/lib/python2.7/smtplib.py&quot;, line 751, in sendmail
    raise SMTPDataError(code, resp)
SMTPDataError: (550, &#39;5.7.1 Client does not have permissions to send as this sender&#39;)
2017-07-29 08:19:49,119 INFO     192.168.19.143  POST    500 409ms (db: 12ms/5q) (+start: 7ms) /accounts/login/ (unauth via ?)
[pid: 66208|app: 0|req: 9/16] 192.168.19.143 () {52 vars in 992 bytes} [Sat Jul 29 08:19:48 2017] POST /accounts/login/?next=/ =&gt; generated 4337 bytes in 420 msecs (HTTP/1.1 500) 5 headers in 324 bytes (1 switches on core 0)
</pre></div>



<a name="260077"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/260077" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#260077">(Jul 31 2017 at 00:04)</a>:</h4>
<p><span class="user-mention" data-user-email="elek-bot@chat.zulip.org" data-user-id="2899">@zhangqx</span> Yeah, so the issue now is that your SMTP credentials seem to not be able to send with different <code>Sender</code> / <code>From</code> addresses.  What tool are you using to send outgoing email?  That tool may need some configuration.</p>



<a name="260078"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/260078" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#260078">(Jul 31 2017 at 00:05)</a>:</h4>
<p><span class="user-mention" data-user-email="rishig@zulipchat.com" data-user-id="131">@Rishi Gupta</span> <span class="user-mention" data-user-email="james.rowan13@gmail.com" data-user-id="2277">@James Rowan</span> as a sidenote, do we have a list of what email accounts Zulip will send as?</p>



<a name="260123"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/260123" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#260123">(Jul 31 2017 at 02:01)</a>:</h4>
<p>For the email address part, I think it should only be things that appear in prod_settings_template.py, which is ZULIP_ADMINISTRATOR and NOREPLY_EMAIL_ADDRESS.<br>
The display name part can be anything, e.g. due to missed message emails.</p>



<a name="260124"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/260124" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> zhangqx <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#260124">(Jul 31 2017 at 02:11)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> I don't use SMTP credentials ,and I test sending an email with tools <code>/home/zulip/deployments/current/manage.py send_test_email</code>successfully。</p>



<a name="260128"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20Internal%20Server%20Error/near/260128" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> zhangqx <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20Internal.20Server.20Error.html#260128">(Jul 31 2017 at 02:43)</a>:</h4>
<blockquote>
<p>For the email address part, I think it should only be things that appear in prod_settings_template.py, which is ZULIP_ADMINISTRATOR and NOREPLY_EMAIL_ADDRESS.<br>
The display name part can be anything, e.g. due to missed message emails.</p>
</blockquote>
<p>thinks,I have found the reason of this error.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>