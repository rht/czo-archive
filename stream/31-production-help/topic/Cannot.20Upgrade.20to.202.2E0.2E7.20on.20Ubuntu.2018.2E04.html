<html>
<head><meta charset="utf-8"><title>Cannot Upgrade to 2.0.7 on Ubuntu 18.04 · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html">Cannot Upgrade to 2.0.7 on Ubuntu 18.04</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="801332"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801332" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801332">(Dec 10 2019 at 07:57)</a>:</h4>
<p>As per here: <a href="https://github.com/zulip/zulip/issues/13495" target="_blank" title="https://github.com/zulip/zulip/issues/13495">https://github.com/zulip/zulip/issues/13495</a> I am opening a topic here as requested by <span class="user-mention" data-user-id="7">@Tim Abbott</span> and <span class="user-mention" data-user-id="12730">@Mateusz Test Mandera</span></p>



<a name="801333"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801333" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801333">(Dec 10 2019 at 07:58)</a>:</h4>
<p>output of lsb_release -a is:<br>
No LSB modules are available.<br>
Distributor ID: Ubuntu<br>
Description:    Ubuntu 18.04.3 LTS<br>
Release:    18.04<br>
Codename:   bionic</p>



<a name="801334"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801334" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801334">(Dec 10 2019 at 07:59)</a>:</h4>
<p>It is a stock standard Ubuntu 18.04 on Google Cloud virtual machine (with all latest updates applied, right before this upgrade, maybe that has something to do with it? And, Zulip is the only thing on this server, nothing else at all)</p>



<a name="801374"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801374" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801374">(Dec 10 2019 at 17:01)</a>:</h4>
<p><span class="user-mention" data-user-id="14099">@Mal</span></p>
<ol>
<li>Can you go to the python shell using <code>/home/zulip/deployments/current/manage.py shell</code> and there run <code>RealmAuditLog.objects.order_by("id").values("event_time", "event_type")[:10]</code> and show the output of that?</li>
<li>Also the output of  <code>/home/zulip/deployments/current/manage.py showmigrations</code></li>
<li>Have you ever attempted a <code>git-upgrade</code> of the server to the <code>2.1-rc1</code> version, or to the <code>master</code> branch?</li>
</ol>



<a name="801440"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801440" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801440">(Dec 10 2019 at 20:19)</a>:</h4>
<p>Outcome of: RealmAuditLog.objects.order_by("id").values("event_time", "event_type")[:10]</p>



<a name="801441"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801441" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801441">(Dec 10 2019 at 20:19)</a>:</h4>
<p>In [1]: RealmAuditLog.objects.order_by("id").values("event_time", "event_type")[:10]                                                                                                                          <br>
Out[1]: &lt;QuerySet [{'event_time': datetime.datetime(2019, 9, 5, 11, 45, 11, 466601, tzinfo=&lt;UTC&gt;), 'event_type': 101}, {'event_time': datetime.datetime(2019, 9, 5, 11, 45, 11, 485095, tzinfo=&lt;UTC&gt;), 'event_type': 101}, {'event_time': datetime.datetime(2019, 9, 5, 11, 45, 11, 485382, tzinfo=&lt;UTC&gt;), 'event_type': 101}, {'event_time': datetime.datetime(2019, 9, 5, 11, 45, 11, 485657, tzinfo=&lt;UTC&gt;), 'event_type': 101}, {'event_time': datetime.datetime(2019, 9, 5, 11, 45, 11, 485885, tzinfo=&lt;UTC&gt;), 'event_type': 101}, {'event_time': datetime.datetime(2019, 9, 5, 11, 45, 11, 486107, tzinfo=&lt;UTC&gt;), 'event_type': 101}, {'event_time': datetime.datetime(2019, 9, 5, 11, 45, 11, 486326, tzinfo=&lt;UTC&gt;), 'event_type': 101}, {'event_time': datetime.datetime(2019, 9, 5, 11, 45, 11, 486552, tzinfo=&lt;UTC&gt;), 'event_type': 101}, {'event_time': datetime.datetime(2019, 9, 5, 11, 51, 33, 927817, tzinfo=&lt;UTC&gt;), 'event_type': 101}, {'event_time': datetime.datetime(2019, 9, 5, 11, 51, 34, 51033, tzinfo=&lt;UTC&gt;), 'event_type': 301}]&gt;</p>



<a name="801445"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801445" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801445">(Dec 10 2019 at 20:20)</a>:</h4>
<p>and....</p>



<a name="801447"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801447" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801447">(Dec 10 2019 at 20:20)</a>:</h4>
<p>zulip@shaberu:~$ /home/zulip/deployments/current/manage.py showmigrations<br>
analytics<br>
 [X] 0001_initial<br>
 [X] 0002_remove_huddlecount<br>
 [X] 0003_fillstate<br>
 [X] 0004_add_subgroup<br>
 [X] 0005_alter_field_size<br>
 [X] 0006_add_subgroup_to_unique_constraints<br>
 [X] 0007_remove_interval<br>
 [X] 0008_add_count_indexes<br>
 [X] 0009_remove_messages_to_stream_stat<br>
 [X] 0010_clear_messages_sent_values<br>
 [X] 0011_clear_analytics_tables<br>
 [X] 0012_add_on_delete<br>
 [X] 0013_remove_anomaly<br>
auth<br>
 [X] 0001_initial<br>
 [X] 0002_alter_permission_name_max_length<br>
 [X] 0003_alter_user_email_max_length<br>
 [X] 0004_alter_user_username_opts<br>
 [X] 0005_alter_user_last_login_null<br>
 [X] 0006_require_contenttypes_0002<br>
 [X] 0007_alter_validators_add_error_messages<br>
 [X] 0008_alter_user_username_max_length<br>
confirmation<br>
 [X] 0001_initial<br>
 [X] 0002_realmcreationkey<br>
 [X] 0003_emailchangeconfirmation<br>
 [X] 0004_remove_confirmationmanager<br>
 [X] 0005_confirmation_realm<br>
 [X] 0006_realmcreationkey_presume_email_valid<br>
contenttypes<br>
 [X] 0001_initial<br>
 [X] 0002_remove_content_type_name<br>
otp_static<br>
 [X] 0001_initial<br>
otp_totp<br>
 [X] 0001_initial<br>
 [X] 0002_auto_20190420_0723<br>
sessions<br>
 [X] 0001_initial<br>
social_django<br>
 [X] 0001_initial (2 squashed migrations)<br>
 [X] 0002_add_related_name (2 squashed migrations)<br>
 [X] 0003_alter_email_max_length (2 squashed migrations)<br>
 [X] 0004_auto_20160423_0400 (2 squashed migrations)<br>
 [X] 0005_auto_20160727_2333 (1 squashed migrations)<br>
 [X] 0006_partial<br>
 [X] 0007_code_timestamp<br>
 [X] 0008_partial_timestamp<br>
two_factor<br>
 [X] 0001_initial<br>
 [X] 0002_auto_20150110_0810<br>
 [X] 0003_auto_20150817_1733<br>
 [X] 0004_auto_20160205_1827<br>
 [X] 0005_auto_20160224_0450<br>
 [X] 0006_phonedevice_key_default<br>
zerver<br>
 [X] 0001_initial<br>
 [X] 0029_realm_subdomain<br>
 [X] 0030_realm_org_type<br>
 [X] 0031_remove_system_avatar_source<br>
 [X] 0032_verify_all_medium_avatar_images<br>
 [X] 0033_migrate_domain_to_realmalias<br>
 [X] 0034_userprofile_enable_online_push_notifications<br>
 [X] 0035_realm_message_retention_period_days<br>
 [X] 0036_rename_subdomain_to_string_id<br>
 [X] 0037_disallow_null_string_id<br>
 [X] 0038_realm_change_to_community_defaults<br>
 [X] 0039_realmalias_drop_uniqueness<br>
 [X] 0040_realm_authentication_methods<br>
 [X] 0041_create_attachments_for_old_messages<br>
 [X] 0042_attachment_file_name_length<br>
 [X] 0043_realm_filter_validators<br>
 [X] 0044_reaction<br>
 [X] 0045_realm_waiting_period_threshold<br>
 [X] 0046_realmemoji_author<br>
 [X] 0047_realm_add_emoji_by_admins_only<br>
 [X] 0048_enter_sends_default_to_false<br>
 [X] 0049_userprofile_pm_content_in_desktop_notifications<br>
 [X] 0050_userprofile_avatar_version<br>
 [X] 0051_realmalias_add_allow_subdomains<br>
 [X] 0052_auto_fix_realmalias_realm_nullable<br>
 [X] 0053_emailchangestatus<br>
 [X] 0054_realm_icon<br>
 [X] 0055_attachment_size<br>
 [X] 0056_userprofile_emoji_alt_code<br>
 [X] 0057_realmauditlog<br>
 [X] 0058_realm_email_changes_disabled<br>
 [X] 0059_userprofile_quota<br>
 [X] 0060_move_avatars_to_be_uid_based<br>
 [X] 0061_userprofile_timezone<br>
 [X] 0062_default_timezone<br>
 [X] 0063_realm_description<br>
 [X] 0064_sync_uploads_filesize_with_db<br>
 [X] 0065_realm_inline_image_preview<br>
 [X] 0066_realm_inline_url_embed_preview<br>
 [X] 0067_archived_models<br>
 [X] 0068_remove_realm_domain<br>
 [X] 0069_realmauditlog_extra_data<br>
 [X] 0070_userhotspot<br>
 [X] 0071_rename_realmalias_to_realmdomain<br>
 [X] 0072_realmauditlog_add_index_event_time<br>
 [X] 0073_custom_profile_fields<br>
 [X] 0074_fix_duplicate_attachments<br>
 [X] 0075_attachment_path_id_unique<br>
 [X] 0076_userprofile_emojiset<br>
 [X] 0077_add_file_name_field_to_realm_emoji<br>
 [X] 0078_service<br>
 [X] 0079_remove_old_scheduled_jobs<br>
 [X] 0080_realm_description_length<br>
 [X] 0081_make_emoji_lowercase<br>
 [X] 0082_index_starred_user_messages<br>
 [X] 0083_index_mentioned_user_messages<br>
 [X] 0084_realmemoji_deactivated<br>
 [X] 0085_fix_bots_with_none_bot_type<br>
 [X] 0086_realm_alter_default_org_type<br>
 [X] 0087_remove_old_scheduled_jobs<br>
 [X] 0088_remove_referral_and_invites<br>
 [X] 0089_auto_20170710_1353<br>
 [X] 0090_userprofile_high_contrast_mode<br>
 [X] 0091_realm_allow_edit_history<br>
 [X] 0092_create_scheduledemail<br>
 [X] 0093_subscription_event_log_backfill<br>
 [X] 0094_realm_filter_url_validator<br>
 [X] 0095_index_unread_user_messages<br>
 [X] 0096_add_password_required<br>
 [X] 0097_reactions_emoji_code<br>
 [X] 0098_index_has_alert_word_user_messages<br>
 [X] 0099_index_wildcard_mentioned_user_messages<br>
 [X] 0100_usermessage_remove_is_me_message<br>
 [X] 0101_muted_topic<br>
 [X] 0102_convert_muted_topic<br>
 [X] 0103_remove_userprofile_muted_topics<br>
 [X] 0104_fix_unreads<br>
 [X] 0105_userprofile_enable_stream_push_notifications<br>
 [X] 0106_subscription_push_notifications<br>
 [X] 0107_multiuseinvite<br>
 [X] 0108_fix_default_string_id<br>
 [X] 0109_mark_tutorial_status_finished<br>
 [X] 0110_stream_is_in_zephyr_realm<br>
 [X] 0111_botuserstatedata<br>
 [X] 0112_index_muted_topics<br>
 [X] 0113_default_stream_group<br>
 [X] 0114_preregistrationuser_invited_as_admin<br>
 [X] 0115_user_groups<br>
 [X] 0116_realm_allow_message_deleting<br>
 [X] 0117_add_desc_to_user_group<br>
 [X] 0118_defaultstreamgroup_description<br>
 [X] 0119_userprofile_night_mode<br>
 [X] 0120_botuserconfigdata<br>
 [X] 0121_realm_signup_notifications_stream<br>
 [X] 0122_rename_botuserstatedata_botstoragedata<br>
 [X] 0123_userprofile_make_realm_email_pair_unique<br>
 [X] 0124_stream_enable_notifications<br>
 [X] 0125_realm_max_invites<br>
 [X] 0126_prereg_remove_users_without_realm<br>
 [X] 0127_disallow_chars_in_stream_and_user_name<br>
 [X] 0128_scheduledemail_realm<br>
 [X] 0129_remove_userprofile_autoscroll_forever<br>
 [X] 0130_text_choice_in_emojiset<br>
 [X] 0131_realm_create_generic_bot_by_admins_only<br>
 [X] 0132_realm_message_visibility_limit<br>
 [X] 0133_rename_botuserconfigdata_botconfigdata<br>
 [X] 0134_scheduledmessage<br>
 [X] 0135_scheduledmessage_delivery_type<br>
 [X] 0136_remove_userprofile_quota<br>
 [X] 0137_realm_upload_quota_gb<br>
 [X] 0138_userprofile_realm_name_in_notifications<br>
 [X] 0139_fill_last_message_id_in_subscription_logs<br>
 [X] 0140_realm_send_welcome_emails<br>
 [X] 0141_change_usergroup_description_to_textfield<br>
 [X] 0142_userprofile_translate_emoticons<br>
 [X] 0143_realm_bot_creation_policy<br>
 [X] 0144_remove_realm_create_generic_bot_by_admins_only<br>
 [X] 0145_reactions_realm_emoji_name_to_id<br>
 [X] 0146_userprofile_message_content_in_email_notifications<br>
 [X] 0147_realm_disallow_disposable_email_addresses<br>
 [X] 0148_max_invites_forget_default<br>
 [X] 0149_realm_emoji_drop_unique_constraint<br>
 [X] 0150_realm_allow_community_topic_editing<br>
 [X] 0151_last_reminder_default_none<br>
 [X] 0152_realm_default_twenty_four_hour_time<br>
 [X] 0153_remove_int_float_custom_fields<br>
 [X] 0154_fix_invalid_bot_owner<br>
 [X] 0155_change_default_realm_description<br>
 [X] 0156_add_hint_to_profile_field<br>
 [X] 0157_userprofile_is_guest<br>
 [X] 0158_realm_video_chat_provider<br>
 [X] 0159_realm_google_hangouts_domain<br>
 [X] 0160_add_choice_field<br>
 [X] 0161_realm_message_content_delete_limit_seconds<br>
 [X] 0162_change_default_community_topic_editing<br>
 [X] 0163_remove_userprofile_default_desktop_notifications<br>
 [X] 0164_stream_history_public_to_subscribers<br>
 [X] 0165_add_date_to_profile_field<br>
 [X] 0166_add_url_to_profile_field<br>
 [X] 0167_custom_profile_fields_sort_order<br>
 [X] 0168_stream_is_web_public<br>
 [X] 0169_stream_is_announcement_only<br>
 [X] 0170_submessage<br>
 [X] 0171_userprofile_dense_mode<br>
 [X] 0172_add_user_type_of_custom_profile_field<br>
 [X] 0173_support_seat_based_plans<br>
 [X] 0174_userprofile_delivery_email<br>
 [X] 0175_change_realm_audit_log_event_type_tense<br>
 [X] 0176_remove_subscription_notifications<br>
 [X] 0177_user_message_add_and_index_is_private_flag<br>
 [X] 0178_rename_to_emails_restricted_to_domains<br>
 [X] 0179_rename_to_digest_emails_enabled<br>
 [X] 0180_usermessage_add_active_mobile_push_notification<br>
 [X] 0181_userprofile_change_emojiset<br>
 [X] 0182_set_initial_value_is_private_flag<br>
 [X] 0183_change_custom_field_name_max_length<br>
 [X] 0184_rename_custom_field_types<br>
 [X] 0185_realm_plan_type<br>
 [X] 0186_userprofile_starred_message_counts<br>
 [X] 0187_userprofile_is_billing_admin<br>
 [X] 0188_userprofile_enable_login_emails<br>
 [X] 0189_userprofile_add_some_emojisets<br>
 [X] 0190_cleanup_pushdevicetoken<br>
 [X] 0191_realm_seat_limit<br>
 [X] 0192_customprofilefieldvalue_rendered_value<br>
 [X] 0193_realm_email_address_visibility<br>
 [X] 0194_userprofile_notification_sound<br>
 [X] 0195_realm_first_visible_message_id<br>
 [X] 0196_add_realm_logo_fields<br>
 [X] 0197_azure_active_directory_auth<br>
 [X] 0198_preregistrationuser_invited_as<br>
 [X] 0199_userstatus<br>
 [X] 0200_remove_preregistrationuser_invited_as_admin<br>
 [X] 0201_zoom_video_chat<br>
 [X] 0202_add_user_status_info<br>
 [X] 0203_realm_message_content_allowed_in_email_notifications<br>
 [X] 0204_remove_realm_billing_fields<br>
 [X] 0205_remove_realmauditlog_requires_billing_update<br>
 [X] 0206_stream_rendered_description<br>
 [X] 0207_multiuseinvite_invited_as<br>
 [X] 0208_add_realm_night_logo_fields<br>
 [X] 0209_stream_first_message_id<br>
 [X] 0210_stream_first_message_id<br>
 [X] 0211_add_users_field_to_scheduled_email<br>
 [X] 0212_make_stream_email_token_unique<br>
 [X] 0213_realm_digest_weekday<br>
 [X] 0214_realm_invite_to_stream_policy<br>
 [X] 0215_realm_avatar_changes_disabled<br>
 [X] 0216_add_create_stream_policy<br>
 [X] 0217_migrate_create_stream_policy<br>
 [X] 0218_remove_create_stream_by_admins_only<br>
 [X] 0219_toggle_realm_digest_emails_enabled_default<br>
 [X] 0220_subscription_notification_settings<br>
 [X] 0221_subscription_notifications_data_migration<br>
 [X] 0222_userprofile_fluid_layout_width<br>
 [X] 0223_rename_to_is_muted<br>
 [X] 0224_alter_field_realm_video_chat_provider<br>
 [X] 0225_archived_reaction_model<br>
 [X] 0226_archived_submessage_model<br>
 [X] 0227_inline_url_embed_preview_default_off<br>
 [X] 0228_userprofile_demote_inactive_streams<br>
 [X] 0229_stream_message_retention_days<br>
 [X] 0230_rename_to_enable_stream_audible_notifications<br>
 [X] 0231_add_archive_transaction_model<br>
 [X] 0232_make_archive_transaction_field_not_nullable<br>
 [X] 0233_userprofile_avatar_hash<br>
 [X] 0234_add_external_account_custom_profile_field<br>
 [X] 0235_userprofile_desktop_icon_count_display<br>
 [X] 0236_remove_illegal_characters_email_full<br>
 [X] 0237_rename_zulip_realm_to_zulipinternal<br>
 [X] 0238_usermessage_bigint_id<br>
 [X] 0239_usermessage_copy_id_to_bigint_id<br>
 [X] 0240_usermessage_migrate_bigint_id_into_id</p>



<a name="801449"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801449" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801449">(Dec 10 2019 at 20:20)</a>:</h4>
<p>[X] 0241_usermessage_bigint_id_migration_finalize<br>
 [X] 0242_fix_bot_email_property<br>
 [X] 0243_message_add_date_sent_column<br>
 [X] 0244_message_copy_pub_date_to_date_sent<br>
 [X] 0245_message_date_sent_finalize_part1<br>
 [X] 0246_message_date_sent_finalize_part2<br>
 [X] 0247_realmauditlog_event_type_to_int<br>
 [X] 0248_userprofile_role_start<br>
 [X] 0249_userprofile_role_finish<br>
 [X] 0250_saml_auth</p>



<a name="801451"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801451" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801451">(Dec 10 2019 at 20:21)</a>:</h4>
<p>and no, I have never attempted upgrade to 2.1-rc1 or to master.  I wanted to remain stable....</p>



<a name="801452"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801452" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801452">(Dec 10 2019 at 20:21)</a>:</h4>
<p>is there anything else I can provide?</p>



<a name="801453"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801453" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801453">(Dec 10 2019 at 20:22)</a>:</h4>
<p><span class="user-mention" data-user-id="10349">@Mateusz Mandera</span> please take a look if you need something more, just let me know.</p>



<a name="801455"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801455" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801455">(Dec 10 2019 at 20:23)</a>:</h4>
<p><span class="user-mention" data-user-id="14099">@Mal</span> you've definitely upgraded to master at some point, based on that list of migrations; the last migration in 2.0.6 was 0208.</p>



<a name="801460"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801460" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801460">(Dec 10 2019 at 20:28)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="7">@Tim Abbott</span> thank you. In this case it was completely unintentional. I only remember using with specifically the 2.0.5 and then 2.0.7 tags. Not sure what I should now do...</p>



<a name="801464"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801464" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801464">(Dec 10 2019 at 20:38)</a>:</h4>
<p>I think it may be necessary to just upgrade to 2.1-rc1 or current master at this point. The migrations are already applied.</p>



<a name="801465"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801465" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801465">(Dec 10 2019 at 20:43)</a>:</h4>
<p>ok, is rc1 stable enough for a small team?</p>



<a name="801467"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801467" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801467">(Dec 10 2019 at 20:53)</a>:</h4>
<p>It should be fine, and then you can do a quick upgrade to 2.1 once the release is out. You should read through the Upgrade notes in <a href="https://zulip.readthedocs.io/en/latest/overview/changelog.html#rc1-2019-11-22" target="_blank" title="https://zulip.readthedocs.io/en/latest/overview/changelog.html#rc1-2019-11-22">https://zulip.readthedocs.io/en/latest/overview/changelog.html#rc1-2019-11-22</a> though some of what's mentioned should already be in what you're running already (judging form the migrations). In particular,</p>
<blockquote>
<p>This release has a particularly expensive database migration, changing the <a href="http://UserMessage.id" target="_blank" title="http://UserMessage.id">UserMessage.id</a> field from an int to a bigint</p>
</blockquote>
<p>is already applied on your current server, so you don't need to worry about it.</p>



<a name="801481"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801481" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801481">(Dec 10 2019 at 21:21)</a>:</h4>
<p>Great. Many thanks. Will try it</p>



<a name="801510"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801510" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801510">(Dec 10 2019 at 22:36)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> <span class="user-mention" data-user-id="10349">@Mateusz Mandera</span> unfortunately same error</p>



<a name="801511"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801511" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801511">(Dec 10 2019 at 22:36)</a>:</h4>
<p>I ran: /home/zulip/deployments/current/scripts/upgrade-zulip-from-git 2.1.0-rc1</p>



<a name="801513"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801513" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801513">(Dec 10 2019 at 22:36)</a>:</h4>
<p>Then get this:</p>



<a name="801514"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801514" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801514">(Dec 10 2019 at 22:37)</a>:</h4>
<p>generate_secrets: No new secrets to generate.<br>
2019-12-10 22:32:58,503 upgrade-zulip-stage-2: Building static assets...<br>
Cached version not found! Installing node modules.<br>
+ /srv/zulip-yarn/bin/yarn install --non-interactive --frozen-lockfile --prod</p>
<p>Error running a subcommand of ./tools/update-prod-static: /srv/zulip-yarn/bin/yarn install --non-interactive --frozen-lockfile --prod<br>
Actual error output for the subcommand is just above this.</p>
<p>Traceback (most recent call last):<br>
  File "./tools/update-prod-static", line 37, in &lt;module&gt;<br>
    setup_node_modules(production=True, stdout=fp, stderr=fp)<br>
  File "./tools/../scripts/lib/node_cache.py", line 66, in setup_node_modules<br>
    stderr=stderr)<br>
  File "./tools/../scripts/lib/node_cache.py", line 91, in do_yarn_install<br>
    cwd=target_path, stdout=stdout, stderr=stderr)<br>
  File "./tools/../scripts/lib/zulip_tools.py", line 200, in run<br>
    subprocess.check_call(args, **kwargs)<br>
  File "/usr/lib/python3.6/subprocess.py", line 311, in check_call<br>
    raise CalledProcessError(retcode, cmd)<br>
subprocess.CalledProcessError: Command '['/srv/zulip-yarn/bin/yarn', 'install', '--non-interactive', '--frozen-lockfile', '--prod']' returned non-zero exit status 1.<br>
Traceback (most recent call last):<br>
  File "/home/zulip/deployments/2019-12-10-22-29-36/scripts/lib/upgrade-zulip-stage-2", line 122, in &lt;module&gt;<br>
    preexec_fn=su_to_zulip)<br>
  File "/usr/lib/python3.6/subprocess.py", line 311, in check_call<br>
    raise CalledProcessError(retcode, cmd)<br>
subprocess.CalledProcessError: Command '['./tools/update-prod-static', '--authors-not-required', '--prev-deploy', '/home/zulip/deployments/current']' returned non-zero exit status 1.<br>
Traceback (most recent call last):<br>
  File "/home/zulip/deployments/current/scripts/lib/upgrade-zulip-from-git", line 69, in &lt;module&gt;<br>
    deploy_path, "--from-git"] + deploy_options)<br>
  File "/usr/lib/python3.6/subprocess.py", line 311, in check_call<br>
    raise CalledProcessError(retcode, cmd)<br>
subprocess.CalledProcessError: Command '['/home/zulip/deployments/2019-12-10-22-29-36/scripts/lib/upgrade-zulip-stage-2', '/home/zulip/deployments/2019-12-10-22-29-36', '--from-git']' returned non-zero exit status 1.</p>



<a name="801517"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801517" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801517">(Dec 10 2019 at 22:39)</a>:</h4>
<p>Rolling back now with this:</p>



<a name="801518"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801518" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801518">(Dec 10 2019 at 22:39)</a>:</h4>
<p>/home/zulip/deployments/2019-10-11-21-04-51/scripts/restart-server</p>



<a name="801519"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801519" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801519">(Dec 10 2019 at 22:39)</a>:</h4>
<p>That looks like a different error.</p>



<a name="801520"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801520" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801520">(Dec 10 2019 at 22:39)</a>:</h4>
<p>Otherwise I will have irate users..</p>



<a name="801521"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801521" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801521">(Dec 10 2019 at 22:39)</a>:</h4>
<p>oh, sorry.  Indeed.  It does</p>



<a name="801522"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801522" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801522">(Dec 10 2019 at 22:39)</a>:</h4>
<p>that was the direct output of the upgrade.</p>



<a name="801523"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801523" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801523">(Dec 10 2019 at 22:40)</a>:</h4>
<p>should I open separate github issue?</p>



<a name="801524"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801524" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801524">(Dec 10 2019 at 22:40)</a>:</h4>
<p>Not sure right now, but this could be the error that tends to happen if you don't have enough RAM during the upgrade <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span> In those cases it's recommended to try the upgrade after shutting down the server first.</p>



<a name="801525"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801525" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801525">(Dec 10 2019 at 22:41)</a>:</h4>
<p><code>supervisorctl stop all</code> and then upgrade</p>



<a name="801526"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801526" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801526">(Dec 10 2019 at 22:41)</a>:</h4>
<p>Yes, I did do supervisorctl stop all first</p>



<a name="801528"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801528" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801528">(Dec 10 2019 at 22:41)</a>:</h4>
<p>I always do that</p>



<a name="801529"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801529" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801529">(Dec 10 2019 at 22:41)</a>:</h4>
<p>How much memory does your server have?</p>



<a name="801531"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801531" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801531">(Dec 10 2019 at 22:41)</a>:</h4>
<p>as I only have 4GB ram.  I can temporarily allocate more and try</p>



<a name="801532"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801532" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801532">(Dec 10 2019 at 22:42)</a>:</h4>
<p>ill try that not</p>



<a name="801533"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801533" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801533">(Dec 10 2019 at 22:42)</a>:</h4>
<p>now</p>



<a name="801534"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801534" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801534">(Dec 10 2019 at 22:45)</a>:</h4>
<p>actually it has 5.5GB</p>



<a name="801535"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801535" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801535">(Dec 10 2019 at 22:45)</a>:</h4>
<p>I will make it more just for an upgrade</p>



<a name="801536"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801536" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801536">(Dec 10 2019 at 22:45)</a>:</h4>
<p>and see what happens</p>



<a name="801540"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801540" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801540">(Dec 10 2019 at 22:50)</a>:</h4>
<p>Upgrade to 4 vCPUs, 12 GB memory.  Running upgrade script again now.</p>



<a name="801543"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801543" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801543">(Dec 10 2019 at 22:56)</a>:</h4>
<p>Wow, it worked!  Thanks for the help <span class="user-mention" data-user-id="10349">@Mateusz Mandera</span> - it was the memory.  But I am surprised it didn't work with 5.5GB!  I think you should update your minimum requirements.</p>



<a name="801546"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801546" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801546">(Dec 10 2019 at 22:59)</a>:</h4>
<p>Ok, great! But yeah, that's a surprising amount. <span class="user-mention" data-user-id="7">@Tim Abbott</span> Should the upgrade really be needing that much memory? I think it's usually webpack that causes this, right?</p>



<a name="801552"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801552" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801552">(Dec 10 2019 at 23:12)</a>:</h4>
<p>Ah, webpack crashes have their own error, for some reason I thought otherwise.</p>



<a name="801576"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801576" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801576">(Dec 10 2019 at 23:51)</a>:</h4>
<p>Well, the question is how much free memory the system had at the time of the upgrade.  I'd expect 5.5GB on the system to be plenty, but it's hard to know without info on what else might have been running, etc.</p>



<a name="801579"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801579" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801579">(Dec 10 2019 at 23:54)</a>:</h4>
<p>He did say "It is a stock standard Ubuntu 18.04 on Google Cloud virtual machine (with all latest updates applied, right before this upgrade, maybe that has something to do with it? And, Zulip is the only thing on this server, nothing else at all)", so it sounds like it should have worked fine <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="801584"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801584" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801584">(Dec 11 2019 at 00:13)</a>:</h4>
<p>Indeed. Zulip was the only thing running. It's a dedicated server for Zulip only.</p>



<a name="801585"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801585" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801585">(Dec 11 2019 at 00:13)</a>:</h4>
<p>Nothing else installed</p>



<a name="801589"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801589" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801589">(Dec 11 2019 at 00:36)</a>:</h4>
<p><span class="user-mention" data-user-id="14099">@Mal</span> when your Zulip server is idle, how much RAM is free?</p>



<a name="801676"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Cannot%20Upgrade%20to%202.0.7%20on%20Ubuntu%2018.04/near/801676" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mal Page <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Cannot.20Upgrade.20to.202.2E0.2E7.20on.20Ubuntu.2018.2E04.html#801676">(Dec 11 2019 at 09:52)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> output of command "free -h" shows available RAM to be 1.5GB of 5.6GB</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>