<html>
<head><meta charset="utf-8"><title>[Django] &quot;hostname&quot;: Zulip server auth failure · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html">[Django] &quot;hostname&quot;: Zulip server auth failure</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="685793"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/685793" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bruce Lewin <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#685793">(Jan 23 2019 at 06:57)</a>:</h4>
<p>Does anyone know how I can fix this error? I had it when running 1.9.0 and today I upgraded to 1.9.1 and the error persists...</p>
<div class="codehilite"><pre><span></span>[Django] &quot;hostname&quot;: Zulip server auth failure: a12096b7-&quot;etc.&quot; is not registered

Logger root, from module zerver.worker.queue_processors line 151:
Error generated by Anonymous user (not logged in) on &quot;hostame&quot; deployment

Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2019-01-23-08-42-12/zerver/worker/queue_processors.py&quot;, line 134, in consume_wrapper
    self.consume(data)
  File &quot;/home/zulip/deployments/2019-01-23-08-42-12/zerver/worker/queue_processors.py&quot;, line 367, in consume
    handle_push_notification(data[&#39;user_profile_id&#39;], data)
  File &quot;/home/zulip/deployments/2019-01-23-08-42-12/zerver/decorator.py&quot;, line 741, in wrapped_func
    ret = func(*args, **kwargs)
  File &quot;/home/zulip/deployments/2019-01-23-08-42-12/zerver/lib/push_notifications.py&quot;, line 678, in handle_push_notification
    gcm_payload)
  File &quot;/home/zulip/deployments/2019-01-23-08-42-12/zerver/lib/push_notifications.py&quot;, line 265, in send_notifications_to_bouncer
    send_json_to_push_bouncer(&#39;POST&#39;, &#39;notify&#39;, post_data)
  File &quot;/home/zulip/deployments/2019-01-23-08-42-12/zerver/lib/push_notifications.py&quot;, line 272, in send_json_to_push_bouncer
    extra_headers={&quot;Content-type&quot;: &quot;application/json&quot;},
  File &quot;/home/zulip/deployments/2019-01-23-08-42-12/zerver/lib/push_notifications.py&quot;, line 333, in send_to_push_bouncer
    raise JsonableError(msg)
zerver.lib.exceptions.JsonableError: Zulip server auth failure: a12096b7-cde5-4942-beb0-5ddbb4dc372a is not registered


Deployed code:
- ZULIP_VERSION: 1.9.1
- version: 1.9.1
</pre></div>



<a name="685796"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/685796" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#685796">(Jan 23 2019 at 07:00)</a>:</h4>
<p><span class="user-mention" data-user-id="133">@Bruce Lewin</span> I believe this is what happens if you lost your Zulip secrets during the upgrade.</p>



<a name="685797"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/685797" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#685797">(Jan 23 2019 at 07:01)</a>:</h4>
<p>That will cause other problems (e.g. logging out all users), so you probably just want to fix that rather than re-registering for mobile push notifications.</p>



<a name="685798"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/685798" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bruce Lewin <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#685798">(Jan 23 2019 at 07:03)</a>:</h4>
<p>Hmmm... any way I can regenerate or fix?</p>



<a name="685808"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/685808" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bruce Lewin <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#685808">(Jan 23 2019 at 07:22)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> I wonder if this came about due to a bug in the exporting organisations feature as that was when the problem emerged...</p>



<a name="686072"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/686072" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#686072">(Jan 23 2019 at 17:54)</a>:</h4>
<p><span class="user-mention" data-user-id="133">@Bruce Lewin</span> can you explain exactly what you did?  Did you use the data export tool as part of your upgrade process?</p>



<a name="686772"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/686772" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bruce Lewin <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#686772">(Jan 24 2019 at 03:57)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Hi Tim, yeah, I just did the export-import stuff as per the <a href="https://zulip.readthedocs.io/en/latest/production/export-and-import.html#export-your-zulip-data" target="_blank" title="https://zulip.readthedocs.io/en/latest/production/export-and-import.html#export-your-zulip-data">docs</a> everything else works fine...</p>



<a name="686963"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/686963" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#686963">(Jan 24 2019 at 18:02)</a>:</h4>
<p><span class="user-mention" data-user-id="133">@Bruce Lewin</span> yeah, so generally you want to also copy the contents of <code>/etc/zulip/</code> when you migrate hardware that way.</p>



<a name="686964"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/686964" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#686964">(Jan 24 2019 at 18:02)</a>:</h4>
<p>And the fact that you didn't do so is why you're having this problem.</p>



<a name="687646"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/687646" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bruce Lewin <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#687646">(Jan 24 2019 at 18:58)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span> hmmm... is there anything else I can do to remedy this? can I ignore this error? is there a solution?</p>



<a name="687713"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/687713" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#687713">(Jan 24 2019 at 19:12)</a>:</h4>
<p><span class="user-mention" data-user-id="133">@Bruce Lewin</span> well, if you don't have the /etc/zulip/ stuff from your old server, you can just re-register your server for push notifications with its new ID.</p>



<a name="687714"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/687714" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#687714">(Jan 24 2019 at 19:12)</a>:</h4>
<p><a href="https://zulip.readthedocs.io/en/latest/production/mobile-push-notifications.html" target="_blank" title="https://zulip.readthedocs.io/en/latest/production/mobile-push-notifications.html">https://zulip.readthedocs.io/en/latest/production/mobile-push-notifications.html</a></p>



<a name="689061"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/689061" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bruce Lewin <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#689061">(Jan 25 2019 at 05:16)</a>:</h4>
<blockquote>
<p>Well, if you don't have the /etc/zulip/ stuff from your old server, you can just re-register your server for push notifications with its new ID.</p>
</blockquote>
<p>Thanks <span class="user-mention" data-user-id="7">@Tim Abbott</span> I've just done this, I'll let you know if I hit any other snags... <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>



<a name="689063"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/689063" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bruce Lewin <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#689063">(Jan 25 2019 at 05:26)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> btw, I guess you want to add the part in about copying /etc/zulip/secrets.py to the export/import docs?</p>



<a name="689266"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/689266" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#689266">(Jan 25 2019 at 19:33)</a>:</h4>
<p>Yeah, I think so -- though I should note we do advise using the backup / database dump approach over the export/import tool for migrating <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="693623"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%5BDjango%5D%20%22hostname%22%3A%20Zulip%20server%20auth%20failure/near/693623" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.5BDjango.5D.20.22hostname.22.3A.20Zulip.20server.20auth.20failure.html#693623">(Feb 03 2019 at 07:22)</a>:</h4>
<p>I merged <a href="https://github.com/zulip/zulip/commit/001ec76e1f9ec460782dd4db608084dc142cae26" target="_blank" title="https://github.com/zulip/zulip/commit/001ec76e1f9ec460782dd4db608084dc142cae26">001ec76e1f9ec460782dd4db608084dc142cae26</a> for this.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>