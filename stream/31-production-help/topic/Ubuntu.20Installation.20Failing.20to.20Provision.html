<html>
<head><meta charset="utf-8"><title>Ubuntu Installation Failing to Provision · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html">Ubuntu Installation Failing to Provision</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="118665"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/118665" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brock Whittaker <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#118665">(Jan 07 2017 at 08:58)</a>:</h4>
<p>Hey, I've downloaded Ubuntu and ran ./tools/provision.py in the zulip directory and got the following error:</p>
<div class="codehilite"><pre><span></span>yui-compressor is already the newest version (2.4.7-2).
curl is already the newest version (7.47.0-1ubuntu2.2).
libldap2-dev is already the newest version (2.4.42+dfsg-2ubuntu3.1).
libpq-dev is already the newest version (9.5.5-0ubuntu0.16.04).
libxml2-dev is already the newest version (2.9.3+dfsg1-1ubuntu0.1).
memcached is already the newest version (1.4.25-2ubuntu1.2).
postgresql-9.5 is already the newest version (9.5.5-0ubuntu0.16.04).
wget is already the newest version (1.17.1-1ubuntu1.1).
nodejs is already the newest version (4.2.6~dfsg-1ubuntu4.1).
nodejs-legacy is already the newest version (4.2.6~dfsg-1ubuntu4.1).
python-pip is already the newest version (8.1.1-2ubuntu0.4).
python-virtualenv is already the newest version (15.0.1+ds-3ubuntu1).
postgresql-9.5-tsearch-extras is already the newest version (0.2).
0 upgraded, 0 newly installed, 0 to remove and 272 not upgraded.
+ sudo rm -rf /srv/zulip-venv-cache/0cb8dd21b68bbc917138352cbe14971913b6c254/zulip-venv
[&#39;sudo&#39;, &#39;rm&#39;, &#39;-rf&#39;, &#39;/srv/zulip-venv-cache/0cb8dd21b68bbc917138352cbe14971913b6c254/zulip-venv&#39;]
+ sudo mkdir -p /srv/zulip-venv-cache/0cb8dd21b68bbc917138352cbe14971913b6c254/zulip-venv
[&#39;sudo&#39;, &#39;mkdir&#39;, &#39;-p&#39;, &#39;/srv/zulip-venv-cache/0cb8dd21b68bbc917138352cbe14971913b6c254/zulip-venv&#39;]
+ sudo chown 1000:1000 /srv/zulip-venv-cache/0cb8dd21b68bbc917138352cbe14971913b6c254/zulip-venv
[&#39;sudo&#39;, &#39;chown&#39;, &#39;1000:1000&#39;, &#39;/srv/zulip-venv-cache/0cb8dd21b68bbc917138352cbe14971913b6c254/zulip-venv&#39;]
+ virtualenv /srv/zulip-venv-cache/0cb8dd21b68bbc917138352cbe14971913b6c254/zulip-venv
Traceback (most recent call last):
  File &quot;./tools/provision.py&quot;, line 246, in &lt;module&gt;
    sys.exit(main())
  File &quot;./tools/provision.py&quot;, line 184, in main
    setup_venvs.main()
  File &quot;/home/brock/projects/zulip/tools/setup/setup_venvs.py&quot;, line 16, in main
    setup_virtualenv(&quot;/srv/zulip-venv&quot;, PY2_DEV_REQS_FILE, patch_activate_script=True)
  File &quot;/home/brock/projects/zulip/scripts/lib/setup_venv.py&quot;, line 70, in setup_virtualenv
    do_setup_virtualenv(cached_venv_path, requirements_file, virtualenv_args or [])
  File &quot;/home/brock/projects/zulip/scripts/lib/setup_venv.py&quot;, line 89, in do_setup_virtualenv
    run([&quot;virtualenv&quot;] + virtualenv_args + [venv_path])
  File &quot;/home/brock/projects/zulip/scripts/lib/zulip_tools.py&quot;, line 90, in run
    process = subprocess.Popen(args)
  File &quot;/usr/lib/python2.7/subprocess.py&quot;, line 711, in __init__
    errread, errwrite)
  File &quot;/usr/lib/python2.7/subprocess.py&quot;, line 1343, in _execute_child
    raise child_exception
OSError: [Errno 2] No such file or directory
brock@brock:~/projects/zulip$ 
</pre></div>


<p>Any ideas on what could be going wrong here?</p>



<a name="118846"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/118846" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#118846">(Jan 07 2017 at 14:03)</a>:</h4>
<p><span class="user-mention" data-user-email="brock@zulipchat.com">@Brock Whittaker</span> Are you on an old version of master by any chance?</p>



<a name="118940"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/118940" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#118940">(Jan 07 2017 at 18:03)</a>:</h4>
<p><span class="user-mention" data-user-email="brock@zulipchat.com">@Brock Whittaker</span> did you figure this out?</p>



<a name="119290"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119290" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brock Whittaker <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119290">(Jan 08 2017 at 00:36)</a>:</h4>
<p>No success yet, and yeah I'm on the latest master.</p>



<a name="119292"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119292" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119292">(Jan 08 2017 at 00:42)</a>:</h4>
<p><span class="user-mention" data-user-email="brock@zulipchat.com">@Brock Whittaker</span> The reason I ask if you're on master is that the line numbers in the traceback you posted earlier don't seem to match up with the code on master.  Unless I'm just misreading somehow.</p>



<a name="119293"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119293" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brock Whittaker <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119293">(Jan 08 2017 at 00:45)</a>:</h4>
<p>I had thrown in a print statement to print the results of the <code>subprocess.Popen()</code> funcs.</p>



<a name="119294"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119294" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brock Whittaker <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119294">(Jan 08 2017 at 00:46)</a>:</h4>
<p><a href="/user_uploads/2/8d/UoRgn8eh1eMXOdsb6qtAeybt/Screen-Shot-2017-01-07-at-4.45.36-PM.png" target="_blank" title="Screen-Shot-2017-01-07-at-4.45.36-PM.png">Here it is straight from master.</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/8d/UoRgn8eh1eMXOdsb6qtAeybt/Screen-Shot-2017-01-07-at-4.45.36-PM.png" target="_blank" title="Here it is straight from master."><img src="/user_uploads/2/8d/UoRgn8eh1eMXOdsb6qtAeybt/Screen-Shot-2017-01-07-at-4.45.36-PM.png"></a></div>



<a name="119295"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119295" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119295">(Jan 08 2017 at 01:04)</a>:</h4>
<p>I am looking at line 89 of <code>scripts/lib/setup_venv.py</code>in your traceback.</p>
<p>Compare that to here: <a href="https://github.com/zulip/zulip/blob/master/scripts/lib/setup_venv.py#L89" target="_blank" title="https://github.com/zulip/zulip/blob/master/scripts/lib/setup_venv.py#L89">https://github.com/zulip/zulip/blob/master/scripts/lib/setup_venv.py#L89</a></p>



<a name="119296"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119296" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119296">(Jan 08 2017 at 01:05)</a>:</h4>
<div class="codehilite"><pre><span></span>  File &quot;/home/brock/projects/zulip/scripts/lib/setup_venv.py&quot;, line 89, in do_setup_virtualenv
    run([&quot;virtualenv&quot;] + virtualenv_args + [venv_path])
</pre></div>



<a name="119298"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119298" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119298">(Jan 08 2017 at 01:08)</a>:</h4>
<p>I think your version of master may be ancient?  Or something funny is going on.</p>



<a name="119310"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119310" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brock Whittaker <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119310">(Jan 08 2017 at 01:43)</a>:</h4>
<div class="codehilite"><pre><span></span>0 upgraded, 3 newly installed, 0 to remove and 272 not upgraded.
Need to get 1,597 kB of archives.
After this operation, 7,854 kB of additional disk space will be used.
Get:1 http://us.archive.ubuntu.com/ubuntu xenial/universe amd64 libzstd0 amd64 0.5.1-1 [112 kB]
Get:2 http://ppa.launchpad.net/groonga/ppa/ubuntu xenial/main amd64 libgroonga0 amd64 6.1.3-2~xenial1 [1,431 kB]
Get:3 http://ppa.launchpad.net/groonga/ppa/ubuntu xenial/main amd64 postgresql-9.5-pgroonga amd64 1.1.9-2~xenial2 [54.0 kB]                                                                                                    
Fetched 1,597 kB in 9s (165 kB/s)                                                                                                                                                                                              
Selecting previously unselected package libzstd0.
(Reading database ... 187560 files and directories currently installed.)
Preparing to unpack .../libzstd0_0.5.1-1_amd64.deb ...
Unpacking libzstd0 (0.5.1-1) ...
Selecting previously unselected package libgroonga0:amd64.
Preparing to unpack .../libgroonga0_6.1.3-2~xenial1_amd64.deb ...
Unpacking libgroonga0:amd64 (6.1.3-2~xenial1) ...
Selecting previously unselected package postgresql-9.5-pgroonga.
Preparing to unpack .../postgresql-9.5-pgroonga_1.1.9-2~xenial2_amd64.deb ...
Unpacking postgresql-9.5-pgroonga (1.1.9-2~xenial2) ...
Processing triggers for libc-bin (2.23-0ubuntu3) ...
Processing triggers for postgresql-common (173) ...
Building PostgreSQL dictionaries from installed myspell/hunspell packages...
  en_us
Removing obsolete dictionary files:
Setting up libzstd0 (0.5.1-1) ...
Setting up libgroonga0:amd64 (6.1.3-2~xenial1) ...
Setting up postgresql-9.5-pgroonga (1.1.9-2~xenial2) ...
Processing triggers for libc-bin (2.23-0ubuntu3) ...
+ sudo rm -rf /srv/zulip-venv-cache/95248d22260eb86f80ab429290a52191bfa39f58/zulip-venv
+ sudo mkdir -p /srv/zulip-venv-cache/95248d22260eb86f80ab429290a52191bfa39f58/zulip-venv
+ sudo virtualenv /srv/zulip-venv-cache/95248d22260eb86f80ab429290a52191bfa39f58/zulip-venv
sudo: virtualenv: command not found
A command run by ./tools/provision.py failed; see output above.
Command was: sudo virtualenv /srv/zulip-venv-cache/95248d22260eb86f80ab429290a52191bfa39f58/zulip-venv
Traceback (most recent call last):
  File &quot;./tools/provision.py&quot;, line 285, in &lt;module&gt;
    sys.exit(main(options))
  File &quot;./tools/provision.py&quot;, line 181, in main
    setup_venvs.main()
  File &quot;/home/brock/projects/zulip/tools/setup/setup_venvs.py&quot;, line 16, in main
    setup_virtualenv(&quot;/srv/zulip-venv&quot;, PY2_DEV_REQS_FILE, patch_activate_script=True)
  File &quot;/home/brock/projects/zulip/scripts/lib/setup_venv.py&quot;, line 211, in setup_virtualenv
    do_setup_virtualenv(cached_venv_path, requirements_file, virtualenv_args or [])
  File &quot;/home/brock/projects/zulip/scripts/lib/setup_venv.py&quot;, line 233, in do_setup_virtualenv
    run([&quot;sudo&quot;, &quot;virtualenv&quot;] + virtualenv_args + [venv_path])
  File &quot;/home/brock/projects/zulip/scripts/lib/zulip_tools.py&quot;, line 96, in run
    subprocess.check_call(args, **kwargs)
  File &quot;/usr/lib/python2.7/subprocess.py&quot;, line 541, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command &#39;[&#39;sudo&#39;, &#39;virtualenv&#39;, &#39;/srv/zulip-venv-cache/95248d22260eb86f80ab429290a52191bfa39f58/zulip-venv&#39;]&#39; returned non-zero exit status 1
</pre></div>


<p>Different error on re-provision. Not totally sure though I cloned zulip/zulip.</p>



<a name="119313"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119313" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119313">(Jan 08 2017 at 01:57)</a>:</h4>
<p>So this is the command that fails:</p>
<div class="codehilite"><pre><span></span> sudo virtualenv /srv/zulip-venv-cache/95248d22260eb86f80ab429290a52191bfa39f58/zulip-venv
</pre></div>


<p>And apparently you don't have <code>virtualenv</code> in your VM.</p>



<a name="119314"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119314" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119314">(Jan 08 2017 at 02:01)</a>:</h4>
<p>In my VM it lives here:</p>
<div class="codehilite"><pre><span></span>(zulip-venv)vagrant@vagrant-base-trusty-amd64:/srv/zulip$ which virtualenv
/usr/bin/virtualenv
</pre></div>



<a name="119315"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119315" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119315">(Jan 08 2017 at 02:02)</a>:</h4>
<p>Can you see if you have <code>virtualenv</code> there?  Also, can you you run <code>./tools/diagnose</code> just in case it reveals anything interesting?</p>



<a name="119316"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119316" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119316">(Jan 08 2017 at 02:03)</a>:</h4>
<p>Also, here is my path; you may want to compare yours to mine:</p>
<div class="codehilite"><pre><span></span>(zulip-venv)vagrant@vagrant-base-trusty-amd64:/srv/zulip$ echo $PATH
/srv/zulip-venv/bin:/usr/local/nvm/versions/node/v6.6.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
</pre></div>



<a name="119317"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119317" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brock Whittaker <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119317">(Jan 08 2017 at 02:04)</a>:</h4>
<p>I ran <code>sudo apt-get install virtualenv</code> and it seems to work.</p>



<a name="119318"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119318" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119318">(Jan 08 2017 at 02:05)</a>:</h4>
<p>Interesting.  I wonder why it apparently failed silently during provision.  (I'm not sure exactly how provision install virtualenv off the top of my head.)</p>



<a name="119319"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119319" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brock Whittaker <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119319">(Jan 08 2017 at 02:05)</a>:</h4>
<p>Thanks for the help getting it up though. :) </p>



<a name="119320"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Ubuntu%20Installation%20Failing%20to%20Provision/near/119320" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Ubuntu.20Installation.20Failing.20to.20Provision.html#119320">(Jan 08 2017 at 02:06)</a>:</h4>
<p>no prob :)</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>