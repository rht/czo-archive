<html>
<head><meta charset="utf-8"><title>build tarball · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html">build tarball</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="631772"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/631772" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#631772">(Aug 15 2018 at 17:12)</a>:</h4>
<p>Could please someone help to point the right direction on how to create a tarball? <br>
We have these instruction, but I am not sure how to move (actually concerned about destroying what has been hardly  built):</p>
<p>"You also have the option of creating your own release tarballs from a copy of the zulip.git repository using tools/build-release-tarball or upgrade Zulip to a version in a Git repository directly."<br>
Thank you.</p>



<a name="631811"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/631811" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#631811">(Aug 15 2018 at 17:33)</a>:</h4>
<p><span class="user-mention" data-user-id="8205">@6lauber oak</span> can you explain more where you're stuck?</p>



<a name="631813"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/631813" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#631813">(Aug 15 2018 at 17:47)</a>:</h4>
<p>Well, I can explain in plain English, because code wise, my progress goes very slowly. If I make a few changes to the code, mostly adding org name and the such, I need to create a zipped file from my forked Zulip, right? So.. I am stuck there, because I am not sure where I need to run and what commands to run from my git connection. Sorry, so basic... but it is what it is.</p>



<a name="631814"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/631814" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#631814">(Aug 15 2018 at 17:50)</a>:</h4>
<p>It looks like it is a 1 line command from the docs... Does not sound right....</p>



<a name="632049"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/632049" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#632049">(Aug 15 2018 at 21:41)</a>:</h4>
<p>The closest I can get is this:<br>
zulip/tools/build-release-tarball<br>
(<a href="https://github.com/zulip/zulip/blob/fa0fb9e299f149f838e559676cc1a4a20ba33a82/tools/build-release-tarball" target="_blank" title="https://github.com/zulip/zulip/blob/fa0fb9e299f149f838e559676cc1a4a20ba33a82/tools/build-release-tarball">https://github.com/zulip/zulip/blob/fa0fb9e299f149f838e559676cc1a4a20ba33a82/tools/build-release-tarball</a>)</p>



<a name="633089"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/633089" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#633089">(Aug 16 2018 at 21:46)</a>:</h4>
<p><span class="user-mention" data-user-id="8205">@6lauber oak</span> yeah, you should run that command, and then copy the tarball and install it like you would a Zulip upgrade release (with <code>scripts/upgrade-zulip</code>)</p>



<a name="634388"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/634388" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#634388">(Aug 18 2018 at 14:47)</a>:</h4>
<p>Thank you. <span class="user-mention" data-user-id="7">@Tim Abbott</span> .  Do you refer to this section (<a href="https://zulip.readthedocs.io/en/1.8.1/production/maintain-secure-upgrade.html?highlight=%20scripts%2Fupgrade-zulip#upgrading" target="_blank" title="https://zulip.readthedocs.io/en/1.8.1/production/maintain-secure-upgrade.html?highlight=%20scripts%2Fupgrade-zulip#upgrading">https://zulip.readthedocs.io/en/1.8.1/production/maintain-secure-upgrade.html?highlight=%20scripts%2Fupgrade-zulip#upgrading</a>)? <br>
Second, when I run the build-release-tarball, I get this: Usage: tools/build-release-tarball &lt;ZULIP_VERSION&gt; [--authors-not-required]<br>
Is that right?<br>
As always, thank you so much for your help.</p>



<a name="634390"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/634390" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#634390">(Aug 18 2018 at 15:03)</a>:</h4>
<p>yes you need to provide a name for your tarball (e.g. <code>test1</code> or whatever you want to call it is fine)</p>



<a name="638598"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/638598" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#638598">(Aug 25 2018 at 05:03)</a>:</h4>
<p>Ok, the testing changes (CSS)  were committed and I get this message: "tarballs builds are based on a commit hash so your changes will not be included; you should commit or stash them based on what you want and then try again." I am missing some silly thing, but I have tried to find this silly thing for a long time. I have tried before and after vagrant up. Any suggestion?</p>



<a name="638812"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/638812" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#638812">(Aug 27 2018 at 05:38)</a>:</h4>
<p><span class="user-mention" data-user-id="8205">@6lauber oak</span> it sounds like you didn't actually do a git commit properly.  Run <code>git status</code> and you'll see what's not committed.</p>



<a name="639120"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639120" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639120">(Aug 27 2018 at 20:12)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> I really appreciate your patience! <br>
I gave <code>git pull --rebase</code> and then status and it says <br>
<code>$ git status
On branch master
Your branch is up to date with origin/master</code></p>
<p>But now  I get this: </p>
<div class="codehilite"><pre><span></span>$ tools/build-release-tarball version1.0
++ git rev-parse HEAD
+ GITID=e56672909f7c4bf74485458938e933a34d4378e0
+ git diff --exit-code
++ mktemp -d
+ TMPDIR=/tmp/tmp.Fu9maTUxDZ
+ TARBALL=/tmp/tmp.Fu9maTUxDZ/zulip-server-version1.0.tar
++ pwd
+ BASEDIR=/c/Users/GRM/zulip
+ git archive -o /tmp/tmp.Fu9maTUxDZ/zulip-server-version1.0.tar --prefix=zulip-server-version1.0/ HEAD
+ cd /tmp/tmp.Fu9maTUxDZ
+ tar -xf /tmp/tmp.Fu9maTUxDZ/zulip-server-version1.0.tar
tar: zulip-server-version1.0/static/node_modules: Cannot create symlink to ‘../node_modules/’: No such file or directory
tar: Exiting with failure status due to previous errors
</pre></div>



<a name="639122"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639122" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639122">(Aug 27 2018 at 20:13)</a>:</h4>
<p>What OS are you using as the host?</p>



<a name="639123"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639123" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639123">(Aug 27 2018 at 20:13)</a>:</h4>
<p>It kinda sounds like you have a problem with creating symlinks, which can happen if you're on Windows and not running Vagrant as an administrator user.</p>



<a name="639124"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639124" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639124">(Aug 27 2018 at 20:14)</a>:</h4>
<p>Window 10 and 7, different computers, getting into the same problem.</p>



<a name="639130"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639130" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639130">(Aug 27 2018 at 20:16)</a>:</h4>
<p>I am running git as admin</p>



<a name="639132"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639132" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639132">(Aug 27 2018 at 20:17)</a>:</h4>
<p>Are you running <code>vagrant</code> as admin as well?</p>



<a name="639135"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639135" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639135">(Aug 27 2018 at 20:20)</a>:</h4>
<p>Not sure how to do it. I run git as admin and then just <code>cd zulip</code>and  <code>vagrant up</code> <br>
If I test the links, I get true. <br>
$ git config core.symlinks<br>
true</p>



<a name="639139"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639139" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639139">(Aug 27 2018 at 20:22)</a>:</h4>
<p>OK, hmm.</p>



<a name="639143"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639143" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639143">(Aug 27 2018 at 20:23)</a>:</h4>
<p>Well, I've never seen that exception before, but we also don't have many developers who work daily on Windows, and <code>build-release-tarball</code> isn't something every developer uses, so it's likely this is a Vagrant+Windows compatibility issue.</p>



<a name="639145"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639145" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639145">(Aug 27 2018 at 20:23)</a>:</h4>
<p>(And clearly has something to do with symlinks)</p>



<a name="639147"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639147" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639147">(Aug 27 2018 at 20:24)</a>:</h4>
<p>I guess my best recommendation for a workaround would be to switch to running the Zulip-development-environment-on-Linux process inside a full Ubuntu Linux VM (i.e. not using Vagrant).</p>



<a name="639148"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639148" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639148">(Aug 27 2018 at 20:24)</a>:</h4>
<p>Ok. I have create the develp environment a few times, maybe 3 or 4. I always get to the same problem.</p>



<a name="639149"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639149" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639149">(Aug 27 2018 at 20:24)</a>:</h4>
<p>(I don't use Windows, so it's not super easy for me to debug)</p>



<a name="639150"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/build%20tarball/near/639150" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> 6lauber oak <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/build.20tarball.html#639150">(Aug 27 2018 at 20:25)</a>:</h4>
<p>No problem, thanks anway. You have been a great help!</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>