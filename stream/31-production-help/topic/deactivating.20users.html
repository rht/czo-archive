<html>
<head><meta charset="utf-8"><title>deactivating users · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html">deactivating users</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="248400"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248400" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248400">(Jul 12 2017 at 17:33)</a>:</h4>
<p>Like deleting a user in zulip. I do not want to disable it, since I have problems with its user, I need to delete it. Any method?? <span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span></p>



<a name="248403"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248403" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248403">(Jul 12 2017 at 17:34)</a>:</h4>
<p><span class="user-mention" data-user-email="bootfine@gmail.com" data-user-id="2759">@Manuel</span> I set a topic for your message so it gets sorted separately from other conversations.</p>



<a name="248407"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248407" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248407">(Jul 12 2017 at 17:34)</a>:</h4>
<p>You can deactivate a user in the Zulip admin UI.  In what way does that not solve your problem?</p>



<a name="248424"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248424" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248424">(Jul 12 2017 at 17:41)</a>:</h4>
<p>For some reason this user has problems connecting. I've disabled and enabled it, but apparently it's a problem with your account. I want to delete the account so I can login again without problems</p>



<a name="248426"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248426" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248426">(Jul 12 2017 at 17:41)</a>:</h4>
<p>For some reason this user has problems connecting. I've disabled and enabled it, but apparently it's a problem with your account. I want to delete the account so I can login again without problems</p>



<a name="248427"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248427" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248427">(Jul 12 2017 at 17:42)</a>:</h4>
<p><span class="user-mention" data-user-email="bootfine@gmail.com" data-user-id="2759">@Manuel</span> you can edit the topics of your messages after sending to the wrong place :)</p>



<a name="248429"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248429" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248429">(Jul 12 2017 at 17:42)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span>  thank</p>



<a name="248431"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248431" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248431">(Jul 12 2017 at 17:42)</a>:</h4>
<p>I don't understand what you're saying.  Did you mean "so the user can login without problems"?  Or is this user account preventing other users from logging in?</p>



<a name="248432"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248432" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248432">(Jul 12 2017 at 17:43)</a>:</h4>
<p>I also have never heard of a "problem with a Zulip account" preventing login, and would be very surprised if deleting and recreating the account helped, so I suspect that there is something else going on here that's the root cause of the problem...</p>



<a name="248437"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248437" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248437">(Jul 12 2017 at 17:52)</a>:</h4>
<p>He drops the page. How can I see the error that happens to the user? Only he happens to others not.</p>



<a name="248438"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248438" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248438">(Jul 12 2017 at 17:57)</a>:</h4>
<p>Unfortunately Zulip does not have a user management console that allows deleting the account, emails, comments, etc.</p>



<a name="248444"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248444" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248444">(Jul 12 2017 at 18:02)</a>:</h4>
<p>Have you had the user send you a screenshot?  Have you asked how they are authenticating?</p>



<a name="248455"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248455" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248455">(Jul 12 2017 at 18:09)</a>:</h4>
<p>This is error:</p>
<p>msg "El uso de la API excedió el límite"<br>
retry-after 5618.2348189354<br>
result  "error"</p>



<a name="248459"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248459" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248459">(Jul 12 2017 at 18:11)</a>:</h4>
<blockquote>
<p>This is error:</p>
<p>msg "El uso de la API excedió el límite"<br>
retry-after 5618.2348189354<br>
result  "error"</p>
</blockquote>



<a name="248461"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248461" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248461">(Jul 12 2017 at 18:12)</a>:</h4>
<blockquote>
<blockquote>
<p>This is error:</p>
<p>msg "El uso de la API excedió el límite"<br>
retry-after 5618.2348189354<br>
result  "error"</p>
</blockquote>
</blockquote>
<p><a href="/user_uploads/2/1b/rnW0DPiMQdH0pZX-tbxc0BXf/Error_Login_usuario.pdf" target="_blank" title="Error_Login_usuario.pdf">Error_Login_usuario.pdf</a></p>



<a name="248462"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248462" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248462">(Jul 12 2017 at 18:12)</a>:</h4>
<p>Are they trying to use the API?   We rate-limit how often a user connects to the server, so that you can prevent denial-of-service attacks.</p>



<a name="248465"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248465" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248465">(Jul 12 2017 at 18:13)</a>:</h4>
<blockquote>
<p>Are they trying to use the API?   We rate-limit how often a user connects to the server, so that you can prevent denial-of-service attacks.</p>
</blockquote>
<p>No, the error appeared, which I do know is that it takes several connection attempts</p>



<a name="248475"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248475" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248475">(Jul 12 2017 at 18:16)</a>:</h4>
<p>Are you able to sit next to the user while they try to log in, or are they remote?</p>



<a name="248477"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248477" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248477">(Jul 12 2017 at 18:17)</a>:</h4>
<p>And how can I help the user to connect?, I thought deleting the account could start again</p>



<a name="248480"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248480" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248480">(Jul 12 2017 at 18:18)</a>:</h4>
<p>The user gave me their credentials, and I'm testing myself on my computer, and it happens exactly the same to me.</p>



<a name="248482"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248482" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248482">(Jul 12 2017 at 18:18)</a>:</h4>
<p>If you can sit next to the user, you can have them open up the browser console to get insight into what's happening.</p>



<a name="248495"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248495" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248495">(Jul 12 2017 at 18:25)</a>:</h4>
<p>Look, perform the following test:<br>
From mozilla and chrome I try to connect to the credential of the affected user, and I get the error mentioned. I tried with another test credential and I did not have any problems of entrance, nor I had problems of entrance with the credential of administrator.</p>



<a name="248501"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248501" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248501">(Jul 12 2017 at 18:28)</a>:</h4>
<p>It's possible that this user's credentials are triggering some obscure bug with out rate limiting code.</p>
<p>I think it's far more likely that there's some runaway script somewhere that's hitting your server with the user's credentials.</p>
<p>A good troubleshooting step, if it's practical for you, is to restart the server.</p>



<a name="248502"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248502" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248502">(Jul 12 2017 at 18:31)</a>:</h4>
<p>There's a management command related to rate limiting that I'm looking at now.</p>



<a name="248503"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248503" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248503">(Jul 12 2017 at 18:32)</a>:</h4>
<p>You might want to try <code>./manage.py rate_limit --email &lt;email&gt; unblock</code>.</p>



<a name="248511"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248511" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248511">(Jul 12 2017 at 18:54)</a>:</h4>
<p>Do you share the editing path to get to the file?</p>



<a name="248514"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248514" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248514">(Jul 12 2017 at 18:55)</a>:</h4>
<p>Run it from your "root" directory.  Have you used Django-based management commands before?</p>



<a name="248521"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248521" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248521">(Jul 12 2017 at 18:56)</a>:</h4>
<blockquote>
<p>Run it from your "root" directory.  Have you used Django-based management commands before?</p>
</blockquote>
<p>No, but I learn fast xD</p>



<a name="248545"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248545" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248545">(Jul 12 2017 at 19:07)</a>:</h4>
<blockquote>
<p>It's possible that this user's credentials are triggering some obscure bug with out rate limiting code.</p>
<p>I think it's far more likely that there's some runaway script somewhere that's hitting your server with the user's credentials.</p>
<p>A good troubleshooting step, if it's practical for you, is to restart the server.</p>
</blockquote>
<p><em>Restart the server, and follow the same user with the same problem</em></p>



<a name="248546"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248546" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248546">(Jul 12 2017 at 19:08)</a>:</h4>
<p>Thanks for trying to restart the server.</p>



<a name="248549"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248549" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248549">(Jul 12 2017 at 19:10)</a>:</h4>
<p>Django management commands are a Django concept where Zulip basically does very normal Django things.  You can run <code>./manage.py help</code> from the root of your installation to see all the management commands that are supported.</p>



<a name="248590"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248590" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248590">(Jul 12 2017 at 19:49)</a>:</h4>
<p>But what I do not understand is that there is no zulip method of eliminating users to correct these problems, do you know one?</p>



<a name="248599"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248599" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248599">(Jul 12 2017 at 19:59)</a>:</h4>
<p>We don't have an admin-friendly way to delete users, because in 99.999% of cases, it's sufficient to deactivate the user.   The thing that is new and unique about your situation is that it seems you have a user whose email has been black-listed in our redis rate limiting system.  I proposed one way to fix that, which is to run the management command.  If that doesn't work, we probably need to figure out a way to clear redis by hand.  Deleting the user from the postgres database won't help if the problem is in redis.</p>
<p>Sorry we're not more helpful here.  If this problem had come up with other admins, we would have solutions ready for you.  But this is the first time we're hearing of it.</p>



<a name="248600"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248600" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248600">(Jul 12 2017 at 20:02)</a>:</h4>
<p>I understand and appreciate the support for everything else, can you explain a little more about how to apply the indicated command?</p>



<a name="248611"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248611" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248611">(Jul 12 2017 at 20:09)</a>:</h4>
<p>You should be able  to log on to your production box and find the "root" directory for zulip. Let me see if I can find what that is.  (It's <code>/srv/zulip</code> on dev.)</p>



<a name="248612"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248612" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248612">(Jul 12 2017 at 20:09)</a>:</h4>
<p>And then run <code>./manage.py help</code>.</p>



<a name="248614"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248614" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248614">(Jul 12 2017 at 20:11)</a>:</h4>
<p><a href="http://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html?highlight=management%20commands#management-commands" target="_blank" title="http://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html?highlight=management%20commands#management-commands">http://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html?highlight=management%20commands#management-commands</a></p>



<a name="248665"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/248665" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#248665">(Jul 12 2017 at 20:36)</a>:</h4>
<p><span class="user-mention" data-user-email="bootfine@gmail.com" data-user-id="2759">@Manuel</span> the reason we don't allow deleting users from the database is that deleting a user from the database will basically break the experience for other users.  E.g. if that user had sent a message, the database has to delete that message as well, since there's no longer a user object to refer to as the sender.  So in a tool like Zulip where you can see things other users did in the past, usually "delete" actually means "deactivate".</p>



<a name="251878"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/251878" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#251878">(Jul 17 2017 at 16:04)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> , <span class="user-mention" data-user-email="showell@zulipchat.com" data-user-id="58">@Steve Howell</span> <br>
I already understood the problem. The topic goes through the NTP update. When done on the server, despite restarting ZULIP services, the accounts are blocked. A cleanup of all the messages that the users made to solve it. I leave this debug to investigate.</p>



<a name="251952"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/251952" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#251952">(Jul 17 2017 at 18:42)</a>:</h4>
<p><span class="user-mention" data-user-email="bootfine@gmail.com" data-user-id="2759">@Manuel</span> can you explain what you mean by "NTP update" a bit more?</p>



<a name="253775"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/253775" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#253775">(Jul 19 2017 at 18:49)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span>  hello!<br>
Network Time Protocol. Network Time Protocol (NTP) is an Internet protocol for synchronizing the clocks of computer systems through packet routing in networks with variable latency. What I saw happened, is that linux had the wrong time and date, when I update the time the messages of the users with the old time could not be logged, so I had to wait for 48 hours after your last message to That the service was restored. It's all I found</p>



<a name="256142"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/256142" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edmund Lian <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#256142">(Jul 24 2017 at 07:39)</a>:</h4>
<p><span class="user-mention" data-user-email="showell@zulipchat.com" data-user-id="58">@Steve Howell</span> <br>
I just came across a situation that needs user deletion... a user successfully registered but cannot log in. Email password reset messages never get sent out to this specific user. When I test the email set up as per the install docs, and also by sending myself a password reset, everything works.</p>
<p>For some mysterious reason, Zulip just doesn't want to work with this user's (legal) address. Since I could not delete the user and recreate his account using the same email address, I had to give him a different address to re-register in Zulip. His old deactivated account is hanging around like a bad smell, I'd really like to just delete it and start again with this user.</p>
<p>Very weird, I looked at the logs but can't find anything amiss.</p>



<a name="256214"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/256214" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#256214">(Jul 24 2017 at 11:34)</a>:</h4>
<p>Just curious, is there anything unusual about the user's email, such as capital letters or unusual punctuation?</p>
<p>It's a bit dangerous to fully delete a user's account, since other users have references to the old user's messages.  When you say the the deactivated account is "hanging around like a bad smell," are there user-facing things still showing up, or are you referring more to the admin screens and that kind of clutter?</p>



<a name="256296"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/256296" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#256296">(Jul 24 2017 at 16:48)</a>:</h4>
<p><span class="user-mention" data-user-email="elian-zulip@645ad.net" data-user-id="2530">@Edmund Lian</span> how are you sending outgoing email?  It sounds a lot like your emails are being spam-filtered by that user's email provider.</p>



<a name="256553"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/256553" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edmund Lian <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#256553">(Jul 24 2017 at 23:05)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> Outgoing and incoming email are being handled locally by our own server. During my testing, I was actually looking at my mail logs in real-time to see if this was happening. I saw contact from Zulip when I used my address, but not when I used this user's address. Does Zulip keep a log of email activity too? If so what is its name? I should look at this log too.</p>



<a name="256554"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/256554" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edmund Lian <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#256554">(Jul 24 2017 at 23:08)</a>:</h4>
<p><span class="user-mention" data-user-email="showell@zulipchat.com" data-user-id="58">@Steve Howell</span> Nothing unusual about the email address... it is of the form "<a href="mailto:firstname_lastname@domain.com" title="mailto:firstname_lastname@domain.com">firstname_lastname@domain.com</a>". Sorry for the colloquialism, but by hanging around, I mean that I can see it as admin, but also that the user can no longer use his regular email address to log in, etc.</p>



<a name="256555"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/256555" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#256555">(Jul 24 2017 at 23:09)</a>:</h4>
<p><span class="user-mention" data-user-email="elian-zulip@645ad.net" data-user-id="2530">@Edmund Lian</span> I don't think we have such a central log but it's probably a good idea (CC <span class="user-mention" data-user-email="rishig@zulipchat.com" data-user-id="131">@Rishi Gupta</span>, can you open an issue?).  There are individual logs for certain types of emails; I guess this is a confirmation email?  I don't think we have a log for that specifically.</p>



<a name="256556"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/256556" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#256556">(Jul 24 2017 at 23:10)</a>:</h4>
<p>This is a bit mysterious.  Can you lay out more precisely what the state of the user's account is and what operation you're trying to do?  E.g. is it that the user has an account with email X, which you deactivated using the admin UI, and now they're trying to sign up again with email X?  Or something else?</p>



<a name="256558"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/256558" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edmund Lian <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#256558">(Jul 24 2017 at 23:12)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> Oh, too bad about the log. I will experiment a bit more  to see if it is the mail system, when I get back to the office in a few days.</p>



<a name="256565"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/256565" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#256565">(Jul 24 2017 at 23:15)</a>:</h4>
<p>Cool.  I think it's definitely worth adding such a log for this sort of debugging.</p>



<a name="256570"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/256570" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edmund Lian <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#256570">(Jul 24 2017 at 23:22)</a>:</h4>
<p>It is indeed mysterious, so looking at the email server more is a good ideal.</p>
<p>What happened is that the user registered with <a href="mailto:first_last@domain.com" title="mailto:first_last@domain.com">first_last@domain.com</a>. His selected password was of the form "word1-word2-word3#". At the time, I did see his registration. Because he didn't use the right fullname during registration, I manually corrected it to a Chinese name.</p>
<p>A few days later, he reported not being able to log in, and not receiving password reset email messages. This is when I began testing. I:</p>
<p>1. Tested SMTP operation by sending a test message using ./manage.py. (success)<br>
2. Tested password recovery on my own account (success, I received the message and saw it in the logs)<br>
3. Tested SMTP email using ./manage.py with the user's email address (failure, no logs either)<br>
4. Tested password recovery with the user's email address (failure).</p>
<p>I do have a spam filter (rspamd) in front of Postfix, but it does (or should) not kick in for email from our own networks and domain. I'll still go and look at this possibility in a few days though...</p>



<a name="256593"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/deactivating%20users/near/256593" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rishi Gupta <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/deactivating.20users.html#256593">(Jul 24 2017 at 23:43)</a>:</h4>
<p>Opened <a href="https://github.com/zulip/zulip/pull/5900" target="_blank" title="https://github.com/zulip/zulip/pull/5900">#5900</a> for adding logs for outgoing email.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>