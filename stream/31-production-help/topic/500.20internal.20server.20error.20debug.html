<html>
<head><meta charset="utf-8"><title>500 internal server error debug · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html">500 internal server error debug</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="246363"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246363" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246363">(Jul 08 2017 at 16:59)</a>:</h4>
<p>Log reports tornado might not be running, but supervisorctl shows it is. Tried restarting everything via both the script and supervisorctl and I'm having no luck. What's the next step in troubleshooting?</p>



<a name="246369"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246369" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246369">(Jul 08 2017 at 17:02)</a>:</h4>
<p>also worth noting my install was working just fine before this happened.</p>



<a name="246418"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246418" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246418">(Jul 08 2017 at 17:41)</a>:</h4>
<p><span class="user-mention" data-user-email="lyle@lylebrown.com" data-user-id="2527">@Lyle</span> have you looked at /var/log/zulip/tornado.log?</p>



<a name="246419"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246419" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246419">(Jul 08 2017 at 17:41)</a>:</h4>
<p>If you're not seeing anything useful in <code>errors.log</code>, that's the stdout/stderr from the Tornado process, and can sometimes have extra details.</p>



<a name="246440"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246440" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246440">(Jul 08 2017 at 18:29)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> looks like I'm getting a connection refused error on port 5672</p>



<a name="246442"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246442" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246442">(Jul 08 2017 at 18:30)</a>:</h4>
<p>even after stopping everything through supervisorctl, it looks like the zulip user is still running a ton of nginx processes</p>



<a name="246443"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246443" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246443">(Jul 08 2017 at 18:30)</a>:</h4>
<p>Ahh, that's rabbitmq.  Make sure your rabbitmq server is running.</p>



<a name="246444"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246444" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246444">(Jul 08 2017 at 18:31)</a>:</h4>
<p>(and accessible)</p>



<a name="246445"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246445" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246445">(Jul 08 2017 at 18:31)</a>:</h4>
<p>What version did you originally install with?  If you installed before 1.5 or so, if you reboot a Zulip server and it comes up with a different hostname, you'd need to purge and reinstall rabbitmq.</p>



<a name="246447"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246447" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246447">(Jul 08 2017 at 18:33)</a>:</h4>
<p>I installed roughly a month ago, so...I think 1.5.2</p>



<a name="246448"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246448" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246448">(Jul 08 2017 at 18:33)</a>:</h4>
<p>how can I check the status of rabbitmq?</p>



<a name="246454"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246454" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246454">(Jul 08 2017 at 18:44)</a>:</h4>
<p><code>rabbitmqctl status</code></p>



<a name="246455"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246455" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246455">(Jul 08 2017 at 18:45)</a>:</h4>
<p><code>cat /etc/zulip/zulip.conf</code> would also be helpful for debugging this</p>



<a name="246457"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246457" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246457">(Jul 08 2017 at 18:47)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> here's what rabbitmqctl status gives me, even after starting up zulip via supervisorctl again: <a href="https://paste.lyle.space/#evu2AvrPI66FqLHr87Acpw" target="_blank" title="https://paste.lyle.space/#evu2AvrPI66FqLHr87Acpw">https://paste.lyle.space/#evu2AvrPI66FqLHr87Acpw</a></p>



<a name="246458"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246458" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246458">(Jul 08 2017 at 18:48)</a>:</h4>
<p>Right, so rabbitmq is run via init, and Zulip's supervisord processes depend on it</p>



<a name="246459"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246459" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246459">(Jul 08 2017 at 18:48)</a>:</h4>
<p>So restarting supervisord won't have any effect until after you get rabbitmq running</p>



<a name="246460"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246460" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246460">(Jul 08 2017 at 18:48)</a>:</h4>
<p>You can try <code>/etc/init.d/rabbitmq-server start</code></p>



<a name="246461"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246461" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246461">(Jul 08 2017 at 18:50)</a>:</h4>
<p>but my guess is that will fail.  If it does, you can purge and reinstall rabbitmq's state roughly like this:</p>
<div class="codehilite"><pre><span></span>/etc/init.d/rabbitmq-server stop
rm -rf /var/lib/rabbitmq/mnesia
/etc/init.d/rabbitmq-server start
/home/zulip/deployments/scripts/setup/configure-rabbitmq
/home/zulip/deployments/scripts/setup/restart-server
</pre></div>



<a name="246467"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246467" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246467">(Jul 08 2017 at 18:53)</a>:</h4>
<p>it looks like rabbitmq came up, but I'm getting a different internal server error now (the page contains nothing but that, not formatted like usual)</p>



<a name="246468"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246468" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246468">(Jul 08 2017 at 19:01)</a>:</h4>
<p>I'll try a reinstall with those steps</p>



<a name="246481"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246481" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246481">(Jul 08 2017 at 19:10)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> did a reinstall, still getting a 500</p>



<a name="246482"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246482" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246482">(Jul 08 2017 at 19:10)</a>:</h4>
<p>what's in your error logs?</p>



<a name="246483"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246483" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246483">(Jul 08 2017 at 19:11)</a>:</h4>
<p>tornado.log once again is showing connection refused on port 5672</p>



<a name="246484"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246484" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246484">(Jul 08 2017 at 19:12)</a>:</h4>
<p>rabbitmqctl status looks the same as it did in my last paste</p>



<a name="246485"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246485" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246485">(Jul 08 2017 at 19:13)</a>:</h4>
<p>OK.  Try replacing that <code>rm -rf</code> command above with:</p>
<div class="codehilite"><pre><span></span>apt-get purge rabbitmq-server
/home/zulip/deployments/current/scripts/zulip-puppet-apply
</pre></div>



<a name="246486"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246486" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246486">(Jul 08 2017 at 19:13)</a>:</h4>
<p>(and doing the other steps)</p>



<a name="246487"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246487" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246487">(Jul 08 2017 at 19:14)</a>:</h4>
<p>It sounds like somehow that was insufficient to get rabbitmq-server to actually be working.</p>



<a name="246488"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246488" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246488">(Jul 08 2017 at 19:14)</a>:</h4>
<p>(rabbitmq-server is by far our most annoying dependency, because while it usually just works, it's pretty hard to debug if it doesn't start up.)</p>



<a name="246496"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246496" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246496">(Jul 08 2017 at 19:30)</a>:</h4>
<p>hmm, well now  the server isn't responding at all</p>



<a name="246498"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246498" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246498">(Jul 08 2017 at 19:30)</a>:</h4>
<p>here we go, now it's up again, but still 500</p>



<a name="246499"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246499" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246499">(Jul 08 2017 at 19:32)</a>:</h4>
<p>tornado loaded this time, reporting a lot of ~60% busy messages in the log though</p>



<a name="246511"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246511" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246511">(Jul 08 2017 at 20:22)</a>:</h4>
<p>those should pass after a minute</p>



<a name="246512"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246512" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246512">(Jul 08 2017 at 20:22)</a>:</h4>
<p>So is it working happily now?</p>



<a name="246539"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246539" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246539">(Jul 08 2017 at 21:15)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> still have a 500 error unfortunately</p>



<a name="246541"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246541" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246541">(Jul 08 2017 at 21:19)</a>:</h4>
<p><span class="user-mention" data-user-email="lyle@lylebrown.com" data-user-id="2527">@Lyle</span> can you paste the tracebacks from the Zulip logs when you mention a 500?  It's much more efficient for us to help you debug if you do so.</p>



<a name="246542"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246542" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246542">(Jul 08 2017 at 21:20)</a>:</h4>
<p>What does "tornado loaded this time" mean if you're still getting 500s?</p>



<a name="246544"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246544" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246544">(Jul 08 2017 at 21:20)</a>:</h4>
<p>so the tornado log did look good when I posted that, but now I'm getting connection refused once again</p>



<a name="246545"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246545" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246545">(Jul 08 2017 at 21:21)</a>:</h4>
<p>do you think it's possibly trying to run twice or more?</p>



<a name="246548"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246548" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246548">(Jul 08 2017 at 21:23)</a>:</h4>
<p>Hrm.  <code>pstree -ap</code> may be helpful to try to investigate the possibility you have multiple copies running.  Or <code>pgrep -U postgres --list-full</code>.  But that seems unlikely.</p>



<a name="246550"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246550" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246550">(Jul 08 2017 at 21:24)</a>:</h4>
<p>errors.log is reporting that as well, not sure if the prior error there is due a shutdown or something else: <a href="https://paste.lyle.space/#LNjmDTZQ_oxSYP-gNY5rtg" target="_blank" title="https://paste.lyle.space/#LNjmDTZQ_oxSYP-gNY5rtg">https://paste.lyle.space/#LNjmDTZQ_oxSYP-gNY5rtg</a></p>



<a name="246551"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246551" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246551">(Jul 08 2017 at 21:24)</a>:</h4>
<p><span class="user-mention" data-user-email="lyle@lylebrown.com" data-user-id="2527">@Lyle</span> just so I understand here, did this just randomly start happening, or did you change something that might have caused the issues?</p>



<a name="246552"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246552" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246552">(Jul 08 2017 at 21:24)</a>:</h4>
<p>this just randomly started happening. Another application of mine has a corrupt database as of recently, so it's possible there was a write error at some point in time</p>



<a name="246554"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246554" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246554">(Jul 08 2017 at 21:25)</a>:</h4>
<p>As in, your file system may have corruption?</p>



<a name="246556"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246556" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246556">(Jul 08 2017 at 21:25)</a>:</h4>
<p>potentially. for the other application (same server &amp; NAS, but different lxc container), it was a corrupted sqlite database, so it would suggest that</p>



<a name="246557"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246557" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246557">(Jul 08 2017 at 21:26)</a>:</h4>
<p>The errors you posted in that log file basically just show the Django process is unable to reach tornado.  I think we should focus on tornado.log until you have that clear of errors.  The rest is apparently just caused by Tornado being down, which is presumably caused by rabbitmq being unavailable.</p>



<a name="246558"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246558" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246558">(Jul 08 2017 at 21:27)</a>:</h4>
<p>alright. well I've confirmed only one instance of manage.py calling tornado exists according to pstree</p>



<a name="246564"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246564" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246564">(Jul 08 2017 at 21:34)</a>:</h4>
<p>not sure if the full tornado log is too helpful, but here it is: <a href="https://paste.lyle.space/#Y3-Yj9wMjHUBzqaXzIfm4g" target="_blank" title="https://paste.lyle.space/#Y3-Yj9wMjHUBzqaXzIfm4g">https://paste.lyle.space/#Y3-Yj9wMjHUBzqaXzIfm4g</a></p>



<a name="246576"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246576" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246576">(Jul 08 2017 at 21:48)</a>:</h4>
<p>Yeah, that looks like rabbitmq isn't accessible.  I think there's no point in checking whether Tornado works until you get rabbitmq working.  I assume `rabbitmqctl status still throws an error?</p>



<a name="246577"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246577" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246577">(Jul 08 2017 at 21:49)</a>:</h4>
<p>For debugging that, ultimately, you just need to get RabbitMQ to start; Googling for resources on rabbitmq issues can be helpful, since that's a popular third-party package, and so most material on debugging it will have nothing to do with Zulip</p>



<a name="246578"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246578" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246578">(Jul 08 2017 at 21:49)</a>:</h4>
<p>(Sorry for the slow replies, I'm in the middle of a few other things this afternoon)</p>



<a name="246579"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/246579" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lyle <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#246579">(Jul 08 2017 at 22:02)</a>:</h4>
<p>no problem, I appreciate the help. Hopefully I can figure that out</p>



<a name="247059"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/247059" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shane Kearns <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#247059">(Jul 10 2017 at 14:36)</a>:</h4>
<p>rabbitmq failing to start is a common issue for my server as well, particularly around upgrade of zulip or hostname changes<br>
A rather unsavory workaround is to apt-get purge &amp; reinstall it, and re-run the zulip script <code>scripts/setup/configure-rabbitmq</code><br>
This is horrible but rescues a production instance quickly.</p>



<a name="247197"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/247197" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#247197">(Jul 10 2017 at 18:01)</a>:</h4>
<p>I'm starting to think about whether we should attempt to replace rabbitmq with redis as a dependency.</p>



<a name="247198"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/247198" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#247198">(Jul 10 2017 at 18:02)</a>:</h4>
<p>Since it seems like 80% of problems people have with Zulip in production have to do with keeping rabbitmq running.</p>



<a name="302811"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/302811" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#302811">(Oct 23 2017 at 07:50)</a>:</h4>
<p>Hi I am facing this error in zulip errors log:</p>
<div class="codehilite"><pre><span></span>  File &quot;/home/zulip/deployments/2017-05-17-04-20-20/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py&quot;, line 185, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File &quot;/home/zulip/deployments/2017-05-17-04-20-20/zulip-venv/lib/python2.7/site-packages/django/views/decorators/csrf.py&quot;, line 58, in wrapped_view
    return view_func(*args, **kwargs)
  File &quot;./zerver/lib/request.py&quot;, line 165, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File &quot;./zerver/decorator.py&quot;, line 237, in _wrapped_func_arguments
    return view_func(request, user_profile, request.client, *args, **kwargs)
  File &quot;./zerver/lib/request.py&quot;, line 165, in _wrapped_view_func
    return view_func(request, *args, **kwargs)
  File &quot;./zerver/webhooks/jira/view.py&quot;, line 255, in api_jira_webhook
    subject = get_issue_subject(payload)
  File &quot;./zerver/webhooks/jira/view.py&quot;, line 141, in get_issue_subject
    return &quot;{}: {}&quot;.format(get_issue_id(payload), get_issue_title(payload))
UnicodeEncodeError: &#39;ascii&#39; codec can&#39;t encode characters in position 0-6: ordinal not in range(128)
</pre></div>



<a name="302812"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/302812" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#302812">(Oct 23 2017 at 07:57)</a>:</h4>
<p>Can I make some changes in the code to modify the encoding?</p>



<a name="302813"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/302813" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#302813">(Oct 23 2017 at 07:58)</a>:</h4>
<p>I tried to restart using supervisorctl, but all statuses showed <code>FATAL</code>, what should I do about this? Any doc I can refer to?</p>



<a name="302866"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/302866" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steve Howell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#302866">(Oct 23 2017 at 13:46)</a>:</h4>
<p>You can modify the code in <code>jira/view.py</code> and restart the server.  Here are some docs on <code>supervisorctl</code>, and I'm a little puzzled about why restarting we would fail for you:</p>
<p><a href="https://zulip.readthedocs.io/en/latest/prod-troubleshooting.html#using-supervisorctl" target="_blank" title="https://zulip.readthedocs.io/en/latest/prod-troubleshooting.html#using-supervisorctl">https://zulip.readthedocs.io/en/latest/prod-troubleshooting.html#using-supervisorctl</a></p>
<p>You can also run <code>./scripts/restart-server</code>:</p>
<p><a href="http://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html?highlight=restart-server#updating-settings" target="_blank" title="http://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html?highlight=restart-server#updating-settings">http://zulip.readthedocs.io/en/latest/prod-maintain-secure-upgrade.html?highlight=restart-server#updating-settings</a></p>



<a name="302934"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/302934" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#302934">(Oct 23 2017 at 17:53)</a>:</h4>
<p><span class="user-mention" data-user-email="showell@zulipchat.com" data-user-id="58">@Steve Howell</span> quick note: if it's been several hours since someone asked a question, it's best to mention them to make sure they see the message.</p>



<a name="302936"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/302936" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#302936">(Oct 23 2017 at 17:54)</a>:</h4>
<p><span class="user-mention" data-user-email="chester.lee.cold@gmail.com" data-user-id="2354">@Chester Li</span> I think the Jira ascii issue is fixed in Zulip 1.7; you can try installing the release candidate being discussed in <a class="stream" data-stream-id="2" href="/#narrow/stream/general">#general</a> to see if it fixes this for you.</p>



<a name="303329"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303329" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303329">(Oct 24 2017 at 00:17)</a>:</h4>
<p>How to re-install zulip without losing chat history? I didn't find related docs........</p>



<a name="303330"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303330" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303330">(Oct 24 2017 at 00:18)</a>:</h4>
<p>and any way to make zulip to use python3?</p>



<a name="303334"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303334" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303334">(Oct 24 2017 at 00:21)</a>:</h4>
<p><span class="user-mention" data-user-email="chester.lee.cold@gmail.com" data-user-id="2354">@Chester Li</span> I'm not sure what you mean by re-install, but you can upgrade the 1.7-rc2 release candidate, which will both fix this bug and switch Zulip to Python 3.</p>



<a name="303391"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303391" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303391">(Oct 24 2017 at 01:26)</a>:</h4>
<p>I meant upgrade, I will try to upgrade to the 1.7-rc2 version thank you <span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span></p>



<a name="303395"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303395" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303395">(Oct 24 2017 at 01:29)</a>:</h4>
<p>but there is only <code>latest</code>, where to find <code>1.7-rc2 release candidate</code>?</p>



<a name="303409"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303409" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303409">(Oct 24 2017 at 02:09)</a>:</h4>
<p><span class="user-mention" data-user-email="chester.lee.cold@gmail.com" data-user-id="2354">@Chester Li</span> <a href="https://chat.zulip.org/#narrow/stream/general/subject/Zulip.201.2E7.20plan/near/302241" target="_blank" title="https://chat.zulip.org/#narrow/stream/general/subject/Zulip.201.2E7.20plan/near/302241">https://chat.zulip.org/#narrow/stream/general/subject/Zulip.201.2E7.20plan/near/302241</a></p>



<a name="303415"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303415" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303415">(Oct 24 2017 at 02:43)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> Much appreciated!</p>



<a name="303465"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303465" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303465">(Oct 24 2017 at 04:37)</a>:</h4>
<p><span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> <br>
Sorry for keeping bothering, I got this error when upgrading:</p>
<div class="codehilite"><pre><span></span>Traceback (most recent call last):
  File &quot;./manage.py&quot;, line 19, in &lt;module&gt;
    log_management_command(&quot; &quot;.join(sys.argv), settings.MANAGEMENT_LOG_PATH)
  File &quot;/home/zulip/deployments/2017-10-24-04-28-14/scripts/lib/zulip_tools.py&quot;, line 190, in log_management_command
    file_handler = logging.FileHandler(log_path)
  File &quot;/usr/lib/python3.4/logging/__init__.py&quot;, line 1006, in __init__
    StreamHandler.__init__(self, self._open())
  File &quot;/usr/lib/python3.4/logging/__init__.py&quot;, line 1030, in _open
    return open(self.baseFilename, self.mode, encoding=self.encoding)
PermissionError: [Errno 13] Permission denied: &#39;/var/log/zulip/manage.log&#39;
Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2017-10-24-04-28-14/scripts/lib/upgrade-zulip-stage-2&quot;, line 104, in &lt;module&gt;
    preexec_fn=su_to_zulip)
  File &quot;/usr/lib/python3.4/subprocess.py&quot;, line 620, in check_output
    raise CalledProcessError(retcode, process.args, output=output)
subprocess.CalledProcessError: Command &#39;[&#39;./manage.py&#39;, &#39;showmigrations&#39;]&#39; returned non-zero exit status 1
Traceback (most recent call last):
  File &quot;/home/zulip/deployments/current/scripts/lib/upgrade-zulip&quot;, line 53, in &lt;module&gt;
    subprocess.check_call([os.path.abspath(&quot;./scripts/lib/upgrade-zulip-stage-2&quot;), deploy_path])
  File &quot;/usr/lib/python2.7/subprocess.py&quot;, line 540, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command &#39;[&#39;/home/zulip/deployments/2017-10-24-04-28-14/scripts/lib/upgrade-zulip-stage-2&#39;, &#39;/home/zulip/deployments/2017-10-24-04-28-14&#39;]&#39; returned non-zero exit status 1
</pre></div>



<a name="303466"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303466" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303466">(Oct 24 2017 at 04:38)</a>:</h4>
<p>anyone would be able to give me some hints?</p>



<a name="303468"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303468" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303468">(Oct 24 2017 at 04:43)</a>:</h4>
<p><code>sudo</code>?</p>



<a name="303469"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303469" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303469">(Oct 24 2017 at 04:44)</a>:</h4>
<p>It appears that the command which causes the error is the one when it is executed as <code>zulip</code>.</p>



<a name="303482"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303482" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303482">(Oct 24 2017 at 05:35)</a>:</h4>
<p><span class="user-mention" data-user-email="chester.lee.cold@gmail.com" data-user-id="2354">@Chester Li</span>, I think you need to run as 'zulip' user. You can do something like: <code>su zulip</code>.</p>



<a name="303483"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303483" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303483">(Oct 24 2017 at 05:40)</a>:</h4>
<p>Tho there is already the <code>preexec_fn=su_to_zulip</code> and perhaps <code>/var/log/zulip/manage.log</code> wasn't accessible by <code>zulip</code>.</p>



<a name="303484"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303484" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303484">(Oct 24 2017 at 05:42)</a>:</h4>
<p>I ran with <code>su zulip -c</code> but it said no permission</p>



<a name="303485"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303485" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303485">(Oct 24 2017 at 05:43)</a>:</h4>
<p>At current master, <code>script/upgrade-zulip</code> requires to be executed by root: <a href="https://github.com/zulip/zulip/blob/master/scripts/lib/upgrade-zulip#L18-L20" target="_blank" title="https://github.com/zulip/zulip/blob/master/scripts/lib/upgrade-zulip#L18-L20">https://github.com/zulip/zulip/blob/master/scripts/lib/upgrade-zulip#L18-L20</a>.</p>



<a name="303486"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303486" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303486">(Oct 24 2017 at 05:47)</a>:</h4>
<p>Hmm, even <code>upgrade-zulip-stage-2</code> has that check. I wonder why it didn't exit earlier.</p>



<a name="303487"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303487" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303487">(Oct 24 2017 at 05:51)</a>:</h4>
<p>Maybe it has to be <code>os.geteuid()</code> instead of <code>os.getuid()</code>. I encountered this permission error lots of time when debugging a way to <code>upgrade-zulip-from-git</code> on Travis (<a href="https://travis-ci.org/rht/zulip/jobs/291909177" target="_blank" title="https://travis-ci.org/rht/zulip/jobs/291909177">https://travis-ci.org/rht/zulip/jobs/291909177</a> for an example for a failed build, also stopped by a subprocess call that uses the <code>preexec_fn=su_to_zulip</code>).</p>



<a name="303488"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303488" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303488">(Oct 24 2017 at 05:52)</a>:</h4>
<p>But then it contradicts the result of various other successful upgrade reports.</p>



<a name="303489"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303489" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303489">(Oct 24 2017 at 05:54)</a>:</h4>
<p><span class="user-mention" data-user-email="chester.lee.cold@gmail.com" data-user-id="2354">@Chester Li</span>, can you run the command as root?</p>



<a name="303499"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303499" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303499">(Oct 24 2017 at 06:41)</a>:</h4>
<p><span class="user-mention" data-user-email="umair.waheed@gmail.com" data-user-id="92">@Umair Khan</span>which arguments should I use?</p>



<a name="303500"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303500" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303500">(Oct 24 2017 at 06:45)</a>:</h4>
<p>Do <code>sudo -s</code> to shift to root user and then run the command.</p>



<a name="303501"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303501" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303501">(Oct 24 2017 at 06:48)</a>:</h4>
<div class="codehilite"><pre><span></span>usage: upgrade-zulip-stage-2 <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>--skip-puppet<span class="o">]</span> <span class="o">[</span>--skip-migrations<span class="o">]</span>
                             <span class="o">[</span>--from-git<span class="o">]</span>
                             deploy_path
upgrade-zulip-stage-2: error: too few arguments
</pre></div>



<a name="303502"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303502" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303502">(Oct 24 2017 at 06:49)</a>:</h4>
<p>I ran <code>deployments/current/scripts/lib/upgrade-zulip-stage-2</code></p>



<a name="303503"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303503" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303503">(Oct 24 2017 at 06:50)</a>:</h4>
<p>Are you upgrading an existing installation?</p>



<a name="303504"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303504" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303504">(Oct 24 2017 at 06:51)</a>:</h4>
<p>Or setting up a new server?</p>



<a name="303505"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303505" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303505">(Oct 24 2017 at 06:51)</a>:</h4>
<p>In case you are doing an upgrade, run this:</p>
<div class="codehilite"><pre><span></span>/home/zulip/deployments/current/scripts/upgrade-zulip zulip-server-VERSION.tar.gz
</pre></div>



<a name="303506"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303506" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303506">(Oct 24 2017 at 06:52)</a>:</h4>
<p><code>zulip-server-VERSION.tar.gz</code> is the tarball.</p>



<a name="303508"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303508" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303508">(Oct 24 2017 at 06:58)</a>:</h4>
<p>I am upgrading to 1.7 candidate version, the  <code>subprocess.CalledProcessError</code> error was from running <code>upgrade-zulip</code> script</p>



<a name="303509"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303509" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303509">(Oct 24 2017 at 06:59)</a>:</h4>
<p>OK, run <code>upgrade-zulip</code> as root.</p>



<a name="303510"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303510" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303510">(Oct 24 2017 at 06:59)</a>:</h4>
<p>by doing <code>sudo -s</code> or <code>sudo su</code>.</p>



<a name="303511"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303511" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303511">(Oct 24 2017 at 07:00)</a>:</h4>
<p>I did run as root</p>



<a name="303512"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303512" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303512">(Oct 24 2017 at 07:04)</a>:</h4>
<p>Can you share with me the complete log including the command?</p>



<a name="303513"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303513" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303513">(Oct 24 2017 at 07:06)</a>:</h4>
<p>sure, let me re-run it</p>



<a name="303514"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303514" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303514">(Oct 24 2017 at 07:07)</a>:</h4>
<p>so the command is <code>deployments/current/scripts/upgrade-zulip zulip-server-1.7.0-rc2.tar.gz</code> after logined as <code>root</code></p>



<a name="303515"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303515" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303515">(Oct 24 2017 at 07:09)</a>:</h4>
<p>And the log is:</p>
<div class="codehilite"><pre><span></span><span class="m">2017</span>-10-24 <span class="m">07</span>:07:06,897 upgrade-zulip: Archiving the tarball under /home/zulip/archives
<span class="m">2017</span>-10-24 <span class="m">07</span>:07:07,252 upgrade-zulip: Unpacking the tarball
<span class="m">2017</span>-10-24 <span class="m">07</span>:07:09,416 upgrade-zulip-stage-2: Upgrading system packages...
Hit http://repo.zabbix.com precise InRelease
Hit http://ppa.launchpad.net trusty InRelease
Get:1 http://security.ubuntu.com trusty-security InRelease <span class="o">[</span><span class="m">65</span>.9 kB<span class="o">]</span>
Ign http://us.archive.ubuntu.com trusty InRelease
Hit http://repo.zabbix.com precise/main Sources
Get:2 http://us.archive.ubuntu.com trusty-updates InRelease <span class="o">[</span><span class="m">65</span>.9 kB<span class="o">]</span>
Hit http://repo.zabbix.com precise/main amd64 Packages
Hit http://ppa.launchpad.net trusty/main Sources
Hit http://repo.zabbix.com precise/main i386 Packages
Hit http://us.archive.ubuntu.com trusty-backports InRelease
Get:3 http://security.ubuntu.com trusty-security/main Sources <span class="o">[</span><span class="m">144</span> kB<span class="o">]</span>
Hit http://ppa.launchpad.net trusty/main amd64 Packages
Hit http://us.archive.ubuntu.com trusty Release.gpg
Get:4 http://us.archive.ubuntu.com trusty-updates/main Sources <span class="o">[</span><span class="m">407</span> kB<span class="o">]</span>
Get:5 http://security.ubuntu.com trusty-security/restricted Sources <span class="o">[</span><span class="m">4</span>,931 B<span class="o">]</span>
Hit http://ppa.launchpad.net trusty/main i386 Packages
Get:6 http://security.ubuntu.com trusty-security/universe Sources <span class="o">[</span><span class="m">65</span>.0 kB<span class="o">]</span>
Get:7 http://us.archive.ubuntu.com trusty-updates/restricted Sources <span class="o">[</span><span class="m">6</span>,322 B<span class="o">]</span>
Hit http://ppa.launchpad.net trusty/main Translation-en
Get:8 http://security.ubuntu.com trusty-security/multiverse Sources <span class="o">[</span><span class="m">3</span>,202 B<span class="o">]</span>
Get:9 http://us.archive.ubuntu.com trusty-updates/universe Sources <span class="o">[</span><span class="m">193</span> kB<span class="o">]</span>
Get:10 http://security.ubuntu.com trusty-security/main amd64 Packages <span class="o">[</span><span class="m">680</span> kB<span class="o">]</span>
Get:11 http://us.archive.ubuntu.com trusty-updates/multiverse Sources <span class="o">[</span><span class="m">7</span>,767 B<span class="o">]</span>
Get:12 http://us.archive.ubuntu.com trusty-updates/main amd64 Packages <span class="o">[</span><span class="m">1</span>,030 kB<span class="o">]</span>
Get:13 http://us.archive.ubuntu.com trusty-updates/restricted amd64 Packages <span class="o">[</span><span class="m">17</span>.1 kB<span class="o">]</span>
Get:14 http://security.ubuntu.com trusty-security/restricted amd64 Packages <span class="o">[</span><span class="m">14</span>.1 kB<span class="o">]</span>
Ign http://repo.zabbix.com precise/main Translation-en_US
Get:15 http://us.archive.ubuntu.com trusty-updates/universe amd64 Packages <span class="o">[</span><span class="m">430</span> kB<span class="o">]</span>
Get:16 http://security.ubuntu.com trusty-security/universe amd64 Packages <span class="o">[</span><span class="m">191</span> kB<span class="o">]</span>
Ign http://repo.zabbix.com precise/main Translation-en
Get:17 http://us.archive.ubuntu.com trusty-updates/multiverse amd64 Packages <span class="o">[</span><span class="m">14</span>.9 kB<span class="o">]</span>
Get:18 http://security.ubuntu.com trusty-security/multiverse amd64 Packages <span class="o">[</span><span class="m">4</span>,798 B<span class="o">]</span>
Get:19 http://us.archive.ubuntu.com trusty-updates/main i386 Packages <span class="o">[</span><span class="m">975</span> kB<span class="o">]</span>
Get:20 http://security.ubuntu.com trusty-security/main i386 Packages <span class="o">[</span><span class="m">624</span> kB<span class="o">]</span>
Get:21 http://us.archive.ubuntu.com trusty-updates/restricted i386 Packages <span class="o">[</span><span class="m">17</span>.0 kB<span class="o">]</span>
Get:22 http://security.ubuntu.com trusty-security/restricted i386 Packages <span class="o">[</span><span class="m">13</span>.9 kB<span class="o">]</span>
Get:23 http://us.archive.ubuntu.com trusty-updates/universe i386 Packages <span class="o">[</span><span class="m">431</span> kB<span class="o">]</span>
Get:24 http://security.ubuntu.com trusty-security/universe i386 Packages <span class="o">[</span><span class="m">192</span> kB<span class="o">]</span>
Get:25 http://us.archive.ubuntu.com trusty-updates/multiverse i386 Packages <span class="o">[</span><span class="m">15</span>.3 kB<span class="o">]</span>
Get:26 http://us.archive.ubuntu.com trusty-updates/main Translation-en <span class="o">[</span><span class="m">509</span> kB<span class="o">]</span>
Get:27 http://security.ubuntu.com trusty-security/multiverse i386 Packages <span class="o">[</span><span class="m">4</span>,946 B<span class="o">]</span>
Get:28 http://us.archive.ubuntu.com trusty-updates/multiverse Translation-en <span class="o">[</span><span class="m">7</span>,760 B<span class="o">]</span>
Get:29 http://security.ubuntu.com trusty-security/main Translation-en <span class="o">[</span><span class="m">366</span> kB<span class="o">]</span>
Get:30 http://security.ubuntu.com trusty-security/multiverse Translation-en <span class="o">[</span><span class="m">2</span>,564 B<span class="o">]</span>
Get:31 http://us.archive.ubuntu.com trusty-updates/restricted Translation-en <span class="o">[</span><span class="m">4</span>,031 B<span class="o">]</span>
Get:32 http://us.archive.ubuntu.com trusty-updates/universe Translation-en <span class="o">[</span><span class="m">233</span> kB<span class="o">]</span>
Get:33 http://security.ubuntu.com trusty-security/restricted Translation-en <span class="o">[</span><span class="m">3</span>,542 B<span class="o">]</span>
Hit http://us.archive.ubuntu.com trusty-backports/main Sources
Get:34 http://security.ubuntu.com trusty-security/universe Translation-en <span class="o">[</span><span class="m">110</span> kB<span class="o">]</span>
Hit http://us.archive.ubuntu.com trusty-backports/restricted Sources
Hit http://us.archive.ubuntu.com trusty-backports/universe Sources
Hit http://us.archive.ubuntu.com trusty-backports/multiverse Sources
Hit http://us.archive.ubuntu.com trusty-backports/main amd64 Packages
Hit http://us.archive.ubuntu.com trusty-backports/restricted amd64 Packages
Hit http://us.archive.ubuntu.com trusty-backports/universe amd64 Packages
Hit http://us.archive.ubuntu.com trusty-backports/multiverse amd64 Packages
Hit http://us.archive.ubuntu.com trusty-backports/main i386 Packages
Hit http://us.archive.ubuntu.com trusty-backports/restricted i386 Packages
Hit http://us.archive.ubuntu.com trusty-backports/universe i386 Packages
Hit http://us.archive.ubuntu.com trusty-backports/multiverse i386 Packages
Hit http://us.archive.ubuntu.com trusty-backports/main Translation-en
Hit http://us.archive.ubuntu.com trusty-backports/multiverse Translation-en
Hit http://us.archive.ubuntu.com trusty-backports/restricted Translation-en
Hit http://us.archive.ubuntu.com trusty-backports/universe Translation-en
Hit http://us.archive.ubuntu.com trusty Release
Hit http://us.archive.ubuntu.com trusty/main Sources
Hit http://us.archive.ubuntu.com trusty/restricted Sources
Hit http://us.archive.ubuntu.com trusty/universe Sources
Hit http://us.archive.ubuntu.com trusty/multiverse Sources
Hit http://us.archive.ubuntu.com trusty/main amd64 Packages
Hit http://us.archive.ubuntu.com trusty/restricted amd64 Packages
Hit http://us.archive.ubuntu.com trusty/universe amd64 Packages
Hit http://us.archive.ubuntu.com trusty/multiverse amd64 Packages
Hit http://us.archive.ubuntu.com trusty/main i386 Packages
Hit http://us.archive.ubuntu.com trusty/restricted i386 Packages
Hit http://us.archive.ubuntu.com trusty/universe i386 Packages
Hit http://us.archive.ubuntu.com trusty/multiverse i386 Packages
Hit http://us.archive.ubuntu.com trusty/main Translation-en
Hit http://us.archive.ubuntu.com trusty/multiverse Translation-en
Hit http://us.archive.ubuntu.com trusty/restricted Translation-en
Hit http://us.archive.ubuntu.com trusty/universe Translation-en
Ign http://us.archive.ubuntu.com trusty/main Translation-en_US
Ign http://us.archive.ubuntu.com trusty/multiverse Translation-en_US
Ign http://us.archive.ubuntu.com trusty/restricted Translation-en_US
Ign http://us.archive.ubuntu.com trusty/universe Translation-en_US
Fetched <span class="m">6</span>,854 kB in 20s <span class="o">(</span><span class="m">341</span> kB/s<span class="o">)</span>
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
<span class="m">0</span> upgraded, <span class="m">0</span> newly installed, <span class="m">0</span> to remove and <span class="m">0</span> not upgraded.
+ apt-get -y install build-essential libffi-dev libfreetype6-dev libz-dev libjpeg-dev libldap2-dev libmemcached-dev python3-dev python-dev python3-pip python-pip python-virtualenv python3-six python-six libxml2-dev libxslt1-dev libpq-dev
Reading package lists...
Building dependency tree...
Reading state information...
build-essential is already the newest version.
libjpeg-dev is already the newest version.
libmemcached-dev is already the newest version.
python-dev is already the newest version.
python3-dev is already the newest version.
zlib1g-dev is already the newest version.
libffi-dev is already the newest version.
libfreetype6-dev is already the newest version.
libldap2-dev is already the newest version.
libpq-dev is already the newest version.
libxml2-dev is already the newest version.
libxslt1-dev is already the newest version.
python-six is already the newest version.
python3-six is already the newest version.
python-pip is already the newest version.
python-virtualenv is already the newest version.
python3-pip is already the newest version.
<span class="m">0</span> upgraded, <span class="m">0</span> newly installed, <span class="m">0</span> to remove and <span class="m">0</span> not upgraded.
Using cached Python venv from /srv/zulip-venv-cache/744df963b13bb2a16c0cc12f71b9650c6016e07e/zulip-py3-venv
+ sudo ln -nsf /srv/zulip-venv-cache/744df963b13bb2a16c0cc12f71b9650c6016e07e/zulip-py3-venv /home/zulip/deployments/2017-10-24-07-07-07/zulip-py3-venv
+ ln -nsf zulip-py3-venv /home/zulip/deployments/2017-10-24-07-07-07/zulip-current-venv
Node version <span class="m">6</span>.6.0 and yarn version <span class="m">0</span>.27.5 are already installed.
Generated Camo config file /etc/default/camo
generate_secrets: No new secrets to generate.
<span class="m">2017</span>-10-24 <span class="m">07</span>:07:37,728 upgrade-zulip-stage-2: Installing static assets...
<span class="m">2017</span>-10-24 <span class="m">07</span>:07:38,936 upgrade-zulip-stage-2: Checking <span class="k">for</span> needed migrations
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&quot;./manage.py&quot;</span>, line <span class="m">19</span>, in &lt;module&gt;
    log_management_command<span class="o">(</span><span class="s2">&quot; &quot;</span>.join<span class="o">(</span>sys.argv<span class="o">)</span>, settings.MANAGEMENT_LOG_PATH<span class="o">)</span>
  File <span class="s2">&quot;/home/zulip/deployments/2017-10-24-07-07-07/scripts/lib/zulip_tools.py&quot;</span>, line <span class="m">190</span>, in log_management_command
    <span class="nv">file_handler</span> <span class="o">=</span> logging.FileHandler<span class="o">(</span>log_path<span class="o">)</span>
  File <span class="s2">&quot;/usr/lib/python3.4/logging/__init__.py&quot;</span>, line <span class="m">1006</span>, in __init__
    StreamHandler.__init__<span class="o">(</span>self, self._open<span class="o">())</span>
  File <span class="s2">&quot;/usr/lib/python3.4/logging/__init__.py&quot;</span>, line <span class="m">1030</span>, in _open
    <span class="k">return</span> open<span class="o">(</span>self.baseFilename, self.mode, <span class="nv">encoding</span><span class="o">=</span>self.encoding<span class="o">)</span>
PermissionError: <span class="o">[</span>Errno <span class="m">13</span><span class="o">]</span> Permission denied: <span class="s1">&#39;/var/log/zulip/manage.log&#39;</span>
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&quot;/home/zulip/deployments/2017-10-24-07-07-07/scripts/lib/upgrade-zulip-stage-2&quot;</span>, line <span class="m">104</span>, in &lt;module&gt;
    <span class="nv">preexec_fn</span><span class="o">=</span>su_to_zulip<span class="o">)</span>
  File <span class="s2">&quot;/usr/lib/python3.4/subprocess.py&quot;</span>, line <span class="m">620</span>, in check_output
    raise CalledProcessError<span class="o">(</span>retcode, process.args, <span class="nv">output</span><span class="o">=</span>output<span class="o">)</span>
subprocess.CalledProcessError: Command <span class="s1">&#39;[&#39;</span>./manage.py<span class="s1">&#39;, &#39;</span>showmigrations<span class="s1">&#39;]&#39;</span> returned non-zero <span class="nb">exit</span> status <span class="m">1</span>
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&quot;deployments/current/scripts/lib/upgrade-zulip&quot;</span>, line <span class="m">53</span>, in &lt;module&gt;
    subprocess.check_call<span class="o">([</span>os.path.abspath<span class="o">(</span><span class="s2">&quot;./scripts/lib/upgrade-zulip-stage-2&quot;</span><span class="o">)</span>, deploy_path<span class="o">])</span>
  File <span class="s2">&quot;/usr/lib/python2.7/subprocess.py&quot;</span>, line <span class="m">540</span>, in check_call
    raise CalledProcessError<span class="o">(</span>retcode, cmd<span class="o">)</span>
subprocess.CalledProcessError: Command <span class="s1">&#39;[&#39;</span>/home/zulip/deployments/2017-10-24-07-07-07/scripts/lib/upgrade-zulip-stage-2<span class="s1">&#39;, &#39;</span>/home/zulip/deployments/2017-10-24-07-07-07<span class="s1">&#39;]&#39;</span> returned non-zero <span class="nb">exit</span> status <span class="m">1</span>
</pre></div>


<p>any idea? <span class="user-mention" data-user-email="umair.waheed@gmail.com" data-user-id="92">@Umair Khan</span></p>



<a name="303516"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303516" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303516">(Oct 24 2017 at 07:14)</a>:</h4>
<p>What is <code>ls -ld /var/log/zulip</code> and <code>ls -l /var/log/zulip</code>?</p>



<a name="303517"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303517" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303517">(Oct 24 2017 at 07:16)</a>:</h4>
<p>returned different user and group ownerships</p>



<a name="303518"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303518" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303518">(Oct 24 2017 at 07:17)</a>:</h4>
<p>root and zulip?</p>



<a name="303519"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303519" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303519">(Oct 24 2017 at 07:19)</a>:</h4>
<p>no, /zulip folder is owned by another user, while all files under it are owned by zulip</p>



<a name="303520"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303520" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303520">(Oct 24 2017 at 07:19)</a>:</h4>
<p>hmm</p>



<a name="303521"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303521" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303521">(Oct 24 2017 at 07:19)</a>:</h4>
<p>that is the problem probably.</p>



<a name="303522"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303522" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303522">(Oct 24 2017 at 07:20)</a>:</h4>
<p>try this <code>sudo chown zulip:zulip /var/log/zulip</code> and then run the upgrade script again.</p>



<a name="303523"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303523" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303523">(Oct 24 2017 at 07:22)</a>:</h4>
<p>hmm, got something new</p>
<div class="codehilite"><pre><span></span>Node version <span class="m">6</span>.6.0 and yarn version <span class="m">0</span>.27.5 are already installed.
Generated Camo config file /etc/default/camo
generate_secrets: No new secrets to generate.
<span class="m">2017</span>-10-24 <span class="m">07</span>:21:01,266 upgrade-zulip-stage-2: Installing static assets...
<span class="m">2017</span>-10-24 <span class="m">07</span>:21:02,465 upgrade-zulip-stage-2: Checking <span class="k">for</span> needed migrations
unix:///var/run/supervisor.sock no such file
<span class="m">2017</span>-10-24 <span class="m">07</span>:21:07,651 upgrade-zulip-stage-2: Stopping Zulip...
unix:///var/run/supervisor.sock no such file
<span class="m">2017</span>-10-24 <span class="m">07</span>:21:07,760 upgrade-zulip-stage-2: Applying puppet changes...
Warning: Could not retrieve fact fqdn
Notice: Compiled catalog <span class="k">for</span> zenlayer in environment production in <span class="m">1</span>.77 seconds
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Nginx/File<span class="o">[</span>/etc/nginx/nginx.conf<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}8d513aaf28f8945138b14140251e9182&#39;</span> to <span class="s1">&#39;{md5}dee26a31dcae0a49a67fb0b4bb3c51d4&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Analytics/File<span class="o">[</span>/etc/cron.d/update-analytics-counts<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}d618204a4c9720aa6b363dc4ad93e391&#39;</span> to <span class="s1">&#39;{md5}da37aff132764038e73a6ee3914c696b&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Postgres_common/Exec<span class="o">[</span>disable_logrotate<span class="o">]</span>/returns: executed successfully
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend/File<span class="o">[</span>/etc/cron.d/restart-zulip<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}3a56343b1c9850a778b9b9150e309587&#39;</span> to <span class="s1">&#39;{md5}d21fb2757945a469df47f0b6a462e0b0&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend/File<span class="o">[</span>/etc/logrotate.d/zulip<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}051c9c309fda9a301edbb524b1f416a4&#39;</span> to <span class="s1">&#39;{md5}4e87145fd2f6c141ce2103171ff66d06&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend/File<span class="o">[</span>/etc/cron.d/soft-deactivate-users<span class="o">]</span>/ensure: defined content as <span class="s1">&#39;{md5}c09efba42ba520713dbdbd79a24c7dbf&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Nginx/File<span class="o">[</span>/var/log/nginx<span class="o">]</span>/owner: owner changed <span class="s1">&#39;root&#39;</span> to <span class="s1">&#39;zulip&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Nginx/File<span class="o">[</span>/var/log/nginx<span class="o">]</span>/mode: mode changed <span class="s1">&#39;0755&#39;</span> to <span class="s1">&#39;0750&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Static_asset_compiler/Zulip::Static_asset_compiler::Safepackage<span class="o">[</span>yui-compressor<span class="o">]</span>/Package<span class="o">[</span>yui-compressor<span class="o">]</span>/ensure: ensure changed <span class="s1">&#39;purged&#39;</span> to <span class="s1">&#39;present&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Postgres_common/Zulip::Postgres_common::Safepackage<span class="o">[</span>python3-tz<span class="o">]</span>/Package<span class="o">[</span>python3-tz<span class="o">]</span>/ensure: ensure changed <span class="s1">&#39;purged&#39;</span> to <span class="s1">&#39;present&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Postgres_common/File<span class="o">[</span>/usr/lib/nagios/plugins/zulip_postgres_common/check_postgres_backup<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}dc995e91c038ddb92c461aba972b52cf&#39;</span> to <span class="s1">&#39;{md5}13aec757ceb0da2c634035bd3f6e0020&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Postgres_appdb_base/Zulip::Postgres_appdb_base::Safepackage<span class="o">[</span>python3-psycopg2<span class="o">]</span>/Package<span class="o">[</span>python3-psycopg2<span class="o">]</span>/ensure: ensure changed <span class="s1">&#39;purged&#39;</span> to <span class="s1">&#39;present&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Postgres_appdb_base/File<span class="o">[</span>/usr/local/bin/process_fts_updates<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}ebd1554cc1a6019d6b2ba32cdd7963c1&#39;</span> to <span class="s1">&#39;{md5}2d98049abad06138d9b3da226074f11c&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Static_asset_compiler/Zulip::Static_asset_compiler::Safepackage<span class="o">[</span>libclosure-compiler-java<span class="o">]</span>/Package<span class="o">[</span>libclosure-compiler-java<span class="o">]</span>/ensure: ensure changed <span class="s1">&#39;purged&#39;</span> to <span class="s1">&#39;present&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend_base/File<span class="o">[</span>/usr/lib/nagios/plugins/zulip_app_frontend/check_cron_file<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}d7340e0a7f7fb7affadc30e66e984fa4&#39;</span> to <span class="s1">&#39;{md5}cc18b9970825f905c2fd06070ef027cf&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend_base/File<span class="o">[</span>/usr/lib/nagios/plugins/zulip_app_frontend/check_send_receive_time<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}10199319bcc26680cebdc8d2fe1f6cae&#39;</span> to <span class="s1">&#39;{md5}fe9510e0365263b42311b3b6e700b865&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend_base/File<span class="o">[</span>/usr/lib/nagios/plugins/zulip_app_frontend/check_rabbitmq_queues<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}515de9b41cef780c8008154b787d0400&#39;</span> to <span class="s1">&#39;{md5}f6b6487d70cc90ac95af179400eca018&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend_base/File<span class="o">[</span>/usr/lib/nagios/plugins/zulip_app_frontend/check_queue_worker_errors<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}75cb3cfb123e77573048268439ae5edf&#39;</span> to <span class="s1">&#39;{md5}2b1a558bcdbf8c45cfa127bc663bbca5&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend_base/File<span class="o">[</span>/usr/lib/nagios/plugins/zulip_app_frontend/check_rabbitmq_consumers<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}3a33c1acd7355e76ac72478f6a8dce8b&#39;</span> to <span class="s1">&#39;{md5}f73299d1ce1b1b80412562d1d92af33d&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend_base/File<span class="o">[</span>/usr/lib/nagios/plugins/zulip_app_frontend/check_worker_memory<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}51ec8abb41d02fa4393b446205701477&#39;</span> to <span class="s1">&#39;{md5}3ebec035ac3d98a2bcece971a47516c8&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Postgres_common/File<span class="o">[</span>/usr/local/bin/pg_backup_and_purge<span class="o">]</span>/ensure: defined content as <span class="s1">&#39;{md5}317f937b65592a8e133a01f80922856b&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Static_asset_compiler/Zulip::Static_asset_compiler::Safepackage<span class="o">[</span>nodejs-legacy<span class="o">]</span>/Package<span class="o">[</span>nodejs-legacy<span class="o">]</span>/ensure: ensure changed <span class="s1">&#39;purged&#39;</span> to <span class="s1">&#39;present&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Postgres_common/Zulip::Postgres_common::Safepackage<span class="o">[</span>python3-dateutil<span class="o">]</span>/Package<span class="o">[</span>python3-dateutil<span class="o">]</span>/ensure: ensure changed <span class="s1">&#39;purged&#39;</span> to <span class="s1">&#39;present&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend_base/File<span class="o">[</span>/etc/zulip/uwsgi.ini<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}096627db48f8c286eb68cdb9a09aaab8&#39;</span> to <span class="s1">&#39;{md5}f671486b4a6092ed71c3ec9c065d4b3b&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend_base/File<span class="o">[</span>/etc/supervisor/conf.d/zulip.conf<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}d8bbb23c5c9b379c73a125d73986626e&#39;</span> to <span class="s1">&#39;{md5}e4acd8ffb577209709a4ecd2214f4f21&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Supervisor/Service<span class="o">[</span>supervisor<span class="o">]</span>: Triggered <span class="s1">&#39;refresh&#39;</span> from <span class="m">2</span> events
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Postgres_appdb_base/File<span class="o">[</span>/usr/lib/nagios/plugins/zulip_postgres_appdb/check_fts_update_log<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}fbcb906daf0e02770d83ca290aabda73&#39;</span> to <span class="s1">&#39;{md5}1819b1fc4c85b34df0671df6e9f7111e&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::App_frontend_base/File<span class="o">[</span>/etc/nginx/zulip-include/app<span class="o">]</span>/content: content changed <span class="s1">&#39;{md5}00918852ebd76649c33da05fd8843ebd&#39;</span> to <span class="s1">&#39;{md5}fd86995aad47a125c3e394a1f86446c2&#39;</span>
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Nginx/Service<span class="o">[</span>nginx<span class="o">]</span>: Triggered <span class="s1">&#39;refresh&#39;</span> from <span class="m">2</span> events
Notice: /Stage<span class="o">[</span>main<span class="o">]</span>/Zulip::Static_asset_compiler/Zulip::Static_asset_compiler::Safepackage<span class="o">[</span>gettext<span class="o">]</span>/Package<span class="o">[</span>gettext<span class="o">]</span>/ensure: ensure changed <span class="s1">&#39;purged&#39;</span> to <span class="s1">&#39;present&#39;</span>
Notice: Finished catalog run in <span class="m">67</span>.97 seconds
Reading package lists...
Building dependency tree...
Reading state information...
<span class="m">0</span> upgraded, <span class="m">0</span> newly installed, <span class="m">0</span> to remove and <span class="m">0</span> not upgraded.
<span class="m">2017</span>-10-24 <span class="m">07</span>:22:22,827 upgrade-zulip-stage-2: Applying database migrations...
</pre></div>



<a name="303524"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303524" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303524">(Oct 24 2017 at 07:23)</a>:</h4>
<p>That Node message is not an issue. The  command is still running?</p>



<a name="303525"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303525" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303525">(Oct 24 2017 at 07:24)</a>:</h4>
<p>other than that, everything is fine now!</p>



<a name="303526"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303526" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chester Li <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303526">(Oct 24 2017 at 07:24)</a>:</h4>
<p><span class="user-mention" data-user-email="umair.waheed@gmail.com" data-user-id="92">@Umair Khan</span> Thank you very much!!!!</p>



<a name="303527"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/500%20internal%20server%20error%20debug/near/303527" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Umair Khan <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/500.20internal.20server.20error.20debug.html#303527">(Oct 24 2017 at 07:24)</a>:</h4>
<p>No problem :).</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>