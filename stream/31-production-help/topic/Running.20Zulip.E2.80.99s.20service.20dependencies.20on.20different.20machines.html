<html>
<head><meta charset="utf-8"><title>Running Zulip’s service dependencies on different machines · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html">Running Zulip’s service dependencies on different machines</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="780072"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/780072" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#780072">(Aug 16 2019 at 08:16)</a>:</h4>
<p>I'm trying to install redis service in a machine with such command "env PUPPET_CLASSES=zulip::redis ./scripts/setup/install --self-signed-cert --hostname=zulipdepends.com --email=zulip@testdomain.com" according to this guide <a href="https://zulip.readthedocs.io/en/latest/production/deployment.html#running-zulip-s-service-dependencies-on-different-machines" target="_blank" title="https://zulip.readthedocs.io/en/latest/production/deployment.html#running-zulip-s-service-dependencies-on-different-machines">https://zulip.readthedocs.io/en/latest/production/deployment.html#running-zulip-s-service-dependencies-on-different-machines</a>, but it failed with "bash: /home/zulip/deployments/current/scripts/setup/initialize-database: No such file or directory"， full log file attached <a href="/user_uploads/2/ce/H6EQr2punorV9m2TCiE28cny/install.log" target="_blank" title="install.log">install.log</a> , ask for help for troubleshooting. Thanks!</p>



<a name="780073"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/780073" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#780073">(Aug 16 2019 at 08:44)</a>:</h4>
<p>Tried another service rabbit, failed with another error "ModuleNotFoundError: No module named 'zproject.prod_settings'", full install log attached <a href="/user_uploads/2/a4/yoA0V1rOOU7X7Zu8kDludb94/install_rabbit.log" target="_blank" title="install_rabbit.log">install_rabbit.log</a> , please advice, thanks!</p>



<a name="780153"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/780153" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#780153">(Aug 16 2019 at 16:52)</a>:</h4>
<p><span class="user-mention" data-user-id="13096">@Tiger</span> thanks for the report.  It looks like we've had a regression here; it installed correctly, but then tried to run some additional code at the very end it should only run if it's supposed to be running the Zulip database.  I think those systems should be installed correctly despite the errors at the end.</p>



<a name="780157"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/780157" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#780157">(Aug 16 2019 at 16:54)</a>:</h4>
<p>(Adding the <code>--no-init-db</code> option should make it exit with status 0 correctly)</p>



<a name="781385"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781385" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781385">(Aug 21 2019 at 01:58)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Thank you Tim! shall I report a issue in github?</p>



<a name="781420"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781420" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781420">(Aug 21 2019 at 09:01)</a>:</h4>
<p>tried more service installation, but all failed as below, please help to analyze the log and advise, thank you in advance!</p>



<a name="781421"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781421" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781421">(Aug 21 2019 at 09:02)</a>:</h4>
<p>env PUPPET_CLASSES=zulip::postgres_appdb_tuned ./scripts/setup/install --self-signed-cert --no-init-db --hostname=zulipdepends.com --email=zulip@hcl.com</p>
<p>Warning: Unknown variable: 'zulip::base::postgres_version'. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/postgres_common.pp, line: 5, column: 35)<br>
Warning: Unknown variable: 'zulip::base::release_name'. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/supervisor.pp, line: 84, column: 6)<br>
Warning: Unknown variable: 'zulip::base::postgres_version'. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/postgres_appdb_base.pp, line: 10, column: 35)<br>
Warning: Unknown variable: 'zulip::base::postgres_version'. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/postgres_appdb_base.pp, line: 20, column: 53)<br>
Warning: Unknown variable: 'zulip::base::postgres_version'. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/postgres_appdb_tuned.pp, line: 7, column: 34)<br>
Warning: Unknown variable: 'zulip::base::postgres_version'. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/postgres_appdb_tuned.pp, line: 11, column: 32)<br>
Warning: Unknown variable: 'zulip::base::release_name'. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/postgres_appdb_tuned.pp, line: 14, column: 4)<br>
Warning: Unknown variable: 'zulip::base::total_memory'. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/postgres_appdb_tuned.pp, line: 66, column: 18)<br>
Error: Evaluation Error: The value '' cannot be converted to Numeric. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/postgres_appdb_tuned.pp, line: 66, column: 18) on node zulipapp<br>
<a href="/user_uploads/2/2c/JBbho1hmRJzMsADvsyldSRde/install_postgres_appdb_tuned.log" target="_blank" title="install_postgres_appdb_tuned.log">install_postgres_appdb_tuned.log</a></p>



<a name="781422"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781422" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781422">(Aug 21 2019 at 09:02)</a>:</h4>
<p>env PUPPET_CLASSES=zulip::memcached ./scripts/setup/install --self-signed-cert --no-init-db --hostname=zulipdepends.com --email=zulip@hcl.com<br>
+ /home/zulip/zulip-server-2.0.4/scripts/zulip-puppet-apply -f<br>
Warning: Unknown variable: 'zulip::base::total_memory_mb'. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/memcached.pp, line: 5, column: 56)<br>
Error: Evaluation Error: The value '' cannot be converted to Numeric. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/memcached.pp, line: 5, column: 56) on node zulipapp<br>
<a href="/user_uploads/2/65/dfXhzqr6rZ_RpcHVMsJQB_Cj/install_memcached.log" target="_blank" title="install_memcached.log">install_memcached.log</a></p>



<a name="781423"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781423" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781423">(Aug 21 2019 at 09:04)</a>:</h4>
<p>env PUPPET_CLASSES=zulip::rabbit ./scripts/setup/install --self-signed-cert --no-init-db --hostname=zulipdepends.com --email=zulip@hcl.com<br>
  File "/home/zulip/zulip-server-2.0.4/zproject/settings.py", line 109, in &lt;module&gt;<br>
    from .prod_settings import *
ModuleNotFoundError: No module named 'zproject.prod_settings'<br>
+ RABBITMQ_USERNAME=</p>
<p><a href="/user_uploads/2/cb/gAb7UWxCVRA-XaKPe0ThNGZR/install_rabbit.log" target="_blank" title="install_rabbit.log">install_rabbit.log</a></p>



<a name="781424"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781424" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781424">(Aug 21 2019 at 09:05)</a>:</h4>
<p>env PUPPET_CLASSES=zulip::thumbor ./scripts/setup/install --self-signed-cert --no-init-db --hostname=zulipdepends.com --email=zulip@hcl.com<br>
Warning: Unknown variable: 'zulip::base::release_name'. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/nginx.pp, line: 45, column: 22)<br>
Warning: Unknown variable: 'zulip::base::release_name'. (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/supervisor.pp, line: 84, column: 6)<br>
Error: Could not find resource 'File[/var/log/zulip]' in parameter 'require' (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/supervisor.pp, line: 48) on node zulipapp<br>
<a href="/user_uploads/2/11/bT9rgd9z4-tltjMIzK2EkM5Z/install_thumbor.log" target="_blank" title="install_thumbor.log">install_thumbor.log</a></p>



<a name="781526"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781526" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781526">(Aug 21 2019 at 17:33)</a>:</h4>
<p><span class="user-mention" data-user-id="13096">@Tiger</span> hmm, try doing e.g. <code>env PUPPET_CLASSES=zulip::postgres_appdb_tuned, zulip::base</code></p>



<a name="781527"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781527" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781527">(Aug 21 2019 at 17:33)</a>:</h4>
<p>I think that's the source of all of those issues.</p>



<a name="781534"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781534" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781534">(Aug 21 2019 at 17:38)</a>:</h4>
<p><a href="https://github.com/zulip/zulip/commit/92d8c5dec6d8f4afecb1509ca5f43ac1d1b693c9" target="_blank" title="https://github.com/zulip/zulip/commit/92d8c5dec6d8f4afecb1509ca5f43ac1d1b693c9">92d8c5dec6d8f4afecb1509ca5f43ac1d1b693c9</a> should fix that in the docs.</p>



<a name="781535"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781535" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781535">(Aug 21 2019 at 17:38)</a>:</h4>
<p><span class="user-mention" data-user-id="13096">@Tiger</span> an issue for the <code>--no-init-db</code> thing would be helpful; I'm not sure what the cleanest way to fix that is.</p>



<a name="781753"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781753" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781753">(Aug 22 2019 at 02:51)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Thank you Tim! I tried your suggestion/fix, but it failed. So I tried to move <code>zulip::base</code> in front of service e.g. <code>env PUPPET_CLASSES=zulip::base,zulip::postgres_appdb_tuned</code>, it works. So I think the fix may need to be updated accordingly.<br>
I found this description in <a href="https://github.com/zulip/zulip/blob/master/puppet/zulip/manifests/voyager.pp" target="_blank" title="https://github.com/zulip/zulip/blob/master/puppet/zulip/manifests/voyager.pp">the main manifest for the default all-in-one Zulip server</a>: </p>
<blockquote>
<p>In general, every machine should have <code>zulip::base</code> and <code>zulip::apt_repository</code> included, but the various service modules can be arranged on different machines</p>
</blockquote>
<p>what's the <code>zulip::apt_repository</code> for? shall I include it as well for individual service module installation? <br>
Thanks!</p>



<a name="781764"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781764" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781764">(Aug 22 2019 at 04:16)</a>:</h4>
<p><span class="user-mention" data-user-id="13096">@Tiger</span> yes, you probably also want <code>zulip::apt_repository</code> as well.</p>



<a name="781765"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781765" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781765">(Aug 22 2019 at 04:16)</a>:</h4>
<p>I would not expect the ordering to matter, but I suppose it pretty clearly does <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="781768"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781768" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781768">(Aug 22 2019 at 04:18)</a>:</h4>
<p>OK added <a href="https://github.com/zulip/zulip/commit/6041c277a9058fef8ffdc6907391a37622607ac4" target="_blank" title="https://github.com/zulip/zulip/commit/6041c277a9058fef8ffdc6907391a37622607ac4">6041c277a9058fef8ffdc6907391a37622607ac4</a> to address that.</p>



<a name="781803"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781803" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781803">(Aug 22 2019 at 08:21)</a>:</h4>
<p>app_frontend, redis and memcached  can be installed successfully with these 2 additional modules, but postgres still fails with another error as below:</p>
<blockquote>
<p>ALTER ROLE<br>
CREATE DATABASE<br>
You are now connected to database "zulip" as user "postgres".<br>
CREATE SCHEMA<br>
CREATE EXTENSION<br>
ERROR:  could not open extension control file "/usr/share/postgresql/10/extension/pgroonga.control": No such file or directory<br>
ERROR:  schema "pgroonga" does not exist<br>
++ dirname /home/zulip/zulip-server-2.0.4/scripts/setup/postgres-init-db<br>
+ /home/zulip/zulip-server-2.0.4/scripts/setup/flush-memcached<br>
Flushing memcached...</p>
<p>Zulip installation failed!</p>
</blockquote>
<p><a href="/user_uploads/2/44/tFSsFRTpfk5cAqk0VWqQ7pEM/install_postgres_appdb_tuned.log" target="_blank" title="install_postgres_appdb_tuned.log">install_postgres_appdb_tuned.log</a></p>



<a name="781804"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781804" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781804">(Aug 22 2019 at 08:21)</a>:</h4>
<p>We're trying to deploy zulip services in different machines, so I'm trying more other services individual installation with your suggestion.  Hopefully they can work well.</p>



<a name="781808"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781808" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781808">(Aug 22 2019 at 08:52)</a>:</h4>
<p>rabbit and static_asset_compiler still failed with error:</p>
<blockquote>
<p>++ /home/zulip/zulip-server-2.0.4/scripts/setup/../get-django-setting RABBITMQ_USERNAME<br>
Traceback (most recent call last):<br>
  File "/home/zulip/zulip-server-2.0.4/scripts/setup/../get-django-setting", line 12, in &lt;module&gt;<br>
    print(getattr(settings, sys.argv[1]))<br>
  File "/home/zulip/zulip-server-2.0.4/zulip-py3-venv/lib/python3.6/site-packages/django/conf/__init__.py", line 56, in __getattr__<br>
    self._setup(name)<br>
  File "/home/zulip/zulip-server-2.0.4/zulip-py3-venv/lib/python3.6/site-packages/django/conf/__init__.py", line 41, in _setup<br>
    self._wrapped = Settings(settings_module)<br>
  File "/home/zulip/zulip-server-2.0.4/zulip-py3-venv/lib/python3.6/site-packages/django/conf/__init__.py", line 110, in __init__<br>
    mod = importlib.import_module(self.SETTINGS_MODULE)<br>
  File "/usr/lib/python3.6/importlib/__init__.py", line 126, in import_module<br>
    return _bootstrap._gcd_import(name[level:], package, level)<br>
  File "&lt;frozen importlib._bootstrap&gt;", line 994, in _gcd_import<br>
  File "&lt;frozen importlib._bootstrap&gt;", line 971, in _find_and_load<br>
  File "&lt;frozen importlib._bootstrap&gt;", line 955, in _find_and_load_unlocked<br>
  File "&lt;frozen importlib._bootstrap&gt;", line 665, in _load_unlocked<br>
  File "&lt;frozen importlib._bootstrap_external&gt;", line 678, in exec_module<br>
  File "&lt;frozen importlib._bootstrap&gt;", line 219, in _call_with_frames_removed<br>
  File "/home/zulip/zulip-server-2.0.4/zproject/settings.py", line 109, in &lt;module&gt;<br>
    from .prod_settings import *
ModuleNotFoundError: No module named 'zproject.prod_settings'<br>
+ RABBITMQ_USERNAME=</p>
</blockquote>
<p><a href="/user_uploads/2/ce/cePAu4rfe1iFtDaFOhBP7dOs/install.log" target="_blank" title="install.log">install.log</a></p>



<a name="781811"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781811" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781811">(Aug 22 2019 at 09:27)</a>:</h4>
<p>thumbor failed with such errors with such install command:<br>
<code>env PUPPET_CLASSES=zulip::base,zulip::apt_repository,zulip::thumbor ./scripts/setup/install --self-signed-cert --no-init-db --hostname=zulipdepends.com --email=zulip@hcl.com</code><br>
but it can succeed if add <code>zulip::app_frontend</code> as this command, is it a dependency?<br>
<code>env PUPPET_CLASSES=zulip::base,zulip::apt_repository,zulip::app_frontend,zulip::thumbor ./scripts/setup/install --self-signed-cert --no-init-db --hostname=zulipdepends.com --email=zulip@hcl.com</code></p>
<blockquote>
<p>Error: Could not set 'file' on ensure: No such file or directory @ dir_s_mkdir - /etc/nginx/zulip-include/app.d/thumbor.conf20190822-85261-1rrobs7.lock (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/thumbor.pp, line: 16)<br>
Error: Could not set 'file' on ensure: No such file or directory @ dir_s_mkdir - /etc/nginx/zulip-include/app.d/thumbor.conf20190822-85261-1rrobs7.lock (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/thumbor.pp, line: 16)<br>
Wrapped exception:<br>
No such file or directory @ dir_s_mkdir - /etc/nginx/zulip-include/app.d/thumbor.conf20190822-85261-1rrobs7.lock<br>
Error: /Stage[main]/Zulip::Thumbor/File[/etc/nginx/zulip-include/app.d/thumbor.conf]/ensure: change from 'absent' to 'file' failed: Could not set 'file' on ensure: No such file or directory @ dir_s_mkdir - /etc/nginx/zulip-include/app.d/thumbor.conf20190822-85261-1rrobs7.lock (file: /home/zulip/zulip-server-2.0.4/puppet/zulip/manifests/thumbor.pp, line: 16)<br>
Notice: /Stage[main]/Zulip::Nginx/Service[nginx]: Dependency File[/etc/nginx/zulip-include/app.d/thumbor.conf] has failures: true<br>
Warning: /Stage[main]/Zulip::Nginx/Service[nginx]: Skipping because of failed dependencies<br>
Notice: Applied catalog in 54.84 seconds</p>
</blockquote>
<p><a href="/user_uploads/2/ac/volu8DA1XoFNT9wW8WrurQAq/install.log" target="_blank" title="install.log">install.log</a></p>



<a name="781895"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781895" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781895">(Aug 22 2019 at 20:06)</a>:</h4>
<p><span class="user-mention" data-user-id="13096">@Tiger</span> thumbor isn't in production use yet, so that isn't surprising.</p>



<a name="781896"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781896" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781896">(Aug 22 2019 at 20:06)</a>:</h4>
<p>And <code>static_asset_compiler</code> isn't meant to be installed independently.</p>



<a name="781897"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781897" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781897">(Aug 22 2019 at 20:09)</a>:</h4>
<p>BTW, just to check, are you planning to do this to run Zulip in Docker, or something else?  Because Zulip has a docker setup you can use that runs each service in its own container already.</p>



<a name="781978"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781978" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781978">(Aug 23 2019 at 02:32)</a>:</h4>
<p>What's this component of 'static_asset_compiler'? I found this module in the  <a href="https://github.com/zulip/zulip/blob/master/puppet/zulip/manifests/voyager.pp" target="_blank" title="https://github.com/zulip/zulip/blob/master/puppet/zulip/manifests/voyager.pp">the main manifest for the default all-in-one Zulip server</a>, but don't see any instruction in the <a href="https://zulip.readthedocs.io/en/latest/overview/architecture-overview.html#components" target="_blank" title="https://zulip.readthedocs.io/en/latest/overview/architecture-overview.html#components">components</a></p>



<a name="781979"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781979" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781979">(Aug 23 2019 at 02:34)</a>:</h4>
<blockquote>
<p>app_frontend, redis and memcached  can be installed successfully with these 2 additional modules, but postgres still fails with another error as below:</p>
<blockquote>
<p>ALTER ROLE<br>
CREATE DATABASE<br>
You are now connected to database "zulip" as user "postgres".<br>
CREATE SCHEMA<br>
CREATE EXTENSION<br>
ERROR:  could not open extension control file "/usr/share/postgresql/10/extension/pgroonga.control": No such file or directory<br>
ERROR:  schema "pgroonga" does not exist<br>
++ dirname /home/zulip/zulip-server-2.0.4/scripts/setup/postgres-init-db<br>
+ /home/zulip/zulip-server-2.0.4/scripts/setup/flush-memcached<br>
Flushing memcached...</p>
<p>Zulip installation failed!</p>
</blockquote>
<p><a href="/user_uploads/2/44/tFSsFRTpfk5cAqk0VWqQ7pEM/install_postgres_appdb_tuned.log" target="_blank" title="install_postgres_appdb_tuned.log">install_postgres_appdb_tuned.log</a></p>
</blockquote>
<p>what's the cause of this instation error of postgres? Any workaround? Thanks!</p>



<a name="781980"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781980" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781980">(Aug 23 2019 at 02:34)</a>:</h4>
<blockquote>
<p>rabbit and static_asset_compiler still failed with error:</p>
<blockquote>
<p>++ /home/zulip/zulip-server-2.0.4/scripts/setup/../get-django-setting RABBITMQ_USERNAME<br>
Traceback (most recent call last):<br>
  File "/home/zulip/zulip-server-2.0.4/scripts/setup/../get-django-setting", line 12, in &lt;module&gt;<br>
    print(getattr(settings, sys.argv[1]))<br>
  File "/home/zulip/zulip-server-2.0.4/zulip-py3-venv/lib/python3.6/site-packages/django/conf/__init__.py", line 56, in __getattr__<br>
    self._setup(name)<br>
  File "/home/zulip/zulip-server-2.0.4/zulip-py3-venv/lib/python3.6/site-packages/django/conf/__init__.py", line 41, in _setup<br>
    self._wrapped = Settings(settings_module)<br>
  File "/home/zulip/zulip-server-2.0.4/zulip-py3-venv/lib/python3.6/site-packages/django/conf/__init__.py", line 110, in __init__<br>
    mod = importlib.import_module(self.SETTINGS_MODULE)<br>
  File "/usr/lib/python3.6/importlib/__init__.py", line 126, in import_module<br>
    return _bootstrap._gcd_import(name[level:], package, level)<br>
  File "&lt;frozen importlib._bootstrap&gt;", line 994, in _gcd_import<br>
  File "&lt;frozen importlib._bootstrap&gt;", line 971, in _find_and_load<br>
  File "&lt;frozen importlib._bootstrap&gt;", line 955, in _find_and_load_unlocked<br>
  File "&lt;frozen importlib._bootstrap&gt;", line 665, in _load_unlocked<br>
  File "&lt;frozen importlib._bootstrap_external&gt;", line 678, in exec_module<br>
  File "&lt;frozen importlib._bootstrap&gt;", line 219, in _call_with_frames_removed<br>
  File "/home/zulip/zulip-server-2.0.4/zproject/settings.py", line 109, in &lt;module&gt;<br>
    from .prod_settings import *
ModuleNotFoundError: No module named 'zproject.prod_settings'<br>
+ RABBITMQ_USERNAME=</p>
</blockquote>
<p><a href="/user_uploads/2/ce/cePAu4rfe1iFtDaFOhBP7dOs/install.log" target="_blank" title="install.log">install.log</a></p>
</blockquote>
<p>what's the cause of this instation error of rabbit ? Any workaround? Thanks!</p>



<a name="781981"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/781981" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#781981">(Aug 23 2019 at 02:43)</a>:</h4>
<blockquote>
<p>BTW, just to check, are you planning to do this to run Zulip in Docker, or something else?  Because Zulip has a docker setup you can use that runs each service in its own container already.</p>
</blockquote>
<p>For zulip in Docker, its status is still experimental from <a href="https://zulip.readthedocs.io/en/latest/production/deployment.html#zulip-in-docker" target="_blank" title="https://zulip.readthedocs.io/en/latest/production/deployment.html#zulip-in-docker">official doc</a>, is it really ready for production? We are trying to deploy Zulip in kubernates with separate services in different node for high availability and scalability,   where can I get a guide? Thanks!</p>



<a name="782118"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/782118" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#782118">(Aug 23 2019 at 19:08)</a>:</h4>
<p><span class="user-mention" data-user-id="13096">@Tiger</span> you should definitely built on top of <code>docker-zulip</code> over doing this yourself.</p>



<a name="782119"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/782119" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#782119">(Aug 23 2019 at 19:09)</a>:</h4>
<p><code>docker-zulip</code> is experimental in that it's definitely a less pleasant way to deploy Zulip than our standard installation and we're not happy with the current configuration system for it.</p>



<a name="782559"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/782559" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#782559">(Aug 26 2019 at 05:29)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span>  what's your dissatisfactory point? could you please explain more so that we can consider it when make decision of deployment ? Thanks!</p>



<a name="782561"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/782561" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#782561">(Aug 26 2019 at 05:31)</a>:</h4>
<p><span class="user-mention" data-user-id="13096">@Tiger</span> I don't have an easy summary, but it's mostly that folks run into issues getting things working due to misconfiguration (typos, etc.) a lot more.</p>



<a name="782563"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/782563" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tiger <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#782563">(Aug 26 2019 at 05:37)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> Thank you Tim for your quick response <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="804514"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/804514" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luís Correia <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#804514">(Dec 26 2019 at 15:17)</a>:</h4>
<p>Hi, <br>
I'm trying to run rabbitmq on a different machine with <strong>env PUPPET_CLASSES=zulip::base,zulip::apt_repository,zulip::rabbit /usr/local/bin/apps/zulip-server-2.1.1/scripts/setup/install --no-init-db</strong> and got this error:</p>
<p>ImportError: No module named 'zproject.prod_settings'</p>
<ul>
<li>RABBITMQ_USERNAME=</li>
</ul>



<a name="804515"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/804515" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luís Correia <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#804515">(Dec 26 2019 at 15:17)</a>:</h4>
<p>Is there anything I'm doing wrong?</p>



<a name="804577"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/804577" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luís Correia <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#804577">(Dec 27 2019 at 15:20)</a>:</h4>
<p>Anyone guys?</p>



<a name="804748"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/804748" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#804748">(Dec 28 2019 at 20:03)</a>:</h4>
<p><span class="user-mention" data-user-id="14300">@Luís Correia</span> sorry for the slow reply; a lot of folks are inactive over the holidays.</p>



<a name="804749"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Running%20Zulip%E2%80%99s%20service%20dependencies%20on%20different%20machines/near/804749" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Running.20Zulip.E2.80.99s.20service.20dependencies.20on.20different.20machines.html#804749">(Dec 28 2019 at 20:04)</a>:</h4>
<p>RabbitMQ is one of the few services we ourselves don't run on a separate machine except via <code>docker-zulip</code>, so it's possible there's a bug here.  </p>
<p>You'll need to post the full output leading up to the error to get further help, since it's unclear what the actual problem is.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>