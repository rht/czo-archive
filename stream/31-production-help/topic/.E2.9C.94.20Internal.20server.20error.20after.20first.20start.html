<html>
<head><meta charset="utf-8"><title>✔ Internal server error after first start · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html">✔ Internal server error after first start</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1373104"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373104" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373104">(Apr 25 2022 at 19:48)</a>:</h4>
<p>I have this issue I opened on Github <a href="https://github.com/zulip/zulip/issues/21903">https://github.com/zulip/zulip/issues/21903</a> and <span class="user-mention" data-user-id="7">@Tim Abbott</span> told me to come here to discuss about it</p>



<a name="1373113"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373113" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373113">(Apr 25 2022 at 20:01)</a>:</h4>
<p>This topic was moved here from <a class="stream-topic" data-stream-id="9" href="/#narrow/stream/9-issues/topic/Internal.20server.20error.20after.20first.20start">#issues &gt; Internal server error after first start</a> by <span class="user-mention silent" data-user-id="7">Tim Abbott</span>.</p>



<a name="1373114"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373114" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373114">(Apr 25 2022 at 20:02)</a>:</h4>
<p><span class="user-mention" data-user-id="24093">@JackBauer78</span> howdy!  I moved this here, since that'll help it get the attention it deserves.</p>



<a name="1373118"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373118" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373118">(Apr 25 2022 at 20:02)</a>:</h4>
<p>Thank you, I didn't know exactly where to post :)</p>



<a name="1373119"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373119" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373119">(Apr 25 2022 at 20:02)</a>:</h4>
<p><span class="user-mention" data-user-id="24093">@JackBauer78</span> can you paste a bit more expanded output from <code>django.log</code>?  (I assume nothing is making it to <code>errors.log</code>)?</p>



<a name="1373120"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373120" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373120">(Apr 25 2022 at 20:03)</a>:</h4>
<p>Yeah, no problem, a benefit of using Zulip is that it's painless to move things <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="1373133"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373133" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373133">(Apr 25 2022 at 20:09)</a>:</h4>
<p><code>Mon Apr 25 20:07:44 2022 - *** HARAKIRI ON WORKER 1 (pid: 178255, try: 1) ***
Mon Apr 25 20:07:44 2022 - HARAKIRI !!! worker 1 status !!!
Mon Apr 25 20:07:44 2022 - HARAKIRI [core 0] 10.20.0.21 - GET /favicon.ico since 1650917243
Mon Apr 25 20:07:44 2022 - HARAKIRI !!! end of worker 1 status !!!
DAMN ! worker 1 (pid: 178255) died, killed by signal 9 :( trying respawn ...
Respawned uWSGI worker 1 (new pid: 178293)
Mon Apr 25 20:07:53 2022 - *** HARAKIRI ON WORKER 2 (pid: 178193, try: 1) ***
Mon Apr 25 20:07:53 2022 - HARAKIRI !!! worker 2 status !!!
Mon Apr 25 20:07:53 2022 - HARAKIRI [core 0] 10.100.14.200 - HEAD / since 1650917252
Mon Apr 25 20:07:53 2022 - HARAKIRI !!! end of worker 2 status !!!
DAMN ! worker 2 (pid: 178193) died, killed by signal 9 :( trying respawn ...
Respawned uWSGI worker 2 (new pid: 178333)
Mon Apr 25 20:08:08 2022 - *** HARAKIRI ON WORKER 5 (pid: 178258, try: 1) ***
Mon Apr 25 20:08:08 2022 - HARAKIRI !!! worker 5 status !!!
Mon Apr 25 20:08:08 2022 - HARAKIRI [core 0] 10.100.14.200 - HEAD / since 1650917267
Mon Apr 25 20:08:08 2022 - HARAKIRI !!! end of worker 5 status !!!
DAMN ! worker 5 (pid: 178258) died, killed by signal 9 :( trying respawn ...
Respawned uWSGI worker 5 (new pid: 178336)
Mon Apr 25 20:08:23 2022 - *** HARAKIRI ON WORKER 4 (pid: 178154, try: 1) ***
Mon Apr 25 20:08:23 2022 - HARAKIRI !!! worker 4 status !!!
Mon Apr 25 20:08:23 2022 - HARAKIRI [core 0] 10.100.14.200 - HEAD / since 1650917282
Mon Apr 25 20:08:23 2022 - HARAKIRI !!! end of worker 4 status !!!
DAMN ! worker 4 (pid: 178154) died, killed by signal 9 :( trying respawn ...
Respawned uWSGI worker 4 (new pid: 178342)
Mon Apr 25 20:08:25 2022 - *** HARAKIRI ON WORKER 1 (pid: 178293, try: 1) ***
Mon Apr 25 20:08:25 2022 - HARAKIRI !!! worker 1 status !!!
Mon Apr 25 20:08:25 2022 - HARAKIRI [core 0] 10.20.0.21 - GET / since 1650917283
Mon Apr 25 20:08:25 2022 - HARAKIRI !!! end of worker 1 status !!!
DAMN ! worker 1 (pid: 178293) died, killed by signal 9 :( trying respawn ...
Respawned uWSGI worker 1 (new pid: 178345)</code></p>



<a name="1373136"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373136" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373136">(Apr 25 2022 at 20:10)</a>:</h4>
<p>Correct, nothing is on <code>errors.log</code></p>



<a name="1373145"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373145" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373145">(Apr 25 2022 at 20:13)</a>:</h4>
<p>My reverse proxy which is connected to the 443 port of the server tells me that <code>TCP connection successful, but the application timed out</code></p>



<a name="1373149"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373149" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373149">(Apr 25 2022 at 20:15)</a>:</h4>
<p>Seeing <code> HARAKIRI [core 0]</code> makes me wonder if a core file was dumped by <code>uwsgi</code>?</p>



<a name="1373156"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373156" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373156">(Apr 25 2022 at 20:18)</a>:</h4>
<p>How can I check it ?</p>



<a name="1373159"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373159" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373159">(Apr 25 2022 at 20:21)</a>:</h4>
<p><code>signal 9</code> also implies a coredump.</p>



<a name="1373161"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373161" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373161">(Apr 25 2022 at 20:22)</a>:</h4>
<p>Check for a file named <code>core</code> in <code>~zulip/deployments/current</code>?</p>



<a name="1373164"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373164" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373164">(Apr 25 2022 at 20:24)</a>:</h4>
<p>Signal 9 is SIGKILL, which doesn’t typically come with a core dump. It suggests an OOM kill to me. I’d check the kernel logs with <code>dmesg</code> for an “Out of memory: Killed process …” error.</p>



<a name="1373166"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373166" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373166">(Apr 25 2022 at 20:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="12178">Alex Vandiver</span> <a href="#narrow/stream/31-production-help/topic/Internal.20server.20error.20after.20first.20start/near/1373161">said</a>:</p>
<blockquote>
<p>Check for a file named <code>core</code> in <code>~zulip/deployments/current</code>?</p>
</blockquote>
<p>Core file doesn't exists</p>



<a name="1373175"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373175" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373175">(Apr 25 2022 at 20:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="699">Anders Kaseorg</span> <a href="#narrow/stream/31-production-help/topic/Internal.20server.20error.20after.20first.20start/near/1373164">said</a>:</p>
<blockquote>
<p>Signal 9 is SIGKILL, which doesn’t typically come with a core dump. It suggests an OOM kill to me. I’d check the kernel logs with <code>dmesg</code> for an “Out of memory: Killed process …” error.</p>
</blockquote>
<p>This error is absent and nothing happens when I refresh the page</p>



<a name="1373176"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373176" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373176">(Apr 25 2022 at 20:31)</a>:</h4>
<p>Server specs are Debian 11 with Gnome, 4 CPU and 16Go RAM<br>
Same for the PostgreSQL server</p>



<a name="1373185"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373185" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373185">(Apr 25 2022 at 20:41)</a>:</h4>
<p>I did <code>apt update</code> and <code>apt upgrade</code> 2 days ago on both servers so they're up to date</p>



<a name="1373194"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373194" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373194">(Apr 25 2022 at 20:52)</a>:</h4>
<p>So the <code>HARIKARI</code> is because the request took 20s and timed out, so the worker gets killed.  This checks out because thew <code>since 1650917252</code> always shows as ~20s before the timestamp the log is at, and we set <code>harakiri=20</code></p>



<a name="1373195"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373195" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373195">(Apr 25 2022 at 20:52)</a>:</h4>
<p>So the question is why the uwsgi is taking so long to start up</p>



<a name="1373204"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373204" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373204">(Apr 25 2022 at 20:55)</a>:</h4>
<p><span class="user-mention" data-user-id="24093">@JackBauer78</span>: As a test, can you try the following:</p>
<p>As the <code>zulip </code>user:</p>
<div class="codehilite"><pre><span></span><code>cd ~/deployments/current
./manage.py runserver 8888
</code></pre></div>



<a name="1373206"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373206" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373206">(Apr 25 2022 at 20:56)</a>:</h4>
<p>That should look like:</p>
<div class="codehilite"><pre><span></span><code>zulip@example-prod:~/deployments/current$ ./manage.py runserver 8888
Performing system checks...

System check identified no issues (15 silenced).
April 25, 2022 - 20:55:45
Django version 3.2.12, using settings &#39;zproject.settings&#39;
Starting development server at http://127.0.0.1:8888/
Quit the server with CONTROL-C.
</code></pre></div>



<a name="1373209"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373209" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373209">(Apr 25 2022 at 20:57)</a>:</h4>
<p>If that <em>does</em> look like that, then in another window try:</p>
<div class="codehilite"><pre><span></span><code>curl -v http://localhost:8888/
</code></pre></div>



<a name="1373675"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373675" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373675">(Apr 26 2022 at 14:46)</a>:</h4>
<p>I ran <code>./manage.py runserver 8888</code> and I had an error that the server couldn't contact the PostgreSQL server.<br>
Turns out I forgot to open the 5432 port :) and now, I have an error regarding the PostgreSQL certificate :<br>
<code>django.db.utils.OperationalError: connection to server at "zulipbdd" (10.200.51.20), port 5432 failed: root certificate file "/home/zulip/.postgresql/root.crt" does not exist
Either provide the file or change sslmode to disable server certificate verification.</code></p>
<p>It's strange because I added the root certificate to <code>/usr/local/share/ca-certificates/</code> and launched a <code>sudo update-ca-certificates</code><br>
Any idea ?</p>



<a name="1373678"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373678" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373678">(Apr 26 2022 at 14:51)</a>:</h4>
<p>And the <code>.postgresql</code> doesn't exist in <code>/home/zulip</code><br>
Pretty strange...</p>
<p>I configured the ssl_mode to verify-full, so it's logic that the certificate has to be verified</p>



<a name="1373807"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373807" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373807">(Apr 26 2022 at 18:50)</a>:</h4>
<p>Ok, I created the .postgresql and put the root ca as root.crt.</p>
<p>Now, I configured the pg_hba.conf with the scram-sha-256 method and restarted the postgresql service to authorise the IP front server and the django.log displays :<br>
<code>django.db.utils.OperationalError: connection to server at "zulipbdd" (10.200.51.20), port 5432 failed: fe_sendauth: no password supplied</code></p>
<p>When I deployed the front server I launched :<br>
<code>./zulip-server-*/scripts/setup/install --self-signed-cert --email=xxx@yyy --hostname=zzz --no-init-db</code></p>
<p>And for the DB server :<br>
<code>env PUPPET_CLASSES=zulip::profile::postgresql ./scripts/setup/install</code></p>
<p>I saw on the <code>install.log</code> that because I used PUPPET_CLASSES it's not considered as a front-end install, so the PostgreSQL is not configured.<br>
Now I'm searching in the docs to configure the DB from scratch.</p>



<a name="1373872"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373872" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373872">(Apr 26 2022 at 19:48)</a>:</h4>
<p>In the docs, I followed the DB configuration for Amazon RDS and I executed the <code>scripts/setup/create-db.sql</code> which seemed the more appropriate.<br>
Now, when I access the front page, the django.log displays this :<br>
`The above exception was the direct cause of the following exception:</p>
<p>Traceback (most recent call last):<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 47, in inner<br>
    response = get_response(request)<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/utils/deprecation.py", line 116, in __call__<br>
    response = self.process_request(request)<br>
  File "./zerver/middleware.py", line 587, in process_request<br>
    request_notes.realm = get_realm(subdomain)<br>
  File "./zerver/models.py", line 1004, in get_realm<br>
    return Realm.objects.get(string_id=string_id)<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/db/models/manager.py", line 85, in manager_method<br>
    return getattr(self.get_queryset(), name)(*args, **kwargs)<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/db/models/query.py", line 431, in get<br>
    num = len(clone)<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/db/models/query.py", line 262, in __len__<br>
    self._fetch_all()<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/db/models/query.py", line 1324, in _fetch_all<br>
    self._result_cache = list(self._iterable_class(self))<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/db/models/query.py", line 51, in __iter__<br>
    results = compiler.execute_sql(chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size)<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/db/models/sql/compiler.py", line 1175, in execute_sql<br>
    cursor.execute(sql, params)<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/db/backends/utils.py", line 66, in execute<br>
    return self._execute_with_wrappers(sql, params, many=False, executor=self._execute)<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/db/backends/utils.py", line 75, in _execute_with_wrappers<br>
    return executor(sql, params, many, context)<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/db/backends/utils.py", line 84, in _execute<br>
    return self.cursor.execute(sql, params)<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/db/utils.py", line 90, in __exit__<br>
    raise dj_exc_value.with_traceback(traceback) from exc_value<br>
  File "/srv/zulip-venv-cache/e2ea2c72ccf4cb51730289f3971a079641e6b8d0/zulip-py3-venv/lib/python3.9/site-packages/django/db/backends/utils.py", line 84, in _execute<br>
    return self.cursor.execute(sql, params)<br>
  File "./zerver/lib/db.py", line 46, in execute<br>
    wrapper_execute(self, super().execute, query, vars)<br>
  File "./zerver/lib/db.py", line 31, in wrapper_execute<br>
    action(sql, params)<br>
django.db.utils.ProgrammingError: relation "zerver_realm" does not exist<br>
LINE 1: ...source", "zerver_realm"."night_logo_version" FROM "zerver_re...</p>
<p>2022-04-26 19:42:47.377 INFO [zr] 10.20.0.21      GET     500  31ms (db: 1ms/1q) / (unauth@root via Mozilla)<br>
[pid: 46371|app: 0|req: 2/14] 10.20.0.21 () {62 vars in 1132 bytes} [Tue Apr 26 19:42:47 2022] GET / =&gt; generated 11242 bytes in 32 msecs (HTTP/2.0 500) 4 headers in 146 bytes (1 switches on core 0)`</p>



<a name="1373873"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373873" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373873">(Apr 26 2022 at 19:53)</a>:</h4>
<p>And now I'm stuck because I don't understand the error.<br>
Can someone help me configure correctly the PostgreSQL server ?<br>
I can't find all the informations to do it in the docs.</p>
<p>Thanks !</p>



<a name="1373890"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373890" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373890">(Apr 26 2022 at 20:09)</a>:</h4>
<p><span class="user-mention" data-user-id="24093">@JackBauer78</span> see <a href="https://zulip.readthedocs.io/en/latest/production/deployment.html#using-zulip-with-amazon-rds-as-the-database">https://zulip.readthedocs.io/en/latest/production/deployment.html#using-zulip-with-amazon-rds-as-the-database</a>.</p>



<a name="1373911"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1373911" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JackBauer78 <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1373911">(Apr 26 2022 at 20:31)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> I completed the installation with the last 2 scripts and now I can access to the server !<br>
Sometimes, you can't see the obvious because you didn't make a pause for some time...</p>
<p>I think I'm good but if not, I won't hesitate to come here again.</p>
<p>Thank you all for your kind help !</p>



<a name="1374438"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/%E2%9C%94%20Internal%20server%20error%20after%20first%20start/near/1374438" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/.E2.9C.94.20Internal.20server.20error.20after.20first.20start.html#1374438">(Apr 27 2022 at 16:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="24093">JackBauer78</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>