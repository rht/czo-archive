<html>
<head><meta charset="utf-8"><title>failed yarn download · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html">failed yarn download</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="283264"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/283264" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#283264">(Sep 16 2017 at 22:03)</a>:</h4>
<p>just tried to do an update from git from 1.6.0 and it through this error </p>
<div class="codehilite"><pre><span></span>Installing Yarn!
Downloading tarball...
/home/zulip/deployments/2017-09-16-21-53-05/scripts/lib/../../scripts/lib/third/install-yarn.sh: line <span class="m">43</span>: curl: <span class="nb">command</span> not found
&gt; Failed to download https://yarnpkg.com/downloads/0.27.5/yarn-v0.27.5.tar.gz.
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&quot;/home/zulip/deployments/2017-09-16-21-53-05/scripts/lib/upgrade-zulip-stage-2&quot;</span>, line <span class="m">63</span>, in &lt;module&gt;
    deploy_path<span class="o">])</span>
  File <span class="s2">&quot;/usr/lib/python3.5/subprocess.py&quot;</span>, line <span class="m">581</span>, in check_call
    raise CalledProcessError<span class="o">(</span>retcode, cmd<span class="o">)</span>
subprocess.CalledProcessError: Command <span class="s1">&#39;[&#39;</span>/home/zulip/deployments/2017-09-16-21-53-05/scripts/lib/install-node<span class="s1">&#39;, &#39;</span>/home/zulip/deployments/2017-09-16-21-53-05<span class="s1">&#39;]&#39;</span> returned non-zero <span class="nb">exit</span> status <span class="m">1</span>
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&quot;/home/zulip/deployments/current/scripts/upgrade-zulip-from-git&quot;</span>, line <span class="m">81</span>, in &lt;module&gt;
    deploy_path, <span class="s2">&quot;--from-git&quot;</span><span class="o">]</span> + deploy_options<span class="o">)</span>
  File <span class="s2">&quot;/usr/lib/python2.7/subprocess.py&quot;</span>, line <span class="m">541</span>, in check_call
    raise CalledProcessError<span class="o">(</span>retcode, cmd<span class="o">)</span>
subprocess.CalledProcessError: Command <span class="s1">&#39;[&#39;</span>sudo<span class="s1">&#39;, &#39;</span>/home/zulip/deployments/2017-09-16-21-53-05/scripts/lib/upgrade-zulip-stage-2<span class="s1">&#39;, &#39;</span>/home/zulip/deployments/2017-09-16-21-53-05<span class="s1">&#39;, &#39;</span>--from-git<span class="s1">&#39;]&#39;</span> returned non-zero <span class="nb">exit</span> status <span class="m">1</span>
</pre></div>


<p>doing <code>wget https://yarnpkg.com/downloads/0.27.5/yarn-v0.27.5.tar.gz</code> though worked fine</p>
<p>the <code>.</code> at the end of the link is not part of the URL, is it?</p>



<a name="283279"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/283279" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#283279">(Sep 16 2017 at 22:34)</a>:</h4>
<p><span class="user-mention" data-user-email="m.mueller@intercultural-elements.eu" data-user-id="1646">@Matthias</span> I don't think so.  I suspect if you just rerun the install script it'll work; tat looks like a temporary network error.</p>



<a name="283480"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/283480" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#283480">(Sep 17 2017 at 09:31)</a>:</h4>
<p>nope, still failing. <br>
1) can anyone else test this <br>
2) are there manual ways of installing the package and resuming the aborted installation</p>



<a name="283529"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/283529" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#283529">(Sep 17 2017 at 13:30)</a>:</h4>
<p>it looks like my zulip is busted since I tried that update from git...<br>
or at least since I added the option of doing updates from git and then run <code>zulip-puppet-apply</code></p>



<a name="283531"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/283531" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#283531">(Sep 17 2017 at 13:32)</a>:</h4>
<p>I can still run <code>/scripts/restart-server</code> though but the server can't be reached</p>



<a name="283538"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/283538" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#283538">(Sep 17 2017 at 13:46)</a>:</h4>
<p>tried </p>
<div class="codehilite"><pre><span></span>/deployment/LastWorkingInstall/scripts/restart-server
supervisorctl status <span class="o">(</span>all running<span class="o">)</span>
service rabbitmq-server restart
service nginx restart
</pre></div>


<p>but the server is still offline in the browser</p>



<a name="283634"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/283634" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#283634">(Sep 17 2017 at 18:03)</a>:</h4>
<p><span class="user-mention" data-user-email="m.mueller@intercultural-elements.eu" data-user-id="1646">@Matthias</span> can you post a copy of <code>/var/log/zulip/upgrade.log</code> showing what happened?  I suspect those details will be important for debugging.</p>



<a name="283690"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/283690" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#283690">(Sep 17 2017 at 18:57)</a>:</h4>
<p>strange, that file doesn't exist in that location</p>



<a name="284355"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/284355" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#284355">(Sep 19 2017 at 22:23)</a>:</h4>
<div class="codehilite"><pre><span></span>Successfully installed apns2-0.3.0 argon2-cffi-... blablabla ... a very long list... -0.1.7 zulip-0.3.4 zulip-bots-0.3.4
+ sudo chmod -R a+rX /srv/zulip-venv-cache/2728dae9e9eba13777198f53d6ad90a67c884b83/zulip-py3-venv
+ touch /srv/zulip-venv-cache/2728dae9e9eba13777198f53d6ad90a67c884b83/zulip-py3-venv/success-stamp
Using cached Python venv from /srv/zulip-venv-cache/2728dae9e9eba13777198f53d6ad90a67c884b83/zulip-py3-venv
+ sudo ln -nsf /srv/zulip-venv-cache/2728dae9e9eba13777198f53d6ad90a67c884b83/zulip-py3-venv /home/zulip/deployments/2017-09-                                                                                                                                                                                                                              <span class="m">19</span>-22-15-16/zulip-py3-venv
+ ln -nsf zulip-py3-venv /home/zulip/deployments/2017-09-19-22-15-16/zulip-current-venv
Installing Yarn!
Downloading tarball...
/home/zulip/deployments/2017-09-19-22-15-16/scripts/lib/../../scripts/lib/third/install-yarn.sh: line <span class="m">43</span>: curl: <span class="nb">command</span> not f                                                                                                                                                                                                                              ound
&gt; Failed to download https://yarnpkg.com/downloads/0.27.5/yarn-v0.27.5.tar.gz.
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&quot;/home/zulip/deployments/2017-09-19-22-15-16/scripts/lib/upgrade-zulip-stage-2&quot;</span>, line <span class="m">63</span>, in &lt;module&gt;
    deploy_path<span class="o">])</span>
  File <span class="s2">&quot;/usr/lib/python3.5/subprocess.py&quot;</span>, line <span class="m">581</span>, in check_call
    raise CalledProcessError<span class="o">(</span>retcode, cmd<span class="o">)</span>
subprocess.CalledProcessError: Command <span class="s1">&#39;[&#39;</span>/home/zulip/deployments/2017-09-19-22-15-16/scripts/lib/install-node<span class="s1">&#39;, &#39;</span>/home/zulip                                                                                                                                                                                                                              /deployments/2017-09-19-22-15-16<span class="s1">&#39;]&#39;</span> returned non-zero <span class="nb">exit</span> status <span class="m">1</span>
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&quot;/home/zulip/deployments/current/scripts/upgrade-zulip-from-git&quot;</span>, line <span class="m">81</span>, in &lt;module&gt;
    deploy_path, <span class="s2">&quot;--from-git&quot;</span><span class="o">]</span> + deploy_options<span class="o">)</span>
  File <span class="s2">&quot;/usr/lib/python2.7/subprocess.py&quot;</span>, line <span class="m">541</span>, in check_call
    raise CalledProcessError<span class="o">(</span>retcode, cmd<span class="o">)</span>
subprocess.CalledProcessError: Command <span class="s1">&#39;[&#39;</span>sudo<span class="s1">&#39;, &#39;</span>/home/zulip/deployments/2017-09-19-22-15-16/scripts/lib/upgrade-zulip-stage                                                                                                                                                                                                                              -2<span class="s1">&#39;, &#39;</span>/home/zulip/deployments/2017-09-19-22-15-16<span class="s1">&#39;, &#39;</span>--from-git<span class="s1">&#39;]&#39;</span> returned non-zero <span class="nb">exit</span> status <span class="m">1</span>
</pre></div>



<a name="284357"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/284357" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#284357">(Sep 19 2017 at 22:24)</a>:</h4>
<p>after doing it a second time there is still not upgrade.log file present and I still get this error.</p>



<a name="284363"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/284363" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#284363">(Sep 19 2017 at 22:25)</a>:</h4>
<p>btw isn't yarn already at version 1.x.xx?</p>



<a name="284370"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/284370" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Harshit Bansal <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#284370">(Sep 19 2017 at 22:27)</a>:</h4>
<p><span class="user-mention" data-user-email="m.mueller@intercultural-elements.eu" data-user-id="1646">@Matthias</span> You are missing curl. You can install it using: <code>sudo apt-get install curl</code>. That should solve this issue I think.</p>



<a name="284444"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/284444" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#284444">(Sep 20 2017 at 02:12)</a>:</h4>
<p><span class="user-mention" data-user-email="m.mueller@intercultural-elements.eu" data-user-id="1646">@Matthias</span> did that turn out to be the issue?</p>



<a name="284445"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/284445" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#284445">(Sep 20 2017 at 02:13)</a>:</h4>
<p>If so, we should add <code>curl</code> as a dependency to <code>zulip_base.pp</code>.</p>



<a name="284448"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/284448" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#284448">(Sep 20 2017 at 02:15)</a>:</h4>
<p>Yeah, that's clearly a bug.  I just merged a fixed, adding <code>curl</code> to the dependencies.</p>



<a name="284449"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/284449" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#284449">(Sep 20 2017 at 02:16)</a>:</h4>
<p>Thanks for reporting this <span class="user-mention" data-user-email="m.mueller@intercultural-elements.eu" data-user-id="1646">@Matthias</span> and for the help debugging <span class="user-mention" data-user-email="harshitbansal2015@gmail.com" data-user-id="907">@Harshit Bansal</span>!</p>



<a name="284502"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/284502" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthias <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#284502">(Sep 20 2017 at 05:16)</a>:</h4>
<p>man, nice spot. that fix it!</p>



<a name="640422"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/failed%20yarn%20download/near/640422" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> xiaotian xu <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/failed.20yarn.20download.html#640422">(Aug 31 2018 at 07:16)</a>:</h4>
<p>I met this problem too,and the way install curl fixed it!</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>