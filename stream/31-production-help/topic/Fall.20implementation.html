<html>
<head><meta charset="utf-8"><title>Fall implementation · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Fall.20implementation.html">Fall implementation</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="246334"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Fall%20implementation/near/246334" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Fall.20implementation.html#246334">(Jul 08 2017 at 16:05)</a>:</h4>
<p>Hello <span class="user-mention" data-user-email="zulip@feorlen.org" data-user-id="397">@Andrea  Longo</span> , <span class="user-mention" data-user-email="*" data-user-id="*">@all</span> </p>
<p>I can not make Zulip work, I fall into the registration process.</p>
<p>The error I have is that at the time of placing the organization in zulip, I get the mail (smtp is ok), but when I click on the link that arrives in the mail zulip falls and will not let me continue the process of registry.</p>
<p>Error:<br>
Well oops. This one's probably our fault. Sorry about that!</p>
<p>If you'd like, you can drop us a line to let us know what happened.</p>
<p>The step-by-step are:</p>
<p>#Installation of Zulip 08/07<br>
hostname: comunicaciones </p>
<p>sudo apt-get update -y<br>
sudo apt-get upgrade -y<br>
sudo shutdown -r now<br>
sudo apt-get install python-dev python-pip openssl nano vim wget -y<br>
sudo apt-get install openssl -y<br>
sudo openssl genrsa -des3 -passout pass:x -out zulip.pass.key 4096<br>
sudo openssl rsa -passin pass:x -in zulip.pass.key -out /etc/ssl/private/zulip.key<br>
sudo rm -rf zulip.pass.key<br>
sudo openssl req -new -key /etc/ssl/private/zulip.key -out zulip.csr<br>
sudo openssl x509 -req -days 365 -in zulip.csr -signkey /etc/ssl/private/zulip.key -out /etc/ssl/certs/zulip.combined-chain.crt<br>
sudo shutdown -r now<br>
wget <a href="https://www.zulip.org/dist/releases/zulip-server-latest.tar.gz" target="_blank" title="https://www.zulip.org/dist/releases/zulip-server-latest.tar.gz">https://www.zulip.org/dist/releases/zulip-server-latest.tar.gz</a><br>
tar -xvzf zulip-server-latest.tar.gz<br>
cd zulip-server-1.6.0<br>
sudo ./scripts/setup/install<br>
vi /etc/zulip/settings.py (Smtp gmail test set up)<br>
vi /etc/zulip/zulip-secrets.conf <br>
    email_password = xxxxxx<br>
    email_host_password = xxxxxx<br>
su zulip -c /home/zulip/deployments/current/scripts/setup/initialize-database<br>
su zulip -c /home/zulip/deployments/current/scripts/restart-server<br>
su zulip<br>
/home/zulip/deployments/current/manage.py generate_realm_creation_link</p>
<p>background:</p>
<p>process-fts-updates                           RUNNING   pid 45296, uptime 0:17:38<br>
zulip-django                                  RUNNING   pid 46294, uptime 0:14:46<br>
zulip-senders:zulip_events_message_sender-0   RUNNING   pid 46303, uptime 0:14:45<br>
zulip-senders:zulip_events_message_sender-1   RUNNING   pid 46304, uptime 0:14:45<br>
zulip-senders:zulip_events_message_sender-2   RUNNING   pid 46305, uptime 0:14:45<br>
zulip-senders:zulip_events_message_sender-3   RUNNING   pid 46306, uptime 0:14:45<br>
zulip-senders:zulip_events_message_sender-4   RUNNING   pid 46307, uptime 0:14:45<br>
zulip-tornado                                 RUNNING   pid 46287, uptime 0:14:48<br>
zulip-workers:zulip_deliver_enqueued_emails   RUNNING   pid 46336, uptime 0:14:43<br>
zulip-workers:zulip_events                    RUNNING   pid 46335, uptime 0:14:43</p>
<p>LogServer</p>
<p>/var/log/zulip/server.log</p>
<p>2017-07-08 15:40:24,881 INFO     Tornado loaded 0 event queues in 0.000s<br>
2017-07-08 15:40:24,881 INFO     Tornado   0.0% busy over the past  0.0 seconds<br>
2017-07-08 15:40:30,356 INFO     Tornado   0.2% busy over the past  5.5 seconds<br>
2017-07-08 15:40:35,357 INFO     Tornado   0.1% busy over the past 10.5 seconds<br>
2017-07-08 15:40:40,357 INFO     Tornado   0.1% busy over the past 15.5 seconds<br>
2017-07-08 15:40:44,251 INFO     Succesfully populated huddle cache!  Consumed 1 remote cache queries (0.0 time)<br>
2017-07-08 15:40:44,254 INFO     Succesfully populated stream cache!  Consumed 1 remote cache queries (0.0 time)<br>
2017-07-08 15:40:44,255 INFO     Succesfully populated client cache!  Consumed 1 remote cache queries (0.0 time)<br>
2017-07-08 15:40:44,261 INFO     Succesfully populated session cache!  Consumed 1 remote cache queries (0.0 time)<br>
2017-07-08 15:40:44,271 INFO     Succesfully populated user cache!  Consumed 1 remote cache queries (0.01 time)<br>
2017-07-08 15:40:44,275 INFO     Succesfully populated recipient cache!  Consumed 1 remote cache queries (0.0 time)<br>
2017-07-08 15:40:46,356 INFO     Tornado   0.1% busy over the past 21.5 seconds<br>
2017-07-08 15:40:47,369 INFO     Tornado dumped 0 event queues in 0.000s<br>
2017-07-08 15:40:48,498 INFO     Tornado loaded 0 event queues in 0.000s<br>
2017-07-08 15:40:48,499 INFO     Tornado   0.0% busy over the past  0.0 seconds<br>
2017-07-08 15:40:54,276 INFO     Tornado   0.1% busy over the past  5.8 seconds<br>
2017-07-08 15:41:00,276 INFO     Tornado   0.0% busy over the past 11.8 seconds<br>
2017-07-08 15:41:05,276 INFO     Tornado   0.0% busy over the past 16.8 seconds<br>
2017-07-08 15:41:11,275 INFO     Tornado   0.1% busy over the past 22.8 seconds<br>
2017-07-08 15:41:16,276 INFO     Tornado   0.0% busy over the past 27.8 seconds<br>
2017-07-08 15:41:22,276 INFO     Tornado   0.1% busy over the past 33.8 seconds<br>
2017-07-08 15:41:27,276 INFO     Tornado   0.0% busy over the past 38.8 seconds<br>
2017-07-08 15:41:32,276 INFO     Tornado   0.1% busy over the past 43.8 seconds<br>
2017-07-08 15:41:38,276 INFO     Tornado   0.1% busy over the past 49.8 seconds<br>
2017-07-08 15:41:44,276 INFO     Tornado   0.1% busy over the past 55.8 seconds<br>
2017-07-08 15:41:49,276 INFO     Tornado   0.0% busy over the past 59.0 seconds<br>
2017-07-08 15:41:54,276 INFO     Tornado   0.0% busy over the past 60.0 seconds<br>
2017-07-08 15:42:00,276 INFO     Tornado   0.0% busy over the past 60.0 seconds<br>
2017-07-08 15:42:05,276 INFO     Tornado   0.0% busy over the past 60.0 seconds<br>
2017-07-08 15:42:11,276 INFO     Tornado   0.0% busy over the past 60.0 seconds<br>
2017-07-08 15:42:17,276 INFO     Tornado   0.0% busy over the past 59.0 seconds<br>
2017-07-08 15:42:23,276 INFO     Tornado   0.0% busy over the past 60.0 seconds<br>
2017-07-08 15:42:29,275 INFO     Tornado   0.0% busy over the past 60.0 seconds<br>
2017-07-08 15:42:34,275 INFO     Tornado   0.0% busy over the past 60.0 seconds<br>
2017-07-08 15:42:39,277 INFO     Tornado   0.0% busy over the past 59.0 seconds<br>
2017-07-08 15:42:45,276 INFO     Tornado   0.0% busy over the past 60.0 seconds<br>
2017-07-08 15:42:51,276 INFO     Tornado   0.0% busy over the past 60.0 seconds<br>
2017-07-08 15:42:57,276 INFO     Tornado   0.0% busy over the past 60.0 seconds<br>
2017-07-08 15:43:02,276 INFO     Tornado   0.0% busy over the past 59.0 seconds<br>
2017-07-08 15:43:08,277 INFO     Tornado   0.0% busy over the past 59.0 seconds<br>
2017-07-08 15:43:08,576 INFO     Succesfully populated huddle cache!  Consumed 1 remote cache queries (0.0 time)<br>
2017-07-08 15:43:08,579 INFO     Succesfully populated stream cache!  Consumed 1 remote cache queries (0.0 time)<br>
2017-07-08 15:43:08,580 INFO     Succesfully populated client cache!  Consumed 1 remote cache queries (0.0 time)<br>
2017-07-08 15:43:08,581 INFO     Succesfully populated session cache!  Consumed 1 remote cache queries (0.0 time)<br>
2017-07-08 15:43:08,591 INFO     Succesfully populated user cache!  Consumed 1 remote cache queries (0.01 time)<br>
2017-07-08 15:43:08,594 INFO     Succesfully populated recipient cache!  Consumed 1 remote cache queries (0.0 time)<br>
2017-07-08 15:43:11,959 INFO     Tornado dumped 0 event queues in 0.000s<br>
2017-07-08 15:43:13,077 INFO     Tornado loaded 0 event queues in 0.000s<br>
2017-07-08 15:43:13,077 INFO     Tornado   0.0% busy over the past  0.0 seconds</p>



<a name="246335"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Fall%20implementation/near/246335" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Fall.20implementation.html#246335">(Jul 08 2017 at 16:06)</a>:</h4>
<p>More:</p>
<p>Error generated by Anonymous user (not logged in) on comunicaciones deployment</p>
<p>Traceback (most recent call last):<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django/core/handlers/exception.py", line 42, in inner<br>
    response = get_response(request)<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py", line 249, in _legacy_get_response<br>
    response = self._get_response(request)<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py", line 187, in _get_response<br>
    response = self.process_exception_by_middleware(e, request)<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django/core/handlers/base.py", line 185, in _get_response<br>
    response = wrapped_callback(request, *callback_args, **callback_kwargs)<br>
  File "./zerver/decorator.py", line 118, in wrapper<br>
    return func(request, *args, **kwargs)<br>
  File "./zerver/views/registration.py", line 143, in accounts_register<br>
    ldap_attrs = _LDAPUser(backend, backend.django_to_ldap_username(email)).attrs<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django_auth_ldap/backend.py", line 423, in _get_user_attrs<br>
    self._load_user_attrs()<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django_auth_ldap/backend.py", line 463, in _load_user_attrs<br>
    if self.dn is not None:<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django_auth_ldap/backend.py", line 416, in _get_user_dn<br>
    self._load_user_dn()<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django_auth_ldap/backend.py", line 479, in _load_user_dn<br>
    self._search_for_user_dn()<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django_auth_ldap/backend.py", line 499, in _search_for_user_dn<br>
    results = search.execute(self.connection, {'user': self._username})<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django_auth_ldap/backend.py", line 438, in _get_bound_connection<br>
    self._bind()<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django_auth_ldap/backend.py", line 723, in _bind<br>
    sticky=True)<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/django_auth_ldap/backend.py", line 735, in _bind_as<br>
    force_str(bind_password))<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/ldap/ldapobject.py", line 222, in simple_bind_s<br>
    msgid = self.simple_bind(who,cred,serverctrls,clientctrls)<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/ldap/ldapobject.py", line 216, in simple_bind<br>
    return self._ldap_call(self._l.simple_bind,who,cred,RequestControlTuples(serverctrls),RequestControlTuples(clientctrls))<br>
  File "/home/zulip/deployments/2017-07-08-11-31-43/zulip-venv/lib/python2.7/site-packages/ldap/ldapobject.py", line 106, in _ldap_call<br>
    result = func(<em>args,</em>*kwargs)<br>
SERVER_DOWN: {'desc': "Can't contact LDAP server"}</p>
<p>Request info:<br>
- path: /accounts/register/<br>
- POST: {u'full_name': [u''], u'csrfmiddlewaretoken': [u'<strong>*</strong><strong>*</strong>'], u'from_confirmation': [u'1'], u'key': [u'<strong>*</strong><strong>*</strong>']}<br>
- REMOTE_ADDR: "[u'192.168.80.1']"<br>
- QUERY_STRING: "[u'']"<br>
- SERVER_NAME: "[u'']"</p>



<a name="246338"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Fall%20implementation/near/246338" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Fall.20implementation.html#246338">(Jul 08 2017 at 16:10)</a>:</h4>
<p><a href="/user_uploads/2/26/sm2dz05kpmo88AG6vl85mhXs/Error_zulip2.png" target="_blank" title="Error_zulip2.png">Error_zulip2.png</a> <a href="/user_uploads/2/37/mpFQKAepx5MS0vJaE9WP1ydB/Error_zulip1.png" target="_blank" title="Error_zulip1.png">Error_zulip1.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/26/sm2dz05kpmo88AG6vl85mhXs/Error_zulip2.png" target="_blank" title="Error_zulip2.png"><img src="/user_uploads/2/26/sm2dz05kpmo88AG6vl85mhXs/Error_zulip2.png"></a></div><div class="message_inline_image"><a href="/user_uploads/2/37/mpFQKAepx5MS0vJaE9WP1ydB/Error_zulip1.png" target="_blank" title="Error_zulip1.png"><img src="/user_uploads/2/37/mpFQKAepx5MS0vJaE9WP1ydB/Error_zulip1.png"></a></div>



<a name="246339"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Fall%20implementation/near/246339" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rein Zustand <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Fall.20implementation.html#246339">(Jul 08 2017 at 16:13)</a>:</h4>
<blockquote>
<p>SERVER_DOWN: {'desc': "Can't contact LDAP server"}</p>
</blockquote>
<p>It looks like you have <code>zproject.backends.ZulipLDAPAuthBackend</code> enabled. If you haven't set this up yet, you can comment it out, with <code>zproject.backends.EmailAuthBackend</code> remaining.</p>



<a name="246355"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Fall%20implementation/near/246355" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Fall.20implementation.html#246355">(Jul 08 2017 at 16:38)</a>:</h4>
<blockquote>
<blockquote>
<p>SERVER_DOWN: {'desc': "Can't contact LDAP server"}</p>
</blockquote>
<p>It looks like you have <code>zproject.backends.ZulipLDAPAuthBackend</code> enabled. If you haven't set this up yet, you can comment it out, with <code>zproject.backends.EmailAuthBackend</code> remaining.</p>
</blockquote>
<p>Thank you, I will review</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>