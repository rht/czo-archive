<html>
<head><meta charset="utf-8"><title>upgrade to 5.3 · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html">upgrade to 5.3</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="1394981"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1394981" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Fangohr <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1394981">(Jun 22 2022 at 08:06)</a>:</h4>
<p>After the update to 5.3, the reported installed version is <code>5.2-51-g3c7fdf8a82</code> (both via <code>SERVERURL//api/v1/server_settings</code> and via <code>Settings Cog -&gt; About Zulip</code> from the web interface).</p>
<p>Should I be worried?</p>



<a name="1394982"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1394982" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Fangohr <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1394982">(Jun 22 2022 at 08:08)</a>:</h4>
<p>More details:</p>
<ul>
<li>
<p>I followed instructions on <a href="https://zulip.readthedocs.io/en/stable/production/upgrade-or-modify.html#upgrading-to-a-release">https://zulip.readthedocs.io/en/stable/production/upgrade-or-modify.html#upgrading-to-a-release</a>, run this command to download the latest server (<code>curl -fLO https://download.zulip.com/server/zulip-server-latest.tar.gz</code>) followed by (<code>/home/zulip/deployments/current/scripts/upgrade-zulip zulip-server-latest.tar.gz</code>). This runs through fine. The confusion arises when I check the version of the upgraded server:</p>
</li>
<li>
<p>I am upgrading from <code>5.2</code>.</p>
</li>
<li>
<p>The tarball, when unpacked, creates a directory <code>zulip-server-5.3</code>. In that directory, there is a <code>version</code> file, containining <code>5.3</code>. </p>
</li>
<li>
<p>When grepping for the displayed version number, I find that it is stored in <code>zulip-server-5.3/zulip-git-version</code>: </p>
</li>
</ul>
<div class="codehilite"><pre><span></span><code>cat zulip-server-5.3/zulip-git-version
5.2-51-g3c7fdf8a82
5.2-49-g9d3fb85897
</code></pre></div>
<ul>
<li>More detailed output from <code>SERVERURL//api/v1/server_settings</code>: </li>
</ul>
<div class="codehilite"><pre><span></span><code>{&quot;result&quot;:&quot;success&quot;,&quot;msg&quot;:&quot;&quot;,&quot;authentication_methods&quot;:
  { ... },
&quot;zulip_version&quot;:&quot;5.2-51-g3c7fdf8a82&quot;,
&quot;zulip_merge_base&quot;:&quot;5.2-49-g9d3fb85897&quot;,
&quot;zulip_feature_level&quot;:122,
&quot;push_notifications_enabled&quot;:true,
... ...}
</code></pre></div>



<a name="1395026"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395026" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395026">(Jun 22 2022 at 11:46)</a>:</h4>
<p>There was a misstep in the release process, and the minor version wasn't incremented at the correct point. You are all set. <span class="user-mention" data-user-id="16098">@Hans Fangohr</span></p>



<a name="1395031"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395031" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Fangohr <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395031">(Jun 22 2022 at 12:02)</a>:</h4>
<p>Okay, thanks.</p>



<a name="1395040"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395040" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Donny Winston <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395040">(Jun 22 2022 at 14:25)</a>:</h4>
<p>I logged in as root and ran <code>curl -fLO https://download.zulip.com/server/zulip-server-latest.tar.gz</code> and then <code>/home/zulip/deployments/current/scripts/upgrade-zulip zulip-server-latest.tar.gz</code> as per &lt;<a href="https://zulip.readthedocs.io/en/stable/production/upgrade-or-modify.html#upgrading-to-a-release">https://zulip.readthedocs.io/en/stable/production/upgrade-or-modify.html#upgrading-to-a-release</a>&gt;.</p>
<p>I get this error:</p>
<div class="codehilite"><pre><span></span><code>The following packages will be DOWNGRADED:
  postgresql-13
39 upgraded, 7 newly installed, 1 downgraded, 0 to remove and 0 not upgraded.
3 standard security updates
E: Packages were downgraded and -y was used without --allow-downgrades.
Traceback (most recent call last):
  File &quot;/home/zulip/deployments/2022-06-22-14-23-28/scripts/lib/upgrade-zulip-stage-2&quot;, line 231, in &lt;module&gt;
    subprocess.check_call([&quot;apt-get&quot;, &quot;-y&quot;, &quot;--with-new-pkgs&quot;, &quot;upgrade&quot;])
  File &quot;/usr/lib/python3.8/subprocess.py&quot;, line 364, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command &#39;[&#39;apt-get&#39;, &#39;-y&#39;, &#39;--with-new-pkgs&#39;, &#39;upgrade&#39;]&#39; returned non-zero exit status 100.

Zulip upgrade failed (exit code 1)!
</code></pre></div>
<p>I'd like to confirm that I should run <code>apt-get -y --with-new-pkgs --allow-downgrades upgrade</code> here and then try again.</p>



<a name="1395043"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395043" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Donny Winston <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395043">(Jun 22 2022 at 14:28)</a>:</h4>
<p>I am currently running 5.2 without issue via the digital ocean droplet &lt;<a href="https://marketplace.digitalocean.com/apps/zulip">https://marketplace.digitalocean.com/apps/zulip</a>&gt;.</p>



<a name="1395057"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395057" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395057">(Jun 22 2022 at 16:03)</a>:</h4>
<p><span class="user-mention" data-user-id="19442">@Donny Winston</span>: Can you show the output of <code>apt-cache policy postgresql-13</code>?</p>



<a name="1395059"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395059" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Donny Winston <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395059">(Jun 22 2022 at 16:07)</a>:</h4>
<p><span class="user-mention" data-user-id="12178">@Alex Vandiver</span> </p>
<div class="codehilite"><pre><span></span><code>postgresql-13:
  Installed: 13.6-1.pgdg18.04+1
  Candidate: 13.5-2.pgdg20.04+1
  Version table:
     13.7-1.pgdg20.04+1 500
        500 http://apt.postgresql.org/pub/repos/apt focal-pgdg/main amd64 Packages
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13.6-1.pgdg20.04+1+b1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13.6-1.pgdg20.04+1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
 *** 13.6-1.pgdg18.04+1 100
        100 /var/lib/dpkg/status
     13.5-2.pgdg20.04+1 1000
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13.5-1.pgdg20.04+1 1000
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13.4-4.pgdg20.04+1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13.4-1.pgdg20.04+1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13.3-1.pgdg20.04+1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13.2-1.pgdg20.04+1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13.1-1.pgdg20.04+1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13.0-1.pgdg20.04+1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13~rc1-1.pgdg20.04+1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13~beta3-1.pgdg20.04+1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13~beta2-1.pgdg20.04+1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
     13~beta1-1.pgdg20.04+1 500
        500 http://apt-archive.postgresql.org/pub/repos/apt focal-pgdg-archive/main amd64 Packages
</code></pre></div>



<a name="1395062"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395062" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395062">(Jun 22 2022 at 16:12)</a>:</h4>
<p>What's your <code>lsb_release -a</code>?</p>



<a name="1395064"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395064" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395064">(Jun 22 2022 at 16:15)</a>:</h4>
<p>And I think it'd be helpful to see the upgrade logs up to the point it failed.</p>
<p>On 5.2, we had a pin, and switched to the <code>apt-archive.postgresql.org</code> to prevent upgrades to versions of PostgreSQL that were incompatible with pgroonga.  But we do not expect 5.3 to do any downgrades.</p>



<a name="1395065"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395065" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395065">(Jun 22 2022 at 16:15)</a>:</h4>
<p><span class="user-mention" data-user-id="699">@Anders Kaseorg</span>: Any thoughts?</p>



<a name="1395066"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395066" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395066">(Jun 22 2022 at 16:17)</a>:</h4>
<p>Well, that first <code>apt-get upgrade</code> happens before the <code>zulip-puppet-apply</code> that would remove the pin, so it’s still in place at that time. I wouldn’t have expected that to lead to a failure, though.</p>



<a name="1395067"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395067" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395067">(Jun 22 2022 at 16:18)</a>:</h4>
<p>I don't know if the 18.04 vs 20.04 is a red herring, but that looks weird to me.</p>



<a name="1395068"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395068" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395068">(Jun 22 2022 at 16:19)</a>:</h4>
<p>That does look weird, as does the fact that 13.6-1.pgdg18.04+1 is only available locally and not in APT.</p>



<a name="1395070"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395070" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395070">(Jun 22 2022 at 16:20)</a>:</h4>
<p>For that matter, why is it 13?</p>



<a name="1395071"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395071" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395071">(Jun 22 2022 at 16:20)</a>:</h4>
<p>Default is 12 on Ubuntu 20.04 and 14 on Ubuntu 22.04.</p>



<a name="1395084"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395084" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Donny Winston <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395084">(Jun 22 2022 at 17:31)</a>:</h4>
<p><code>lsb_release -a</code>:</p>
<div class="codehilite"><pre><span></span><code>No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 20.04.4 LTS
Release:    20.04
Codename:   focal
</code></pre></div>



<a name="1395087"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395087" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395087">(Jun 22 2022 at 17:33)</a>:</h4>
<p>Did you explicitly <a href="https://zulip.readthedocs.io/en/latest/production/upgrade-or-modify.html#upgrading-postgresql">upgrade to PostgreSQL 13</a> at some point?</p>



<a name="1395088"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395088" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Donny Winston <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395088">(Jun 22 2022 at 17:35)</a>:</h4>
<p>I started with a pre-5.0 ubuntu 18.04 offering of a zulip "app" on the Digital Ocean marketplace. IIRC I followed Zulip docs to upgrade to 20.04 and then upgraded to 5.0.</p>



<a name="1395089"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395089" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395089">(Jun 22 2022 at 17:36)</a>:</h4>
<p><span class="user-mention" data-user-id="699">@Anders Kaseorg</span>: I think we installed 13 from <a href="https://github.com/zulip/zulip/commit/ae2c377d13ac23c9e72a6f11b61b6e64e76b5947">ae2c377d13ac23c9e72a6f11b61b6e64e76b5947</a> to <a href="https://github.com/zulip/zulip/commit/544e8c569e8ffb788d70119e5834d42134524b42">544e8c569e8ffb788d70119e5834d42134524b42</a></p>



<a name="1395091"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395091" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Donny Winston <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395091">(Jun 22 2022 at 17:37)</a>:</h4>
<p>re: explicitly upgrading postgres, I don't recall, but I may have in direct response to some kind of error, in an attempt to remedy, but not electively.</p>



<a name="1395092"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395092" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Donny Winston <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395092">(Jun 22 2022 at 17:38)</a>:</h4>
<p><span class="user-mention" data-user-id="12178">@Alex Vandiver</span> do you think following &lt;<a href="https://zulip.readthedocs.io/en/latest/production/upgrade-or-modify.html#upgrading-postgresql">https://zulip.readthedocs.io/en/latest/production/upgrade-or-modify.html#upgrading-postgresql</a>&gt; to get to postgres 14 and then re-running the 5.3 installer will do the trick?</p>



<a name="1395093"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395093" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395093">(Jun 22 2022 at 17:39)</a>:</h4>
<p>That seems likely to work.</p>



<a name="1395094"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395094" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395094">(Jun 22 2022 at 17:40)</a>:</h4>
<p>But to be clear, none of the steps you've mentioned so far is all that weird, hence all of our questions trying to figure out if this is going to bite other folks.</p>



<a name="1395101"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395101" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Donny Winston <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395101">(Jun 22 2022 at 17:50)</a>:</h4>
<p>cool, it did work to upgrade postgres using that procedure and then run the upgrade process as normal. I do see what <span class="user-mention" data-user-id="16098">@Hans Fangohr</span> saw wrt. it not identifying as  "5.3":</p>
<p><a href="/user_uploads/2/e9/juLyhCo2z3BCsdDdtwl_RTxz/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/e9/juLyhCo2z3BCsdDdtwl_RTxz/image.png" title="image.png"><img src="/user_uploads/2/e9/juLyhCo2z3BCsdDdtwl_RTxz/image.png"></a></div>



<a name="1395102"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395102" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395102">(Jun 22 2022 at 17:53)</a>:</h4>
<p>Yes, that's expected for all 5.3 installs, because the tag was made after the tarball was, effectively.  But it's the right commit, as one can verify with:</p>
<div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="gp">$ </span>git rev-parse <span class="m">5</span>.3
<span class="go">3c7fdf8a82004627afb21185a2066f18522273bb</span>
</code></pre></div>
<p>...which matches the <code>-g3c7fdf8a82</code> on the identifier.</p>



<a name="1395103"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395103" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395103">(Jun 22 2022 at 17:53)</a>:</h4>
<p>And the "forked from upstream" is because of the security commit being private when we rolled the release.</p>



<a name="1395143"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395143" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395143">(Jun 22 2022 at 19:14)</a>:</h4>
<p>We should probably add an end-to-end check in <code>build-release-tarball</code> that if you used a tag to generate the release, the contents of the version file match the tag that one requested.</p>



<a name="1395146"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395146" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395146">(Jun 22 2022 at 19:20)</a>:</h4>
<p>What does "used a tag to generate the release" mean?  That's not really a concept the tool has currently.</p>
<p><a href="https://github.com/zulip/zulip/pull/22280">#22280</a> makes it make the tag right before building the tarball.  We can double-check that the tag matches the cached file, but I don't see any way it won't, if it made the tag.</p>



<a name="1395147"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395147" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395147">(Jun 22 2022 at 19:21)</a>:</h4>
<p>Well, I'd been imagining checking the format of the name you provided -- if it's <code>[0-9][.][0-9]</code>, that's likely an official release.</p>



<a name="1395149"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395149" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395149">(Jun 22 2022 at 19:22)</a>:</h4>
<p>What I had in mind for the check is checking that the <code>zulip-git-version</code> file does not have a format with <code>-</code>s in it, like it does when building off a fork:</p>
<div class="codehilite"><pre><span></span><code>$ cat zulip-git-version
6.0-dev-585-gae1bc33d2c
6.0-dev-582-gacfa55138e
</code></pre></div>



<a name="1395150"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395150" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395150">(Jun 22 2022 at 19:22)</a>:</h4>
<p>So perhaps "If there's no <code>-</code> in the version specified on the command line, there's no dash in <code>zulip-git-version</code>", would be a version of this check that would have caught this bug.</p>



<a name="1395151"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395151" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395151">(Jun 22 2022 at 19:24)</a>:</h4>
<p>But wouldn't catch <code>zulip-server-5.0-rc1</code>.</p>
<p>We should make it impossible to do this wrong, not rely on heuristics.</p>



<a name="1395157"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395157" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395157">(Jun 22 2022 at 19:26)</a>:</h4>
<p>It also wouldn’t catch, you know, <code>4.11</code>.</p>



<a name="1395159"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395159" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395159">(Jun 22 2022 at 19:27)</a>:</h4>
<p>That's a one-character fix, but yes. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>
<p>My intent with <a href="https://github.com/zulip/zulip/pull/22280">#22280</a> was to remove any manual <code>git tag</code> step -- making it happen as part of the tarball build means there's no space between those steps to reorder them or have them point to different places.  Which seems like it solves the problem without having to pattern-match on anything.</p>



<a name="1395160"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395160" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395160">(Jun 22 2022 at 19:28)</a>:</h4>
<p>Well, we can do both -- this isn't the first time we've had a bug in the tooling result a version string like this, and we fixed the previous issue too. (The previous one had to do with the version caching script having a bug in its output, IIRC).</p>



<a name="1395161"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395161" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395161">(Jun 22 2022 at 19:29)</a>:</h4>
<p>So I think it's not unwarranted to add some sort of assertion in addition to trying to eliminate the failure mode; I'm not particular about the details.</p>



<a name="1395166"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395166" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395166">(Jun 22 2022 at 19:33)</a>:</h4>
<p>Are you referring to the bug where we weren’t fetching tags from zulip/zulip before computing the version in <code>upgrade-zulip-from-git</code>? An assertion in <code>build-release-tarball</code> wouldn’t have helped there.</p>



<a name="1395168"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395168" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395168">(Jun 22 2022 at 19:35)</a>:</h4>
<p>I think we had another one too, but in some sense it doesn't matter. If others don't think an added assertion is useful, I won't insist on it, but I generally think when we have a class of error that has some permanent harm (in this case, a release that confusingly describes its version), it's generally good to have an independent test or assertion for it, even if we think that we've designed the workflow in a way that prevents it.</p>



<a name="1395183"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395183" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395183">(Jun 22 2022 at 20:07)</a>:</h4>
<p><code>ZULIP_MERGE_BASE</code> has been wrong in all our minor releases since 4.1, because it’s computed as the merge base with zulip/zulip before we push to zulip/zulip.</p>



<a name="1395184"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395184" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395184">(Jun 22 2022 at 20:09)</a>:</h4>
<p><code>ZULIP_VERSION</code> was wrong in 2.1.1 (2.1.0-5-g49ff894d6a), 2.1.3 (2.1.x), and 2.1.4 (2.1.3-9-g2b95f54593).</p>



<a name="1395186"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395186" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395186">(Jun 22 2022 at 20:12)</a>:</h4>
<p>Also the tarballs for 1.8.0-rc1, 1.9.0-rc1, 1.9.0-rc3, 1.9.2, 2.0.6, 3.0-rc2 are missing on GitHub.</p>



<a name="1395187"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395187" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395187">(Jun 22 2022 at 20:12)</a>:</h4>
<p>So I can retroactively feel good about having done this silly audit.</p>



<a name="1395188"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395188" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395188">(Jun 22 2022 at 20:17)</a>:</h4>
<p>There are no GitHub releases or tags at all for 1.6.0-rc1, 1.7.0-rc1, 1.7.0-rc2.</p>



<a name="1395189"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395189" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395189">(Jun 22 2022 at 20:20)</a>:</h4>
<p>And here’s an interesting one…the checksum for zulip-server-5.0-rc2.tar.gz in <a href="https://download.zulip.com/server/SHA256SUMS.txt">SHA256SUMS.txt</a> doesn’t match.</p>



<a name="1395193"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395193" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395193">(Jun 22 2022 at 20:38)</a>:</h4>
<p>2.1.1 and 2.1.3 are the same as 5.3, in that the commit hash is right, but the tag wasn't there when the describe happened.</p>



<a name="1395194"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395194" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395194">(Jun 22 2022 at 20:39)</a>:</h4>
<p>The SHA256SUMs are cached in metadata on the objects in S3, which is what we build the SHA256SUMS.txt from</p>



<a name="1395195"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395195" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395195">(Jun 22 2022 at 20:45)</a>:</h4>
<p>For the missing tags, it seems:</p>
<ul>
<li>1.6.0-rc1 might be <a href="https://github.com/zulip/zulip/commit/23baaae98075e19f51dab40affb5a94998389a50">23baaae98075e19f51dab40affb5a94998389a50</a>,</li>
<li>1.7.0-rc1 might be <a href="https://github.com/zulip/zulip/commit/88245d2cd66c75e1096eec53882a2750826f03be">88245d2cd66c75e1096eec53882a2750826f03be</a>,</li>
<li>1.7.0-rc2 doesn’t match any commit I can find; it might be <a href="https://github.com/zulip/zulip/commit/79d0f13885282442a30b65071affbef2a79714ca">79d0f13885282442a30b65071affbef2a79714ca</a> with <a href="https://github.com/zulip/zulip/commit/11ab545f3b989c667d337b11000514bcc2dad43d">11ab545f3b989c667d337b11000514bcc2dad43d</a> cherry-picked?</li>
</ul>
<p>Tim, do you have these tags locally somewhere?</p>



<a name="1395197"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395197" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395197">(Jun 22 2022 at 20:57)</a>:</h4>
<p>The S3 metadata is equally wrong.</p>
<div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="gp">$ </span>aws s3api head-object --bucket zulip-download --key server/zulip-server-5.0-rc2.tar.gz
<span class="go">{</span>
<span class="go">    "AcceptRanges": "bytes",</span>
<span class="go">    "LastModified": "Fri, 25 Mar 2022 04:39:12 GMT",</span>
<span class="go">    "ContentLength": 94002279,</span>
<span class="go">    "ETag": "\"7b1159d4c309260d221e46e33adf6abe-12\"",</span>
<span class="go">    "VersionId": "null",</span>
<span class="go">    "ContentType": "application/gzip",</span>
<span class="go">    "Metadata": {</span>
<span class="go">        "sha256sum": "5a40e181bf3cbd27c704a2ec34bbfac2e5479c177e4fc2c9a6824f58501e9c5e"</span>
<span class="go">    }</span>
<span class="go">}</span>
<span class="gp">$ </span>aws s3 cp s3://zulip-download/server/zulip-server-5.0-rc2.tar.gz - <span class="p">|</span> sha256sum
<span class="go">2c0eec79e7ae60c1ae3e29917ba4906412d6154df89bd4c651b735d1a74d069f  -</span>
</code></pre></div>



<a name="1395222"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395222" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395222">(Jun 22 2022 at 21:35)</a>:</h4>
<p>The SHA256SUMs file is produced from the metadata, so there's no way it could be right. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>
<p>I've updated the metadata.  I don't understand how it was wrong, though.</p>



<a name="1395317"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395317" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395317">(Jun 22 2022 at 23:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="699">Anders Kaseorg</span> <a href="#narrow/stream/31-production-help/topic/upgrade.20to.205.2E3/near/1395195">said</a>:</p>
<blockquote>
<p>For the missing tags, it seems:</p>
<ul>
<li>1.6.0-rc1 might be <a href="https://github.com/zulip/zulip/commit/23baaae98075e19f51dab40affb5a94998389a50">23baaae98075e19f51dab40affb5a94998389a50</a>,</li>
<li>1.7.0-rc1 might be <a href="https://github.com/zulip/zulip/commit/88245d2cd66c75e1096eec53882a2750826f03be">88245d2cd66c75e1096eec53882a2750826f03be</a>,</li>
<li>1.7.0-rc2 doesn’t match any commit I can find; it might be <a href="https://github.com/zulip/zulip/commit/79d0f13885282442a30b65071affbef2a79714ca">79d0f13885282442a30b65071affbef2a79714ca</a> with <a href="https://github.com/zulip/zulip/commit/11ab545f3b989c667d337b11000514bcc2dad43d">11ab545f3b989c667d337b11000514bcc2dad43d</a> cherry-picked?</li>
</ul>
<p>Tim, do you have these tags locally somewhere?</p>
</blockquote>
<p>Good question. It seems plausible that I do on the hard drive of a previous computer; I don't have them on my current laptop.</p>



<a name="1395320"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395320" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395320">(Jun 22 2022 at 23:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="699">Anders Kaseorg</span> <a href="#narrow/stream/31-production-help/topic/upgrade.20to.205.2E3/near/1395186">said</a>:</p>
<blockquote>
<p>Also the tarballs for 1.8.0-rc1, 1.9.0-rc1, 1.9.0-rc3, 1.9.2, 2.0.6, 3.0-rc2 are missing on GitHub.</p>
</blockquote>
<p>This we should be able to fix by just uploading those to GitHub, right? </p>
<p>I do have an archive directory in my personal Dropbox where I have original copies of every release I've personally uploaded; not sure if that's useful for any of this.</p>



<a name="1395321"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395321" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395321">(Jun 22 2022 at 23:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="699">Anders Kaseorg</span> <a href="#narrow/stream/31-production-help/topic/upgrade.20to.205.2E3/near/1395187">said</a>:</p>
<blockquote>
<p>So I can retroactively feel good about having done this silly audit.</p>
</blockquote>
<p>Yeah, thanks for doing this!</p>



<a name="1395378"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395378" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395378">(Jun 23 2022 at 00:34)</a>:</h4>
<p>I uploaded 2.0.6, which already had a release, but for the others we’d need to create one; the annoying part of that is that releases can’t be backdated.</p>



<a name="1395392"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395392" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395392">(Jun 23 2022 at 00:50)</a>:</h4>
<p>Are you sure there's no way to backdate? I seem to recall uploading all our old releases to GitHub at some point, since we didn't use their release feature at first.</p>



<a name="1395393"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395393" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395393">(Jun 23 2022 at 00:51)</a>:</h4>
<p><a href="https://github.com/orgs/github-community/discussions/5447">https://github.com/orgs/github-community/discussions/5447</a></p>



<a name="1395394"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395394" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395394">(Jun 23 2022 at 00:51)</a>:</h4>
<p>That suggests you're right, sight.</p>



<a name="1395395"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395395" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395395">(Jun 23 2022 at 00:51)</a>:</h4>
<p>That’s why <a href="https://github.com/zulip/zulip/releases/1.3.0">https://github.com/zulip/zulip/releases/1.3.0</a> is dated 2017-02-01 for a tag from 2015-09-25.</p>



<a name="1395398"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395398" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395398">(Jun 23 2022 at 00:52)</a>:</h4>
<p>The most visible effects would be that the order in <a href="https://github.com/zulip/zulip/releases">https://github.com/zulip/zulip/releases</a> would be wacky, and 5.3 would be displaced as “Latest” on <a href="https://github.com/zulip/zulip">https://github.com/zulip/zulip</a> unless we marked them all as pre-releases.</p>



<a name="1395399"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395399" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395399">(Jun 23 2022 at 00:53)</a>:</h4>
<p>Well the release candidates probably should be marked as pre releases, so that may help?</p>



<a name="1395400"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395400" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anders Kaseorg <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395400">(Jun 23 2022 at 00:54)</a>:</h4>
<p>Yeah, I mean, we could pretend 1.9.2 is a pre-release until we release 5.4 to work around the latter problem.</p>



<a name="1395840"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1395840" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vandiver <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1395840">(Jun 24 2022 at 00:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="7">Tim Abbott</span> <a href="#narrow/stream/31-production-help/topic/upgrade.20to.205.2E3/near/1395143">said</a>:</p>
<blockquote>
<p>We should probably add an end-to-end check in <code>build-release-tarball</code> that if you used a tag to generate the release, the contents of the version file match the tag that one requested.</p>
</blockquote>
<p>Repushed <a href="https://github.com/zulip/zulip/pull/22280">#22280</a> with some additional security in it, and the signature bits dropped.</p>



<a name="1397231"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1397231" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Sparks <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1397231">(Jun 27 2022 at 18:04)</a>:</h4>
<p>quick check: The IETF Zulip instance is currently at 5.0-dev-2368-gebeb9c4440. Are there any special considerations we need to take into account moving to 5.3? (And if such things are in a well-known place beyond upgrade-or-modfy.md please point me to it?)</p>



<a name="1397234"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1397234" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1397234">(Jun 27 2022 at 18:14)</a>:</h4>
<p><span class="user-mention" data-user-id="24296">@Robert Sparks</span> I don't expect so!</p>



<a name="1397235"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1397235" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1397235">(Jun 27 2022 at 18:15)</a>:</h4>
<p>I believe you folks are running a development version between 4.x and 5.0 because you wanted the OpenID connect authentication backend, which was released as part of 5.0.</p>



<a name="1397236"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/upgrade%20to%205.3/near/1397236" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Robert Sparks <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/upgrade.20to.205.2E3.html#1397236">(Jun 27 2022 at 18:15)</a>:</h4>
<p>thanks Tim!</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>