<html>
<head><meta charset="utf-8"><title>puppet hang on 16.04 · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html">puppet hang on 16.04</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="489134"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489134" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489134">(Feb 08 2018 at 21:01)</a>:</h4>
<p>May first install of 1.7.1 was to follow the production directions on a 16.04 system. I had update the system with all the latest packages before attempting the Zulip install. During the install process it seemed to go well until it got to puppet. Then it hung. Here is the portion of the install.log with the problem. Do we know the cause of this? I was unable to find it in the Issue tracker.</p>
<p>Attaching log because too big to post in comment.</p>
<p><a href="/user_uploads/2/8b/EnszXVXy2-bCwFghSMlUSzGG/zulip_171_install_hang.txt" target="_blank" title="zulip_171_install_hang.txt">zulip_171_install_hang.txt</a></p>



<a name="489140"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489140" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489140">(Feb 08 2018 at 21:03)</a>:</h4>
<p><span class="user-mention" data-user-email="scott@frak.ms" data-user-id="5233">@Scott Russell</span> Huh -- it hung at that point?</p>
<p>That's new to me. Is it still running? What does <code>ps faux</code> or <code>pstree</code> say underneath the puppet process?</p>



<a name="489149"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489149" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489149">(Feb 08 2018 at 21:05)</a>:</h4>
<p>I killed the install process and setup our test Zulip with the docker-compose GitHub instead. However for prod I would prefer the direct install. <span class="emoji emoji-1f60a" title="blush">:blush:</span></p>
<p>Let me restart the installer and check. But while I've never used puppet I think the big clue is the apt-get messages "Provider apt does not support features virtual_packages"</p>



<a name="489151"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489151" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489151">(Feb 08 2018 at 21:06)</a>:</h4>
<p>(Greg: I've never seen a similar hang before either)</p>



<a name="489192"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489192" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489192">(Feb 08 2018 at 21:11)</a>:</h4>
<p>Yeah, I'm definitely curious about that "does not support features" message.</p>



<a name="489202"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489202" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489202">(Feb 08 2018 at 21:12)</a>:</h4>
<p>Not sure it means anything -- in my experience Puppet and Puppet modules have a habit of spewing a lot of logs even when things are perfectly normal. But I'll go run a test install and see how the log compares.</p>



<a name="489205"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489205" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489205">(Feb 08 2018 at 21:14)</a>:</h4>
<p>Let's see if this formats right.. ps faux for the puppet process...</p>
<div class="codehilite"><pre><span></span>USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root      1167  0.0  0.0  61328  6064 ?        Ss   Feb06   0:00 /usr/sbin/sshd -D
root      7508  0.0  0.1  96320  8944 ?        Ss   13:07   0:00  \_ sshd: root@pts/0
root      7538  0.0  0.1  19416  8472 pts/0    Ss   13:08   0:00  |   \_ -bash
root      8022  0.0  0.0  12528  3028 pts/0    S+   13:10   0:00  |       \_ /bin/bash ./scripts/setup/install
root      8024  0.0  0.0  12548  3052 pts/0    S+   13:10   0:00  |           \_ bash ./scripts/lib/install
root     16463  0.0  0.1  30296 10548 pts/0    S+   13:10   0:00  |           |   \_ python3 /root/zulip-server-1.7.1/scripts/zulip-puppet-apply -f
root     16464  1.6  0.6 210484 52316 pts/0    Sl+  13:10   0:02  |           |       \_ /usr/bin/ruby /usr/bin/puppet apply --modulepath /root/zulip-server-1.7.1/puppet -e  Exec {
root      8025  0.0  0.0   7296   668 pts/0    S+   13:10   0:00  |           \_ tee -a /var/log/zulip/install.log
root     16621  0.0  0.1  96320  8896 ?        Ss   13:10   0:00  \_ sshd: root@pts/1
root     16650  0.0  0.0  19416  8132 pts/1    Ss   13:10   0:00      \_ -bash
root     16822  0.0  0.0  31176  3144 pts/1    R+   13:12   0:00          \_ ps faux 16464
</pre></div>



<a name="489216"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489216" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489216">(Feb 08 2018 at 21:15)</a>:</h4>
<p>I had modified the zulip-puppet-apply script to add the -d option to the CLI so I could see that debug output. Without that debug output  the last line I see is "Notice: Compiled catalog for <a href="http://zulip.eng.nimblestorage.com" target="_blank" title="http://zulip.eng.nimblestorage.com">zulip.eng.nimblestorage.com</a> in environment production in 1.43 seconds"</p>



<a name="489222"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489222" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489222">(Feb 08 2018 at 21:16)</a>:</h4>
<p>Huh, so no subprocesses for puppet.</p>



<a name="489224"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489224" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489224">(Feb 08 2018 at 21:17)</a>:</h4>
<p>Maybe some service not running on my system that should be?</p>



<a name="489231"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489231" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489231">(Feb 08 2018 at 21:18)</a>:</h4>
<div class="codehilite"><pre><span></span>root@zulip:~# ps aux | grep puppet | grep -v grep
root     16463  0.0  0.1  30296 10548 pts/0    S+   13:10   0:00 python3 /root/zulip-server-1.7.1/scripts/zulip-puppet-apply -f
root     16464  0.6  0.6 213460 55428 pts/0    Sl+  13:10   0:02 /usr/bin/ruby /usr/bin/puppet apply --modulepath /root/zulip-server-1.7.1/puppet -e  Exec { path =&gt; &quot;/usr/sbin:/usr/bin:/sbin:/bin&quot; } include apt include zulip::voyager  --detailed-exitcodes -d
</pre></div>



<a name="489264"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489264" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489264">(Feb 08 2018 at 21:27)</a>:</h4>
<p>I'm running a test install now, with <code>-d</code> added to the puppet command line like you did</p>



<a name="489266"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489266" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489266">(Feb 08 2018 at 21:27)</a>:</h4>
<p>(It's on trusty because that's what I have handy, but hopefully that will be informative enough)</p>



<a name="489295"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489295" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489295">(Feb 08 2018 at 21:37)</a>:</h4>
<p>Here's the puppet section of the log on my test install:<br>
<a href="/user_uploads/2/80/V-1kNqsyCxqh6plpbNT78XL3/log" target="_blank" title="log">trusty log</a></p>



<a name="489297"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489297" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489297">(Feb 08 2018 at 21:38)</a>:</h4>
<p>It has some similar messages in flavor, like</p>
<blockquote>
<p>Debug: /User[zulip]: Provider useradd does not support features libuser; not managing attribute forcelocal</p>
</blockquote>
<p>but not the one about apt and <code>virtual_packages</code></p>



<a name="489298"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489298" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489298">(Feb 08 2018 at 21:38)</a>:</h4>
<p>That is on trusty, so it could just be an OS version difference</p>



<a name="489316"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489316" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489316">(Feb 08 2018 at 21:48)</a>:</h4>
<p>Hmm.. is there some other puppet process that should be running? Do you know of basic env setting I need to check? hostname, dns, network?</p>



<a name="489317"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489317" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489317">(Feb 08 2018 at 21:48)</a>:</h4>
<p>Hmm. One way to get more information: run <code>strace</code> on the puppet process. Like<br>
<code>sudo strace -p $(pgrep -f 'ruby.*puppet-apply')</code></p>



<a name="489324"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489324" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489324">(Feb 08 2018 at 21:49)</a>:</h4>
<p>(Meanwhile I'm setting up a Xenial test-install environment; should have one of those anyway)</p>



<a name="489338"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489338" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489338">(Feb 08 2018 at 21:52)</a>:</h4>
<p>At a quick check of a couple of running prod servers, we do have a <code>puppet agent</code> daemon running. Not sure if that's expected/required in the install process. But try <code>service puppet status</code>?</p>



<a name="489340"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489340" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489340">(Feb 08 2018 at 21:52)</a>:</h4>
<p>And if it's not running, <code>service puppet start</code>.</p>



<a name="489344"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489344" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489344">(Feb 08 2018 at 21:54)</a>:</h4>
<p>If that fixes it, then you have a workaround and we've reduced the mystery to why that wasn't running for you <span class="emoji emoji-1f604" title="smile">:smile:</span> -- we do install Puppet with <code>apt</code> earlier in the install script, which should start it</p>



<a name="489349"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489349" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489349">(Feb 08 2018 at 21:55)</a>:</h4>
<p>Let me get this running and restart the install. I wonder why it didn't autostart?</p>
<div class="codehilite"><pre><span></span>root@zulip:~# systemctl status puppet
● puppet.service - Puppet agent
   Loaded: loaded (/lib/systemd/system/puppet.service; disabled; vendor preset: enabled)
   Active: inactive (dead)

Feb 06 20:42:42 zulip systemd[1]: Starting Puppet agent...
Feb 06 20:42:43 zulip puppet-agent[12622]: Reopening log files
Feb 06 20:42:43 zulip systemd[1]: Started Puppet agent.
Feb 06 20:42:43 zulip puppet-agent[12622]: Starting Puppet client version 3.8.5
Feb 06 20:42:43 zulip puppet-agent[12622]: Skipping run of Puppet configuration client; administratively disabled (Reason: &#39;Disabled by default on new or unconfigured old installati
Feb 06 20:42:43 zulip puppet-agent[12622]: Use &#39;puppet agent --enable&#39; to re-enable.
Feb 06 20:45:44 zulip systemd[1]: Stopping Puppet agent...
Feb 06 20:45:44 zulip puppet-agent[12622]: Caught TERM; exiting
Feb 06 20:45:44 zulip systemd[1]: Stopped Puppet agent.
Feb 06 20:57:54 zulip systemd[1]: Stopped Puppet agent.
</pre></div>



<a name="489365"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489365" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489365">(Feb 08 2018 at 22:00)</a>:</h4>
<p>Started puppet and enabled it. Confirmed it was running and kicked off the installer again. I still see the same types of messages about apt does not support features virtual_packages. The install doesn't progress any further after 60 seconds of sitting there. Confirmed that puppet agent is running during the install now.</p>
<div class="codehilite"><pre><span></span>root@zulip:~# ps aux | grep puppet | grep -v grep
root     16962  0.0  0.4 144864 39092 ?        Ssl  13:55   0:00 /usr/bin/ruby /usr/bin/puppet agent
root     17341  0.0  0.1  30292 10616 pts/0    S+   13:55   0:00 python3 /root/zulip-server-1.7.1/scripts/zulip-puppet-apply -f
root     17342  6.4  0.6 207532 49288 pts/0    Sl+  13:55   0:02 /usr/bin/ruby /usr/bin/puppet apply --modulepath /root/zulip-server-1.7.1/puppet -e  Exec { path =&gt; &quot;/usr/sbin:/usr/bin:/sbin:/bin&quot; } include apt include zulip::voyager  --detailed-exitcodes -d
</pre></div>


<p>That didn't change the output of ps faux except to add a puppet agent process that is not running under the installer.</p>



<a name="489375"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489375" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489375">(Feb 08 2018 at 22:02)</a>:</h4>
<p><code>pgrep -f 'ruby.*puppet-apply'</code> doesn't return anything... only the zulip-puppet-apply python script seems to be running.</p>



<a name="489383"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489383" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489383">(Feb 08 2018 at 22:06)</a>:</h4>
<p>Hmm, dang, red herring then.</p>



<a name="489385"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489385" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489385">(Feb 08 2018 at 22:06)</a>:</h4>
<p>Oh! I misread your <code>pstree</code> output above -- you had <code>/usr/bin/ruby /usr/bin/puppet apply</code>, with a space.</p>



<a name="489389"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489389" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489389">(Feb 08 2018 at 22:07)</a>:</h4>
<p>That <code>pgrep</code> was meant to match that command -- so try <code>pgrep -f 'ruby.*puppet apply'</code>. Or just type the PID of that process. :-)</p>
<p><span class="user-mention" data-user-email="scott@frak.ms" data-user-id="5233">@Scott Russell</span> ^</p>



<a name="489390"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489390" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489390">(Feb 08 2018 at 22:08)</a>:</h4>
<p>(BTW thanks for the report and this detailed debugging!)</p>



<a name="489404"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489404" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489404">(Feb 08 2018 at 22:10)</a>:</h4>
<p>No thank you! This is bugging the crap out of me. I'm very happy to have assistance looking at this as I've been poking at it for a day or two now. Let me get a good strace. Maybe try lsof and fuser to see what that process has open</p>



<a name="489419"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489419" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489419">(Feb 08 2018 at 22:11)</a>:</h4>
<p>Now we are getting somewhere! strace gave me back bunch of NIS stuff. We do have a NIS env for hosts, mounts, and users. However it should be disabled on this box. Let me look at it.</p>
<div class="codehilite"><pre><span></span>open(&quot;/var/yp/binding/nimblestorage.2&quot;, O_RDONLY) = 8
pread64(8, &quot;\1\0\0\0\n\24\0000\3\303\0\0&quot;, 12, 2) = 12
socket(PF_INET, SOCK_DGRAM|SOCK_CLOEXEC|SOCK_NONBLOCK, IPPROTO_UDP) = 9
bind(9, {sa_family=AF_INET, sin_port=htons(657), sin_addr=inet_addr(&quot;0.0.0.0&quot;)}, 16) = 0
setsockopt(9, SOL_IP, IP_RECVERR, [1], 4) = 0
close(8)                                = 0
</pre></div>



<a name="489422"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489422" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489422">(Feb 08 2018 at 22:13)</a>:</h4>
<p>The second I disabled NIS the install process kicked into gear!</p>



<a name="489433"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489433" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489433">(Feb 08 2018 at 22:16)</a>:</h4>
<p>Excellent!</p>



<a name="489436"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489436" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489436">(Feb 08 2018 at 22:18)</a>:</h4>
<p>When you have a chance, I'd be interested in your thoughts on what the installer could do to better detect or help debug this case.</p>



<a name="489439"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489439" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489439">(Feb 08 2018 at 22:19)</a>:</h4>
<p>So, with a NIS environment, I'm wondering if there is a way to force local user creation. My experience with CentOS is that adduser gets a little odd with NIS in place. I've not run Ubuntu in NIS environments before unsure of the impact there.</p>



<a name="489441"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489441" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489441">(Feb 08 2018 at 22:21)</a>:</h4>
<p>I caught the installer with the strace trying to do some group work. (maybe add a new group?) In a NIS environment that could fail if the OS is trying to update the NIS server.</p>
<div class="codehilite"><pre><span></span>stat(&quot;/usr/lib/ruby/vendor_ruby/puppet/vendor/pathspec/lib/puppet/type/class.rb&quot;, 0x7ffd6e549c80) = -1 ENOENT (No such file or directory)
stat(&quot;/usr/lib/ruby/vendor_ruby/puppet/vendor/safe_yaml/lib/puppet/type/class.rb&quot;, 0x7ffd6e549c80) = -1 ENOENT (No such file or directory)
stat(&quot;/root/zulip-server-1.7.1/puppet/zulip/lib/puppet/type/class.rb&quot;, 0x7ffd6e549c80) = -1 ENOENT (No such file or directory)
stat(&quot;/root/zulip-server-1.7.1/puppet/stdlib/lib/puppet/type/class.rb&quot;, 0x7ffd6e549c80) = -1 ENOENT (No such file or directory)
stat(&quot;/var/lib/puppet/lib/puppet/type/class.rb&quot;, 0x7ffd6e549c80) = -1 ENOENT (No such file or directory)
open(&quot;/etc/group&quot;, O_RDONLY|O_CLOEXEC)  = 7
fstat(7, {st_mode=S_IFREG|0644, st_size=967, ...}) = 0
read(7, &quot;root:x:0:\ndaemon:x:1:\nbin:x:2:\ns&quot;..., 4096) = 967
read(7, &quot;&quot;, 4096)                       = 0
open(&quot;/etc/ld.so.cache&quot;, O_RDONLY|O_CLOEXEC) = 8
fstat(8, {st_mode=S_IFREG|0644, st_size=34373, ...}) = 0
mmap(NULL, 34373, PROT_READ, MAP_PRIVATE, 8, 0) = 0x7f2a80063000
close(8)                                = 0
access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)
open(&quot;/lib/x86_64-linux-gnu/libnss_nis.so.2&quot;, O_RDONLY|O_CLOEXEC) = 8
read(8, &quot;\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\260 \0\0\0\0\0\0&quot;..., 832) = 832
fstat(8, {st_mode=S_IFREG|0644, st_size=47648, ...}) = 0
mmap(NULL, 2143624, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 8, 0) = 0x7f2a7653a000
mprotect(0x7f2a76545000, 2093056, PROT_NONE) = 0
mmap(0x7f2a76744000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 8, 0xa000) = 0x7f2a76744000
close(8)                                = 0
access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)
open(&quot;/lib/x86_64-linux-gnu/libnsl.so.1&quot;, O_RDONLY|O_CLOEXEC) = 8
read(8, &quot;\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\360?\0\0\0\0\0\0&quot;..., 832) = 832
fstat(8, {st_mode=S_IFREG|0644, st_size=93128, ...}) = 0
mmap(NULL, 2198104, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 8, 0) = 0x7f2a76321000
mprotect(0x7f2a76337000, 2093056, PROT_NONE) = 0
mmap(0x7f2a76536000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 8, 0x15000) = 0x7f2a76536000
mmap(0x7f2a76538000, 6744, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f2a76538000
close(8)                                = 0
</pre></div>



<a name="489455"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489455" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489455">(Feb 08 2018 at 22:26)</a>:</h4>
<p>Interesting.</p>



<a name="489457"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489457" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489457">(Feb 08 2018 at 22:28)</a>:</h4>
<p>So, around that spot in the logs, the next things in my log from trusty are</p>
<div class="codehilite"><pre><span></span>Debug: /User[postgres]: Provider useradd does not support features libuser; not managing attribute forcelocal
Debug: Creating default schedules
Debug: Using settings: adding file resource &#39;confdir&#39;: &#39;File[/etc/puppet]{:path=&gt;&quot;/etc/puppet&quot;, :ensure=&gt;:directory, :loglevel=&gt;:debug, :links=&gt;:follow, :backup=&gt;false}&#39;
Debug: /User[puppet]: Provider useradd does not support features libuser; not managing attribute forcelocal
Debug: /Group[puppet]: Provider groupadd does not support features libuser; not managing attribute forcelocal
</pre></div>



<a name="489458"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489458" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489458">(Feb 08 2018 at 22:28)</a>:</h4>
<p>In your log, it's already successfully added both a user and group named <code>zulip</code>, it looks like</p>



<a name="489461"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489461" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489461">(Feb 08 2018 at 22:31)</a>:</h4>
<p>But maybe on creating the postgres user, there's something different that makes it fail trying to use NIS?</p>



<a name="489462"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489462" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489462">(Feb 08 2018 at 22:32)</a>:</h4>
<p>Ah, here's what looks like the relevant bit of our puppet code:</p>
<div class="codehilite"><pre><span></span>puppet/zulip/manifests/postgres_common.pp:

  # Use arcane puppet virtual resources to add postgres user to zulip group
  @user { &#39;postgres&#39;:
    groups     =&gt; [&#39;ssl-cert&#39;],
    membership =&gt; minimum,
    require    =&gt; [Package[&quot;postgresql-${zulip::base::postgres_version}&quot;],
                   Package[&quot;ssl-cert&quot;]],
  }
  User &lt;| title == postgres |&gt; { groups +&gt; &quot;zulip&quot; }
}
</pre></div>



<a name="489464"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489464" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489464">(Feb 08 2018 at 22:32)</a>:</h4>
<p>So, adding a user to a group.</p>



<a name="489474"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489474" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489474">(Feb 08 2018 at 22:38)</a>:</h4>
<p>I could try that at the CLI as root with NIS enabled and disabled to see if there is a difference.</p>



<a name="489475"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489475" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489475">(Feb 08 2018 at 22:39)</a>:</h4>
<p>I'm not sure exactly how puppet is going about adding the user to the group given that syntax... just appending it to the /etc/groups files?</p>



<a name="489482"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489482" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489482">(Feb 08 2018 at 22:58)</a>:</h4>
<p>Me neither. I imagine it's calling system commands like <code>adduser</code>.</p>



<a name="489484"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489484" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489484">(Feb 08 2018 at 23:00)</a>:</h4>
<p>Looks like <span class="user-mention" data-user-email="tabbott@zulipchat.com" data-user-id="7">@Tim Abbott</span> added that line, including the comment remarking on the arcane bit of Puppet syntax -- Tim, do you recall any further details?</p>



<a name="489512"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489512" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489512">(Feb 08 2018 at 23:35)</a>:</h4>
<p>Just following up that I was able to complete the rest of the install and have the instance running outside of docker now. Thank you again for the awesome help!</p>



<a name="489687"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/489687" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#489687">(Feb 09 2018 at 02:34)</a>:</h4>
<p><span class="user-mention" data-user-email="greg@zulipchat.com" data-user-id="2187">@Greg Price</span> I imagine <code>puppet</code> calls <code>adduser</code> internally.  I believe the reason we need to do that is so that postgres SSL authentication works.</p>



<a name="490871"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/490871" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#490871">(Feb 09 2018 at 20:02)</a>:</h4>
<p>Oh -- <code>ssl-cert</code> is the group that can read <code>/etc/ssl/private</code>, as I happened to notice yesterday for unrelated reasons.</p>



<a name="490874"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/490874" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#490874">(Feb 09 2018 at 20:03)</a>:</h4>
<p>Why do we add it to the <code>zulip</code> group with the funny syntax at the end, instead of with the <code>groups</code> field where we give it the <code>ssl-cert</code> group?</p>



<a name="490884"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/490884" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#490884">(Feb 09 2018 at 20:07)</a>:</h4>
<p>Basically because <code>puppet</code> sucks.  I believe because we don't create the <code>postgres</code> user -- the <code>postgres</code> package does.  And the <code>ssl-cert</code> and <code>zulip</code> groups may not exist when the packages are installed.</p>



<a name="490886"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/490886" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#490886">(Feb 09 2018 at 20:08)</a>:</h4>
<p>In other words, if you try doing the other thing, you'll get an error.</p>



<a name="490936"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/490936" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#490936">(Feb 09 2018 at 20:26)</a>:</h4>
<p>Root user typically is a local account not in NIS. I believe that’s also the required user for install. Since this is an install issue only, just check for NIS in the install setup and about the install with a message to disable NIS for the install process. NIS can be enabled again after install. </p>
<p>Clumsy I know but I don’t think NIS environments are common enough in the user base or we would have seen this before?</p>



<a name="490969"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/490969" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#490969">(Feb 09 2018 at 20:37)</a>:</h4>
<p><span class="user-mention" data-user-email="scott@frak.ms" data-user-id="5233">@Scott Russell</span> do you have a recommended command we should use for checking if it's an NIS environment?  Also, we should create an issue to track this at this point; I'll work on that.</p>



<a name="490973"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/490973" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#490973">(Feb 09 2018 at 20:39)</a>:</h4>
<p>Created <a href="https://github.com/zulip/zulip/issues/8330" target="_blank" title="https://github.com/zulip/zulip/issues/8330">https://github.com/zulip/zulip/issues/8330</a> to track this.</p>



<a name="490974"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/490974" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Scott Russell <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#490974">(Feb 09 2018 at 20:39)</a>:</h4>
<p>Tag me in the issue and I’ll find a suggestion. My initial thought will be using service to see if NIS is installed and running. I’ll try out some commands</p>
<p>My github email is the same.</p>



<a name="528593"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/528593" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> maziBIE <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#528593">(Mar 07 2018 at 10:26)</a>:</h4>
<p><a href="/user_uploads/2/12/2Ojk12f3ki8bLiJSmml3Obx5/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a> <br>
The above problems when installing zulip . How do I deal with it?  Ubuntu 16.04 xenial (ARM64)</p>
<div class="message_inline_image"><a href="/user_uploads/2/12/2Ojk12f3ki8bLiJSmml3Obx5/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/2/12/2Ojk12f3ki8bLiJSmml3Obx5/pasted_image.png"></a></div>



<a name="528665"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/528665" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rohitt Vashishtha <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#528665">(Mar 07 2018 at 11:59)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="4850">@maziBIE</span> this is the first time i've seen tsearch missing on Xenial, I suppose. We've earlier encountered similar issues on Debian Stretch and Ubuntu Artful, as seen in a quick search here: <a href="#narrow/search/tsearch" title="#narrow/search/tsearch">https://chat.zulip.org/#narrow/search/tsearch</a></p>



<a name="528667"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/528667" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rohitt Vashishtha <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#528667">(Mar 07 2018 at 12:01)</a>:</h4>
<p>Try this person's solution, replacing artful with xenial in the repository listing: <a href="#narrow/stream/95-new-members/subject/Help.20needed.20for.20Ubuntu17.2E10.20zulip.20setup/near/501657" title="#narrow/stream/95-new-members/subject/Help.20needed.20for.20Ubuntu17.2E10.20zulip.20setup/near/501657">https://chat.zulip.org/#narrow/stream/95-new-members/subject/Help.20needed.20for.20Ubuntu17.2E10.20zulip.20setup/near/501657</a></p>



<a name="528670"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/528670" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rohitt Vashishtha <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#528670">(Mar 07 2018 at 12:03)</a>:</h4>
<p>Just adding that PPA and running <code>sudo apt upgrade</code> should ideally be enough, as after that, the install script can take care of the package installation. Pinging <span class="user-mention" data-user-id="7">@Tim Abbott</span> in case I'm reading the situation incorrectly.</p>



<a name="529319"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529319" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529319">(Mar 07 2018 at 21:01)</a>:</h4>
<p><span class="user-mention" data-user-id="4850">@maziBIE</span> I think the arm64 architecture is a key part of the issue -- thanks for mentioning that detail!</p>
<p>Looking at <a href="https://launchpad.net/~tabbott/+archive/ubuntu/zulip/+packages" target="_blank" title="https://launchpad.net/~tabbott/+archive/ubuntu/zulip/+packages">https://launchpad.net/~tabbott/+archive/ubuntu/zulip/+packages</a> and expanding the line "tsearch-extras - 0.3", we've only uploaded versions of that for amd64, i386, and armhf.</p>



<a name="529321"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529321" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529321">(Mar 07 2018 at 21:01)</a>:</h4>
<p>I'm curious -- what kind of machine are you trying to install Zulip on?</p>



<a name="529323"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529323" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529323">(Mar 07 2018 at 21:02)</a>:</h4>
<p>It might or might not be easy for us to add an arm64 build to the PPA -- <span class="user-mention" data-user-id="7">@Tim Abbott</span> would know more.</p>



<a name="529327"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529327" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529327">(Mar 07 2018 at 21:02)</a>:</h4>
<p><span class="user-mention" data-user-id="2187">@Greg Price</span> I think it's not hard, but requires asking Canonical to upgrade our PPA to support that architecture, and then a few clicks.</p>



<a name="529329"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529329" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529329">(Mar 07 2018 at 21:03)</a>:</h4>
<p>If we do, though, you will be in uncharted territory -- nobody else has ever installed Zulip on an arm64 machine <span class="emoji emoji-1f603" title="smiley">:smiley:</span> -- so there may be other things you run into further on.</p>



<a name="529330"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529330" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529330">(Mar 07 2018 at 21:03)</a>:</h4>
<p>I think posting something like this: <a href="https://answers.launchpad.net/launchpad/+question/271836" target="_blank" title="https://answers.launchpad.net/launchpad/+question/271836">https://answers.launchpad.net/launchpad/+question/271836</a></p>



<a name="529332"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529332" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529332">(Mar 07 2018 at 21:03)</a>:</h4>
<p>Ha, I see.</p>



<a name="529334"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529334" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529334">(Mar 07 2018 at 21:04)</a>:</h4>
<p>So that's how we got armhf, by asking for "ARM builds" -- and it turns out armhf isn't the only ARM architecture people might want. (Maybe it was in 2015, I don't know.)</p>



<a name="529335"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529335" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529335">(Mar 07 2018 at 21:04)</a>:</h4>
<p>Tim, want to make another request like that?</p>



<a name="529347"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529347" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529347">(Mar 07 2018 at 21:08)</a>:</h4>
<p>(OK, and some quick web research says arm64 was new in Debian jessie, released 2015; so probably new in xenial, and didn't exist in Ubuntu at the time of that previous request of ours.)</p>



<a name="529365"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529365" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529365">(Mar 07 2018 at 21:10)</a>:</h4>
<p>Done, see <a href="https://answers.launchpad.net/launchpad/+question/665356" target="_blank" title="https://answers.launchpad.net/launchpad/+question/665356">https://answers.launchpad.net/launchpad/+question/665356</a></p>



<a name="529388"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529388" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Greg Price <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529388">(Mar 07 2018 at 21:16)</a>:</h4>
<p>Great -- thanks!</p>
<p><span class="user-mention" data-user-id="4850">@maziBIE</span> based on experience last time, I expect we'll probably have support for arm64 within a few days. Thanks again for the report!</p>



<a name="529555"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529555" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529555">(Mar 07 2018 at 23:03)</a>:</h4>
<p>OK, we've been approved; I'll try to take care of the series of clicking things spaced by 30 minutes required to have the package posted soon.</p>



<a name="529761"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/puppet%20hang%20on%2016.04/near/529761" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> maziBIE <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/puppet.20hang.20on.2016.2E04.html#529761">(Mar 08 2018 at 01:27)</a>:</h4>
<p><span class="user-mention" data-user-id="2187">@Greg Price</span> <span class="user-mention" data-user-id="1406">@Rohitt Vashishtha</span> <span class="user-mention" data-user-id="7">@Tim Abbott</span>  Thanks a lot!</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>