<html>
<head><meta charset="utf-8"><title>Different accounts same email · production help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rht.github.io/czo-archive/stream/31-production-help/index.html">production help</a></h2>
<h3>Topic: <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html">Different accounts same email</a></h3>

<hr>

<base href="https://chat.zulip.org">

<head><link href="https://rht.github.io/czo-archive/style.css" rel="stylesheet"></head>

<a name="844465"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/844465" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#844465">(Mar 31 2020 at 07:18)</a>:</h4>
<p>Hello,  I'm using LDAP Backend for authentication.<br>
I'm seeing that it is possible to login in to Zulip either using the unique id (as per ldap) or the email.<br>
This is problematic for me because I know that there will be different accounts with the same email field. </p>
<p>To me is very important to identify the account by id and not be email, is it possible to use and configure zulip this way?<br>
Is it possible to only allow login only with the account id?</p>



<a name="844677"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/844677" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oktay X <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#844677">(Mar 31 2020 at 15:39)</a>:</h4>
<p>I believe the LDAP filter is configurable. Can't you make sure it picks up the correct field?</p>



<a name="844744"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/844744" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#844744">(Mar 31 2020 at 16:13)</a>:</h4>
<p>Zulip uses email as the user identifier, so it would be hard to do this I think</p>



<a name="844931"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/844931" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#844931">(Mar 31 2020 at 20:17)</a>:</h4>
<p>This is a good info, I didn't catch that from the docs. Then it would be impossible to have to different users with the same email.</p>



<a name="844933"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/844933" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#844933">(Mar 31 2020 at 20:19)</a>:</h4>
<p>This is going to be a big problem for me. Because I can guarantee unique username in ldap but not unique email.</p>



<a name="844934"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/844934" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#844934">(Mar 31 2020 at 20:20)</a>:</h4>
<p>If I understood correctly I either find a way to have unique emails or I can't use Zulip. Is this correct?</p>



<a name="844937"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/844937" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#844937">(Mar 31 2020 at 20:26)</a>:</h4>
<p>Or I could do as suggested by <span class="user-mention" data-user-id="4703">@Oktay X</span>  and bend the LDAP REVERSE EMAIL QUERY to use a special ldap attribute were I guarantee it to be unique.<br>
I don't like it much but it could be a workaround.</p>



<a name="845083"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845083" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845083">(Mar 31 2020 at 23:40)</a>:</h4>
<p><span class="user-mention" data-user-id="15289">@Francesco</span> can you talk about how your situation is that you have multiple users with the same email address?</p>



<a name="845084"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845084" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845084">(Mar 31 2020 at 23:40)</a>:</h4>
<p>How does email get route to those users?</p>



<a name="845281"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845281" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845281">(Apr 01 2020 at 07:24)</a>:</h4>
<p><span class="user-mention" data-user-id="7">@Tim Abbott</span> I have this two cases:</p>
<p><strong>Two users that share email</strong></p>
<div class="codehilite"><pre><span></span>dn: uid=elizabethmcphee,ou=users,dc=mydomain,dc=org
objectClass: inetOrgPerson
uid: elizabethmcphee
cn: McPhee, Elizabeth
givenName: Elizabeth
sn: McPhee
mail: family.mckenzie@email.com

dn: uid=johnmckenzie,ou=users,dc=mydomain,dc=org
objectClass: inetOrgPerson
uid: johnmckenzie
cn: McKenzie, John
givenName: John
sn: McKenzie
mail: family.mckenzie@email.com
</pre></div>


<p><strong>Two users with different emails but that also share an email</strong></p>
<div class="codehilite"><pre><span></span>dn: uid=miguelrivera,ou=users,dc=mydomain,dc=org
objectClass: inetOrgPerson
uid: miguelrivera
cn: Rivera, Miguel
givenName: Miguel
sn: Rivera
mail: miguelrivera@mydomain.org
mail: wemakeshoes@rivera.com

dn: uid=enriquerivera,ou=users,dc=mydomain,dc=org
objectClass: inetOrgPerson
uid: enriquerivera
cn: Rivera, Enrique
givenName: Enrique
sn: Rivera
mail: enriquerivera@mydomain.org
mail: wemakeshoes@rivera.com
</pre></div>



<a name="845290"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845290" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845290">(Apr 01 2020 at 07:28)</a>:</h4>
<p>The configuration is something like this:</p>
<div class="codehilite"><pre><span></span>AUTH_LDAP_USER_SEARCH = LDAPSearch(&quot;ou=users,dc=mydomain,dc=org&quot;,
        ldap.SCOPE_SUBTREE, &quot;(uid=%(user)s)&quot;)
LDAP_APPEND_DOMAIN = None
LDAP_EMAIL_ATTR = &quot;mail&quot;
AUTH_LDAP_REVERSE_EMAIL_SEARCH = LDAPSearch(&quot;ou=users,dc=mydomain,dc=org&quot;,
        ldap.SCOPE_SUBTREE, &quot;(mail=%(email)s)&quot;)
AUTH_LDAP_USERNAME_ATTR = &quot;uid&quot;
</pre></div>



<a name="845291"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845291" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845291">(Apr 01 2020 at 07:34)</a>:</h4>
<p>As you can see we don't use email as a unique identifier.</p>



<a name="845292"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845292" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845292">(Apr 01 2020 at 07:38)</a>:</h4>
<p>Also, many emails are not <code>mydomain.org</code>.</p>



<a name="845294"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845294" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845294">(Apr 01 2020 at 07:43)</a>:</h4>
<p>Then if I login with <code>family.mckenzie@email.com</code> zulip will choose the first result it gets from the ldap query, the same if I login with <code>wemakeshoes@rivera.com</code></p>



<a name="845295"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845295" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845295">(Apr 01 2020 at 07:45)</a>:</h4>
<p>This is why I asked if I could restrict login only to username, this way I'm already certain that it is unique.</p>



<a name="845297"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845297" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845297">(Apr 01 2020 at 08:10)</a>:</h4>
<p>To put this in to perspective, of about 3000 users there are 360 emails which are used in more than one user, some up to four times.</p>



<a name="845398"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845398" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oktay X <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845398">(Apr 01 2020 at 12:23)</a>:</h4>
<p>Interesting setup. How come they share email addresses like this? Are they actually using a shared mailbox ?</p>



<a name="845409"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845409" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845409">(Apr 01 2020 at 12:41)</a>:</h4>
<p>The first case may be just older people that share an email, think a wife and husband where they just rarely use email and the share the same email address.</p>
<p>The second case its more close to the shared mailbox case.</p>



<a name="845415"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845415" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845415">(Apr 01 2020 at 12:45)</a>:</h4>
<p>I have made some testing, and when using LDAP the change of email should be disabled. This is stated in the docs for the Name but not for the email.</p>
<p>This is the test I did.<br>
<strong>the user</strong></p>
<div class="codehilite"><pre><span></span>dn: uid=enriquerivera,ou=users,dc=mydomain,dc=org
objectClass: inetOrgPerson
uid: enriquerivera
cn: Rivera, Enrique
givenName: Enrique
sn: Rivera
mail: enriquerivera@mydomain.org
mail: enriquerivera@gmail.com
</pre></div>


<p>I can succesfully login with the same password using as a username either <code>enriquerivera</code> or <code>enriquerivera@mydomain.org</code> or <code>enriquerivera@gmail.com</code>. This is possible because the <code>AUTH_LDAP_REVERSE_EMAIL_SEARCH</code> query will find the user with either email.</p>
<p>The problem is that if I change the email only in to Zulip with <code>enriquerivera@hotmail.com</code> aftewards  is impossible to login with username <code>enriquerivera@hotmail.com</code>, and loggin in with <code>enriquerivera</code> creates a new user in Zulip.</p>



<a name="845417"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845417" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845417">(Apr 01 2020 at 12:49)</a>:</h4>
<p>I think that for now I'll just tell everybody to use the <code>username</code> to login. If someone logins with the email it's fine; I'll just not officially support it because it can be a problem in some cases.<br>
I'll also disable the change of email.</p>



<a name="845465"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845465" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845465">(Apr 01 2020 at 15:06)</a>:</h4>
<p><span class="user-mention" data-user-id="15289">@Francesco</span> If you have two different people with the same email log into zulip with their individual <code>uid+password</code>, it'll indeed log them in, but it'll be a single zulip account. Because to zulip, the identity of a user is their email address.</p>



<a name="845468"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845468" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mateusz Mandera <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845468">(Apr 01 2020 at 15:09)</a>:</h4>
<p>Zulip doesn't care about the uid, when you log in with uid:<br>
It finds the entry in the ldap directory with the uid and verifies the password -&gt; "Okay, this user is authenticated to this ldap account" -&gt; Searches for email to figure out to which Zulip account to authenticate you -&gt; Authenticates you to the unique zulip account in the orgniazation with the found email</p>



<a name="845471"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845471" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Francesco <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845471">(Apr 01 2020 at 15:10)</a>:</h4>
<p>Auch! Thanks for making that clear. Then I MUST have unique email per account on LDAP. I'll figure something out.</p>



<a name="845820"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845820" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Oktay X <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845820">(Apr 01 2020 at 20:14)</a>:</h4>
<p>If they are sharing emails they might as well share zulip too I'd say. Saves you a whole lot of trouble. :)</p>



<a name="845826"></a>
<h4><a href="https://chat.zulip.org#narrow/stream/31-production%20help/topic/Different%20accounts%20same%20email/near/845826" class="zl"><img src="https://rht.github.io/czo-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tim Abbott <a href="https://rht.github.io/czo-archive/stream/31-production-help/topic/Different.20accounts.20same.20email.html#845826">(Apr 01 2020 at 20:17)</a>:</h4>
<p>Yeah, that's a reasonable conclusion.</p>



<hr><p>Last updated: Oct 02 2023 at 04:38 UTC</p>
</html>